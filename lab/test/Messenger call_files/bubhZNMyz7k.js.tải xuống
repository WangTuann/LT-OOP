if (self.CavalryLogger) { CavalryLogger.start_js(["uOImf"]); }

__d("RTWebCallModelTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:RTWebCallModelLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:RTWebCallModelLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:RTWebCallModelLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setCallModelEvent=function(a){this.$1.call_model_event=a;return this};c.setFluxStores=function(a){this.$1.flux_stores=a;return this};c.setInfraCallModel=function(a){this.$1.infra_call_model=a;return this};c.setPublicCallModel=function(a){this.$1.public_call_model=a;return this};return a}();c={call_id:!0,call_model_event:!0,flux_stores:!0,infra_call_model:!0,public_call_model:!0};e.exports=a},null);
__d("ZenonMWSendMessageMutation.graphql",[],function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"RtcWebSendMultiwaySignalingMessageResponsePayload",kind:"LinkedField",name:"rtc_web_send_multiway_signaling_message",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"header",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"body",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"ZenonMWSendMessageMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"ZenonMWSendMessageMutation",selections:b},params:{id:"2430330443724069",metadata:{},name:"ZenonMWSendMessageMutation",operationKind:"mutation",text:null}}}();e.exports=a},null);
__d("ZenonP2PSendMessageMutation.graphql",[],function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],kind:"ScalarField",name:"rtc_web_send_p2p_signaling_message",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"ZenonP2PSendMessageMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"ZenonP2PSendMessageMutation",selections:b},params:{id:"2599144283486119",metadata:{},name:"ZenonP2PSendMessageMutation",operationKind:"mutation",text:null}}}();e.exports=a},null);
__d("FluxDebugUtils",["areEqual","flattenArray","getByPath"],function(a,b,c,d,e,f){"use strict";f.diff=n;f.diffStoreMutation=o;f.diffStoreMutationInstance=a;f.isOperationTouchingPath=c;f.getStoreStateFromStoreConfig=d;f.getStoreInstanceFromStoreConfig=e;f.applyPlugins=p;var g;function h(a,c){return(g||(g=b("areEqual")))(a,c.slice(0,a.length))}function i(a){return Object.prototype.toString.call(a)==="[object Object]"}function j(a){return Object.keys(a).sort()}function k(a,b){return j(a).filter(function(a){return!(a in b)})}function l(a,b){return j(b).filter(function(b){return!(b in a)})}function m(a,b){return j(a).filter(function(a){return a in b})}function n(a,c){if(!i(a)||!i(c))return[];var d=l(a,c).map(function(a){var b;return{path:[],op:"add",value:(b={},b[a]=c[a],b)}}),e=k(a,c).map(function(a){return{path:[a],op:"delete"}}),f=[].concat(b("flattenArray")(m(a,c).map(function(d){if((g||(g=b("areEqual")))(a[d],c[d]))return[];return!i(a[d])||!i(c[d])?{path:[d],op:"update",oldValue:a[d],newValue:c[d]}:n(a[d],c[d]).map(function(a){return babelHelpers["extends"]({},a,{path:[d].concat(a.path)})})})));return[].concat(d,e,f)}function o(a){return a.prevState&&a.prevState.toJS?n(a.prevState.toJS(),a.currState.toJS()):n(a.prevState,a.currState)}function a(a){return o(a.mutation)}function c(a,c){if((g||(g=b("areEqual")))(a.path,c))return!0;if(h(a.path,c)){c=c.slice(a.path.length);a=a.value||a.newValue;return!!b("getByPath")(a,c)}return!1}function d(a){return a.store&&a.stateGetter?a.stateGetter():a.getState()}function e(a){return a.store||a}function p(a,b,c){b.forEach(function(d){return a[d.name]=function(){for(var a=arguments.length,e=new Array(a),f=0;f<a;f++)e[f]=arguments[f];var g=d.run.apply(d,[c()].concat(e));p(g,b,function(){return g});return g}})}},null);
__d("TWriteBuffer",[],function(a,b,c,d,e,f){a=function(){function a(b){b===void 0&&(b=a.DEFAULT_BYTE_BUFFER_SIZE),this.$1=new DataView(new ArrayBuffer(b)),this.$2=0}var b=a.prototype;b.write=function(a){this.$2+a.length>this.$1.byteLength&&this.$3(this.$2+a.length);for(var b=0;b<a.length;b++)this.$1.setUint8(this.$2+b,a[b]);this.$2+=a.length;return a.length};b.writeByte=function(a){this.$2+1>this.$1.byteLength&&this.$3(this.$2+1);this.$1.setUint8(this.$2,a);this.$2++;return 1};b.writeFloatBE=function(a){this.$2+Float32Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float32Array.BYTES_PER_ELEMENT);this.$1.setFloat32(this.$2,a);this.$2+=Float32Array.BYTES_PER_ELEMENT;return Float32Array.BYTES_PER_ELEMENT};b.writeDoubleBE=function(a){this.$2+Float64Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float64Array.BYTES_PER_ELEMENT);this.$1.setFloat64(this.$2,a);this.$2+=Float64Array.BYTES_PER_ELEMENT;return Float64Array.BYTES_PER_ELEMENT};b.toByteArray=function(){var a=new Uint8Array(this.$1.buffer,0,this.$2);return a};b.currentSize=function(){return this.$2};b.getUnderlyingDataView=function(){return this.$1};b.$3=function(a){a=a*2;if(!Number.isSafeInteger(a))throw new Error("unable to resize");a=new DataView(new ArrayBuffer(a));for(var b=0;b<this.$2;b++)a.setUint8(b,this.$1.getUint8(b));this.$1=a};b.readByte=function(){throw new Error("operation not supported")};b.readBytes=function(a){throw new Error("operation not supported")};b.readFloatBE=function(){throw new Error("operation not supported")};b.readDoubleBE=function(){throw new Error("operation not supported")};return a}();e.exports=a;a.DEFAULT_BYTE_BUFFER_SIZE=16},null);
__d("StringToUtf8",["TWriteBuffer"],function(a,b,c,d,e,f){a=function(a){var c=new(b("TWriteBuffer"))(a.length),d;for(var e=0;e<a.length;e++){d=a.charCodeAt(e);if(d<128)c.writeByte(d);else if(d<2048)c.writeByte(d>>6|192),c.writeByte(d&63|128);else if((d&64512)==55296){if(e+1>=a.length)throw new Error("UTF-16 string is truncated: ["+d.toString(16)+"]");if((a.charCodeAt(e+1)&64512)!==56320)throw new Error("Invalid UTF-16 string: ["+d.toString(16)+", "+a.charCodeAt(e+1).toString(16)+"]");d=65536+((d&1023)<<10)+(a.charCodeAt(++e)&1023);c.writeByte(d>>18|240);c.writeByte(d>>12&63|128);c.writeByte(d>>6&63|128);c.writeByte(d&63|128)}else c.writeByte(d>>12|224),c.writeByte(d>>6&63|128),c.writeByte(d&63|128)}return c.toByteArray()};e.exports={StringToUtf8:a}},null);
__d("Utf8ToString",[],function(a,b,c,d,e,f){var g=function(a,b){throw new Error(a+": ["+b.map(function(a){return a.toString(16)}).toString()+"]")},h=function(a){g("Invalid UTF-8 sequence",a)},i=function(a,b){g("Not enough bytes for "+a+"-byte sequence",b)};a=function(a){var b=0,c=[];while(b<a.length){var d=a[b++];if(d<128)c.push(String.fromCharCode(d));else if(d>=128&&d<194)h([d]);else if(d>=194&&d<224){b>=a.length&&i(2,[d]);var e=a[b++];(e&192)!==128&&h([d,e]);c.push(String.fromCharCode((d&31)<<6|e&63))}else if(d>=240&&d<245){b+2>=a.length&&i(4,[d]);e=a[b++];var f=a[b++],g=a[b++];(d==240&&(!(e>=144&&e<192)||(f&192)!==128||(g&192)!==128)||d>=241&&d<244&&((e&192)!==128||(f&192)!==128||(g&192)!==128)||d==244&&(!(e>=128&&e<144)||(f&192)!==128||(g&192)!==128))&&h([d,e,f,g]);e=((d&7)<<18|(e&63)<<12|(f&63)<<6|g&63)-65536;c.push(String.fromCharCode(55296+(e>>10)));c.push(String.fromCharCode(56320+(e&1023)))}else if(d>=245)h([d]);else{b+1>=a.length&&i(3,[d]);f=a[b++];g=a[b++];d==224?f>=160&&f<192||h([d,f,g]):d>=225&&d<237?f>=128&&f<192||h([d,f,g]):d==237?f>=128&&f<160||h([d,f,g]):d>=238&&d<240&&(f>=128&&f<192||h([d,f,g]));g>=128&&g<192||h([d,f,g]);c.push(String.fromCharCode((d&15)<<12|(f&63)<<6|g&63))}}return c.join("")};e.exports={Utf8ToString:a}},null);
__d("TNoOpWriteBuffer",[],function(a,b,c,d,e,f){a=function(){function a(){this.$1=0}var b=a.prototype;b.write=function(a){this.$1+=a.length;return a.length};b.writeByte=function(a){this.$1++;return 1};b.writeFloatBE=function(a){this.$1+=Float32Array.BYTES_PER_ELEMENT;return Float32Array.BYTES_PER_ELEMENT};b.writeDoubleBE=function(a){this.$1+=Float64Array.BYTES_PER_ELEMENT;return Float64Array.BYTES_PER_ELEMENT};b.toByteArray=function(){throw new Error("operation not supported")};b.currentSize=function(){return this.$1};b.readByte=function(){throw new Error("operation not supported")};b.readBytes=function(a){throw new Error("operation not supported")};b.readFloatBE=function(){throw new Error("operation not supported")};b.readDoubleBE=function(){throw new Error("operation not supported")};return a}();e.exports=a},null);
__d("TReadBuffer",[],function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a,this.$2=0}var b=a.prototype;b.readByte=function(){if(this.$2<this.$1.length)return this.$1[this.$2++];throw new Error("no available byte to read")};b.readBytes=function(a){if(a<0)throw new Error("cannot readBytes of negative length: "+a);if(a+this.$2>this.$1.length)throw new Error("not enough bytes to read");var b=new Uint8Array(this.$1.buffer,this.$3(),a);this.$2+=a;return b};b.readFloatBE=function(){if(Float32Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var a=new DataView(this.$1.buffer).getFloat32(this.$3());this.$2+=Float32Array.BYTES_PER_ELEMENT;return a};b.readDoubleBE=function(){if(Float64Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var a=new DataView(this.$1.buffer).getFloat64(this.$3());this.$2+=Float64Array.BYTES_PER_ELEMENT;return a};b.$3=function(){return this.$2+this.$1.byteOffset};b.getCurrentCursor=function(){return this.$2};b.writeByte=function(a){throw new Error("operation not supported")};b.write=function(a){throw new Error("operation not supported")};b.toByteArray=function(){throw new Error("operation not supported")};b.writeFloatBE=function(a){throw new Error("operation not supported")};b.writeDoubleBE=function(a){throw new Error("operation not supported")};return a}();e.exports=a},null);
__d("CometBlueBridgeContext",["React"],function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext(!1);e.exports=c},null);
__d("BaseScrollableArea.react",["BaseScrollableAreaContext","CometVisualCompletionAttributes","React","UserAgent","debounce","gkx","resize-observer-polyfill","stylex","useVisibilityObserver"],function(a,b,c,d,e,f){"use strict";var g,h=b("React"),i={baseScroller:{display:"j83agx80",flexDirection:"cbu4d94t",flexGrow:"buofh1pr"},baseScrollerHorizontal:{flexDirection:"btwxx1t3"},"default":{MsOverflowStyle:"o8kakjsu",MsScrollChaining:"rpm2j7zs",MsScrollRails:"k7i0oixp",WebkitOverflowScrolling:"gvuykj2m",display:"j83agx80",flexDirection:"cbu4d94t",overflowX:"ni8dbmo4",overflowY:"stjgntxs",position:"l9j0dhe7",zIndex:"du4w35lb"},expanding:{flexBasis:"d8ncny3e",flexGrow:"buofh1pr",flexShrink:"g5gj957u",minHeight:"tgvbjcpo"},hideScrollbar:{MsOverflowStyle:"q5bimw55",scrollbarWidth:"ofs802cu","::-webkit-scrollbar":{display:"pohlnb88",height:"dkue75c7",width:"mb9wzai9"}},horizontalAuto:{overflowX:"d76ob5m9",overscrollBehaviorX:"qan41l3s"},perspective:{perspective:"l56l04vs",perspectiveOrigin:"r57mb794",position:"l9j0dhe7",transformStyle:"kh7kg01d"},verticalAuto:{overflowY:"eg9m0zos",overscrollBehaviorY:"c3g1iek1"}},j={base:{boxSizing:"rq0escxv",display:"mkhogb32",opacity:"b5wmifdl",paddingTop:"jb3vyjys",paddingEnd:"ph5uu5jm",paddingBottom:"qt6c0cv9",paddingStart:"b3onmgus",pointerEvents:"hzruof5a",position:"pmk7jnqg",right:"kwrap0ej",top:"kr520xx4",transformOrigin:"enuw37q7",transitionDuration:"dpja2al7",transitionProperty:"art1omkt",transitionTimingFunction:"nw2je8n7",width:"hhz5lgdu"},hovered:{opacity:"pedkr2u6",transitionDuration:"z1801hqc"},inner:{backgroundColor:"oj68ptkr",borderTopStartRadius:"jk6sbkaj",borderTopEndRadius:"kdgqqoy6",borderBottomEndRadius:"ihh4hy1g",borderBottomStartRadius:"qttc61fc",height:"datstx6m",width:"k4urcfbm"}},k={base:{backgroundColor:"pwoa4pd7",display:"mkhogb32",height:"datstx6m",opacity:"b5wmifdl",position:"pmk7jnqg",right:"kwrap0ej",top:"kr520xx4",transitionDuration:"qgmjvhk0",transitionProperty:"art1omkt",transitionTimingFunction:"nw2je8n7",width:"hhz5lgdu",":hover":{opacity:"pyaxyem1"}}},l=b("gkx")("1708607");function a(a,c){var d=a.children,e=a.expanding;e=e===void 0?!1:e;var f=a.hideScrollbar,l=f===void 0?!1:f,m=a.horizontal;f=a.id;var n=a.onScroll,r=a.onScrollBottom,s=a.onScrollTop,t=a.style,u=a.testid,v=a.vertical;u=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","expanding","hideScrollbar","horizontal","id","onScroll","onScrollBottom","onScrollTop","style","testid","vertical","xstyle"]);var w=h.useMemo(function(){return!v||l||m||q()},[v,l,m]),x=h.useState(!1),y=x[0],z=x[1];x=h.useState(!1);var A=x[0],B=x[1];x=h.useState(!1);var C=x[0],D=x[1],E=h.useContext(b("BaseScrollableAreaContext")),F=h.useRef(null),G=h.useRef(null),H=h.useRef(null),I=h.useRef(null),J=h.useRef(null),K=h.useRef(0);h.useEffect(function(){if(w)return;var a=F.current,c=G.current,d=H.current,e=I.current;if(a==null||c==null||d==null||e==null)return;var f=0,g=0,h=function(){e.style.display="none";d.style.display="none";var a=c.getBoundingClientRect(),b=a.height;g=a.top;K.current=c.scrollHeight;a=K.current;a!==c.scrollHeight&&(a=c.scrollHeight);f=Math.pow(b,2)/a;var h=(b-f)/(a-b);d.style.right="0px";e.style.right="0px";d.style.height=a<=b?"0px":f+"px";e.style.height=a+"px";d.style.transform=["matrix3d(\n          1,0,0,0,\n          0,1,0,0,\n          0,0,1,0,\n          0,0,0,-1)","scale("+1/h+")","translateZ("+(1-1/h)+"px)","translateZ(-2px)"].join(" ");d.style.display="block";e.style.display=a<=b?"none":"block"},i=function(a){a.preventDefault();var b=a.clientY;a=c.clientHeight;var d=c.scrollTop;D(!0);var h=K.current/a;a=d/h;var i=function(a){a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation()};if(b<g+a||b>g+a+f){var j=b<g+a?-20:20,k=!0,l=window.setInterval(function(){k&&c.scrollTo({top:c.scrollTop+j})},16);a=function a(b){i(b),l&&window.clearInterval(l),window.removeEventListener("mouseup",a,!0),e.removeEventListener("mouseenter",m),e.removeEventListener("mouseleave",n)};var m=function(a){k=!0},n=function(a){k=!1};window.addEventListener("mouseup",a,!0);e.addEventListener("mouseenter",m);e.addEventListener("mouseleave",n);return}var o=function(a){i(a);a=a.clientY-b;c.scrollTo({top:d+a*h})};a=function a(b){i(b),D(!1),window.removeEventListener("mousemove",o,!0),window.removeEventListener("mouseup",a,!0)};window.addEventListener("mousemove",o,!0);window.addEventListener("mouseup",a,!0)},j=b("debounce")(h,100);window.addEventListener("resize",j);e.addEventListener("mousedown",i);var k=new(b("resize-observer-polyfill"))(j);k.observe(a);return function(){window.removeEventListener("resize",j),e.removeEventListener("mousedown",i),k.disconnect(),j.reset()}},[w]);x=function(){z(!0)};var L=function(){return z(!1)},M=function(a){n&&n(a),B(!0),J.current&&window.clearTimeout(J.current),J.current=window.setTimeout(function(){B(!1)},1e3)};h.useEffect(function(){return function(){window.clearTimeout(J.current)}},[]);var N=h.useMemo(function(){return{getDOMNode:function(){return G.current}}},[]);h.useImperativeHandle(c,function(){return N});c=h.useMemo(function(){return[].concat(E,[N])},[N,E]);return w?h.jsx(b("BaseScrollableAreaContext").Provider,{value:c,children:h.jsx("div",babelHelpers["extends"]({},a,{className:(g||(g=b("stylex")))(i["default"],e&&i.expanding,l&&i.hideScrollbar,m&&i.horizontalAuto,v&&i.verticalAuto,u),"data-testid":void 0,id:f,onScroll:M,ref:G,style:t,children:h.jsxs("div",{className:g(i.baseScroller,m&&!v&&i.baseScrollerHorizontal),children:[s?h.jsx(p,{onVisible:s,scrollerRef:G}):null,d,r?h.jsx(o,{onVisible:r,scrollerRef:G}):null]})}))}):h.jsx(b("BaseScrollableAreaContext").Provider,{value:c,children:h.jsxs("div",babelHelpers["extends"]({},a,{className:(g||(g=b("stylex")))(i["default"],i.hideScrollbar,e&&i.expanding,i.perspective,m&&i.horizontalAuto,v&&i.verticalAuto,u),"data-testid":void 0,id:f,onMouseEnter:x,onMouseLeave:L,onScroll:M,ref:G,style:t,children:[h.jsxs("div",{className:g(i.baseScroller,m&&!v&&i.baseScrollerHorizontal),ref:F,children:[s?h.jsx(p,{onVisible:s,scrollerRef:G}):null,d,r?h.jsx(o,{onVisible:r,scrollerRef:G}):null]}),h.jsx("div",babelHelpers["extends"]({className:g(k.base)},b("CometVisualCompletionAttributes").IGNORE,{"data-thumb":1,ref:I})),h.jsx("div",babelHelpers["extends"]({className:g(j.base,(y||A||C)&&j.hovered)},b("CometVisualCompletionAttributes").IGNORE,{"data-thumb":1,ref:H,children:h.jsx("div",{className:g(j.inner)})}))]}))})}var m={main:{height:"ay7djpcl",opacity:"b5wmifdl",pointerEvents:"hzruof5a",width:"rfua0xdk"},top:{position:"pmk7jnqg",top:"kr520xx4"}};function n(a){var c=a.onVisible,d=a.scrollerRef;a=a.xstyle;var e=h.useMemo(function(){return l?function(){return d.current}:void 0},[d]);c=b("useVisibilityObserver")({onVisible:c,options:{root:e}});return h.jsx("div",{className:(g||(g=b("stylex")))(m.main,a),ref:c})}function o(a){var b=a.onVisible;a=a.scrollerRef;return h.jsx(n,{onVisible:b,scrollerRef:a})}function p(a){var b=a.onVisible;a=a.scrollerRef;return h.jsx(n,{onVisible:b,scrollerRef:a,xstyle:m.top})}function q(){return b("UserAgent").isPlatform("iOS")||b("UserAgent").isPlatform("Android")||b("UserAgent").isBrowser("Edge")||b("UserAgent").isBrowser("IE")||b("UserAgent").isBrowser("Firefox < 64")}c=h.forwardRef(a);e.exports=c},null);
__d("FBRTCCallSummaryPageVisibilityObserver",["FBRTCLogger","Visibility","requireCond","cr:1440831"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){var a=this;this.$1=new Map();if(b("Visibility").isSupported()){var c;(c=b("Visibility")).addListener(c.HIDDEN,function(){a.$1.forEach(function(a){a.addExtraInfo(b("FBRTCLogger").Key.APPLICATION_STATE,b("Visibility").HIDDEN),b("cr:1440831")&&b("cr:1440831").logCallSummaryHeartbeat(a,"pagehide")})});c.addListener(c.VISIBLE,function(){a.$1.forEach(function(a){a.addExtraInfo(b("FBRTCLogger").Key.APPLICATION_STATE,b("Visibility").VISIBLE),b("cr:1440831")&&b("cr:1440831").logCallSummaryHeartbeat(a,"pageunhide")})})}}var c=a.prototype;c.onCallStart=function(a){this.$1.set(a.callID,a),b("Visibility").isSupported()&&a.addExtraInfo(b("FBRTCLogger").Key.APPLICATION_STATE,b("Visibility").VISIBLE)};c.onCallEnd=function(a){this.$1["delete"](a.callID)};return a}();c=new a();e.exports=c},null);
__d("RTCIceCandidate",[],function(a,b,c,d,e,f){"use strict";a=window.RTCIceCandidate||window.mozRTCIceCandidate;e.exports=a},null);
__d("RTCPeerConnection",[],function(a,b,c,d,e,f){"use strict";e.exports=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection},null);
__d("FBRTCCallConstants",[],function(a,b,c,d,e,f){e.exports=Object.freeze({FBRTCCallConnectionType:{MISSED_CALL:4,CONNECTED_CALL:5},FBRTCCallType:{VOICE_CALL:1,VIDEO_CALL:2,COLLAB_VIDEO_CALL:3,COLLAB_SCREEN_SHARE_CALL:4}})},null);
__d("ScotchFBRTCUtils",["AsyncRequest","FBIDCheck","FBRTCConfig","ScotchRTWebUserActionLogger","assignMediaStream","emptyFunction"],function(a,b,c,d,e,f){f.attachMediaStream=a;f.aboutEqual=c;f.sendServerRequest=d;f.supportsSetSink=e;f.isPeerVCEndpoint=i;f.isCollabTrigger=j;var g=6e3,h="setSinkId"in window.HTMLMediaElement.prototype;function a(a,c){if(a==null)return;b("assignMediaStream")(a,c);if(c){c=a.play();c!==void 0&&c["catch"](function(a){b("ScotchRTWebUserActionLogger").logError({errorDomain:"autoplay was prevented",errorType:a.toString()})})}}function c(a,b){return a-b<.01&&b-a<.01}function d(a,c,d,e,f,h){c===void 0&&(c=b("emptyFunction"));d===void 0&&(d=b("emptyFunction"));e===void 0&&(e=!1);f===void 0&&(f=g);h===void 0&&(h={});a=new(b("AsyncRequest"))().setURI(a).setData(h).setAllowCrossPageTransition(!0).setHandler(c).setErrorHandler(d).setTimeoutHandler(f,function(){d()});e&&a.setOption("asynchronous_DEPRECATED",!1);a.send()}function e(){return h}function i(a){var c=b("FBRTCConfig").isVCEndpointCall();return c!==void 0?c:!!a&&!b("FBIDCheck").isUser_deprecated(a)}function j(a){return a==="quickdial"||a==="meeting_room_page_profile"}},null);
__d("XVideoCallAdminMessageController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/admin_msg/",{})},null);
__d("ScotchFBRTCAdminMessage",["FBRTCCallConstants","FBRTCConstants","FBRTCLogger","ScotchFBRTCUtils","ScotchRTWebUserActionLogger","XVideoCallAdminMessageController","emptyFunction","performanceNow"],function(a,b,c,d,e,f){var g;a=function(){function a(a,b){this.$1=a,this.$2=b,this.$3=Date.now(),this.$4=null,this.$5=null}var c=a.prototype;c.getPeerID=function(){return this.$1};c.getCallID=function(){return this.$2};c.getStartTimestamp=function(){return this.$3};c.getConnectedTime=function(){return this.$4};c.getEndTime=function(){return this.$5};c.onCallConnected=function(){this.$4||(this.$4=(g||(g=b("performanceNow")))())};c.onCallEnded=function(){this.$5||(this.$5=(g||(g=b("performanceNow")))())};c.submit=function(a,c,d){this.$5||this.onCallEnded();var e=0,f=b("FBRTCCallConstants").FBRTCCallConnectionType.MISSED_CALL;this.$4&&this.$5&&(e=Math.ceil(this.$5-this.$4),f=b("FBRTCCallConstants").FBRTCCallConnectionType.CONNECTED_CALL);c=f===b("FBRTCCallConstants").FBRTCCallConnectionType.CONNECTED_CALL||c===b("FBRTCConstants").CallEndReason.IGNORE_CALL;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"admin_message_"+f});this.$6({peer_id:this.$1,call_id:this.$2,start_time:this.$3,call_duration:e,message_type:f,call_category:a,call_acknowledged:c,conference_name:d})};c.$6=function(a){var c=b("XVideoCallAdminMessageController").getURIBuilder().getURI();b("ScotchFBRTCUtils").sendServerRequest(c,b("emptyFunction"),this.$7.bind(this,a.peer_id,a.call_id),!1,void 0,a)};c.$7=function(a,c,d){d?d="Fail to log admin message, error "+d.error:d="Server timed out on logging admin message";b("FBRTCLogger").getInstance().logError(a,c,d)};return a}();e.exports=a},null);
__d("ScotchFBRTCIceCache",[],function(a,b,c,d,e,f){a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.getCache=function(){var a={};for(var b=this.$1,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];a[f]={};for(var e=e,g=Array.isArray(e),h=0,e=g?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=e.length)break;i=e[h++]}else{h=e.next();if(h.done)break;i=h.value}i=i;var j=i[0];i=i[1];a[f][j]=i}}return a};b.reset=function(a,b){var c=this.$1.get(a);c||(c=new Map(),this.$1.set(a,c));c.set(b,[])};b.cacheCandidate=function(a,b,c){var d=this.$1.get(a);d||(d=new Map(),this.$1.set(a,d));a=d.get(b);a||(a=[],d.set(b,a));a.unshift(c)};b.drainCandidates=function(a,b,c){a=this.$1.get(a);if(a){a=a.get(b)||[];while(a.length>0){b=a.pop();c(b)}}};return a}();e.exports=a},null);
__d("ScotchRTWebExperiments",["FBRTCConfig","ScotchRTWebUserActionLogger","gkx","qex"],function(a,b,c,d,e,f){"use strict";f.enableCallCollisionFix=a;f.passOfferWithWindowMessages=c;f.shouldUseZenonMediaStatsParser=d;f.shouldUseZenonStarRating=e;f.shouldUseZenonHeaderContainer=g;f.shouldUseZenonSignaling=h;f.shouldUseZenonCallStatus=i;f.getNumSimulcastLayers=j;f.shouldUseUnifiedPlan=k;f.shouldUseMWUnifiedPlanSDP=l;f.shouldUseP2PUnifiedPlanSDP=m;f.shouldSubscribeToSimpleTopicOnJoin=n;function a(){var a;return b("FBRTCConfig").isVCEndpointCall()?!1:(a=b("qex")._("771668"))!=null?a:!1}function c(){var a;return b("FBRTCConfig").isVCEndpointCall()?!1:(a=b("qex")._("771669"))!=null?a:!1}function d(){var a;a=(a=b("qex")._("901545"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_zenon_stats_parser"});return a}function e(){var a;a=(a=b("qex")._("903503"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: new_star_rating_container"});return a}function g(){var a;a=(a=b("qex")._("946845"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_zenon_header_container"});return a}function h(){var a;a=(a=b("qex")._("907889"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: refactor_listener"});return a}function i(){var a;a=(a=b("qex")._("944477"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: new_call_status"});return a}function j(){var a;return(a=b("qex")._("1574288"))!=null?a:1}function k(){var a=b("gkx")("1429707");a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_sdp_interop"});return a}function l(){var a;a=(a=b("qex")._("1146131"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_unified_plan"});return a}function m(){var a;a=(a=b("qex")._("1162655"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_p2p_unified_plan"});return a}function n(){var a;a=(a=b("qex")._("1447474"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_state_sync_test, param: subscribe_simple_on_join"});return a}},null);
__d("ScotchRTWebClientFeatureGating",["CurrentUser","FBRTCConfig","FBRTCExperiment","FBRTCSupport","ScotchRTWebExperiments","gkx"],function(a,b,c,d,e,f){"use strict";f.isVCCallOrWorkUser=a;f.addScreenContentTypeInSDP=c;f.draggableSelfView=d;f.endCallSurveyDropdownOptions=e;f.canUseMWVideoFilters=g;f.isChatEnabled=h;f.isGroupChatEnabled=i;f.useNewIncomingCallDialog=j;f.answerCallWithThreeButtons=k;f.callUnification=l;f.waitForMediaPermission=m;f.canUseMultiwaySandbox=n;f.stopVideoWhenMute=o;f.restartVideoWithTrackAPI=p;f.shouldAlwaysShowRedial=q;f.disableOpusStereo=r;f.shouldApplySdpMidTranslation=s;f.preserveFirefoxInactiveDataChannelBlock=t;f.showMojavePermissionsWarning=u;f.alwaysOpenChatTab=v;f.shouldShowNetworkQualityIndicator=w;f.shouldMonitorNetworkQuality=x;f.preferIsacForGroupCalls=y;function a(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()}function c(){return!1}function d(){return b("FBRTCExperiment").gen("rtc_www_larger_self_view").getBool("draggable_self_view",!1)}function e(){return!this.isVCCallOrWorkUser()}function g(){return!b("CurrentUser").isWorkUser()&&b("FBRTCSupport").isVideoFilterEffectSupported()}function h(){return!b("FBRTCConfig").isVCEndpointCall()}function i(){return!1}function j(){return b("FBRTCExperiment").getIncomingCallExperiments().getBool("use_new_incoming_call_dialog",!1)}function k(){return b("FBRTCExperiment").getIncomingCallExperiments().getBool("use_three_buttons",!1)}function l(){return b("FBRTCExperiment").gen("rtc_www_call_unification").getBool("in_call_background_updated",!1)}function m(){return!1}function n(){return b("gkx")("678350")}function o(){if(b("FBRTCConfig").isVCEndpointCall())return!1;var a=b("FBRTCExperiment").gen("turnoff_camera_when_facemute");return a.getBool("camera_off",!1)}function p(){var a=b("FBRTCExperiment").gen("turnoff_camera_when_facemute");return a.getBool("track_api",!1)}function q(){return!this.isVCCallOrWorkUser()}function r(){return b("gkx")("678351")}function s(){return b("gkx")("700608")||b("ScotchRTWebExperiments").shouldUseP2PUnifiedPlanSDP()}function t(){return b("gkx")("724606")}function u(){return navigator.userAgent.indexOf("Intel Mac OS X 10_14")!==-1}function v(){return b("FBRTCExperiment").gen("rt_web_fb_profile_rtc_buttons").getBool("open_chat_tab",!1)}function w(){return this.isVCCallOrWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("show_network_indicator",!1)}function x(){return this.isVCCallOrWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("monitor_network_quality",!1)}function y(){return!b("FBRTCConfig").isVCEndpointCall()}},null);
__d("ScotchFBRTCSdpUtils",["FBLogger","ScotchRTWebClientFeatureGating","UserAgent"],function(a,b,c,d,e,f){f.replaceRTPSAVPFProfile=a;f.addIceOptionToSdp=c;f.preferIsac=d;f.preferCodec=e;f.disableVideo=q;f._makeDisabledVideoReceiveOnly=r;f.fixMobileIceSdp=s;f.addAudioNack=t;f.addSetup=u;f._replaceFmtp=v;f._addFmtpToMediaSection=w;f.addFmtp=x;f._getrtcpFeedbackLinesFromAudioFMTs=y;f._removeCodec=z;f.removeRED=A;f.removeH264=B;f.removeVP9=C;f.removeUnknownRtpHeaderExtensions=D;f.isVideoSupported=E;f.setDtlsRole=F;f.setVideoBitrateConstraint=G;f.removeSdparta=H;f.constructMidMap=I;f.constructMidMapFromRemoteOffer=J;f.transformSdpMids=K;f.useDTLSOverCrypto=L;f.validateOfferSdp=M;f._removeCodecID=N;f._getAllCodecIds=O;f._getCodecIDMatchingH264Profile=P;f.pickSpecificH264ProfileIfExists=Q;f.promoteSpecificH264ProfileIfExists=R;f.clearFirefoxInactiveDataChannelBlock=S;f.maybeAddPtimeForOpusOnly=T;f.toLoggingString=U;f.addFBFeatures=V;f.getFBFeatures=W;f.addSSRCContentType=$;var g="a=x-fb-feature:",h="\r\n",i="m=video 0";a=["audio","video"].map(function(a){return new RegExp("m="+a+"\\s+\\d+\\s+(\\w+\\/?)+(\\s+\\d+)+")});var j=a[0],k=a[1];f.RX_SDP_MEDIA_VIDEO=k;f.RX_SDP_MEDIA_AUDIO=j;var l=["http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01","http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time","urn:3gpp:video-orientation","urn:ietf:params:rtp-hdrext:ssrc-audio-level","urn:ietf:params:rtp-hdrext:toffset"],m=function(a){return a.match(/^a=rtpmap:(\d+)\s/)[1]},n=function(a,b,c){var d=m(a[b]);o(a,c,[d]);a.splice(b,1)},o=function(a,b,c){var d=a[b].split("RTP/SAVPF"),e=d[1].split(/\s+/);for(var f=0;f<c.length;f++){var g=e.indexOf(c[f]);g>=0&&e.splice(g,1)}d[1]=e.join(" ");a[b]=d.join("RTP/SAVPF")},p=function(a,b,c){var d=m(a[b]);n(a,b,c);var e=new RegExp("^a=(rtcp-fb|fmtp):"+d+" ");a=a.filter(function(a,b){return!(e.test(a)&&b>=c)});var f=new RegExp("^a=fmtp:(\\d+)\\s+apt="+d+"($|;)");b=a.reduce(function(a,b,c){c=b.match(f);return c?[].concat(a,[c[1]]):a},[]);d=b.join("|");o(a,c,b);var g=new RegExp("^a=rtpmap:("+d+")\\s+rtx/|^a=fmtp:("+d+")\\s+apt=");return a.filter(function(a){return!g.test(a)})};function a(a){var b="UDP/TLS/RTP/SAVPF",c="RTP/SAVPF";while(a.indexOf(b)>=0)a=a.replace(b,c);return a}function c(a,b){"use strict";var c="a=ice-options:",d=a.indexOf(c);if(d>=0)return a.split(h).map(function(a){return a.startsWith(c)?a+" "+b:a}).join(h);d=c+b;var e=a.split(h),f=!1,g=-1;for(var i=0;i<e.length;i++){var j=e[i].slice(0,2);if(j=="s="){f=!0;continue}if(f&&j=="a="){g=i;break}}if(g>=0){e.splice(g,0,d);return e.join(h)}return[a,d,h].join("")}function d(a){a=a.split(h);var b=-1,c=-1,d=-1;for(var e=0;e<a.length;e++){var f=a[e];f.match(j)&&(b=e);d===-1&&b>-1&&f.match(/^a=rtpmap:/)&&(d=e);f.match(/^a=rtpmap:\d+\s+ISAC\/16000/)&&(c=e)}if(b===-1||c===-1||d===-1||a[b].indexOf("RTP/SAVPF")===-1)return a.join(h);f=a[c];n(a,c,b);a.splice(d,0,f);a[b]=a[b].replace("RTP/SAVPF","RTP/SAVPF "+m(f));return a.join(h)}function e(a,b,c){a=a.split(h);var d=c?k:j,e=a.findIndex(function(a){return d.test(a)});if(e!==-1&&a[e].indexOf("RTP/SAVPF")!==-1){var f=new RegExp("^a=rtpmap:\\d+\\s+"+b);c=a.findIndex(function(a){return f.test(a)});var g=/^a=rtpmap:/;b=a.findIndex(function(a,b){return b>e&&g.test(a)});if(c!==-1&&b!==-1){var i=a[c];n(a,c,e);a.splice(b,0,i);a[e]=a[e].replace("RTP/SAVPF","RTP/SAVPF "+m(i))}}return a.join(h)}function q(a){var c=/m=video\s+\S+/;a=a.replace(c,i);b("UserAgent").isBrowser("Firefox <= 37")&&(a=this._makeDisabledVideoReceiveOnly(a));return a}function r(a){if(a.indexOf(i)>-1){var b=a.split(i);b[1]=b[1].replace(/send(recv|only)/,"recvonly");a=b.join(i)}return a}function s(a){a=a.replace(/^a=/,"");a=a.split(/\s+username\s+.+password.+/)[0];var b=a.match(/\s+relay\s+|\s+srflx\s+/),c=a.match(/raddr.+rport.+/);if(b&&!c){b=b[0];c=a.split(b);var d=c[1].match(/^(\d+\.\d+\.\d+\.\d+)\s+(\d+)\s+/),e,f;d?(e=d[1],f=d[2],c[1]=c[1].replace(d[0],"")):(d=c[0].split(/\s+/),e=d[4],f=d[5]);a=""+c[0]+b+"raddr "+e+" rport "+f+" "+c[1]}return a}function t(a){var b=this,c=[];a=a.split(h).map(function(a){var d="";c.length>0&&(/^a=rtpmap:(\d+)/.test(a)||/^a=ssrc/.test(a)||/^m=/.test(a))&&(d+=b._getrtcpFeedbackLinesFromAudioFMTs(c)+h,c=[]);/^m=audio/.test(a)&&(c=a.match(/^m=audio\s+[\d\/]+\s+[\w\/]+([\s+\d+]+)/)[1].trim().split(" "));return d+a}).join(h);c.length>0&&(a+=h+this._getrtcpFeedbackLinesFromAudioFMTs(c));return a}function u(a){if(a.indexOf("a=setup:")>=0)return a;a=a.split(h);var b=a.findIndex(function(a){return a.startsWith("s=")}),c=a.findIndex(function(a,c){return c>b&&a.startsWith("a=")});a.splice(c,0,"a=setup:actpass");return a.join(h)}function v(a,b,c,d){a=a==b?[]:a.substr(b.length).split(";");var e=a.findIndex(function(a){return a.startsWith(c+"=")});d=c+"="+d;e<0?a.push(d):a[e]=d;return""+b+a.join(";")}function w(a,b,c,d){var e=new RegExp("^a=rtpmap:(\\d+)\\s"+b),f=[];a.forEach(function(a,b){a.match(e)&&f.push(b)});if(f.length<=0)return a;f.forEach(function(b){var f=a[b].match(e);f=f[1];var g="a=fmtp:"+f+" ";f=a.findIndex(function(a){return a.startsWith(g)});f===-1&&(f=b+1,a.splice(f,0,g));a[f]=v(a[f],g,c,d)});return a}function x(a,b,c,d){a=a.split(h);var e=-1;for(var f=0;f<=a.length;f++)if(f===a.length||a[f].startsWith("m=")){if(e!==-1){var g=a.splice(e,f-e);g=w(g,b,c,d);a.splice.apply(a,[e,0].concat(g));f=e+1+g.length}e=f}return a.join(h)}function y(a){return a.map(function(a){return"a=rtcp-fb:"+a+" nack"}).join(h)}function z(a,b){a=a;var c=new RegExp("^a=rtpmap:\\d+\\s+"+b+"\\/"),d=new RegExp("^m=video");do{b=a.split(h);var e=b.findIndex(function(a){return c.test(a)}),f=b.findIndex(function(a){return d.test(a)});if(e==-1||f==-1)break;a=p(b,e,f).join(h)}while(!0);return a}function A(a){return this._removeCodec(a,"red")}function B(a){return this._removeCodec(a,"H264")}function C(a){return this._removeCodec(a,"VP9")}function D(a,b){b===void 0&&(b=null);var c=b==null?l:l.concat(b);b=a.split(h);b=b.filter(function(a){return!a.match(/^a=extmap:/)||c.some(function(b){return a.includes(b)})});return b.join(h)}function E(a){return!!a&&a.indexOf("m=video")!==-1&&a.indexOf(i)===-1}function F(a,b){if(!a.match(/setup:(active|passive|actpass)/))return a.replace(/(a=fingerprint:.+)/g,"$1"+h+"a=setup:"+b);else return a.replace(/setup:actpass/g,"setup:"+b)}function G(a){var c=b("UserAgent").isBrowser("Firefox"),d=c?"TIAS":"AS";c=c?72e4:720;var e=new RegExp("^b="+d+":","m");if(a.match(e))return a;a=a.replace(/^a=mid:video\r\n/m,"a=mid:video"+h+"b="+d+":"+c+h);return a}function H(a){if(b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return a;a=a.split(h);var c="audio",d=!1,e=-1;for(var f=0;f<a.length;f++){var g=a[f];g.indexOf("m=audio")===0&&(c="audio");g.indexOf("m=video")===0&&(d=!0,c="video");g.indexOf("a=mid:sdparta_")===0&&(a[f]="a=mid:"+c);g.indexOf("a=group:BUNDLE sdparta_")===0&&(e=f);g.indexOf("a=group:BUNDLE audio sdparta_")===0&&(e=f);g.indexOf("a=group:BUNDLE audio video sdparta_")===0&&b("FBLogger")("rtc_www").mustfix("content_name rewriting will not work anymore, fix sdparta_# in Firefox.")}e>-1&&(d?a[e]="a=group:BUNDLE audio video":a[e]="a=group:BUNDLE audio");return a.join(h)}function I(a){if(!b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return{remoteSdpMap:null,localSdpMap:null};a=a.split(h);var c={},d={},e=null;a.forEach(function(b){b.startsWith("m=audio")?e="audio":b.startsWith("m=video")?e="video":b.startsWith("m=")?e=null:b.startsWith("a=mid:")&&e&&(a=b.split("a=mid:")[1],a!==e&&(c[a]=e,d[e]||(d[e]=a)))});return{localSdpMap:Object.keys(c).length?c:null,remoteSdpMap:Object.keys(d).length?d:null}}function J(a){if(!b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return{remoteSdpMap:null,localSdpMap:null};a=a.split(h);var c={},d={};a.forEach(function(a){a.startsWith("m=audio")?(c["0"]="audio",d.audio="0"):a.startsWith("m=video")&&(c["1"]="video",d.video="1")});return{localSdpMap:Object.keys(c).length?c:null,remoteSdpMap:Object.keys(d).length?d:null}}function K(a,c){if(c==null||!b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return a;var d=c,e=a.split(h);c=-1;e.forEach(function(b,f){if(b.startsWith("a=group:BUNDLE"))c=f;else if(b.startsWith("a=mid:")){a=b.split("a=mid:")[1];b=d[a]||a;e[f]="a=mid:"+b}});if(c>-1){var f=e[c].split("a=group:BUNDLE ")[1].split(" ");f=f.map(function(a){return d[a]||a});e[c]="a=group:BUNDLE "+f.join(" ")}return e.join(h)}function L(a){if(!(b("UserAgent").isBrowser("Chrome >= 57")||b("UserAgent").isBrowser("Edge (Chromium Based)")||b("UserAgent").isBrowser("Opera >= 44")))return a;return!/^a=fingerprint:/m.test(a)?a:a.split(h).filter(function(a){return a.indexOf("a=crypto:")!==0}).join(h)}function M(a,b){if(a.split(":")[0]==="LIVE"){a=/^m=/;var c=/^m=audio/,d=/^m=video/,e=/^a=ssrc:/;b=b.split(h);var f=[];for(var g=b.length-1;g>=0;g--)a.test(b[g])&&f.push(b.splice(g));var i=!1,j=!1;f.forEach(function(a){c.test(a[0])&&!i?i=a.some(function(a){return e.test(a)}):d.test(a[0])&&!j&&(j=a.some(function(a){return e.test(a)}))});return i&&j}return!0}function N(a,b){var c=a.findIndex(function(a){a=a.match(/^a=rtpmap:(\S+)\s/);return a&&a[1]===b?!0:!1}),d=a.findIndex(function(a){return/^m=video/.test(a)});return c===-1||d===-1?a:p(a,c,d)}function O(a,b){var c=a.findIndex(function(a){return/^m=video/.test(a)});if(c===-1)return[];var d=new RegExp("^a=rtpmap:\\S+\\s+"+b+"\\/"),e=[];a.forEach(function(b,f){if(d.test(b)){b=m(a[f]);a[c].indexOf(b)>0&&e.push(b)}});return e}function P(a,b){var c=b.levelAsymmetryAllowed?"1":"0",d=b.packetizationMode?"1":"0";c=new RegExp("^a=fmtp:(\\S+)\\s+level-asymmetry-allowed="+c+";packetization-mode="+d+";profile-level-id="+b.profileLevelId);for(var d=0;d<a.length;d++){b=a[d].match(c);if(b)return b[1]}return null}function Q(a,b){var c=this,d=a.split(h),e=this._getCodecIDMatchingH264Profile(d,b);if(!e)return a;b=this._getAllCodecIds(d,"H264");return b.reduce(function(a,b){return b!==e?c._removeCodecID(a,b):a},d).join(h)}function R(a,b){var c=a.split(h);b=this._getCodecIDMatchingH264Profile(c,b);if(!b)return a;var d=k,e=c.findIndex(function(a){return d.test(a)});if(e!==-1&&c[e].indexOf("RTP/SAVPF")!==-1){a="H264";var f=new RegExp("^a=rtpmap:"+b+"\\s+"+a);b=c.findIndex(function(a){return f.test(a)});var g=/^a=rtpmap:/;a=c.findIndex(function(a,b){return b>e&&g.test(a)});if(b!==-1&&a!==-1){a=c[b];o(c,e,[m(a)]);c[e]=c[e].replace("RTP/SAVPF","RTP/SAVPF "+m(a))}}return c.join(h)}function S(a){if(!b("UserAgent").isBrowser("Firefox")||b("ScotchRTWebClientFeatureGating").preserveFirefoxInactiveDataChannelBlock())return a;var c=a.split(h),d=c.findIndex(function(a){return a.startsWith("m=application")});if(d===-1)return a;var e=c.slice(d),f=e.findIndex(function(a,b){return b>0&&a.startsWith("m=")});f!==-1&&(e=e.slice(0,f));if(e[0]!=null&&e[0].endsWith("0")&&e.some(function(a){return a.startsWith("a=inactive")})){f=e.findIndex(function(a){return a.startsWith("c=")});return[].concat(c.slice(0,d+1+(f!==-1?f:0)),c.slice(d+e.length),[""]).join(h)}return a}function T(a,b){var c=a.split(h),d=c.findIndex(function(a){return a.startsWith("m=audio")});if(d<0)return a;var e=!1,f=!1,g=!1;for(var d=d+1;d<c.length;d++){var i=c[d];if(i.startsWith("m="))break;i.startsWith("a=rtpmap")?i.includes("opus")?e=!0:f=!0:i.startsWith("a=ptime")&&(g=!0)}if(!e||f||g)return a;c.splice(d,0,"a=ptime:"+b);return c.join(h)}function U(a){var b=[" IP4 "," IP6 "],c=a.split(h);c.forEach(function(a,d){a.startsWith("a=crypto:")?c[d]="a=crypto:**-----**":a.startsWith("a=candidate:")?c[d]="a=candidate:**-----**":b.forEach(function(b){var e=a.indexOf(b);e!==-1&&(c[d]=a.slice(0,e+b.length)+"**-----**")})});return c.join(h)}function V(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(c.length<1)return a;var e=X(a),f=e[0],i=e[1],j=f.split(h),k=Y(j),l=j.filter(function(a){return!a.startsWith(g)}),m=1+l.map(function(a){return a?a.substr(0,2):""}).lastIndexOf("a=")||l.length;return[].concat(l.slice(0),Z([].concat(k,c)).map(function(a){return""+g+a}),l.slice(m),[i?[i.trim(),""].join(h):""]).join(h)}function W(a){a=X(a);a=a[0];return Y(a.split(h))}function X(a){if(!a)return["",""];var b=a.trim().split(h),c=0;while(c<b.length){if(b[c].startsWith("m="))break;c++}return c===b.length?[a.trim(),""]:[b.slice(0,c).join(h).trim(),b.slice(c).join(h).trim()]}function Y(a){return Z(a.filter(function(a){return a.startsWith(g)}).map(function(a){return a.substr(g.length)}))}function Z(a){var b=Object.create(null);for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e&&(b[e]=!0)}return Object.keys(b).sort()}function $(a,b){var c=a.split(h);b.forEach(function(a,b){var d=new RegExp("^a=ssrc:\\d+ label:"+b);b=c.findIndex(function(a){return d.test(a)});if(b!==-1){var e=c[b].trim().split(" ")[0];if(/^a=ssrc:\d+$/.test(e)){e=e+" x-fb-content:"+a;c.splice(b+1,0,e)}}});return c.join(h)}},null);
__d("ZenonSimulcastExperiments",["UserAgent","ZenonVideoConstraintUtils","gkx","qex"],function(a,b,c,d,e,f){"use strict";f.shouldUsePlanBChromeSimulcast=g;f.allowH264Simulcast=a;f.shouldUseSimulcast=c;f.isCurrentBrowserCompatibleWithSimulcast=h;f.getSimulcastVideoConstraintsFromQe=d;f.getNumLayers=e;function g(){var a;a=(a=b("qex")._("1420551"))!=null?a:!1;return a}function a(){var a;return(a=b("qex")._("1606177"))!=null?a:!1}function c(a){return a&&h()&&!b("gkx")("1429707")&&g()}function h(){return b("UserAgent").isBrowser("Chrome >= 86")}function d(){var a=b("qex")._("1577194"),c=b("qex")._("1577195"),d=b("qex")._("1577196");return b("ZenonVideoConstraintUtils").createConstraints(a,c,d)}function e(){var a;return(a=b("qex")._("1574288"))!=null?a:1}},null);
__d("ScotchRTCSignalingExperiments",["CurrentUser","FBRTCConfig","FBRTCExperiment","ZenonSimulcastExperiments","gkx","qex"],function(a,b,c,d,e,f){"use strict";f.shouldCapMWBitrate=a;f.shouldCapAudioBitrate=c;f.shouldPreferIsac=d;f.shouldPreferOpus=e;f.shouldPreferOpusMultiway=g;f.shouldPreferVp9=h;f.shouldPreferVp9Multiway=i;f.shouldPreferH264Multiway=j;f.shouldPreferHWH264Multiway=k;f.shouldEnableAudioNack=l;f.shouldEnablePlayoutDelayRtpHeaderExtensionForMw=m;f.shouldAllowContentTypeRtpHeaderExtensionForMw=n;f.isOpusPtimeMungeEnabled=o;f.getOpusPtimeMungeValue=p;f.shouldP2PPreserveH264=q;f.shouldMungeUseDtxForOpus=r;f.mungeMinParticipantsForEnablingDtx=s;f.enableSDPRenegotiation=t;f.shouldEnableMWSAudioNack=u;function a(){return b("FBRTCExperiment").gen("rtc_www_mw_video_quality").getBool("cap_bitrate",!1)}function c(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("use_audio_bitrate_cap",!1)}function d(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()?!0:b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_isac",!0)}function e(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_opus",!1)}function g(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_opus_mws",!1)}function h(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_vp9",!1)}function i(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_vp9_mws",!1)}function j(){var a=b("gkx")("1707280");return a&&b("ZenonSimulcastExperiments").shouldUseSimulcast(!0)?b("ZenonSimulcastExperiments").allowH264Simulcast():a}function k(){var a;return(a=b("qex")._("1606697"))!=null?a:!1}function l(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("enable_audio_nack",!1)}function m(){var a;return(a=b("qex")._("1390078"))!=null?a:!1}function n(){return b("qex")._("1595537")===1}function o(){var a;return(a=b("qex")._("1426589"))!=null?a:!0}function p(){var a;return(a=b("qex")._("1426590"))!=null?a:60}function q(){var a;return(a=b("qex")._("1407741"))!=null?a:!1}function r(){var a;return(a=b("qex")._("1435732"))!=null?a:!1}function s(){var a;return(a=b("qex")._("1441388"))!=null?a:Infinity}function t(){var a;return(a=b("gkx")("1484828"))!=null?a:!0}function u(){var a;return(a=b("qex")._("1713531"))!=null?a:!1}},null);
__d("ScotchFBRTCMessage",["FBRTCConstants","FBRTCExperiment","FBRTCSupport","ScotchFBRTCSdpUtils","ScotchRTCSignalingExperiments"],function(a,b,c,d,e,f){var g="mobile";a=function(){"use strict";function a(a){var b;if(!this.$1(a))throw new Error("invalid webrtc message");this.originalMessageData=a;this.peerID=a.from;this.selfID=(b=a.to)!=null?b:null;this.callID=parseInt(a.call_id,10);this.msg=JSON.parse(a.payload);this.msg.json_payload&&(this.escalationName=this.msg.sessionName,this.msg=this.msg.json_payload);this.msgType=this.msg.type;this.msgID=this.msg.msg_id;this.ackID=this.msg.ack_id;this.source=a.source;this.peerSupportsVideoInterop=!!this.msg.supports_video_interop;this.$2();this.$3();this.$4();this.$5()}var c=a.prototype;c.$1=function(a){return a.from&&a.call_id&&a.payload};c.$2=function(){if(this.peerSupportsVideoInterop)return;this.isFromMobile()&&this.disableVideo()};c.disableVideo=function(){this.msg.sdp&&(this.msg.sdp=b("ScotchFBRTCSdpUtils").disableVideo(this.msg.sdp)),(this.msgType===b("FBRTCConstants").PayloadType.SET_VIDEO||this.msgType===b("FBRTCConstants").PayloadType.OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.ANSWER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_ANSWER)&&(this.msg.videoon=!1)};c.$3=function(){this.isFromMobile()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE&&(this.msg.sdp=b("ScotchFBRTCSdpUtils").removeRED(this.msg.sdp))};c.$4=function(){if(this.isFromMobile()&&b("FBRTCSupport").isWebrtcSupported()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE){var a=b("ScotchRTCSignalingExperiments").shouldP2PPreserveH264();a||(this.msg.sdp=b("ScotchFBRTCSdpUtils").removeH264(this.msg.sdp))}};c.$5=function(){if(this.isFromMobile()&&b("FBRTCSupport").isWebrtcSupported()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE){var a=b("FBRTCExperiment").gen("rtc_browser_use_vp9");a.getBool("allow_vp9",!1)||(this.msg.sdp=b("ScotchFBRTCSdpUtils").removeVP9(this.msg.sdp))}};c.isOffer=function(){return this.msgType===b("FBRTCConstants").PayloadType.OFFER};c.isFromMobile=function(){return this.source===g};c.isRemoteVideoSupported=function(){return!this.msg.sdp||this.msgType===b("FBRTCConstants").PayloadType.ICE_CANDIDATE?!0:b("ScotchFBRTCSdpUtils").isVideoSupported(this.msg.sdp)};c.isRetry=function(){return!!this.msg.flag};c.isForCall=function(a,c){return this.escalationName&&(this.msgType===b("FBRTCConstants").PayloadType.HANGUP||this.msgType===b("FBRTCConstants").PayloadType.SWITCH_TO_MULTIWAY)?c===this.escalationName:!a||a===this.callID||this.msgType===b("FBRTCConstants").PayloadType.OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.PCRESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICE_CANDIDATE};c.getSignalingExperiments=function(){if(this.isFromMobile()){if(!this.msg.experiments)return["sdp_update"];this.msg.experiments.includes("sdp_update")||this.msg.experiments.push("sdp_update")}return this.msg.experiments};return a}();e.exports=a},null);
__d("ScotchFBRTCMessageDedup",[],function(a,b,c,d,e,f){f.check=a;var g={};function a(a,b,c){g[a]||(g[a]={});g[a][b]||(g[a][b]={});if(g[a][b][c])return!1;g[a][b][c]=!0;return!0}},null);
__d("ScotchFBRTCVersionDetection",["UserAgent","UserAgentData"],function(a,b,c,d,e,f){f.isChrome=a;f.isFirefox=c;f.isChromiumBasedEdge=d;f.isChromium=e;f.webrtcVersion=g;function a(){return b("UserAgent").isBrowser("Chrome")}function c(){return b("UserAgent").isBrowser("Firefox")}function d(){return b("UserAgent").isBrowser("Edge (Chromium Based)")}function e(){return!!navigator.webkitGetUserMedia}function g(){if(this.isFirefox()||this.isChrome()||this.isChromiumBasedEdge())return b("UserAgentData").browserVersion||0;if(this.isChromium()){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return a!=null?parseInt(a[2],10):999}return 0}},null);
__d("ScotchRTCAudioTrackNoiseDetector",["invariant","Promise","MediaStream"],function(a,b,c,d,e,f,g){"use strict";f.detect=a;var h="audio track with absolute silence";f.ABSOLUTE_SILENCE_ERROR=h;var i="audio track data timeout";f.DATA_TIMEOUT_ERROR=i;var j='wrong track type, expected "audio"';f.WRONG_TRACK_TYPE_ERROR=j;var k=100;function a(a,c){if("kind"in a&&a.kind!=="audio")return b("Promise").reject(new Error(j));var d=new(b("MediaStream"))();d.addTrack(a);var e=new AudioContext(),f=e.createMediaStreamSource(d),l=e.createScriptProcessor(0,1,1),m=k,n=function(){l!=null||g(0,2865);l.onaudioprocess=null;l.disconnect();l=null;f!=null||g(0,2866);f.disconnect();f=null;d!=null||g(0,2867);d.removeTrack(a);d=null;e!=null||g(0,2868);return b("Promise").resolve(e.close())["catch"](function(){return b("Promise").resolve()}).then(function(){e=null})};return b("Promise").race([new(b("Promise"))(function(a,b){l!=null||g(0,2865),l.onaudioprocess=function(c){c=c.inputBuffer;for(var c=c.getChannelData(0),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;if(f!==0){a();return}}m>0?m--:b(new Error(h))},f!=null||g(0,2866),f.connect(l),e!=null||g(0,2868),l.connect(e.destination)}),new(b("Promise"))(function(a){return window.setTimeout(a,c)}).then(function(){throw new Error(i)})]).then(function(){return n()})["catch"](function(a){return n().then(function(){throw a})})}},null);
__d("ScotchRTWebStrings",["fbt"],function(a,b,c,d,e,f,g){"use strict";a=g._("Busy");f.busy=a;b=g._("Call Again");f.callAgain=b;c=g._("Call ended");f.callEnded=c;d=g._("Call Failed");f.callFailed=d;e=g._("Call Interrupted");f.callInterrupted=e;a=g._("Can't connect Call");f.cannotConnect=a;b=g._("You left the group video chat");f.chatLinksLeftVideoChat=b;c=g._("Client encryption error");f.clientEncryptionError=c;d=g._("Close");f.close=d;e=g._("Connected");f.connected=e;a=g._("Connecting...");f.connecting=a;b=g._("Connection dropped");f.connectionDropped=b;c=g._("Connection lost");f.connectionLost=c;d=g._("Contacting...");f.contacting=d;e=g._("Copied");f.copiedVideoChatLink=e;a=g._("Copy Video Chat Link");f.copyVideoChatLink=a;b=g._("Disconnected");f.disconnected=b;c=g._("Dismiss");f.dismiss=c;d=g._("Hanging up...");f.hangingUp=d;e=g._("Call is inactive");f.inactive=e;a=g._("In another call");f.inAnotherCall=a;b=g._("Incoming video chat");f.incomingVideoChat=b;c=g._("Too many clients connected to the room");f.invalidStreamConfiguration=c;d=g._("No answer");f.noAnswer=d;e=g._("Not Now");f.notNow=e;a=g._("Participant limit reached");f.participantLimitReached=a;b=g._("Please wait...");f.pleaseWait=b;c=g._("Profile picture");f.profilePictureAlt=c;d=g._("Reconnecting...");f.reconnecting=d;e=g._("Redial");f.redial=e;a=g._("Ringing...");f.ringing=a;b=g._("Switch to Wi-Fi to complete your call");f.switchToWiFi=b;c=g._("Unreachable");f.unreachable=c;d=function(a){return g._("{name}'s camera is off",[g._param("name",a)])};f.userVideoOff=d;e=g._("Your camera is off");f.viewerVideoOff=e;a=g._("Waiting for others to join...");f.waitingForOthers=a},null);
__d("ScotchRTCEndCallReason",["FBRTCConstants","FBRTCDismissReason","FBRTCHangupReason","FBRTCRtcResponseStatusCode","ScotchRTWebStrings"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$3="local",typeof a==="string"||a instanceof String?this.$1=b("FBRTCConstants").endCallReasonFromString(a):this.$1=a}var c=a.prototype;c.setSubreason=function(a){this.$2=a;return this};c.getSubreason=function(){return this.$2};c.setRemoteEnded=function(a){this.$3=a?"remote":"local";return this};c.getRemoteEnded=function(){return this.$3==="remote"};c.toStrName=function(a){a===void 0&&(a=!0);return a?this.$4()+"_"+this.$3:this.$4()};c.$4=function(){return b("FBRTCConstants").callEndReasonString(this.$1)};c.getReasonID=function(){return this.$1};c.toString=function(a){var b;a===void 0&&(a=!1);b=((b=this.$5(a))!=null?b:"").toString();return a?b+" "+this.$6():b};c.$5=function(a){switch(this.$1){case b("FBRTCConstants").CallEndReason.NO_ANSWER_TIMEOUT:case b("FBRTCConstants").CallEndReason.IGNORE_CALL:return b("ScotchRTWebStrings").noAnswer;case b("FBRTCConstants").CallEndReason.OTHER_NOT_CAPABLE:if(this.$2===b("FBRTCConstants").CollabCallEndSubreason.MCU_INVALID_STREAM_CONFIGURATION)return b("ScotchRTWebStrings").invalidStreamConfiguration;case b("FBRTCConstants").CallEndReason.INCOMING_TIMEOUT:case b("FBRTCConstants").CallEndReason.NO_PERMISSION:case b("FBRTCConstants").CallEndReason.OTHER_CARRIER_BLOCKED:return b("ScotchRTWebStrings").unreachable;case b("FBRTCConstants").CallEndReason.SIGNALING_MESSAGE_FAILED:case b("FBRTCConstants").CallEndReason.WEBRTC_ERROR:case b("FBRTCConstants").CallEndReason.NO_UI_ERROR:case b("FBRTCConstants").CallEndReason.CALLER_NOT_VISIBLE:case b("FBRTCConstants").CallEndReason.CLIENT_ERROR:return b("ScotchRTWebStrings").callFailed;case b("FBRTCConstants").CallEndReason.UNSUPPORTED_VERSION:return b("ScotchRTWebStrings").cannotConnect;case b("FBRTCConstants").CallEndReason.IN_ANOTHER_CALL:return b("ScotchRTWebStrings").inAnotherCall;case b("FBRTCConstants").CallEndReason.CARRIER_BLOCKED:return b("ScotchRTWebStrings").switchToWiFi;case b("FBRTCConstants").CallEndReason.CLIENT_INTERRUPTED:return b("ScotchRTWebStrings").callInterrupted;case b("FBRTCConstants").CallEndReason.HANGUP_CALL:case b("FBRTCConstants").CallEndReason.ACCEPT_AFTER_HANGUP:return a?"":b("ScotchRTWebStrings").callEnded;case b("FBRTCConstants").CallEndReason.CONNECTION_DROPPED:return b("ScotchRTWebStrings").connectionLost;case b("FBRTCConstants").CallEndReason.OTHER_INSTANCE_HANDLED:return null;case b("FBRTCConstants").CallEndReason.CLIENT_ENCRYPTION_ERROR:return b("ScotchRTWebStrings").clientEncryptionError;case b("FBRTCConstants").CallEndReason.INACTIVE_TIMEOUT:return b("ScotchRTWebStrings").inactive;default:return null}};c.$6=function(){var a;if(this.$1!==b("FBRTCConstants").CallEndReason.OTHER_NOT_CAPABLE&&this.$1!==b("FBRTCConstants").CallEndReason.SIGNALING_MESSAGE_FAILED&&this.$1!==b("FBRTCConstants").CallEndReason.HANGUP_CALL&&this.$1!==b("FBRTCConstants").CallEndReason.ACCEPT_AFTER_HANGUP)return"";switch(this.$2){case b("FBRTCConstants").CollabCallEndSubreason.REMOTE_PEER_HANGUP:return"Call ended";case b("FBRTCConstants").CollabCallEndSubreason.REMOTE_PEER_REJECT:return"Call declined";case b("FBRTCConstants").CollabCallEndSubreason.CLOSED_BY_MCU:return"Call expired";case b("FBRTCConstants").CollabCallEndSubreason.CLOSED_AS_STALE:return"Server failed, call is stale";case b("FBRTCConstants").CollabCallEndSubreason.CALL_INITIALIZATION_FAILED:return"Call initialization to room failed";case b("FBRTCConstants").CollabCallEndSubreason.SIP_CONNECTION_INITIALIZATION_FAILED:return"No Answer";case b("FBRTCConstants").CollabCallEndSubreason.LOST_MCU_CONNECTION:return"MCU Media connection failed";case b("FBRTCConstants").CollabCallEndSubreason.LOST_MCU_THRIFT_CONNECTION:return"MCU infrastructure dropped connection";case b("FBRTCConstants").CollabCallEndSubreason.LOST_SIP_ADAPTER_CONNECTION:return"SIP infrastructure dropped connection";case b("FBRTCConstants").CollabCallEndSubreason.MCU_NO_AUDIO_STREAM:return"Invalid audio stream";case b("FBRTCConstants").CollabCallEndSubreason.MCU_INVALID_STREAM_CONFIGURATION:return"Invalid stream configuration";case b("FBRTCConstants").CollabCallEndSubreason.INVALID_MEETING_ID:return"Invalid meeting ID";case b("FBRTCConstants").CollabCallEndSubreason.UNKNOWN:default:a=(a=this.$2)!=null?a:"Unknown";return this.$2!=null&&this.$2!==""?"Unexpected call failure: "+a:"Call ended"}};a.fromHangupReason=function(c){switch(c){case b("FBRTCHangupReason").IGNORE_CALL:return new a(b("FBRTCConstants").CallEndReason.IGNORE_CALL);case b("FBRTCHangupReason").NO_ANSWER_TIMEOUT:return new a(b("FBRTCConstants").CallEndReason.NO_ANSWER_TIMEOUT);case b("FBRTCHangupReason").HANGUP_CALL:return new a(b("FBRTCConstants").CallEndReason.HANGUP_CALL);case b("FBRTCHangupReason").CLIENT_ERROR:return new a(b("FBRTCConstants").CallEndReason.CLIENT_ERROR);case b("FBRTCHangupReason").IN_ANOTHER_CALL:return new a(b("FBRTCConstants").CallEndReason.IN_ANOTHER_CALL);case b("FBRTCHangupReason").CLIENT_INTERRUPTED:return new a(b("FBRTCConstants").CallEndReason.CLIENT_INTERRUPTED);default:return new a(b("FBRTCConstants").CallEndReason.HANGUP_CALL)}};a.subreasonFromDismissRequest=function(a){if(!a)return null;switch(a.reason){case b("FBRTCDismissReason").REMOVED_BY_PARTICIPANT:return"REMOVED_BY_PARTICIPANT";default:return null}};a.fromDismissRequest=function(c){if(!c)return new a(b("FBRTCConstants").CallEndReason.HANGUP_CALL);switch(c.reason){case b("FBRTCDismissReason").ANSWERED_ON_ANOTHER_DEVICE:case b("FBRTCDismissReason").REJECTED_ON_ANOTHER_DEVICE:return new a(b("FBRTCConstants").CallEndReason.OTHER_INSTANCE_HANDLED);case b("FBRTCDismissReason").CALL_ENDED:return new a(b("FBRTCConstants").CallEndReason.HANGUP_CALL);case b("FBRTCDismissReason").IN_ANOTHER_CALL:return new a(b("FBRTCConstants").CallEndReason.IN_ANOTHER_CALL);case b("FBRTCDismissReason").CONNECTION_DROPPED:return new a(b("FBRTCConstants").CallEndReason.CONNECTION_DROPPED);case b("FBRTCDismissReason").REMOVED_BY_PARTICIPANT:return new a(b("FBRTCConstants").CallEndReason.HANGUP_CALL);case b("FBRTCDismissReason").REJECTED_BY_CALLEE:return new a(b("FBRTCConstants").CallEndReason.IGNORE_CALL);case b("FBRTCDismissReason").INTERNAL_ERROR:return new a(b("FBRTCConstants").CallEndReason.SIGNALING_MESSAGE_FAILED);default:return new a(b("FBRTCConstants").CallEndReason.HANGUP_CALL)}};a.fromResponseStatusCode=function(c){switch(c){case b("FBRTCRtcResponseStatusCode").METHOD_NOT_ALLOWED:case b("FBRTCRtcResponseStatusCode").UNAUTHORIZED:return new a(b("FBRTCConstants").CallEndReason.NO_PERMISSION);case b("FBRTCRtcResponseStatusCode").SERVICE_UNAVAILABLE:return new a(b("FBRTCConstants").CallEndReason.SIGNALING_MESSAGE_FAILED);case b("FBRTCRtcResponseStatusCode").SERVER_INTERNAL_ERROR:case b("FBRTCRtcResponseStatusCode").BAD_REQUEST:case b("FBRTCRtcResponseStatusCode").CONDITIONAL_REQUEST_FAILED:case b("FBRTCRtcResponseStatusCode").NOT_FOUND:return new a(b("FBRTCConstants").CallEndReason.CLIENT_ERROR);default:return new a(b("FBRTCConstants").CallEndReason.HANGUP_CALL)}};return a}();e.exports=a},null);
__d("ScotchRTCMediaDevices",["invariant","Promise","FBLogger","ScotchRTCOnDeviceChangePoller","webrtc-adapter"],function(a,b,c,d,e,f,g){"use strict";f.addEventListener=a;f.removeEventListener=c;f.isSupported=d;f.enumerateDevices=e;f.filterDevicesOfKind=j;var h=1e3,i;function a(a,c){if(a==="devicechange"&&b("ScotchRTCOnDeviceChangePoller").isNeeded()){i||(i=new(b("ScotchRTCOnDeviceChangePoller"))(h));i.add(c);return}var d=navigator;d=d.mediaDevices;d&&"addEventListener"in d&&d.addEventListener(a,c)}function c(a,c){if(a==="devicechange"&&b("ScotchRTCOnDeviceChangePoller").isNeeded()){i&&i.remove(c);return}var d=navigator;d=d.mediaDevices;d&&"removeEventListener"in d&&d.removeEventListener(a,c)}function d(a){return!0}function e(){b("webrtc-adapter")==null&&b("FBLogger")("rtc_www").mustfix("Webrtc-adapter should be loaded");if(l()){navigator.mediaDevices||g(0,4492);return b("Promise").resolve(navigator.mediaDevices.enumerateDevices())}else if(m())return new(b("Promise"))(function(a){return window.MediaStreamTrack.getSources(a)}).then(k);return b("Promise").reject(new Error("enumerateDevices() not supported"))}function j(a,b){return a.filter(function(a){return a.kind===b})}function k(a){return a.map(function(a){var b=a.id,c=a.kind;a=a.label;return{deviceId:b,groupId:"",kind:c==="video"?"videoinput":"audioinput",label:a}})}function l(){return navigator.mediaDevices!=null&&typeof navigator.mediaDevices.enumerateDevices==="function"}function m(){return window.MediaStreamTrack!=null&&typeof window.MediaStreamTrack.getSources==="function"}},null);
__d("ScotchRTCOnDeviceChangePoller",["Promise","FBRTCLogger","ScotchRTCMediaDevices"],function(a,b,c,d,e,f){a=function(){a.isNeeded=function(){var a=navigator;a=a.mediaDevices;return!b("ScotchRTCMediaDevices").isSupported("enumerateDevices")||a&&"ondevicechange"in a?!1:!0};function a(a){var c=this;this.$1=[];this.$2="";this.$4=null;this.$7=function(){b("ScotchRTCMediaDevices").enumerateDevices().then(function(a){a=a.map(function(a){return a.deviceId+":"+a.label+":"+a.groupId}).sort().join("~");if(a===c.$2)return;c.$2=a;for(var a=c.$1,b=Array.isArray(a),d=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(b){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;try{e()}catch(a){}}})["catch"](function(a){return b("Promise").resolve()}).then(function(){c.$4=window.setTimeout(c.$7,c.$3)})["catch"](function(a){})};this.$3=a}var c=a.prototype;c.add=function(a){this.$1.push(a),this.$5()};c.remove=function(a){this.$1=this.$1.filter(function(b){return b!==a}),this.$6()};c.$5=function(){if(this.$4!==null)return;this.$4=window.setTimeout(this.$7,0)};c.$6=function(){if(this.$1.length>0)return;this.$4!==null&&(window.clearTimeout(this.$4),this.$4=null)};return a}();e.exports=a},null);
__d("ScotchRTCVideoTrackActivityDetector",["invariant","Promise","MediaStream","assignMediaStream"],function(a,b,c,d,e,f,g){"use strict";f.detect=a;var h="video track playback timeout";f.PLAYBACK_TIMEOUT_ERROR=h;var i="unexpected video track ready state";f.WRONG_READY_STATE_ERROR=i;var j='wrong track type, expected "video"';f.WRONG_TRACK_TYPE_ERROR=j;function a(a,c){if("kind"in a&&a.kind!=="video")return b("Promise").reject(new Error(j));var d=document.createElement("video");d.muted=!0;var e=new(b("MediaStream"))();e.addTrack(a);var f,k=null,l=function(){window.clearInterval(k),d&&(d.pause(),b("assignMediaStream")(d,null),d.removeEventListener("timeupdate",f),d=null),e&&(e.removeTrack(a),e=null)};return b("Promise").race([new(b("Promise"))(function(c,h){d!=null||g(0,5995),b("assignMediaStream")(d,e),f=function(b){d!=null||g(0,5995),d.currentTime>0&&(a.readyState==="live"?(c(),l()):h(new Error(i)))},b("Promise").resolve(d.pause()).then(function(){d!=null||g(0,5995);return d.play()}).then(function(){f(),d!=null||g(0,5995),d.addEventListener("timeupdate",f),k=window.setInterval(f,50)})["catch"](function(a){return h(a)})}),new(b("Promise"))(function(a){return window.setTimeout(a,c)}).then(function(){throw new Error(h)})])["catch"](function(a){l();throw a})}},null);
__d("ScotchRTCMediaStreamValidator",["Promise","ScotchRTCAudioTrackNoiseDetector","ScotchRTCVideoTrackActivityDetector"],function(a,b,c,d,e,f){"use strict";f.validate=a;var g="no audio tracks";f.NO_AUDIO_TRACKS_ERROR=g;var h="no video tracks";f.NO_VIDEO_TRACKS_ERROR=h;var i="too many audio tracks";f.TOO_MANY_AUDIO_TRACKS_ERROR=i;var j="too many video tracks";f.TOO_MANY_VIDEO_TRACKS_ERROR=j;var k="unexpected audio track(s)";f.UNEXPECTED_AUDIO_TRACKS_ERROR=k;var l="unexpected video track(s)";f.UNEXPECTED_VIDEO_TRACKS_ERROR=l;function a(a,c,d,e){d===void 0&&(d={});e===void 0&&(e={});d=d;var f=d.audio;f=f===void 0?!0:f;d=d.video;d=d===void 0?!0:d;e=e;var g=e.audio;g=g===void 0?1e3:g;e=e.video;e=e===void 0?1e3:e;return b("Promise").all([m(a,c,f,g),n(a,c,d,e)]).then(function(){return a})}function m(a,c,d,e){var f=a.getAudioTracks();if(!c.audio)return f.length>0?b("Promise").reject(new Error(k)):b("Promise").resolve(a);if(f.length<1)return b("Promise").reject(new Error(g));else if(f.length>1)return b("Promise").reject(new Error(i));return d?b("ScotchRTCAudioTrackNoiseDetector").detect(f[0],e).then(function(){return a}):b("Promise").resolve(a)}function n(a,c,d,e){var f=a.getVideoTracks();if(!c.video)return f.length>0?b("Promise").reject(new Error(l)):b("Promise").resolve(a);if(f.length<1)return b("Promise").reject(new Error(h));else if(f.length>1)return b("Promise").reject(new Error(j));return d?b("ScotchRTCVideoTrackActivityDetector").detect(f[0],e).then(function(){return a}):b("Promise").resolve(a)}},null);
__d("ScotchRTCUserMediaConstraints",["FBRTCConstants","FBRTCSupport","RTCConfig"],function(a,b,c,d,e,f){"use strict";f.audio=a;f.video=c;f.chromeMediaSource=d;f.chromify=k;var g={width:(e=b("FBRTCConstants")).RTCConstraints.FHD_WIDTH,height:e.RTCConstraints.FHD_HEIGHT,frameRate:e.RTCConstraints.FRAME_RATE},h={width:e.RTCConstraints.HD_WIDTH,height:e.RTCConstraints.HD_HEIGHT,frameRate:e.RTCConstraints.FRAME_RATE},i={width:e.RTCConstraints.SD_WIDTH,height:e.RTCConstraints.SD_HEIGHT,frameRate:e.RTCConstraints.FRAME_RATE},j={width:e.RTCConstraints.LQ_WIDTH,height:e.RTCConstraints.LQ_HEIGHT,frameRate:e.RTCConstraints.LQ_FRAME_RATE};function a(a){return a?{deviceId:{exact:a}}:!0}function c(a,c,d){d===void 0&&(d=b("RTCConfig").CollaborationCallQuality.videoToRoom);c=c?{deviceId:{exact:c}}:null;if(a===b("FBRTCConstants").VideoQuality.CUSTOM_VIDEO)return babelHelpers["extends"]({},d,c);if(b("FBRTCSupport").isMobileDevice())return{facingMode:{ideal:"user"}};d=m(a);a=l(a)?j:o(d);return babelHelpers["extends"]({width:n(d,"width",a),height:n(d,"height",a),frameRate:n(d,"frameRate",{frameRate:10})},c)}function d(a,b){a=a.video;a=k(a);if(typeof a!=="object")return{audio:!1,video:Boolean(a)};var c=a.mandatory;a=a.optional;a=a===void 0?[]:a;return{audio:!1,video:{mandatory:babelHelpers["extends"]({},c,{chromeMediaSource:"desktop",chromeMediaSourceId:b}),optional:[{googTemporalLayeredScreencast:!0}].concat(a)}}}function k(a,b){if(!a||typeof a!=="object")return Boolean(a);if(!r(a))return a;b=b?b.optionalConstraintsOnly:!1;var c=a.mandatory;c=c===void 0?{}:c;var d=a.optional;d=d===void 0?[]:d;var e=Object.entries(a);for(var f=0;f<e.length;f++){var g=e[f],h=g[0];g=g[1];if(h==="require"||h==="advanced"||h==="mediaSource")continue;g=g&&typeof g==="object"?g:{ideal:g};Number.isFinite(g.exact)&&(g.min=g.exact,g.max=g.exact);var i=g.ideal,j=g.exact;if(i!==void 0)if(Number.isFinite(i)){var k;d.push((k={},k[q(h,"min")]=i,k),(k={},k[q(h,"max")]=i,k))}else{d.push((k={},k[q(h)]=i,k))}if(!b)if(j!==void 0&&!Number.isFinite(j))c[q(h)]=j;else{i=["min","max"];for(var k=0;k<i.length;k++){j=i[k];Number.isFinite(g[j])&&(c[q(h,j)]=g[j])}}}a.advanced&&d.push.apply(d,a.advanced);j={};Object.keys(c).length>0?j.mandatory=c:b&&(j.mandatory={});d.length>0&&(j.optional=d);return j}function l(a){return a===b("FBRTCConstants").VideoQuality.HD_IDEAL_LQ_REQUIRED_VIDEO||a===b("FBRTCConstants").VideoQuality.FHD_IDEAL_LQ_REQUIRED_VIDEO}function m(a){switch(a){case b("FBRTCConstants").VideoQuality.FHD_VIDEO:case b("FBRTCConstants").VideoQuality.FHD_IDEAL_LQ_REQUIRED_VIDEO:return g;case b("FBRTCConstants").VideoQuality.HD_VIDEO:case b("FBRTCConstants").VideoQuality.HD_IDEAL_LQ_REQUIRED_VIDEO:return h;case b("FBRTCConstants").VideoQuality.LQ_VIDEO:return j;case b("FBRTCConstants").VideoQuality.SD_VIDEO:return i;default:return h}}function n(a,b,c){c===void 0&&(c=o(a));var d=a[b];return{min:Math.min(c[b],d),max:Math.max(p(a)[b],d),ideal:d}}function o(a){switch(a){case g:return h;case h:return i;case i:case j:default:return j}}function p(a){switch(a){case j:return i;case i:return h;case h:case g:default:return g}}function q(b,a){return a?""+a+b.charAt(0).toUpperCase()+b.slice(1):b==="deviceId"?"sourceId":b}function r(a){return Object.keys(a).some(function(a){return a!=="mandatory"&&a!=="optional"})}},null);
__d("ScotchgenerateRTCTransactionID",["randomInt"],function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return String(b("randomInt")(0,4294967294)+1)}},null);
__d("ScotchRTCUtils",["invariant","Promise","CurrentUser","FBLogger","FBRTCConfig","FBRTCLogger","RTCConfig","RTCUser","ScotchFBRTCUtils","ScotchgenerateRTCTransactionID","ScotchRTCAudioTrackNoiseDetector","ScotchRTCEndCallReason","ScotchRTCMediaDevices","ScotchRTCMediaStreamValidator","ScotchRTCScreenSharing","ScotchRTCUserMediaConstraints","ScotchRTCVideoTrackActivityDetector","ScotchRTWebClientFeatureGating","ScotchRTWebUserActionLogger","URI","UserAgent","ZenonWebRTCWrapper","webrtc-adapter"],function(a,b,c,d,e,f,g){"use strict";var h,i=b("ScotchRTCAudioTrackNoiseDetector").DATA_TIMEOUT_ERROR,j=b("ScotchRTCVideoTrackActivityDetector").PLAYBACK_TIMEOUT_ERROR,k=0,l={isGroupCall:function(a){return a.split(":")[0]==="GROUP"},isMessengerCall:function(a){return a.split(":")[0]==="MESSENGER"},isRoomCall:function(a){return a.split(":")[0]==="ROOM"},isPeerCall:function(a){return a.split(":")[0]==="PEER"},isAlohaCall:function(a){return a.split(":")[0]==="ALOHA"},isWatchPartyCall:function(a){return a.split(":")[0]==="WATCH"},isSupportedMWCall:function(a){return l.isGroupCall(a)||l.isMessengerCall(a)||l.isRoomCall(a)||l.isAlohaCall(a)||l.isWatchPartyCall(a)},getPeerID:function(a){if(l.isGroupCall(a))throw new Error("Not a P2P call: "+a);a=a.split(":");a=a.slice(1);return a[0]===b("CurrentUser").getID()?a[1]:a[0]},getMessengerCallID:function(a){if(!l.isMessengerCall(a))throw new Error("Not a Messenger call: "+a);return Number(a.split(":")[1])},getThreadID:function(a){return!l.isGroupCall(a)?null:Number(a.split(":")[1])},getSandboxingTierFromURIOrEmpty:function(a,b){b=b+"=";a=a.split(b);if(a[1]){b=a.pop().split("&").shift();return b}return""},_addDevTierOverridesToHeaderExtensions:function(a){if(!b("ScotchRTWebClientFeatureGating").canUseMultiwaySandbox())return a;var c=window.location.href,d=l.getSandboxingTierFromURIOrEmpty(c,"multiway_www_tier");c=l.getSandboxingTierFromURIOrEmpty(c,"multiway_core_tier");d&&(a.multiwayWwwTier=d);c&&(a.multiwayCoreTier=c);return a},createRequestHeader:function(a,c,d,e,f){a={type:a,clientStack:4,transactionId:b("ScotchgenerateRTCTransactionID")(),retryCount:0,conferenceName:c,clientSessionId:e?e:"",sequenceNumber:k++};c={};d&&(a.serverInfoData=d);f&&(c.esc_p2p_call_id=f);c=l._addDevTierOverridesToHeaderExtensions(c);a.extensions=c;return a},createClientContextMessage:function(a,b){a={num_participants:a,trigger:b};b={header:{topic_DEPRECATED:"client_context",shouldSendToAllUsers:!1},body:{genericMessage:{topic:"client_context",data:JSON.stringify(a)}}};return b},createResponseHeader:function(a,c,d){c={type:a.type,clientStack:4,transactionId:a.transactionId,retryCount:0,conferenceName:a.conferenceName,responseStatusCode:c,clientSessionId:d?d:""};a.serverInfoData&&(c.serverInfoData=a.serverInfoData);b("ScotchRTWebClientFeatureGating").canUseMultiwaySandbox()&&(c.extensions=l._addDevTierOverridesToHeaderExtensions({}));return c},maybeRemoveVideoConstraint:function(a){b("webrtc-adapter")==null&&b("FBLogger")("rtc_www").mustfix("Webrtc-adapter should be loaded");return b("ScotchRTCMediaDevices").enumerateDevices().then(function(c){if(c.some(function(a){return a.kind==="videoinput"})){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[maybeRemoveVideoConstraint] At least one device has videoinput.  Keeping constraints "+JSON.stringify(a)});return a}b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[maybeRemoveVideoConstraint] No devices capable of videoinput.",errorDomain:"GetUserMedia",errorType:"Removing video stream by setting video constraint to false."});return babelHelpers["extends"]({},a,{video:!1})})["catch"](function(){return b("Promise").resolve(a)})},getUserMediaWithAudioFallback:function(a,c){return a.video?l.maybeRemoveVideoConstraint(a).then(function(a){return l.getUserMedia(a,c)})["catch"](function(c){if(a.video){if(c.name==="NotFoundError"||c.name==="StreamFailedToStart"){var d="Audio Fallback Error Recovery: "+JSON.stringify(c)+" constraints: "+JSON.stringify(a);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithAudioFallback] Retrying getUserMedia with no video stream",errorDomain:"GetUserMedia",errorType:d});return l.getUserMedia({video:!1,audio:a.audio})}if(c.name==="OverconstrainedError"){d="Video Constraints Error Recovery: "+JSON.stringify(c)+" constraints: "+JSON.stringify(a);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithAudioFallback] Retrying getUserMedia with no video constraints",errorDomain:"GetUserMedia",errorType:d});return l.getUserMedia({video:!0,audio:a.audio})}}d="Error: "+JSON.stringify(c)+" constraints: "+JSON.stringify(a);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithAudioFallback] Throwing other error",errorDomain:"GetUserMedia",errorType:d});throw c}):l.getUserMedia(a,c)},getUserMediaWithFallbackToEmptyVideoConstraints:function(a,c){return l.getUserMedia(a,c)["catch"](function(c){if(a.video&&c.name==="OverconstrainedError"){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithFallbackToEmptyVideoConstraints] Fallback getUserMedia with no video constraints",errorDomain:"GetUserMedia",errorType:"Original Constraints: "+JSON.stringify(a)});return l.getUserMedia(babelHelpers["extends"]({},a,{video:!0}))}throw c})},getUserScreenMedia:function(a,c,d){return b("ScotchRTCScreenSharing").getUserMedia(a,c,d)},getUserMedia:function(a,c){return b("ZenonWebRTCWrapper").getUserMedia(a)},parseConstraints:function(a,c){if(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")||b("UserAgent").isBrowser("Opera")){var d=a.audio,e=a.video,f={};d!==void 0&&(f.audio=b("ScotchRTCUserMediaConstraints").chromify(d));e!==void 0&&(f.video=b("ScotchRTCUserMediaConstraints").chromify(e,c));return f}return a},maybeSupportFilteredStreams:function(a,b){return a},getUserMediaWithValidation:function(a,c,d,e){c===void 0&&(c={audio:!0,video:!0});d===void 0&&(d=5);e===void 0&&(e={audio:1e3,video:1e3});return new(b("Promise"))(function(f,g){var h=function d(h){l.getUserMedia(a).then(function(d){return b("ScotchRTCMediaStreamValidator").validate(d,a,c,e).then(function(a){return f({stream:a})})["catch"](function(a){if(a.message===i||a.message===j)f({stream:d,err:a});else{l.stopMediaStream(d);throw a}})},g)["catch"](function(a){h>0?d(h-1):g(a)})};h(d)})},isFullScreen:function(){return Boolean(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},requestFullScreen:function(a){a===void 0&&(a=document.documentElement),typeof a.requestFullscreen==="function"?a.requestFullscreen():typeof a.msRequestFullscreen==="function"?a.msRequestFullscreen():typeof a.mozRequestFullScreen==="function"?a.mozRequestFullScreen():typeof a.webkitRequestFullscreen==="function"&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},exitFullScreen:function(){typeof document.exitFullscreen==="function"?document.exitFullscreen():typeof document.msExitFullscreen==="function"?document.msExitFullscreen():typeof document.mozCancelFullScreen==="function"?document.mozCancelFullScreen():typeof document.webkitExitFullscreen==="function"&&document.webkitExitFullscreen()},toggleFullScreen:function(){l.isFullScreen()?l.exitFullScreen():l.requestFullScreen()},endCallReasonFromHangupReason:function(a){return b("ScotchRTCEndCallReason").fromHangupReason(a).getReasonID()},endCallReasonFromDismissRequest:function(a){return b("ScotchRTCEndCallReason").fromDismissRequest(a).getReasonID()},endCallSubreasonFromDismissRequest:function(a){return b("ScotchRTCEndCallReason").subreasonFromDismissRequest(a)},endCallReasonFromResponseStatusCode:function(a){return b("ScotchRTCEndCallReason").fromResponseStatusCode(a).getReasonID()},stopMediaStream:function(a){if(!a.active&&"active"in a)return;a.getTracks().forEach(function(a){a.readyState!=="ended"&&a.stop()})},transferAudioTracks:function(a,b){for(var c=b.getAudioTracks(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;a.addTrack(f);b.removeTrack(f)}},payloadParticipantsToRTCUsers:function(a){return a.map(function(a){var c=a.big_image_src||a.image_src;a.fbid||g(0,1174);return new(b("RTCUser"))({FBID:a.fbid,profileUrl:new(h||(h=b("URI")))(a.href),profilePictureUrl:c,isMessengerUser:!!a.is_messenger_user,isPartiesUser:!!a.is_parties_user,userName:a.name,userShortName:a.short_name,vanity:a.vanity||""})})},getStreamVideoResolution:function(a){return new(b("Promise"))(function(c,d){var e=document.createElement("video");b("ScotchFBRTCUtils").attachMediaStream(e,a);var f=function(){e.removeEventListener("loadedmetadata",g),e.removeEventListener("error",h),b("ScotchFBRTCUtils").attachMediaStream(e,null)},g=function(){c({height:e.videoHeight,width:e.videoWidth}),f()},h=function(){d(e.error),f()};e.addEventListener("loadedmetadata",g);e.addEventListener("error",h)})},isScreenSharingSupported:function(){return b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")||this.isVCScreenSharingSupported()},isVCScreenSharingSupported:function(){return b("FBRTCConfig").isVCEndpointCall()&&b("RTCConfig").CollabWhitelistedBrowserGK},filterDevicesByKind:function(a,b){return a?a.filter(function(a){return a.kind===b}):[]},isDevicePresent:function(a,b){return a==null?!1:a.some(function(a){return a.deviceId===b})}};e.exports=l},null);
__d("ScotchRTCScreenSharing",["Promise","CollabRTCChromeScreenSharing","ScotchRTCUserMediaConstraints","ScotchRTCUtils","UserAgent","WorkplaceChatHelper"],function(a,b,c,d,e,f){"use strict";f.getUserMedia=a;f.stop=i;var g="SCREEN_SHARING_NOT_SUPPORTED";f.SCREEN_SHARING_NOT_SUPPORTED=g;var h="UNEXPECTED_ERROR";function a(a,c,d){if(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")){var e;b("WorkplaceChatHelper").isDesktopChatApp()?e=b("WorkplaceChatHelper").getScreenSharingSourceID():e=b("CollabRTCChromeScreenSharing").getSourceID(d,c);return e.then(function(c){return b("ScotchRTCUtils").getUserMedia(b("ScotchRTCUserMediaConstraints").chromeMediaSource(a,c))}).then(function(a){for(var b=a.getTracks(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.addEventListener("ended",function(b){return window.setTimeout(function(){a.active||i()})})}return a})}else if(b("ScotchRTCUtils").isVCScreenSharingSupported()&&navigator.mediaDevices&&typeof navigator.mediaDevices.getUserMedia==="function")return b("Promise").resolve(navigator.mediaDevices.getUserMedia(a)["catch"](function(a){if(a.name==="NotAllowedError")throw new Error(g)}));return b("Promise").reject(new Error(g))}function i(){return b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")?b("WorkplaceChatHelper").isDesktopChatApp()?b("WorkplaceChatHelper").stopScreenSharing():b("CollabRTCChromeScreenSharing").stop():b("Promise").reject(new Error(h))}},null);
__d("ZenonRTWebBrowserFeatureSupport",["RTCPeerConnection"],function(a,b,c,d,e,f){"use strict";f.isCanvasStreamSupported=a;f.isGetSendersSupported=c;f.isReplaceTrackSupported=d;function a(){return typeof window.HTMLCanvasElement==="function"&&typeof window.HTMLCanvasElement.prototype.captureStream==="function"}function c(){return g("getSenders")}function d(){return typeof window.RTCRtpSender==="function"&&typeof window.RTCRtpSender.prototype.replaceTrack==="function"}function g(a){return typeof b("RTCPeerConnection").prototype[a]==="function"}},null);
__d("ScotchFBRTCScreenSharingUtils",["FBRTCSupport","ScotchFBRTCVersionDetection","ScotchRTCUtils","ScotchRTWebExperiments","ZenonRTWebBrowserFeatureSupport"],function(a,b,c,d,e,f){"use strict";f.isSupportedBrowser=a;f.canUserReceiveScreenSharing=c;f.canPeerReceiveScreenSharing=d;function a(){return(b("ScotchFBRTCVersionDetection").isChrome()||b("ScotchFBRTCVersionDetection").isChromiumBasedEdge())&&b("ScotchFBRTCVersionDetection").webrtcVersion()>=34}function c(){return!b("FBRTCSupport").isMobileDevice()&&(b("ScotchFBRTCVersionDetection").isChromium()&&b("ScotchFBRTCVersionDetection").webrtcVersion()>=34||b("ScotchRTCUtils").isVCScreenSharingSupported())}function d(a){if(b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported())return!0;return a.remoteSupport("screen_sharing")?!0:!1}},null);
__d("ScotchFBRTCUserCapabilities",["FBRTCSupport","MessengerCowatchConfig","ScotchFBRTCScreenSharingUtils"],function(a,b,c,d,e,f){"use strict";a=function(){function a(b){this.$2=new Set(),this.$1=new Set(a.getLocal()),b&&(this.$2=new Set(b))}var c=a.prototype;c.getLocal=function(){return Array.from(this.$1)};c.setRemote=function(b){return!b?this:new a(b)};c.getRemote=function(){return Array.from(this.$2)};c.support=function(a){return this.localSupport(a)&&this.remoteSupport(a)};c.localSupport=function(a){return this.$1.has(a)};c.remoteSupport=function(a){return this.$2.has(a)};a.getLocal=function(){var a=[];b("ScotchFBRTCScreenSharingUtils").canUserReceiveScreenSharing()&&a.push("screen_sharing");b("FBRTCSupport").isMobileDevice()?a.push("mweb"):a.push("www");b("FBRTCSupport").videoEscalationByUnmuteWorkaround()&&a.push("video_escalation_by_unmute");b("MessengerCowatchConfig").hasZenonCowatchCapability()&&a.push("cowatch");b("MessengerCowatchConfig").hasZenonGroupCowatchCapability()&&a.push("GROUP_COWATCH");return a};return a}();e.exports=a},null);
__d("ScotchRTCAppData",["FacebookAppIDs","WorkplaceChatHelper"],function(a,b,c,d,e,f){"use strict";f.getAppID=a;f.getChannelManagerAppName=c;f._getWorkplaceChatDesktopAppID=d;f.getMWAppID=g;function a(){return b("WorkplaceChatHelper").isDesktopChatApp()?this._getWorkplaceChatDesktopAppID():b("FacebookAppIDs").WWW}function c(){switch(g()){case b("FacebookAppIDs").MESSENGERDOTCOM.toString():return"messenger_dot_com";case b("FacebookAppIDs").WWW.toString():return"www";case b("FacebookAppIDs").WORKPLACE_DESKTOP.toString():return"workplace";case b("FacebookAppIDs").MESSENGER_DESKTOP_ARCHON_MACOS.toString():return"desktop_video_chat";case b("FacebookAppIDs").MESSENGER_DESKTOP_ARCHON_WINDOWS.toString():return"desktop_video_chat_for_windows";default:return"desktop"}}function d(){return b("WorkplaceChatHelper").getAppID()||b("FacebookAppIDs").WORKPLACE_DESKTOP}function g(){return b("FacebookAppIDs").MQTT_WEB.toString()}},null);
__d("ScotchRTCAppDispatcher",["ExplicitRegistrationDispatcher","objectValues"],function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;babelHelpers.assertThisInitialized(b).dispatch=b.dispatch.bind(babelHelpers.assertThisInitialized(b));return b}var d=c.prototype;d.explicitlyRegisterStoresInMap=function(a){this.explicitlyRegisterStores(b("objectValues")(a))};return c}(b("ExplicitRegistrationDispatcher"));c=new a({strict:!0});e.exports=c},null);
__d("ScotchRTCOneVCStoreState",["immutable"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({meetingID:null,meetingPassword:null,participants:[]}));e.exports=a},null);
__d("ScotchRTCOneVCStore",["invariant","FBRTCConfig","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCOneVCStoreState"],function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.call(this,b("ScotchRTCAppDispatcher"))||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCOneVCStoreState"))()};d.reduce=function(a,b){switch(b.type){case"SET_MEETING_ID":return a.set("meetingID",b.meetingID);case"SET_MEETING_PASSWORD":return a.set("meetingPassword",b.meetingPassword);case"STORE_PARTICIPANTS":b=h(b.participants);return a.set("participants",b);default:return a}};d.getParticipantsSummary=function(){var a=this.getState().participants;return a.length===0?{audioParticipants:0,videoParticipants:0}:a.reduce(function(a,b){b=b.video_mute.some(function(a){return a!==!1});return b?{audioParticipants:a.audioParticipants+1,videoParticipants:a.videoParticipants}:{audioParticipants:a.audioParticipants,videoParticipants:a.videoParticipants+1}},{audioParticipants:0,videoParticipants:0})};d.getParticipants=function(){return this.getState().participants};return c}(b("FluxReduceStore"));a.__moduleID=e.id;function h(a){var c=b("FBRTCConfig").getMeetingID();c!=null||g(0,11961);var d="Facebook (Meeting ID: "+c+")";return a.filter(function(a){return!a.peer_name.includes(d)})}c=new a();e.exports=c},null);
__d("ScotchgenerateRTCSignalingMessageID",["randomInt"],function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return b("randomInt")(0,4294967294)+1}},null);
__d("XCollabCallSendMessageController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/collab/sendmessage/",{recipient_id:{type:"Int",required:!0},msg_id:{type:"Int",required:!0},message_info:{type:"String",required:!0},webrtc_fbtrace:{type:"Int"},device_id:{type:"String"}})},null);
__d("XVideoCallSendMessageController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/sendmessage/",{recipient_id:{type:"Int",required:!0},msg_id:{type:"Int",required:!0},message_info:{type:"String",required:!0},webrtc_fbtrace:{type:"Int"},device_id:{type:"String"}})},null);
__d("ScotchFBRTCMessageSender",["errorCode","ChannelClientID","CurrentUser","FBRTCConstants","FBRTCLocalUploadLogLevel","FBRTCLogger","FBRTCSupport","PresenceProperties","ScotchFBRTCUserCapabilities","ScotchFBRTCUtils","ScotchgenerateRTCSignalingMessageID","ScotchRTCAppData","ScotchRTCOneVCStore","SiteData","XCollabCallSendMessageController","XVideoCallSendMessageController"],function(a,b,c,d,e,f,g){var h=0;a=function(){"use strict";function a(){this.onSendFailure=null,this.$1=b("FBRTCLogger").getInstance()}var c=a.prototype;c.sendOffer=function(a,c,d,e,f,g){return this.$2(b("FBRTCConstants").PayloadType.OFFER,a,c,d,e,f,null,g)};c.sendAnswer=function(a,c,d,e,f,g){return this.$2(b("FBRTCConstants").PayloadType.ANSWER,a,c,d,e,f,g)};c.sendPCRestartOffer=function(a,c,d,e,f){return this.$2(b("FBRTCConstants").PayloadType.PCRESTART_OFFER,a,c,d,e,f)};c.sendSdpUpdate=function(a,c,d,e,f){return this.$2(b("FBRTCConstants").PayloadType.SDP_UPDATE,a,c,d,e,f)};c.resendSdpMessage=function(a,b){b.flag=1,this.$3(a,b)};c.resendPayload=function(a,b){b.flag=1,this.$4(a,b)};c.$2=function(a,c,d,e,f,g,h,i){d=this.$5(d,a);d.sdp=e;a===b("FBRTCConstants").PayloadType.OFFER&&(d.browser_supports_escalation=b("FBRTCSupport").isGroupCallWebtrcSupported(),d.handlescollision=!0,d.pranswer=!1,i&&(d.call_trigger=i));a===b("FBRTCConstants").PayloadType.ANSWER&&h&&(d.escalation_conference_name=h.escalationConferenceName,d.negotiated_escalation_support=h.negotiatedEscalationSupport);(a===b("FBRTCConstants").PayloadType.OFFER||a===b("FBRTCConstants").PayloadType.ANSWER||a===b("FBRTCConstants").PayloadType.PCRESTART_OFFER)&&(d.icerestart=!1,d.experiments=b("ScotchFBRTCUserCapabilities").getLocal());d.videoon=f;d.attributes=g;d.ull=b("FBRTCConstants").convertFromUploadLogLevel(b("FBRTCLocalUploadLogLevel").getLocalUploadLogLevel());this.$3(c,d);return d};c.sendIceCandidate=function(a,c,d){c=this.$5(c,b("FBRTCConstants").PayloadType.ICE_CANDIDATE);c.sdp_mid=d.sdpMid;c.label=d.sdpMLineIndex;c.sdp=d.candidate;this.$4(a,c)};c.sendHangup=function(a,c,d,e,f){c=this.$5(c,b("FBRTCConstants").PayloadType.HANGUP);c.reason=b("FBRTCConstants").callEndReasonString(d);c.subreason=f||"";this.$4(a,c,e,!0)};c.sendOtherDismiss=function(a){a=this.$5(a,b("FBRTCConstants").PayloadType.OTHER_DISMISS);this.$4(b("CurrentUser").getID(),a)};c.sendOfferAck=function(a,c,d,e){e===void 0&&(e=new Map()),this.$6(a,c,d,b("FBRTCConstants").PayloadType.OFFER_ACK,e)};c.sendOfferNack=function(a,c,d){this.$6(a,c,d,b("FBRTCConstants").PayloadType.OFFER_NACK,new Map([["error_code",1356043]]))};c.sendAnswerAck=function(a,c,d){this.$6(a,c,d,b("FBRTCConstants").PayloadType.ANSWER_ACK)};c.sendAck=function(a,c,d){this.$6(a,c,d,b("FBRTCConstants").PayloadType.ACK,new Map([["ack_type",d.type]]))};c.sendMuteStateUpdate=function(a,c,d){c=this.$5(c,b("FBRTCConstants").PayloadType.SET_VIDEO);c.videoon=d;this.$4(a,c)};c.sendClientReportedEvent=function(a,c,d){c=this.$5(c,b("FBRTCConstants").PayloadType.CLIENT_REPORTED_EVENT);c.event_type=d;this.$4(a,c)};c.sendVideoEscalationRequest=function(a,b,c){return this.sendVideoRequestResponse(a,b,0,c)};c.sendVideoRequestResponse=function(a,c,d,e){c=this.$5(c,b("FBRTCConstants").PayloadType.VIDEO_REQUEST);c.ack_id=d;c.videoon=e;c.capability=b("PresenceProperties").getProperties();this.$4(a,c);return c};c.sendMsgAck=function(){};c.sendOk=function(){};c.sendPranswer=function(){};c.sendIcerestartAnswer=function(){};c.$5=function(a,c){var d=b("ScotchgenerateRTCSignalingMessageID")();a={version:h,type:c,call_id:a,msg_id:d};this.$7(c)&&(a.supports_video_interop=!0);return a};c.$7=function(a){return a===b("FBRTCConstants").PayloadType.OFFER||a===b("FBRTCConstants").PayloadType.ANSWER||a===b("FBRTCConstants").PayloadType.PRANSWER||a===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||a===b("FBRTCConstants").PayloadType.ICERESTART_ANSWER||a===b("FBRTCConstants").PayloadType.PCRESTART_OFFER||a===b("FBRTCConstants").PayloadType.PCRESTART_ANSWER||a===b("FBRTCConstants").PayloadType.SDP_UPDATE||a===b("FBRTCConstants").PayloadType.SET_VIDEO||a===b("FBRTCConstants").PayloadType.VIDEO_REQUEST};c.$3=function(a,b){this.$4(a,b,!1,!0,!0)};c.$6=function(a,c,d,e){var f=(arguments.length<=4?void 0:arguments[4])||new Map(),g=this.$5(c,e);g.ack_id=d.msg_id;d.flag===1&&(g.flag=1);g.ull=b("FBRTCConstants").convertFromUploadLogLevel(b("FBRTCLocalUploadLogLevel").getLocalUploadLogLevel());f.forEach(function(a,b,c){g[b]=a});this.$4(a,g)};c.$4=function(a,c,d,e,f){var g=c.msg_id,h={peer_id:a,call_id:c.call_id,msg_id:g,msg_type:c.type},i=b("ScotchFBRTCUtils").isPeerVCEndpoint(a);if(i){var j=b("ScotchRTCOneVCStore").getState(),k=j.meetingID;j=j.meetingPassword;k!=null&&(c.meeting_id=k);j!=null&&(c.meeting_pass=j)}k=(i?b("XCollabCallSendMessageController"):b("XVideoCallSendMessageController")).getURIBuilder().setInt("recipient_id",a).setInt("msg_id",g).setString("message_info",JSON.stringify(c)).setString("device_id",b("ChannelClientID").getID()).getURI();j=null;e&&(j=this.$4.bind(this,a,c,d,!1,f));i=this.$8.bind(this,h);g=this.$9.bind(this,h,j,f);b("ScotchFBRTCUtils").sendServerRequest(k,i,g,d);this.onMessageSent&&this.onMessageSent(a,c);this.$1.logSentMessage(a,c.call_id,c)};c.$8=function(a){this.$1.logSentMessageSuccess(a.peer_id,a.call_id,a.msg_type,a.msg_id)};c.$9=function(a,c,d,e){var f="UNKNOWN_ERROR";e&&(f=e.getError?e.getError():e);this.$1.logSentMessageFailure(a.peer_id,a.call_id,a.msg_type,a.msg_id,f);e=null;f===1356001||f===1356049?e=b("FBRTCConstants").CallEndReason.NO_PERMISSION:f===1356046?e=b("FBRTCConstants").CallEndReason.CALLER_NOT_VISIBLE:(f===1356003||f===1356002||f===1356044)&&(e=b("FBRTCConstants").CallEndReason.OTHER_NOT_CAPABLE);if(!e&&c){c();return}d&&this.onSendFailure&&(e||(e=b("FBRTCConstants").CallEndReason.SIGNALING_MESSAGE_FAILED),this.onSendFailure(e,f,a.msg_type))};return a}();e.exports=a},null);
__d("ScotchFBRTCPeerConnectionHelper",["regeneratorRuntime","Promise","MediaStream","ScotchRTCP2PProtocolHandler","flatMapArray","gkx"],function(a,b,c,d,e,f){"use strict";f.resetLocalStreams=a;f.resetLocalStreamWithTrackAPI=c;f.resetLocalStreamsByTrack=d;function a(a,c){var d=!1,e=a.getLocalStreams(),f=e.filter(function(a){return!c.includes(a)}),g=c.filter(function(a){return!e.includes(a)});(f.length>0||g.length>0)&&(d=!0);f.forEach(function(b){return a.removeStream(b)});g.forEach(function(b){return a.addStream(b)});if(b("gkx")("1344456")&&b("ScotchRTCP2PProtocolHandler").supportMultipleStreams()===!1){g=e.filter(function(a){return!f.includes(a)});g=b("flatMapArray")(g,function(b){return a.addStream(b)});g.length>0&&(d=!0)}return d}function c(a,b,c){var d=!1,e=b.getVideoTracks().length>0?b.getVideoTracks()[0]:null,f=b.getAudioTracks().length>0?b.getAudioTracks()[0]:null,g=a.getSenders(),h=g.filter(function(a){return a.track&&a.track.kind==="video"}),i=g.filter(function(a){return a.track&&a.track.kind==="audio"});h=h.length===(e===null?0:1)&&i.length===(f===null?0:1);if(c||!h){g.filter(function(a){return a.track!==e&&a.track!==e}).forEach(function(b){d=!0,a.removeTrack(b)});f&&!g.some(function(a){return a.track===f})&&(d=!0,a.addTrack(f,b));e&&!g.some(function(a){return a.track===e})&&(d=!0,a.addTrack(e,b));return d}a.getSenders().forEach(function(a){a.track&&a.track.kind==="video"&&e!==a.track?a.replaceTrack(e):a.track&&a.track.kind==="audio"&&f!==a.track&&a.replaceTrack(f)});return d}function d(a,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:i=a.getSenders();j=(e=a.getLocalStreams()[0])!=null?e:new(b("MediaStream"))();k=(f=d==null?void 0:d.getAudioTracks()[0])!=null?f:c.getAudioTracks()[0];l=(h=d==null?void 0:d.getVideoTracks()[0])!=null?h:c.getVideoTracks()[0];m=[];k!=null&&m.push(k);l!=null&&m.push(l);j.getTracks().forEach(function(a){m.includes(a)===!1&&j.removeTrack(a)});m.forEach(function(a){j.addTrack(a)});n=i.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="audio"})[0];o=i.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"})[0];t.next=13;return b("regeneratorRuntime").awrap(b("Promise").all([g(a,k,n),g(a,l,o)]));case 13:p=t.sent;q=p[0];r=p[1];s=a.addStream(j);return t.abrupt("return",q||r||s.length>0);case 18:case"end":return t.stop()}},null,this)}function g(a,c,d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=!1;if(!(c!=null)){f.next=8;break}if(!(d!=null&&d.track!==null)){f.next=6;break}if(!(c!==d.track)){f.next=6;break}f.next=6;return b("regeneratorRuntime").awrap(d.replaceTrack(c));case 6:f.next=9;break;case 8:d!=null&&d.track!==null&&(a.removeTrack(d),e=!0);case 9:return f.abrupt("return",e);case 10:case"end":return f.stop()}},null,this)}},null);
__d("ScotchRTCGroupCallActions",["ScotchRTCAppDispatcher","ScotchRTCUtils","ScotchRTWebUserActionLogger","gkx"],function(a,b,c,d,e,f){"use strict";f.setLayout=a;f.setDominantSpeaker=c;f.setPinnedSpeaker=d;f.initThread=e;f.onParticipantLeft=g;f.onParticipantsAdded=h;f.addParticipantsToRing=i;f.toggleRemoteStream=j;f.addRemoteScreenSharingUserID=k;f.removeRemoteScreenSharingUserID=l;f.handleDismissRequest=m;f.handleConferenceStateRequest=n;f.onJoinRequestSent=o;f.onReceivedJoinResponse=p;f.onJoinResponse=q;f.onProcessedJoinResponse=r;f.onServerMediaUpdateSuccess=s;f.setLocalClientVersion=t;f.onClientMediaUpdateResponse=u;f.setStateSyncInput=v;f.setStateSyncOutput=w;f.setStateSyncSubscribe=x;f.setStateSyncUnsubscribe=y;f.onPendingApproval=z;f.forceEncodingEnabled=A;f.videoEscalationStarted=B;f.videoEscalationCompleted=C;f.resetVideoEscalation=D;f.onLocalTrackReplaced=E;function a(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_LAYOUT",layout:a})}function c(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_DOMINANT_SPEAKER",dominantSpeakerFBID:a})}function d(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_PINNED_SPEAKER",pinnedSpeakerFBID:a})}function e(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"INIT_THREAD",thread:a,participants:c})}function g(a){b("ScotchRTCAppDispatcher").dispatch({type:"ON_PARTICIPANT_LEFT",participantFBID:a})}function h(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ON_PARTICIPANTS_ADDED",participants:a,images:c})}function i(a){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_PARTICIPANTS_TO_RING",participantFBIDs:a})}function j(a,c){if(b("gkx")("1439080")&&a!=null){var d=Object.keys(a).reduce(function(b,c){return""+b+c+":"+String(a[c])+";"},"");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCGroupCallActions_toggleRemoteStream mediaStatus:"+d,callID:c})}b("ScotchRTCAppDispatcher").dispatch({type:"TOGGLE_REMOTE_STREAM",mediaStatus:a})}function k(a){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_SCREEN_SHARING_USER_ID",userID:a})}function l(a){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_SCREEN_SHARING_USER_ID",userID:a})}function m(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"DISMISS",transaction:a,request:c,endCallReason:b("ScotchRTCUtils").endCallReasonFromDismissRequest(c.dismissRequest()),endCallSubreason:b("ScotchRTCUtils").endCallSubreasonFromDismissRequest(c.dismissRequest())})}function n(a,c,d,e){b("ScotchRTCAppDispatcher").dispatch({type:"ON_CONFERENCE_STATE",transaction:a,request:c,conferenceStateVersion:d,resolve:e})}function o(){b("ScotchRTCAppDispatcher").dispatch({type:"ON_JOIN_REQUEST_SENT"})}function p(){b("ScotchRTCAppDispatcher").dispatch({type:"ON_RECEIVED_JOIN_RESPONSE"})}function q(a){b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCGroupCallActions_onJoinResponse"}),b("ScotchRTCAppDispatcher").dispatch({type:"ON_JOIN_RESPONSE",serverInfoData:a})}function r(a){b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCGroupCallActions_onProcessedJoinResponse:",callID:a}),b("ScotchRTCAppDispatcher").dispatch({type:"ON_PROCESSED_JOIN_RESPONSE"})}function s(){b("ScotchRTCAppDispatcher").dispatch({type:"ON_SERVER_MEDIA_UPDATE_SUCCESS"})}function t(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_LOCAL_CLIENT_VERSION",version:a})}function u(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ON_CLIENT_MEDIA_UPDATE_RESPONSE",responseStatusCode:a,currentVersion:c})}function v(a,c,d){b("ScotchRTCAppDispatcher").dispatch({type:"SET_INPUT_SYNC_STATE",topic:a,version:c,inputData:d})}function w(a,c,d){b("ScotchRTCAppDispatcher").dispatch({type:"SET_OUTPUT_SYNC_STATE",topic:a,version:c,outputData:d})}function x(a){b("ScotchRTCAppDispatcher").dispatch({type:"STATE_SYNC_SUBSCRIBE",topic:a})}function y(a){b("ScotchRTCAppDispatcher").dispatch({type:"STATE_SYNC_UNSUBSCRIBE",topic:a})}function z(){b("ScotchRTCAppDispatcher").dispatch({type:"SET_PENDING_APPROVAL"})}function A(a){b("ScotchRTCAppDispatcher").dispatch({type:"FORCE_ENCODING_ENABLED",enabled:a})}function B(){b("ScotchRTCAppDispatcher").dispatch({type:"MW_VIDEO_ESCALATION_STARTED"})}function C(){b("ScotchRTCAppDispatcher").dispatch({type:"MW_VIDEO_ESCALATION_COMPLETED"})}function D(){b("ScotchRTCAppDispatcher").dispatch({type:"MW_VIDEO_ESCALATION_RESET"})}function E(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ON_LOCAL_TRACK_REPLACED",newTrack:a,oldTrack:c})}},null);
__d("ScotchRTCMWThreadDeltaHandler",["Arbiter","ChannelConstants","CurrentUser","MercuryIDs","MercurySyncDeltaTypes","MessengerParticipants.bs","ScotchRTCCallInitUtils","ScotchRTCGroupCallActions"],function(a,b,c,d,e,f){"use strict";f.initHandler=a;f.processThreadUpdateFromSignaling=c;function a(a){b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("delta"),function(c,d){c=d&&d.obj&&d.obj.queue;if(c&&c.toString()!==b("CurrentUser").getID())return;d=(c=d)!=null?(c=c.obj)!=null?c.delta:c:c;c=(c=d)!=null?(c=c.messageMetadata)!=null?(c=c.threadKey)!=null?c.threadFbId:c:c:c;if(!d||c!==a)return;switch(d["class"]){case b("MercurySyncDeltaTypes").ParticipantLeftGroupThread:b("ScotchRTCGroupCallActions").onParticipantLeft(d.leftParticipantFbId);break;case b("MercurySyncDeltaTypes").ParticipantsAddedToGroupThread:b("MessengerParticipants.bs").getMulti(d.addedParticipants.map(function(a){a=a.userFbId;return b("MercuryIDs").getParticipantIDFromUserID(a)}),b("ScotchRTCGroupCallActions").onParticipantsAdded);break}})}function c(a){var c=null;a=a.appMessages;a&&a.forEach(function(a){var b;b=(b=a)!=null?(b=b.body)!=null?(b=b.genericMessage)!=null?b.topic:b:b:b;a=(a=a)!=null?(a=a.body)!=null?(a=a.genericMessage)!=null?a.data:a:a:a;if(b==="thread_id_payload"&&a!=null){b=JSON.parse(a);if(b.thread_id!==null){c=b.thread_id;return}}});c&&b("ScotchRTCCallInitUtils").initializeThreadFromCollisionContext({groupThreadID:String(c),peerID:null})}},null);
__d("FBRTCDeviceStatus",[],function(a,b,c,d,e,f){e.exports=Object.freeze({OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10})},null);
__d("ZenonScreenSharingConstants",["$InternalEnum"],function(a,b,c,d,e,f){"use strict";a="kMNScreenShareDataKeyUserId";f.SCREEN_SHARE_DATA_USER_ID_KEY=a;c=b("$InternalEnum")({End:"kMNScreenShareDataEndScreenSharing",Start:"kMNScreenShareDataStartScreenSharing"});f.ZenonScreenSharingDataMessageTopic=c},null);
__d("ScotchFBRTCMultiwayMessage",["ChannelManager","CurrentUser","FBRTCMessageType","ScotchRTCAppData","ScotchRTCUtils","ZenonScreenSharingConstants"],function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a}var c=a.prototype;c.isRequest=function(){return this.$1.jsonPayload.header.responseStatusCode==null};c.isType=function(a){return this.type()==a};c.transactionId=function(){return this.$1.jsonPayload.header.transactionId};c.conferenceName=function(){return this.$1.jsonPayload.header.conferenceName};c.serverInfoData=function(){return this.$1.jsonPayload.header.serverInfoData};c.message=function(){return this.$1};c.type=function(){return this.header().type};c.endpoint=function(){return this.$1.endpoint};c.header=function(){return this.$1.jsonPayload.header};c.body=function(){return this.$1.jsonPayload.body};c.incrementRetryCount=function(){this.$1.jsonPayload.header.retryCount++};c.ringRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").RING)?this.body().ringRequest:null};c.dismissRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").DISMISS)?this.body().dismissRequest:null};c.serverMediaUpdateRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").SERVER_MEDIA_UPDATE)?this.body().serverMediaUpdateRequest:null};c.conferenceStateRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").CONFERENCE_STATE)?this.body().conferenceStateRequest:null};c.notifyRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").NOTIFY)?this.body().notifyRequest:null};c.startScreenSharingRequest=function(){var a=this.genericDataMessage();if(a!=null&&a.topic===b("ZenonScreenSharingConstants").ZenonScreenSharingDataMessageTopic.Start){a=JSON.parse(atob(a.data));return a[b("ZenonScreenSharingConstants").SCREEN_SHARE_DATA_USER_ID_KEY]}return null};c.endScreenSharingRequest=function(){var a=this.genericDataMessage();if(a!=null&&a.topic===b("ZenonScreenSharingConstants").ZenonScreenSharingDataMessageTopic.End){a=JSON.parse(atob(a.data));return a[b("ZenonScreenSharingConstants").SCREEN_SHARE_DATA_USER_ID_KEY]}return null};c.genericDataMessage=function(){var a;return this.isRequest()&&this.isType(b("FBRTCMessageType").DATA_MESSAGE)?(a=this.body().dataMessageRequest)==null?void 0:(a=a.message)==null?void 0:(a=a.body)==null?void 0:a.genericMessage:null};c.createResponse=function(c,d){var e=d.body;d=d.callID;c={endpoint:{appId:b("ScotchRTCAppData").getMWAppID(),deviceId:b("ChannelManager").getCompleteConfig().sessionID,userId:b("CurrentUser").getID()},jsonPayload:{header:b("ScotchRTCUtils").createResponseHeader(this.header(),c,d?d:""),body:e||{}}};return new a(c)};return a}();e.exports=a},null);
__d("XGroupCallSendMessageController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/groupcall/sendmessage/",{webrtc_fbtrace:{type:"Int"}})},null);
__d("ScotchRTCMessageSender",["Promise","AsyncRequest","FBRTCLogger","ScotchFBRTCMultiwayMessage","XGroupCallSendMessageController"],function(a,b,c,d,e,f){var g=6e3;a=function(){function a(){}var c=a.prototype;c.send=function(a){return new(b("Promise"))(function(c,d){var e=new(b("ScotchFBRTCMultiwayMessage"))(a);b("FBRTCLogger").getInstance().logSendingMultiwayMessage(e);var f=b("XGroupCallSendMessageController").getURIBuilder().getURI();f=new(b("AsyncRequest"))(f).setMethod("POST").setData({message:JSON.stringify(a)}).setAllowCrossPageTransition(!0).setHandler(function(a){b("FBRTCLogger").getInstance().logSentMultiwayMessage(e),c(a)}).setErrorHandler(function(a){b("FBRTCLogger").getInstance().logSendMultiwayMessageFailed(e);a=a.getErrorDescription();a=Error(a!=null?a.toString():"AsyncRequest error");d(a)}).setTimeoutHandler(g,function(){b("FBRTCLogger").getInstance().logSendMultiwayMessageFailed(e),d("Timeout")});f.send()})};return a}();e.exports=a},null);
__d("ScotchFBRTCTransactions",["Promise","FBRTCConsoleLogger","ScotchRTCMessageSender","clearTimeout","setTimeout"],function(a,b,c,d,e,f){"use strict";var g=6e4,h=Object.freeze({INIT:0,PROCESSING:1,COMPLETED:2,TERMINATED:3});a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.findTransaction=function(a){return this.$1.get(a)};b.addTransaction=function(a){this.$1.set(a.id,a)};b.removeTransaction=function(a){this.$1["delete"](a.id)};b.getTransaction=function(a){return this.findTransaction(a.transactionId())||new i(this,a)};return a}();f.FBRTCTransactionOwner=a;var i=function(){function a(a,c){this.id=c.transactionId(),this.$1=h.INIT,this.$2=c,this.$3=null,this.$4=a,this.$5=new Error("Unknown"),this.$6=null,this.$7=new(b("ScotchRTCMessageSender"))(),this.$8(),this.$4.addTransaction(this)}var c=a.prototype;c.start=function(){if(this.$1==h.INIT){this.$9(h.PROCESSING);return b("Promise").resolve(this.$2)}else if(this.$1==h.PROCESSING)return b("Promise").resolve(null);else if(this.$1==h.COMPLETED){this.$10();return b("Promise").resolve(null)}return b("Promise").reject(this.$5)};c.sendResponse=function(a){var b=this;this.$3=a;this.$9(h.COMPLETED);return this.$7.send(a.message()).then(function(a){},function(a){b.$5=a,b.$9(h.TERMINATED)})};c.$10=function(){if(this.$3!=null){var a=this.$3;a.incrementRetryCount();this.sendResponse(a)}};c.$9=function(a){a!=this.$1&&(this.$1=a,this.$1!=h.TERMINATED&&this.$8(),this.$1==h.TERMINATED&&(this.$5=new Error("Terminated"),this.$4.removeTransaction(this)))};c.$8=function(){var a=this;this.$6&&(b("clearTimeout")(this.$6),this.$6=null);this.$6=b("setTimeout")(function(){a.$9(h.TERMINATED)},g)};return a}();f.FBRTCServerTransaction=i},null);
__d("FBRTCCapability",[],function(a,b,c,d,e,f){e.exports=Object.freeze({SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4,SUPPORT_MWPP:5,REQUIRE_FULL_SDP_IN_SMU:6,SUPPORT_PRECONNECT:7,SUPPORT_MWPP_DEESCALATION:8,SUPPORT_PARTICIPANT_STATE_UNCALLABLE:9,SUPPORT_MULTIPLE_VIDEO_STREAMS:10})},null);
__d("ScotchMWDeviceCapabilities",["FBRTCCapability","gkx"],function(a,b,c,d,e,f){"use strict";f.getDeviceCapabilities=a;function a(){if(b("gkx")("1484828")){var a=[b("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,b("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED,b("FBRTCCapability").SUPPORT_SDP_RENEGOTIATION];b("gkx")("1679118")&&a.push(b("FBRTCCapability").REQUIRE_FULL_SDP_IN_SMU);return a}else return[b("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,b("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED]}},null);
__d("ScotchRTCProxyUserActions",["ScotchRTCAppDispatcher"],function(a,b,c,d,e,f){"use strict";f.setProxyUsers=a;function a(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"SET_PROXY_USER_MAP",proxyUserID:a,proxyingAsUserID:c})}},null);
__d("ScotchRTCProxyUserReducer",[],function(a,b,c,d,e,f){"use strict";f.setProxyUsers=a;function a(a,b){switch(b.type){case"SET_PROXY_USER_MAP":var c=b.proxyUserID;b=b.proxyingAsUserID;if(!a.proxyUserToProxyingAs.has(c))return a.set("proxyingAsToProxyUser",a.proxyingAsToProxyUser.set(b,c)).set("proxyUserToProxyingAs",a.proxyUserToProxyingAs.set(c,b))}return a}},null);
__d("ScotchRTCProxyUserStoreState",["immutable"],function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({proxyingAsToProxyUser:b("immutable").Map(),proxyUserToProxyingAs:b("immutable").Map()}));e.exports=a},null);
__d("ScotchRTCProxyUserStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCProxyUserReducer","ScotchRTCProxyUserStoreState"],function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCProxyUserReducer").setProxyUsers];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCProxyUserStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a(b("ScotchRTCAppDispatcher"));e.exports=c},null);
__d("ScotchRTCProxyUserUtils",["ImmutableObject","MercuryIDs","ScotchRTCProxyUserActions","ScotchRTCProxyUserStore","ScotchRTWebUserActionLogger","immutable"],function(a,b,c,d,e,f){"use strict";f.setProxyingAsUsersFromMessage=a;f.transformProxyUserParticipantsToProxyingAs=c;f.getUserIDToFetch=d;function a(a){a=a.appMessages;if(a){var c=new Map();a.forEach(function(a){var d;d=(d=a)!=null?(d=d.body)!=null?(d=d.genericMessage)!=null?d.topic:d:d:d;a=(a=a)!=null?(a=a.body)!=null?(a=a.genericMessage)!=null?a.data:a:a:a;if(d==="aloha_proxying_as_users"&&a!=null){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Initializing_AlohaProxyingAsUsers"});d=JSON.parse(a);for(var e in d){a=d[e][0].id.toString();a&&(b("ScotchRTCProxyUserActions").setProxyUsers(e,a),c.set(e,a))}}});return c}return null}function c(a,c){for(var d in a){var e=a[d].fbid;if(c.has(e)){var f=a[d];e=c.get(e);var g=b("MercuryIDs").getParticipantIDFromUserID(e);f=b("ImmutableObject").setProperty(f,"fbid",e);f=b("ImmutableObject").setProperty(f,"id",g);a[g]=f}}return a}function d(a){var c=b("ScotchRTCProxyUserStore").getState();c=c.proxyUserToProxyingAs;return c.has(a)?c.get(a):a}},null);
__d("ScotchMultiwayParticipantFetcher",["Promise","regeneratorRuntime","ImmutableObject","MercuryIDs","MercuryParticipantsConstants","MessengerParticipants.bs","MessengerParticipantsImages.re","ScotchRTCProxyUserUtils","immutable"],function(a,b,c,d,e,f){"use strict";f.fetchParticipant=a;f.fetchAllParticipants=c;b("immutable").Map;b("immutable").Set;function g(a,c){var d=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});return new(b("Promise"))(function(a,e){try{b("MessengerParticipantsImages.re").getBigImageMultiWithSize({ids:d.toArray(),callback:function(c){a(b("immutable").fromJS(c))},size:c})}catch(a){e(a)}})}function h(a,c){var d=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});return new(b("Promise"))(function(a,e){try{b("MessengerParticipants.bs").getMulti(d.toArray(),function(d){c&&c.proxyingAsToProxyUser!=null&&c.proxyingAsToProxyUser!==void 0&&c.proxyingAsToProxyUser.size>0&&(d=b("ScotchRTCProxyUserUtils").transformProxyUserParticipantsToProxyingAs(d,c.proxyingAsToProxyUser)),a(b("immutable").fromJS(d))})}catch(a){e(a)}})}function i(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(h(a,c));case 2:d=f.sent;if(!c.profileImageSize){f.next=8;break}f.next=6;return b("regeneratorRuntime").awrap(g(a,c.profileImageSize));case 6:e=f.sent;return f.abrupt("return",d.withMutations(function(a){e.forEach(function(c,d){var e=a.get(d);if(e){e=b("ImmutableObject").setProperty(e,"big_image_src",c);a.set(d,e)}})}));case 8:return f.abrupt("return",d);case 9:case"end":return f.stop()}},null,this)}function j(a){var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=b("immutable").Set([a]);d=b("MercuryIDs").getParticipantIDFromUserID(a);f.next=4;return b("regeneratorRuntime").awrap(i(c,{profileImageSize:b("MercuryParticipantsConstants").WWW_INCALL_THUMBNAIL_SIZE}));case 4:e=f.sent;return f.abrupt("return",e.get(d));case 6:case"end":return f.stop()}},null,this)}function a(a,c){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(j(c));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},null,this)}function c(a,c,d){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:d===void 0&&(d={});a.next=3;return b("regeneratorRuntime").awrap(i(c,d));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}},null,this)}},null);
__d("ScotchRTCCallActions",["invariant","ScotchRTCAppDispatcher","ScotchRTCUtils","ScotchRTWebUserActionLogger","emptyFunction","mixInEventEmitter"],function(a,b,c,d,e,f,g){"use strict";var h={addListener:b("emptyFunction"),emit:b("emptyFunction"),initialize:function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallActions_initialize",callID:String(a.callID),conferenceName:a.conferenceName,callType:a.protocol==="p2p"?"p2p":"mw"}),b("ScotchRTCAppDispatcher").dispatch(babelHelpers["extends"]({type:"INIT"},a))},reset:function(){b("ScotchRTCAppDispatcher").dispatch({type:"RESET"})},resetForRedial:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"RESET_FOR_REDIAL",conferenceName:a,callID:c})},callCollision:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"CALL_COLLISION",conferenceName:a,peerID:c})},setCallSummary:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CALL_SUMMARY",callSummary:a})},call:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"CALL",usersToRing:a,peerConnection:c})},callSuccess:function(a){a===void 0&&(a=!1),b("ScotchRTCAppDispatcher").dispatch({type:"CALL_SUCCESS",connected:a})},incomingCallSuccess:function(){b("ScotchRTCAppDispatcher").dispatch({type:"INCOMING_CALL_SUCCESS"})},callError:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"CALL_ERROR",endCallReason:b("ScotchRTCUtils").endCallReasonFromResponseStatusCode(a),endCallSubreason:"Call error: "+(a||0),responseSubCode:c})},completeTransitionToMultiway:function(){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_CLEAR_P2P_CONNECTION"})},hangupSuccess:function(){b("ScotchRTCAppDispatcher").dispatch({type:"HANGUP_SUCCESS"})},hangupError:function(){b("ScotchRTCAppDispatcher").dispatch({type:"HANGUP_ERROR"})},join:function(a){h.call([],a)},hangup:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"HANGUP",hangupReason:a,endCallReason:a,endCallSubreason:c})},initLocalUser:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"INIT_LOCAL_USER",localUser:a})},initRemoteUsers:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"INIT_REMOTE_USERS",remoteUsers:a})},updateRemoteUsers:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"UPDATE_REMOTE_USERS",remoteUsers:a})},addLocalStream:function(a){a!=null||g(0,11208),b("ScotchRTCAppDispatcher").dispatch({type:"ADD_LOCAL_STREAM",stream:a})},removeLocalStream:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_LOCAL_STREAM",stream:a})},replaceLocalStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"REPLACE_LOCAL_STREAM",oldStream:a,newStream:c})},removeAllLocalStreams:function(a){a===void 0&&(a=!1),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_ALL_LOCAL_STREAMS",stopStreams:a})},removeAllLocalScreenStreams:function(a){a===void 0&&(a=!1),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_ALL_LOCAL_SCREEN_STREAMS",stopStreams:a})},addRemoteStream:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_addRemoteStream. Stream="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_STREAM",stream:a,userID:c})},removeRemoteStream:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_removeRemoteStream. Stream="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_STREAM",stream:a,userID:c})},removeAllRemoteStreams:function(a){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_removeAllRemoteStreams"}),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_ALL_REMOTE_STREAMS",userID:a})},addRemoteTrack:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_addRemoteTrack. Track id ="+c.id+";stream id ="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_TRACK",stream:a,track:c})},removeRemoteTrack:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_removeRemoteTrack. Track id ="+c.id+";stream id ="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_TRACK",stream:a,track:c})},addLocalScreenStream:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_LOCAL_SCREEN_STREAM",stream:a})},removeLocalScreenStream:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_LOCAL_SCREEN_STREAM",stream:a})},replaceLocalScreenStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"REPLACE_LOCAL_SCREEN_STREAM",oldStream:a,newStream:c})},addRemoteScreenStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_SCREEN_STREAM",stream:a,userID:c})},removeRemoteScreenStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_SCREEN_STREAM",stream:a,userID:c})},endCall:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"END_CALL",endCallReason:a,endCallSubreason:c})},waitForUserInput:function(){b("ScotchRTCAppDispatcher").dispatch({type:"WAIT_FOR_USER_INPUT"})},toggleMuteAudio:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"AUDIO_UNMUTED":"AUDIO_MUTED"})},toggleMuteVideo:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"VIDEO_UNMUTED":"VIDEO_MUTED"})},stopLocalVideo:function(){b("ScotchRTCAppDispatcher").dispatch({type:"STOP_LOCAL_STREAM"})},toggleMuteRemoteVideo:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:a?"REMOTE_VIDEO_MUTED":"REMOTE_VIDEO_UNMUTED",userID:c})},toggleSelfView:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"SELF_VIEW_COLLAPSED":"SELF_VIEW_UNCOLLAPSED"})},submitRating:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_RATING",rating:a})},submitFeedback:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_FEEDBACK",feedback:a})},submitFeedbackOptions:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_FEEDBACK_OPTIONS",feedbackOptions:a})},submitSurveyChoice:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_SURVEY_CHOICE",surveyChoice:a})},ratingShown:function(){b("ScotchRTCAppDispatcher").dispatch({type:"RATING_SHOWN"})},feedbackShown:function(){b("ScotchRTCAppDispatcher").dispatch({type:"FEEDBACK_SHOWN"})},setEndCallReason:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_END_CALL_REASON",endCallReason:a})},setConferenceState:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CONFERENCE_STATE",conferenceState:a})}};b("mixInEventEmitter")(h,{onIceConnectionStateChange:!0});a=h;e.exports=a},null);
__d("ScotchFBRTCCallSummaryReducer",["FBRTCCallSummaryPageVisibilityObserver","FBRTCCallSummaryStore","FBRTCLogger","ScotchRTCCallStore","ScotchRTWebUserActionLogger","gkx"],function(a,b,c,d,e,f){"use strict";f.setCallSummary=a;f.onCallStarted=c;f.onMessageSignaling=d;f.onCallEnded=e;f.onSurveyResult=h;var g=b("FBRTCLogger").Key;function a(a,b){switch(b.type){case"SET_CALL_SUMMARY":return a.set("callSummary",b.callSummary)}return a}function c(a,c){switch(c.type){case"INCOMING_CALL_SUCCESS":case"CALL_SUCCESS":c=function c(){var d=b("ScotchRTCCallStore").getState().callInfo,e=d.conferenceState;d=d.callID;e!=="TERMINATED"&&a.callInfo.callID===d&&(a.callSummary.save(b("FBRTCCallSummaryStore").getInstance()),window.setTimeout(c,1e4))};c();b("FBRTCCallSummaryPageVisibilityObserver").onCallStart(a.callSummary);return a}return a}function d(a,c){switch(c.type){case"ON_JOIN_REQUEST_SENT":a.callSummary.setJoinRequestSent();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"ON_RECEIVED_JOIN_RESPONSE":a.callSummary.setJoinResponseReceived();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"ON_JOIN_RESPONSE":a.callSummary.setServerInfoData(c.serverInfoData);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"ON_PROCESSED_JOIN_RESPONSE":a.callSummary.setJoinResponseProcessed();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a}return a}function e(a,c){var d=b("FBRTCCallSummaryStore").getInstance();switch(c.type){case"CALL_ERROR":case"HANGUP":case"END_CALL":b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCCallSummaryReducer_onCallEnded: "+JSON.stringify({reason:c.endCallReason,subreason:c.endCallSubreason,type:c.type})});a.callSummary.onCallEnded(c.endCallReason,!1,!1,c.endCallSubreason);a.callSummary.save(d);b("FBRTCCallSummaryPageVisibilityObserver").onCallEnd(a.callSummary);if(b("gkx")("1369511")&&a.callInfo.protocol!=="p2p"){a.callSummary.logThisSummary(d,!0);return a["delete"]("callSummary")}return a;case"DISMISS":b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCCallSummaryReducer_onCallEnded: "+JSON.stringify({reason:c.endCallReason,subreason:c.endCallSubreason,type:c.type})});a.callSummary.onCallEnded(c.endCallReason,!0,!1,c.endCallSubreason);a.callSummary.save(d);b("FBRTCCallSummaryPageVisibilityObserver").onCallEnd(a.callSummary);if(b("gkx")("1369511")&&a.callInfo.protocol!=="p2p"){a.callSummary.logThisSummary(d,!0);return a["delete"]("callSummary")}return a}return a}function h(a,c){switch(c.type){case"RATING_SHOWN":a.callSummary.addExtraInfo(g.RATING_SHOWN,"1");a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"FEEDBACK_SHOWN":a.callSummary.addExtraInfo(g.SURVEY_SHOWN,"1");a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"SUBMIT_RATING":a.callSummary.addExtraInfo(g.RATING,c.rating);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"SUBMIT_FEEDBACK":a.callSummary.addExtraInfo(g.SURVEY_DETAILS,c.feedback);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"SUBMIT_SURVEY_CHOICE":a.callSummary.addExtraInfo(g.SURVEY_CHOICE,c.surveyChoice);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a}return a}},null);
__d("ZenonMediaStatsSource",[],function(a,b,c,d,e,f){"use strict";a=["firCount","nackCount","packetsLost","pliCount","qpSum","sliCount","timestamp"];f.RTP_STATS=a;b=["bytesSent","framesEncoded","headerBytesSent","hugeFramesSent","keyFramesEncoded","packetsSent","qualityLimitationResolutionChanges","retransmittedBytesSent","retransmittedPacketsSent","targetBitrate","totalEncodedBytesTarget","totalEncodeTime","totalPacketSendDelay"];f.OUTBOUND_RTP_STATS=b;c=["audioLevel","burstDiscardCount","burstDiscardRate","burstLossCount","burstPacketsDiscarded","burstPacketsLost","bytesReceived","concealedSamples","concealmentEvents","decoderImplementation","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","frameHeight","frameWidth","framesDecoded","framesDropped","framesReceived","gapDiscardRate","gapLossRate","headerBytesReceived","insertedSamplesForDeceleration","jitter","jitterBufferDelay","jitterBufferEmittedCount","keyFramesDecoded","lastPacketReceivedTimestamp","packetsDiscarded","packetsReceived","packetsRepaired","removedSamplesForAcceleration","roundTripTime","totalAudioEnergy","totalDecodeTime","totalInterFrameDelay","totalSamplesDuration","totalSamplesReceived","totalSquaredInterFrameDelay"];f.INBOUND_RTP_STATS=c;d=["delayedPacketOutageSamples","framesSent","interruptionCount","jitterBufferTargetDelay","relativePacketArrivalDelay","sumOfSquaredFramesDuration","timestamp","totalFramesDuration","totalInterruptionDuration"];f.TRACK_STATS=d;e=["availableOutgoingBitrate","consentRequestsSent","requestsReceived","requestsSent","responsesReceived","responsesSent"];f.CANDIDATE_PAIR_STATS=e;a=["audioLevel","framesPerSecond","height","timestamp","totalAudioEnergy","totalSamplesDuration","width"];f.MEDIA_SOURCE_STATS=a;b=["googAccelerateRate","googCurrentDelayMs","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googPreferredJitterBufferMs","googRtt","googSecondaryDiscardedRate","googSpeechExpandRate","packetsLost"];f.SSRC_STATS=b},null);
__d("ZenonMediaStatsSourcePreM86",[],function(a,b,c,d,e,f){"use strict";a=["audioLevel","concealedSamples","concealmentEvents","delayedPacketOutageSamples","frameHeight","framesDropped","framesReceived","framesSent","frameWidth","insertedSamplesForDeceleration","interruptionCount","jitterBufferDelay","jitterBufferEmittedCount","jitterBufferTargetDelay","relativePacketArrivalDelay","removedSamplesForAcceleration","sumOfSquaredFramesDuration","timestamp","totalAudioEnergy","totalFramesDuration","totalInterruptionDuration","totalSamplesDuration","totalSamplesReceived"];f.TRACK_STATS=a;b=["burstDiscardCount","burstDiscardRate","burstLossCount","burstPacketsDiscarded","burstPacketsLost","bytesReceived","decoderImplementation","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","framesDecoded","gapDiscardRate","gapLossRate","headerBytesReceived","jitter","keyFramesDecoded","lastPacketReceivedTimestamp","packetsDiscarded","packetsReceived","packetsRepaired","roundTripTime","totalDecodeTime","totalInterFrameDelay","totalSquaredInterFrameDelay"];f.INBOUND_RTP_STATS=b},null);
__d("ZenonRenderedView",["$InternalEnum"],function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({THUMBNAIL:1,GRID:2,PINNED:3});c=a;e.exports=c},null);
__d("ZenonMediaStatsConfig",["UserAgent","ZenonMediaStatsSource","ZenonMediaStatsSourcePreM86","ZenonRenderedView"],function(a,b,c,d,e,f){"use strict";f.isPreChromium86=a;f.getTrackStats=c;f.getInboundRtpStats=d;f.getOutboundRtpStats=g;f.getRtpStats=h;f.getCandidatePairStats=i;f.getMediaSourceStats=j;f.getSsrcStats=k;a="globalStatsTrackId";f.GLOBAL_STATS_TRACKID=a;c="audio";f.GLOBAL_STATS_CONTENT_TYPE=c;d=b("ZenonRenderedView").GRID;f.GLOBAL_STATS_RENDERED_VIEW=d;g="pinnedAudioStatsTrackId";f.PINNED_AUDIO_STATS_TRACKID=g;h="pinnedVideoStatsTrackId";f.PINNED_VIDEO_STATS_TRACKID=h;i="outboundAudioStatsTrackId";f.OUTBOUND_AUDIO_STATS_TRACKID=i;j="outboundScreenStatsTrackId";f.OUTBOUND_SCREEN_STATS_TRACKID=j;k="outboundVideoStatsTrackId";f.OUTBOUND_VIDEO_STATS_TRACKID=k;a=0;f.VOICE_ENERGY_THRESHOLD=a;c=6e4;f.AV_SYNC_CUTOFF=c;d={AUDIO_DEV_IS_STALLED:"audioDevIsStalled",AUDIO_DEV_REC_STALLS:"audioDevRecStalls",AUDIO_DEV_STALL_DURATION:"audioDevStallDuration",AUDIO_DEV_TOTAL_STALLS:"audioDevTotalStalls",AUDIO_LOG_LEVEL:"audioLogLevel",AUDIO_LOG_LEVEL_COUNT:"audioLogLevelCount",AV_SYNC:"avSync",AV_SYNC_ABS:"avSyncAbs",AV_SYNC_COUNT:"avSyncCount",AV_SYNC_OOB:"avSyncOob",E2E_LATENCY:"e2eLatency",FRAME_RATE_MEAN:"framerateMean",PACKETS_LOST_CORRECTED:"packetsLostCorrected",RENDERED_VIEW:"renderedView",SIMULCAST_LAYER_CHANGES:"simulcast_layer_changes",VIDEO_CAPTURE_FRAME_COUNT:"captureFrameCount",VIDEO_CONVERTED_QP_SUM:"videoConvertedQpSum",VIDEO_DECODE_TIME:"videoDecodeTime",VIDEO_DECODED_BYTES:"videoDecodedBytes",VIDEO_FREEZE_COUNT:"videoFreezeCount",VIDEO_FREEZE_DURATION:"videoFreezeDuration",VIDEO_PAUSE_COUNT:"videoPauseCount",VIDEO_PAUSE_DURATION:"videoPauseDuration",VIDEO_QP:"qp",VIDEO_SUM_CAPTURE_PIXEL:"videoSumCapturePixel",VIDEO_SUM_PIXEL:"videoSumPixel"};f.DERIVED_METRICS=d;g={AUDIO_NETEQ_WAIT_TIME:"audioNeteqWaitTime",AUDIO_PACKET_LOSS_RATE:"audioPacketLossRate",AUDIO_PLC_CNG_RATE:"audioPlcCngRate",AUDIO_PLC_RATE:"audioPlcRate",GLOBAL_AUDIO_BITRATE:"globalAudioBitrate",GLOBAL_BATTERY_USAGE:"globalBatteryUsage",GLOBAL_CPU_USAGE:"globalCpuUsage",GLOBAL_VIDEO_BITRATE:"globalVideoBitrate",ROUND_TRIP_TIME:"roundTripTime",VIDEO_AV_SYNC_ABS:"videoAvSyncAbs",VIDEO_AV_SYNC_OOB:"videoAvSyncOob",VIDEO_CROPPING_RATIO:"videoCroppingRatio",VIDEO_ENCODED_FRAME_RATE:"encodedFrameRate",VIDEO_FRAME_RATE:"videoFrameRate",VIDEO_FREEZE_COUNT_PER_MIN:"videoFreezeCountPerMin",VIDEO_FREEZE_DURATION_PER_MIN:"videoFreezeDurationPerMin",VIDEO_NETEQ_WAIT_TIME:"videoNeteqWaitTime",VIDEO_PACKET_LOSS_RATE:"videoPacketLossRate",VIDEO_QP:"videoQP",VIDEO_QUALITY:"videoQuality",VIDEO_RENDER_SCALE_RATIO:"videoRenderScaleRatio"};f.PER_STREAM_AGG_METRICS=g;h=["bytesReceived","bytesSent","consentRequestsSent","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","firCount","framesDecoded","framesEncoded","framesReceived","framesSent","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","insertedSamplesForDeceleration","jitterBufferDelay","jitterBufferEmittedCount","keyFramesDecoded","keyFramesEncoded","nackCount","packetsLost","packetsReceived","packetsSent","pliCount","qpSum","requestsReceived","requestsSent","removedSamplesForAcceleration","responsesReceived","responsesSent","totalAudioEnergy","totalDecodeTime","totalEncodeTime","totalInterFrameDelay","totalPacketSendDelay","totalSamplesDuration","totalSamplesReceived","totalSquaredInterFrameDelay",d.AUDIO_LOG_LEVEL,d.AUDIO_LOG_LEVEL_COUNT,d.AUDIO_DEV_REC_STALLS,d.AUDIO_DEV_STALL_DURATION,d.AUDIO_DEV_TOTAL_STALLS,d.AV_SYNC_COUNT,d.AV_SYNC_OOB,d.PACKETS_LOST_CORRECTED,d.SIMULCAST_LAYER_CHANGES,d.VIDEO_CAPTURE_FRAME_COUNT,d.VIDEO_FREEZE_COUNT,d.VIDEO_FREEZE_DURATION,d.VIDEO_PAUSE_COUNT,d.VIDEO_PAUSE_DURATION,d.VIDEO_SUM_CAPTURE_PIXEL,d.VIDEO_SUM_PIXEL,d.VIDEO_CONVERTED_QP_SUM,d.VIDEO_DECODED_BYTES,d.VIDEO_DECODE_TIME];f.CUMULATIVE_STATS=h;i=["audioLevel","availableOutgoingBitrate","frameHeight","frameWidth","framesPerSecond","googAccelerateRate","googCurrentDelayMs","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googPreferredJitterBufferMs","googRtt","googSecondaryDiscardedRate","googSpeechExpandRate","height","jitter","roundTripTime","width",d.AUDIO_DEV_IS_STALLED,d.RENDERED_VIEW,d.FRAME_RATE_MEAN,d.E2E_LATENCY,d.AV_SYNC,d.AV_SYNC_ABS,d.VIDEO_QP];f.DELTA_STATS=i;j=["availableOutgoingBitrate","bytesReceived","bytesSent","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","firCount","frameHeight","framesDecoded","framesEncoded","framesPerSecond","framesReceived","framesSent","frameWidth","googAccelerateRate","googCurrentDelayMs","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googRtt","googSecondaryDiscardedRate","googSpeechExpandRate","height","insertedSamplesForDeceleration","jitter","jitterBufferDelay","jitterBufferEmittedCount","nackCount","keyFramesDecoded","packetsLost","packetsReceived","packetsSent","pliCount","qpSum","removedSamplesForAcceleration","roundTripTime","totalAudioEnergy","totalDecodeTime","totalEncodeTime","totalInterFrameDelay","totalPacketSendDelay","totalSamplesDuration","totalSamplesReceived","totalSquaredInterFrameDelay","width",d.AUDIO_DEV_REC_STALLS,d.AUDIO_DEV_STALL_DURATION,d.AUDIO_DEV_TOTAL_STALLS,d.PACKETS_LOST_CORRECTED,d.VIDEO_CAPTURE_FRAME_COUNT,d.VIDEO_FREEZE_COUNT,d.VIDEO_FREEZE_DURATION,d.VIDEO_PAUSE_COUNT,d.VIDEO_PAUSE_DURATION,d.VIDEO_SUM_CAPTURE_PIXEL,d.VIDEO_SUM_PIXEL,d.VIDEO_CONVERTED_QP_SUM,d.VIDEO_DECODED_BYTES,d.VIDEO_DECODE_TIME,d.SIMULCAST_LAYER_CHANGES,d.AUDIO_DEV_IS_STALLED,d.FRAME_RATE_MEAN,d.E2E_LATENCY,d.AV_SYNC,d.AV_SYNC_ABS];f.STATS_REQUESTED=j;k=["audioLevel","availableOutgoingBitrate","bytesReceived","bytesSent","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","firCount","frameHeight","framerateMean","framesDecoded","framesEncoded","framesPerSecond","framesReceived","framesSent","frameWidth","googAccelerateRate","googCurrentDelayMs","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googPreferredJitterBufferMs","googRtt","height","jitter","jitterBufferDelay","jitterBufferEmittedCount","keyFramesEncoded","packetsLost","packetsReceived","packetsSent","pliCount","qpSum","roundTripTime","totalAudioEnergy","totalDecodeTime","totalEncodeTime","width",d.E2E_LATENCY,d.VIDEO_QP];f.TSLOG_STATS_REQUESTED=k;a=["consentRequestsSent","estimatedPlayoutTimestamp","estimatedPlayoutTimestamp_delta","fecPacketsDiscarded","fecPacketsReceived","firCount","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","jitterBufferDelay_delta","jitterBufferDelay","jitterBufferEmittedCount","keyFramesEncoded","packetsLost","packetsReceived","packetsSent","pliCount","qpSum_delta","qpSum","requestsReceived","requestsSent","responsesReceived","responsesSent","totalAudioEnergy"];f.TSLOG_STATS_TO_SUPPRESS=a;c={audioLevel:1e4,jitter:1e3,totalAudioEnergy:1e4,totalDecodeTime:1e3,totalEncodeTime:1e3,totalSamplesDuration:1e3};f.TSLOG_METRIC_SCALE=c;g=["availableOutgoingBitrate","consentRequestsSent","requestsReceived","requestsSent","responsesReceived","responsesSent"];f.TSLOG_STATS_REQUESTED_FROM_CANDIDATE_PAIR=g;h=["audioLevel","packetsLost","totalAudioEnergy","totalSamplesDuration"];f.RULE_VIOLATION_WHITELIST=h;i=[5,50,95];f.PERCENTILES_REQUESTED=i;function a(){return b("UserAgent").isBrowser("Chrome < 86")||b("UserAgent").isBrowser("Edge (Chromium Based) < 86")||b("UserAgent").isBrowser("Opera < 72")}function c(){return e.exports.isPreChromium86()?b("ZenonMediaStatsSourcePreM86").TRACK_STATS:b("ZenonMediaStatsSource").TRACK_STATS}function d(){return e.exports.isPreChromium86()?b("ZenonMediaStatsSourcePreM86").INBOUND_RTP_STATS:b("ZenonMediaStatsSource").INBOUND_RTP_STATS}function g(){return b("ZenonMediaStatsSource").OUTBOUND_RTP_STATS}function h(){return b("ZenonMediaStatsSource").RTP_STATS}function i(){return b("ZenonMediaStatsSource").CANDIDATE_PAIR_STATS}function j(){return b("ZenonMediaStatsSource").MEDIA_SOURCE_STATS}function k(){return b("ZenonMediaStatsSource").SSRC_STATS}},null);
__d("ZenonCumulativeMediaStat",["performanceNow"],function(a,b,c,d,e,f){"use strict";var g;a=function(){function a(a){this.$3=this.$5=this.$1=a,this.$7=this.$8=a,this.$9=!1,this.$4=this.$6=this.$2=(g||(g=b("performanceNow")))(),this.$10=1}var c=a.prototype;c.$11=function(a){this.$5=this.$1,this.$6=this.$2,this.$1=a,this.$2=(g||(g=b("performanceNow")))(),this.$10++};c.update=function(a){this.$7=this.$8;this.$8=a;a=this.$8-this.$7;a<0?(a=this.$8,this.$9=!0):this.$9=!1;this.$11(this.$1+a)};c.updateNonStrictCumulative=function(a){this.$7=this.$8,this.$8=a,this.$9=!1,this.$11(a)};c.isReset=function(){return this.$9};c.getCurrentValue=function(){return this.$1};c.getDeltaValue=function(){return this.$1-this.$3};c.getDeltaFromLastUpdate=function(){return this.$1-this.$5};c.getTimeSinceLastUpdate=function(){return this.$2-this.$6};c.getElapsedTime=function(){return this.$2-this.$4};c.getPreviousTime=function(){return this.$6};c.getCurrentTime=function(){return this.$2};c.getAverageOverTime=function(){return this.getDeltaValue()/this.getElapsedTime()};c.getCurrentTimeSinceLastUpdate=function(){return(g||(g=b("performanceNow")))()-this.$2};c.getStatCount=function(){return this.$10};c.getFirstValue=function(){return this.$3};return a}();e.exports=a},null);
__d("percentile",[],function(a,b,c,d,e,f){function g(a,b){return(a||0)-(b||0)}function a(a,b){return h(a.slice().sort(g),b)}function h(a,b){b=(a.length-1)*b;var c=Math.floor(b),d=Math.ceil(b);if(c===d)return a[b];var e=a[c]*(d-b);a=a[d]*(b-c);return e+a}e.exports=a;e.exports.fromSorted=h},null);
__d("median",["percentile"],function(a,b,c,d,e,f){function a(a){return b("percentile")(a,.5)}e.exports=a},null);
__d("ZenonDeltaMediaStat",["median"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[],this.$2=0,this.$3=null}var c=a.prototype;c.add=function(a){this.$1.push(a),this.$2++,this.$3=a};c.getLastAddedValue=function(){return this.$3};c.getTotal=function(){var a=this.$1.reduce(function(a,b){return a+b},0);return a};c.getCount=function(){return this.$1.length};c.getAverage=function(){return this.getTotal()/this.getCount()};c.getMin=function(){return Math.min.apply(Math,this.$1)};c.getMax=function(){return Math.max.apply(Math,this.$1)};c.getMedian=function(){return b("median")(this.$1)};return a}();e.exports=a},null);
__d("ZenonSimulcastStats",[],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=0,this.$2=new Map(),this.$3=new Map()}var b=a.prototype;b.update=function(a){a=g(a,this.$2,this.$3);var b=0;for(var c=a,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f[0];f=f[1];f&&b++}if(this.$3.size===0)b>0&&this.$1++;else{f=!1;for(var e=a,d=Array.isArray(e),c=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(c>=e.length)break;b=e[c++]}else{c=e.next();if(c.done)break;b=c.value}b=b;var h=b[0];b=b[1];(!this.$3.has(h)||this.$3.get(h)!==b)&&(f=!0)}f&&this.$1++}this.$3=a};b.getNumLayerChanges=function(){return this.isSimulcastCall()?this.$1:0};b.isSimulcastCall=function(){return this.$3.size>1};return a}();e.exports=a;function g(a,b,c){var d=new Map();for(var a=a.values(),e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;if(g.ssrc===void 0||g.framesSent===void 0)continue;var h=String(g.ssrc);g=Number(g.framesSent);if(b.has(h)){var i=b.get(h);i!==void 0&&d.set(h,g>i)}else d.set(h,g>0);b.set(h,g)}for(var i=c,h=Array.isArray(i),g=0,i=h?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(h){if(g>=i.length)break;f=i[g++]}else{g=i.next();if(g.done)break;f=g.value}e=f;a=e[0];e[1];d.has(a)||d.set(a,!1)}return d}},null);
__d("ZenonVideoScaleHistogram",[],function(a,b,c,d,e,f){"use strict";f.getBinFromScale=g;f.updateTrackerWithScaleHistogram=a;function g(a){if(a>=.765625)return 0;else if(a>=.390625)return 1;else if(a>=.19140625)return 2;else if(a>=.09765625)return 3;return 4}function a(a,b){var c=["video","screen"];a.filter(function(a){return c.includes(a.contentType)&&a.remote===!1}).forEach(function(a){a=b.get(a.trackId);if(!a||!a.cumulativeStat||!a.histResScale)return;var c=a.cumulativeStat,d=c.framesEncoded;c=c.tracktimestamp;var e=a.deltaStat,f=e.frameHeight,h=e.frameWidth,i=e.height;e=e.width;if(d!=null&&e!=null&&i!=null&&h!=null&&f!=null&&d.getDeltaFromLastUpdate()>0&&c.getCurrentValue()>a.lastUpdate){c=d.getDeltaFromLastUpdate();d=((d=e.getLastAddedValue())!=null?d:0)*((e=i.getLastAddedValue())!=null?e:0);h=((i=h.getLastAddedValue())!=null?i:0)*((e=f.getLastAddedValue())!=null?e:0);if(d>0){i=h/d;f=g(i);a.histResScale[f]+=c}}})}},null);
__d("ZenonMediaStatsParser",["ScotchRTWebUserActionLogger","ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonSimulcastStats","ZenonVideoScaleHistogram","isTruthy","performanceNow"],function(a,b,c,d,e,f){"use strict";f.filterLegacyMediaReports=i;f.filterMediaReports=a;f.getMediaTrackDirection=c;f.getOrCreateTrackerFromMap=j;f.isCumulativeStat=k;f.isDeltaStat=l;f.makeStatsReportMap=d;f.updateTrackStatsWithChromiumLegacyReport=e;f.updateTrackStatsWithReport=m;var g,h=["inbound-rtp","outbound-rtp","track","media-source","candidate-pair"];function i(a,b){var c=new Map();b.forEach(function(b,d){b.type==="ssrc"&&b.googTrackId!=null&&b.googTrackId===a.trackId&&c.set(d,b)});return c}function a(a){var b=new Map();for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];h.includes(e.type)&&b.set(f,e)}return b}function c(a){var c=["recv","inbound"],d=["send","outbound"];if(c.some(function(b){return a.toLowerCase().includes(b)}))return"inbound";if(d.some(function(b){return a.toLowerCase().includes(b)}))return"outbound";b("ScotchRTWebUserActionLogger").logError({errorDomain:"ZenonMediaStatsParser",errorType:"CANNOT_DETERMINE_STREAM_DIRECTION"});return"inbound"}function j(a,c){var d=a.get(c);d==null&&(d={codec:null,cumulativeStat:{},deltaStat:{},duration:0,histResScale:new Array(b("ZenonVideoScaleHistogram").getBinFromScale(0)+1).fill(0),lastUpdate:0,maxTotalDecodeTime:0,percentStat:{},startTime:(g||(g=b("performanceNow")))()},a.set(c,d));return d}function k(a){return b("ZenonMediaStatsConfig").CUMULATIVE_STATS.includes(a)}function l(a){return b("ZenonMediaStatsConfig").DELTA_STATS.includes(a)}function d(a){if(a instanceof Map)return a;var b=new Map();if(a.result)for(var c=a.result(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g={id:f.id,timestamp:f.timestamp,type:f.type};for(var h=f.names(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=h.length)break;k=h[j++]}else{j=h.next();if(j.done)break;k=j.value}k=k;g[k]==null&&(g[k]=f.stat(k))}b.set(g.id,g)}else for(var k=a.values(),j=Array.isArray(k),i=0,k=j?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(j){if(i>=k.length)break;h=k[i++]}else{i=k.next();if(i.done)break;h=i.value}f=h;b.set(f.id,f)}return b}function e(a,b,c){c=i(a,c);for(var c=c.values(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=j(b,a.trackId);p(a,g,f);g.codec=n(f)}}function m(a,c,d){var e=null,f=[];for(var d=d.values(),g=Array.isArray(d),h=0,d=g?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=d.length)break;i=d[h++]}else{h=d.next();if(h.done)break;i=h.value}i=i;i.type==="outbound-rtp"&&i.trackId&&(e=j(c,a.trackId),typeof i.trackId==="string"&&(e.sender=i.trackId),i.kind==="video"&&f.push(i));switch(i.type){case"inbound-rtp":e=j(c,a.trackId);q(e,i,b("ZenonMediaStatsConfig").getInboundRtpStats().concat(b("ZenonMediaStatsConfig").getRtpStats()));break;case"outbound-rtp":e=j(c,a.trackId);q(e,i,b("ZenonMediaStatsConfig").getOutboundRtpStats().concat(b("ZenonMediaStatsConfig").getRtpStats()));break;case"media-source":e=j(c,a.trackId);q(e,i,b("ZenonMediaStatsConfig").getMediaSourceStats());break;case"track":e=j(c,a.trackId);q(e,i,b("ZenonMediaStatsConfig").getTrackStats());break;case"candidate-pair":e=j(c,a.trackId);q(e,i,b("ZenonMediaStatsConfig").getCandidatePairStats());break;case"codec":var k=String(i.mimeType).split("/")[1];k!=null&&k!==""&&(e=j(c,a.trackId),o(e,k));break;case"local-candidate":e=j(c,a.trackId);e.localIceCandidateStats=s(i);break;case"remote-candidate":e=j(c,a.trackId);e.remoteIceCandidateStats=s(i);break;default:break}}e!=null&&f.length>0&&r(e,f)}function n(a){var b=null;a.googCodecName!=null&&a.googCodecName!==""&&(b=String(a.googCodecName),a.codecImplementationName!=null&&(b+=String(a.codecImplementationName)));return b}function o(a,c){a.startTime==null&&(a.startTime=(g||(g=b("performanceNow")))());var d=a.startTime;a.codecHistory==null&&(a.codecHistory=[]);c.length>0&&(a.codecHistory.length===0||a.codecHistory[a.codecHistory.length-1].codec!==c)&&a.codecHistory.push({codec:c,updateTime:(g||(g=b("performanceNow")))()-d});a.codec=c}function p(a,c,d){Object.entries(d).forEach(function(d){var e=d[0];d=Number(d[1]);if(b("ZenonMediaStatsConfig").STATS_REQUESTED.includes(e)&&b("ZenonMediaStatsConfig").getSsrcStats().includes(e))if(b("ZenonMediaStatsConfig").CUMULATIVE_STATS.includes(e)){if(e==="packetsLost"&&a.remote)return;c.cumulativeStat[e]!=null?e==="packetsLost"?c.cumulativeStat[e].updateNonStrictCumulative(d):c.cumulativeStat[e].update(d):c.cumulativeStat[e]=new(b("ZenonCumulativeMediaStat"))(d)}else b("ZenonMediaStatsConfig").DELTA_STATS.includes(e)&&(c.deltaStat[e]==null&&(c.deltaStat[e]=new(b("ZenonDeltaMediaStat"))()),c.deltaStat[e].add(d))})}function q(a,c,d){Object.entries(c).forEach(function(e){var f=e[0];e=Number(e[1]);if(!d||d.includes(f))if(k(f))a.cumulativeStat[f]!=null?f==="packetsLost"?a.cumulativeStat[f].updateNonStrictCumulative(e):a.cumulativeStat[f].update(e):a.cumulativeStat[f]=new(b("ZenonCumulativeMediaStat"))(e);else if(f==="timestamp"){var g=c.type+f;a.cumulativeStat[g]!=null?a.cumulativeStat[g].update(e):a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(e)}else if(f===b("ZenonMediaStatsConfig").DERIVED_METRICS.FRAME_RATE_MEAN){g=null;c.framesEncoded!=null?g=Number(c.framesEncoded):c.framesDecoded!=null&&(g=Number(c.framesDecoded));b("isTruthy")(g)&&(a.deltaStat[f]==null&&(a.deltaStat[f]=new(b("ZenonDeltaMediaStat"))()),a.deltaStat[f].add(e))}else l(f)&&(a.deltaStat[f]==null&&(a.deltaStat[f]=new(b("ZenonDeltaMediaStat"))()),a.deltaStat[f].add(e))})}function r(a,c){var d;a.simulcastStats===void 0&&(a.simulcastStats=new(b("ZenonSimulcastStats"))());(d=a.simulcastStats)==null?void 0:d.update(c);c=(d=a.simulcastStats)==null?void 0:d.getNumLayerChanges();if(c!=null){d=b("ZenonMediaStatsConfig").DERIVED_METRICS.SIMULCAST_LAYER_CHANGES;a.cumulativeStat[d]!=null?a.cumulativeStat[d].update(c):a.cumulativeStat[d]=new(b("ZenonCumulativeMediaStat"))(c)}}function s(a){var b=a.candidateType,c=a.networkType;a=a.protocol;var d={};b&&typeof b==="string"&&(d.candidateType=b);c&&typeof c==="string"&&(d.networkType=c);a&&typeof a==="string"&&(d.protocol=a);return d}},null);
__d("ZenonVideoQpConversion",[],function(a,b,c,d,e,f){"use strict";f.convertQp=a;var g=[0,1,2,3,4,5,7,8,9,10,12,13,15,17,18,19,20,21,23,24,25,26,27,28,29,30,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,64,67,70,73,76,79,82,85,88,91,94,97,100,103,106,109,112,115,118,121,124,127];function a(a,b,c){var d;a===0?d=0:d=b/a;b=d;c||(b=g.findIndex(function(a){return a>=d}));return b==-1?g.length-1:Math.round(b)}},null);
__d("ZenonTSLogDataHelper",["ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonVideoQpConversion"],function(a,b,c,d,e,f){"use strict";f._addDataQp=j;f._addExtraStats=k;f._cumulativeToDelta=l;f._getTslogStreamName=m;f._normalizeStreamName=n;f._serializeAvsync=o;f._serializeCounters=p;f._serializeNeteqMeanWaitTime=q;f.addCandidatePairStats=a;f.addData=c;f.addNonMediaStates=d;f.advance=e;f.emptyTSLogDataHolder=r;f.onIceConnectionStateChange=s;f.serialize=t;var g={"new":1,checking:2,connected:3,completed:4,failed:5,disconnected:6,closed:7},h={iceConnectionState:0},i=1073741824;function j(a,c,d,e){if(e.includes("qp")&&c.counters.qpSum!=null&&(c.counters.framesDecoded!=null||c.counters.framesEncoded!=null)){c.counters.qp==null&&(c.counters.qp=Array(a.shared_idx-c.bucket_start).fill(0));e=0;var f=0;a=a.shared_idx-c.bucket_start;a>0?(c.counters.framesEncoded!=null?e=c.counters.framesEncoded[a]-c.counters.framesEncoded[a-1]:c.counters.framesDecoded!=null&&(e=c.counters.framesDecoded[a]-c.counters.framesDecoded[a-1]),f=c.counters.qpSum[a]-c.counters.qpSum[a-1]):(c.counters.framesEncoded!=null?e=c.counters.framesEncoded[a]:c.counters.framesDecoded!=null&&(e=c.counters.framesDecoded[a]),f=c.counters.qpSum[a]);c.counters.qp[a]=b("ZenonVideoQpConversion").convertQp(e,f,d)}}function k(a,c,d,e,f){var g=function(e,g){for(var h=0;h<e.length;h++){var i=e[h];if(d.includes(i))for(var j=c.values(),k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{l=j.next();if(l.done)break;m=l.value}m=m;if(m.type===g&&m[i]!==void 0){var n;f.counters[i]==null&&(f.counters[i]=Array(a.shared_idx-f.bucket_start).fill(0));n=(n=b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[i])!=null?n:1;f.counters[i][a.shared_idx-f.bucket_start]=Math.round(Number(m[i])*n)}}}};g(b("ZenonMediaStatsConfig").getTrackStats(),"track");g(b("ZenonMediaStatsConfig").getMediaSourceStats(),"media-source");if(e==="video"&&d.includes("qp")){g=!1;for(var e=c.values(),h=Array.isArray(e),i=0,e=h?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(h){if(i>=e.length)break;k=e[i++]}else{i=e.next();if(i.done)break;k=i.value}k=k;k.encoderImplementation!==void 0&&(g=String(k.encoderImplementation).includes("264"))}j(a,f,g,d)}}function l(a){return a.map(function(b,c){return c===0?0:b-a[c-1]})}function m(a){if(a.type==="candidate-pair")return a.id;var b="unknown",c=["recv","inbound"],d=["send","outbound"];c.some(function(b){return a.id.toLowerCase().includes(b)})&&(b="inbound");d.some(function(b){return a.id.toLowerCase().includes(b)})&&(b="outbound");c=a.mediaType===void 0?"unknown":a.mediaType.toString();d=a.ssrc===void 0?"unknown":a.ssrc.toString();return b+"_"+c+"_"+d}function n(a,b){return a+"_rtp_"+b}function o(a,b,c){if(c&&Object.prototype.hasOwnProperty.call(c.counters,"estimatedPlayoutTimestamp")&&Object.prototype.hasOwnProperty.call(a.counters,"estimatedPlayoutTimestamp")){var d=c.counters.estimatedPlayoutTimestamp.length,e=a.counters.estimatedPlayoutTimestamp.length,f=Math.min(e,d),g=new Array(f).fill(0),h=new Array(f).fill(0);for(var j=0;j<f;j++){var k=c.counters.estimatedPlayoutTimestamp[j],l=a.counters.estimatedPlayoutTimestamp[j];k>0&&l>0?k>=l?(h[j]=2,g[j]=Math.min(k-l,i)):(h[j]=1,g[j]=Math.min(l-k,i)):(h[j]=0,g[j]=0)}b.push({data:g,name:"avSync"});b.push({data:h,name:"avSyncSign"});l=22089888e5+1598738e6;k=Math.max(e,d);j=new Array(d).fill(0);f=new Array(e).fill(0);g=null;for(var h=0;h<k;h++){d=c.counters.estimatedPlayoutTimestamp[h];e=a.counters.estimatedPlayoutTimestamp[h];g==null&&(d>l&&e>l?g=Math.min(d,e):d>l?g=d:e>l&&(g=e));g!=null&&(d>l&&(j[h]=Math.max(Math.min(d-g,i),-i)),e>l&&(f[h]=Math.max(Math.min(e-g,i),-i)))}b.push({data:j,name:"audioTs"});b.push({data:f,name:"videoTs"})}}function p(a,c,d){var e=[];for(var f in a.counters)c.includes(f)||e.push({data:a.counters[f],name:f}),b("ZenonMediaStatsParser").isCumulativeStat(f)&&!c.includes(f+"_delta")&&e.push({data:l(a.counters[f]),name:f+"_delta"});c=a.counters;var g=c.fecPacketsDiscarded;c=c.fecPacketsReceived;if(g!=null&&c!=null){var h=Math.min(g.length,c.length),i=[];for(var j=0;j<h;j++)i.push(c[j]-g[j]);e.push({data:l(i),name:"fecPacketsUsed_delta"})}q(a,e);o(a,e,d);return e}function q(a,b){if(Object.prototype.hasOwnProperty.call(a.counters,"jitterBufferDelay")&&Object.prototype.hasOwnProperty.call(a.counters,"jitterBufferEmittedCount")){var c=Math.min(a.counters.jitterBufferDelay.length,a.counters.jitterBufferEmittedCount.length),d=new Array(c).fill(0);for(var e=1;e<c;e++){var f=a.counters.jitterBufferDelay[e]-a.counters.jitterBufferDelay[e-1],g=a.counters.jitterBufferEmittedCount[e]-a.counters.jitterBufferEmittedCount[e-1];g===0?d[e]=0:d[e]=Math.round(f*1e3/g)}b.push({data:d,name:"neteqMeanWaitTime"})}}function a(a,c){if(c.size===0)return;c.forEach(function(c){if(c.type==="candidate-pair"){var d=m(c),e=a.streams[d];e==null&&(e={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:"candidate-pair",counters:{},owner:""},a.streams[d]=e);(a.start_time_ms==null||c.timestamp<a.start_time_ms)&&(a.start_time_ms=c.timestamp);for(var f in c)b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED_FROM_CANDIDATE_PAIR.includes(f)&&u(a,e,f,c[f],b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[f]);e.bucket_end=a.shared_idx;(a.end_time_ms==null||c.timestamp>a.end_time_ms)&&(a.end_time_ms=c.timestamp)}})}function c(a,c,d,e,f,g){if(d.size===0)return;d.forEach(function(h){if(h.type==="track"||h.type==="media-source"||h.type==="candidate-pair")return;var i=m(h),j=a.streams[i];if(h.type==="ssrc"){if(j==null)return;for(var l in h)e.includes(l)&&b("ZenonMediaStatsConfig").getSsrcStats().includes(l)&&u(a,j,l,h[l],b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[l])}else{j==null&&(j={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:f,counters:{},owner:g?g.id:""},a.streams[i]=j);(a.start_time_ms==null||h.timestamp<a.start_time_ms)&&(a.start_time_ms=h.timestamp);h.ssrc!=null&&(j.ssrc=h.ssrc.toString());u(a,j,"trackEnabled",c);for(var n in h){e.includes(n)&&u(a,j,n,h[n],b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[n]);if(n==="estimatedPlayoutTimestamp"&&e.includes(b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY)){i=new Date(Date.UTC(0,0));i=Date.now()-i-Number(h[n]);j.counters[b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY]==null&&(j.counters[b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY]=Array(a.shared_idx-j.bucket_start).fill(0));j.counters[b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY][a.shared_idx-j.bucket_start]=i}}k(a,d,e,f,j)}j.bucket_end=a.shared_idx;(a.end_time_ms==null||h.timestamp>a.end_time_ms)&&(a.end_time_ms=h.timestamp)})}function d(a){a.streams.nonMediaState==null&&(a.streams.nonMediaState={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:"non-media-state",counters:{},owner:""});var b=a.streams.nonMediaState;Object.keys(h).forEach(function(c){u(a,b,c,h[c])});b.bucket_end=a.shared_idx}function e(a){var b;a.streams["."]==null&&(a.streams["."]={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:"time",counters:{btime:[],ctime:[]}});b=(b=a.end_time_ms)!=null?b:0;var c=a.streams["."].counters,d=c.btime;c=c.ctime;c.push(Math.round(b-((b=a.start_time_ms)!=null?b:0)));d.push(Math.round(c[a.shared_idx]-((b=c[a.shared_idx-1])!=null?b:0)));a.streams["."].bucket_end=a.shared_idx;a.shared_idx++}function r(){return{end_time_ms:null,shared_idx:0,source:"rtc_www",start_time_ms:null,streams:{}}}function s(a){h.iceConnectionState=(a=g[a])!=null?a:0}function t(a,c){c=(c=c)!=null?c:b("ZenonMediaStatsConfig").TSLOG_STATS_TO_SUPPRESS;var d={source:a.source,start_time_ms:Number(a.start_time_ms),streams:[]},e=new Map(),f=0,g=new Map(),h=["audio","video"];for(var i in a.streams){var j=a.streams[i];if(h.includes(j.contentType)){var k=b("ZenonMediaStatsParser").getMediaTrackDirection(i);k==="inbound"&&j.owner!=null&&!e.has(j.owner)&&(e.set(j.owner,f.toString()),f++);k=j.owner+j.contentType;g.set(k,i)}}j={};for(var l in a.streams){k=a.streams[l];f=void 0;var m=l;if(h.includes(k.contentType)){var o=b("ZenonMediaStatsParser").getMediaTrackDirection(l);j[o+k.contentType]=j[o+k.contentType]+1||0;m=n(o,k.contentType)}else k.contentType==="candidate-pair"&&(m="cp");o=g.get(k.owner+"audio");k.contentType==="video"&&o!=null&&(f=a.streams[o]);o={bucket_end:k.bucket_end,bucket_start:k.bucket_start,counters:p(a.streams[l],c,f),name:m,props:{}};e.has(a.streams[l].owner)&&(o.props.seq=e.get(a.streams[l].owner));a.streams[l].ssrc!=null&&(o.props.ssrc=a.streams[l].ssrc);d.streams.push(o)}return d}function u(a,b,c,d,e){a=Math.max(a.shared_idx-b.bucket_start,0);b.counters[c]==null&&(b.counters[c]=Array(a).fill(0));e=Math.round(Number(d)*((d=e)!=null?d:1));b.counters[c][a]=e}},null);
__d("ScotchRTCCallStoreState",["CurrentUser","FBRTCCallSummary","RTCUser","ZenonTSLogDataHelper","immutable"],function(a,b,c,d,e,f){"use strict";a={debugID:0,callID:"",collisionContext:{groupThreadID:null,peerID:null,serverInfoData:null},conferenceState:"NEW",conferenceName:"",responseSubCode:null,protocol:"",serverInfoData:"",tsLogData:b("ZenonTSLogDataHelper").emptyTSLogDataHolder()};d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.isInCall=function(){return this.conferenceState==="CONNECTING"||this.conferenceState==="CONNECTED"};return b}((c=b("immutable")).Record(a));f={connections:c.Set(),localUser:new(b("RTCUser"))({FBID:b("CurrentUser").getID()}),remoteUsers:c.Set(),remoteScreenSharingUserIDs:c.OrderedSet(),callInfo:new d(),callSummary:b("FBRTCCallSummary").nullSummary(),mediaStatus:c.Map()};a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c.Record(f));e.exports=a},null);
__d("ScotchRTCCallReducer",["invariant","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCLogger","FBRTCParticipantCallState","FBRTCRtcResponseStatusCode","RTCUser","ScotchRTCCallStore","ScotchRTCCallStoreState","ScotchRTCUtils","ScotchRTWebUserActionLogger","URI","ZenonMWTranslatorUtils","gkx","immutable"],function(a,b,c,d,e,f,g){"use strict";f.callInit=a;f.callStart=c;f.setPendingApproval=d;f.incomingCallStart=e;f.callEnd=i;f.completeTransitionToMultiway=j;f.abortMultiwayEscalationProcess=k;f.onParticipantsChanged=l;f.processConferenceState=m;f.processJoinResponse=n;f.processUsers=o;f.processRemoteScreenSharingUserID=p;f.toggleLocalStream=q;f.processLocalStream=r;f.processLocalScreenStream=s;f.processRemoteStream=t;f.processRemoteTrack=u;f.processRemoteScreenStream=v;f.toggleRemoteStream=w;f.waitForUserInput=y;var h;function a(a,c){switch(c.type){case"INIT":return a.set("callInfo",a.callInfo.set("callID",c.callID).set("conferenceName",c.conferenceName).set("serverInfoData",c.serverInfoData).set("protocol",c.protocol).set("collisionContext",{serverInfoData:c.serverInfoData,peerID:null,groupThreadID:null})).set("remoteScreenSharingUserIDs",b("immutable").OrderedSet());case"RESET":return new(b("ScotchRTCCallStoreState"))();case"RESET_FOR_REDIAL":return a.set("callInfo",a.callInfo.set("conferenceState","NEW").set("callID",c.callID).set("conferenceName",c.conferenceName)).set("callSummary",b("FBRTCCallSummary").nullSummary()).set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()})).set("remoteScreenSharingUserIDs",b("immutable").OrderedSet());case"CALL_COLLISION":return a.set("callInfo",a.callInfo.set("conferenceState","NEW").set("callID",c.conferenceName).set("conferenceName",c.conferenceName)).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()})).set("remoteScreenSharingUserIDs",b("immutable").OrderedSet())}return a}function c(a,b){switch(b.type){case"CALL":return a.setIn(["callInfo","conferenceState"],"CONNECTING").set("connections",a.connections.add(b.peerConnection));case"CALL_ERROR":return a.setIn(["callInfo","conferenceState"],"TERMINATED").setIn(["callInfo","responseSubCode"],b.responseSubCode);case"CALL_SUCCESS":return b.connected?a.setIn(["callInfo","conferenceState"],"CONNECTED"):a}return a}function d(a,b){switch(b.type){case"SET_PENDING_APPROVAL":return a.setIn(["callInfo","conferenceState"],"PENDING_APPROVAL")}return a}function e(a,b){switch(b.type){case"INCOMING_CALL_SUCCESS":return a.setIn(["callInfo","conferenceState"],"CONNECTED")}return a}function i(a,c){switch(c.type){case"HANGUP":a.connections.forEach(function(a){return a.close()});return a.setIn(["callInfo","conferenceState"],"TERMINATING").set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()}));case"DISMISS":c.transaction.sendResponse(c.request.createResponse(b("FBRTCRtcResponseStatusCode").OK,{callID:a.callInfo.callID}));case"END_CALL":a.connections.forEach(function(a){return a.close()});return a.setIn(["callInfo","conferenceState"],"TERMINATED").set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()}));case"HANGUP_ERROR":case"HANGUP_SUCCESS":return a.setIn(["callInfo","conferenceState"],"TERMINATED")}return a}function j(a,c){switch(c.type){case"GROUP_ESCALATION_CLEAR_P2P_CONNECTION":var d=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.P2P);if(d){c=d.getRemoteStreams();var e=c[0];d.close();var f=a.localUser;c=f.getScreenStream();if(c){var g=f.getStream();g&&b("ScotchRTCUtils").transferAudioTracks(g,c);b("ScotchRTCUtils").stopMediaStream(c);f=f.removeScreenStream(c)}return a.withMutations(function(a){a.set("connections",a.connections.remove(d)).set("localUser",f).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeStream(e)}))})}}return a}function k(a,c){switch(c.type){case"GROUP_ESCALATION_CANCEL":var d=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(d){var e=d.getRemoteStreams(),f=e[0],g=a.callSummary;c.p2pCallSummary&&(g=c.p2pCallSummary,b("FBRTCCallSummaryStore").getInstance().removeCallSummary(a.callSummary.peerID,a.callSummary.callID));d.close();return a.withMutations(function(a){a.set("callInfo",a.callInfo.set("conferenceState","CONNECTED").set("conferenceName",g.callID).set("protocol","p2p").set("serverInfoData","")).set("callSummary",g).set("connections",a.connections.remove(d)).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeStream(f)}))})}}return a}function l(a,c){var d=function(){switch(c.type){case"ON_PARTICIPANTS_ADDED":var d=a.remoteUsers.map(function(a){return a.FBID});return a.set("remoteUsers",a.remoteUsers.union(Object.keys(c.participants).filter(function(a){return!d.has(c.participants[a].fbid)}).map(function(a){var d=c.participants[a],e=d.big_image_src||d.image_src;c.images&&c.images[a]&&(e=c.images[a]);d.fbid||g(0,1174);return new(b("RTCUser"))({FBID:d.fbid,profileUrl:new(h||(h=b("URI")))(d.href),profilePictureUrl:e,isGuestUser:d.user_type==="guest",isMessengerUser:!!d.is_messenger_user,isPartiesUser:!!d.is_parties_user,streams:(a=d.streams)!=null?a:b("immutable").Set(),userName:d.name,userShortName:d.short_name,vanity:d.vanity})})))}return a};d=d();return d}function m(a,c){var d=function(){switch(c.type){case"ON_CONFERENCE_STATE":var d=c.transaction,e=c.request,f=c.request.conferenceStateRequest(),g={currentVersion:c.conferenceStateVersion},h=a.callInfo.callID;if(a.callInfo.conferenceState==="TERMINATING"||a.callInfo.conferenceState==="TERMINATED"){b("FBRTCLogger").getInstance().logServerRequestDoneProcessing(e,h);d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{conferenceStateResponse:g},callID:h}));return a}b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_processConferenceState: "+JSON.stringify(f)});if(c.conferenceStateVersion>=f.version){b("FBRTCLogger").getInstance().logServerRequestDoneProcessing(e,h);d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{conferenceStateResponse:g},callID:h}));return a}c.resolve(f.version);var i=a.remoteUsers.map(function(a){var c=f.participantStates[a.FBID];c&&c.state===b("FBRTCParticipantCallState").DISCONNECTED&&(a=a.removeAllStreams());return c?a.setParticipantState(c):a}),j=i.some(function(a){a=a.participantState;return a&&a.state===b("FBRTCParticipantCallState").CONNECTED});j=j&&a.callInfo.conferenceState!="PENDING_APPROVAL"?"CONNECTED":a.callInfo.conferenceState;var k=f.appMessages;k=(k=b("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(k))!=null?k:a.callInfo.collisionContext;b("FBRTCLogger").getInstance().logServerRequestDoneProcessing(e,h);d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{conferenceStateResponse:g},callID:a.callInfo.callID}));return a.setIn(["remoteUsers"],i).setIn(["callInfo","conferenceState"],j).setIn(["callInfo","collisionContext"],k)}return a};d=d();return d}function n(a,b){switch(b.type){case"ON_JOIN_RESPONSE":return a.setIn(["callInfo","serverInfoData"],b.serverInfoData).setIn(["callInfo","collisionContext"],{serverInfoData:b.serverInfoData})}return a}function o(a,b){var c=function(){switch(b.type){case"INIT_LOCAL_USER":return a.set("localUser",b.localUser);case"INIT_REMOTE_USERS":case"UPDATE_REMOTE_USERS":return a.set("remoteUsers",b.remoteUsers)}return a};c=c();return c}function p(a,b){switch(b.type){case"ADD_REMOTE_SCREEN_SHARING_USER_ID":return a.set("remoteScreenSharingUserIDs",a.remoteScreenSharingUserIDs.add(b.userID));case"REMOVE_REMOTE_SCREEN_SHARING_USER_ID":return a.set("remoteScreenSharingUserIDs",a.remoteScreenSharingUserIDs.remove(b.userID))}return a}function q(a,b){switch(b.type){case"AUDIO_MUTED":case"AUDIO_UNMUTED":return a.set("localUser",a.localUser.toggleDisableAudio());case"VIDEO_MUTED":return a.set("localUser",a.localUser.toggleDisableVideo(!0));case"VIDEO_UNMUTED":return a.set("localUser",a.localUser.toggleDisableVideo(!1));default:return a}}function r(a,c){switch(c.type){case"ADD_LOCAL_STREAM":return a.set("localUser",a.localUser.addStream(c.stream));case"REMOVE_LOCAL_STREAM":return a.set("localUser",a.localUser.removeStream(c.stream));case"REPLACE_LOCAL_STREAM":var d=c.oldStream.getAudioTracks();d=d[0];var e=c.oldStream.getVideoTracks();e=e[0];if(d!=null)for(var f=c.newStream.getAudioTracks(),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;i.enabled=d.enabled}if(e!=null)for(var i=c.newStream.getVideoTracks(),h=Array.isArray(i),g=0,i=h?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(h){if(g>=i.length)break;f=i[g++]}else{g=i.next();if(g.done)break;f=g.value}d=f;d.enabled=e.enabled}return a.set("localUser",a.localUser.replaceStream(c.oldStream,c.newStream));case"STOP_LOCAL_STREAM":return a.set("localUser",a.localUser.stopVideo());case"REMOVE_ALL_LOCAL_STREAMS":if(c.stopStreams)for(var f=a.localUser.streams,d=Array.isArray(f),g=0,f=d?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(g>=f.length)break;h=f[g++]}else{g=f.next();if(g.done)break;h=g.value}i=h;b("ScotchRTCUtils").stopMediaStream(i)}return a.set("localUser",a.localUser.removeAllStreams())}return a}function s(a,c){switch(c.type){case"ADD_LOCAL_SCREEN_STREAM":return a.set("localUser",a.localUser.addScreenStream(c.stream));case"REMOVE_LOCAL_SCREEN_STREAM":return a.set("localUser",a.localUser.removeScreenStream(c.stream));case"REMOVE_ALL_LOCAL_SCREEN_STREAMS":if(c.stopStreams)for(var d=a.localUser.screenStreams,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b("ScotchRTCUtils").stopMediaStream(g)}return a.set("localUser",a.localUser.removeAllScreenStreams());case"REPLACE_LOCAL_SCREEN_STREAM":return a.set("localUser",a.localUser.replaceScreenStream(c.oldStream,c.newStream))}return a}function t(a,c){var d,e=function(){switch(c.type){case"ADD_REMOTE_STREAM":var e="";a.mediaStatus.forEach(function(a,b){e+="track: "+b+" status: "+(a?"true":"false")+","});var f=c.stream.getTracks().reduce(function(a,b){return a.concat(b.kind+": "+b.id+",")},"");b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_AddRemoteStream.\n            New stream: "+c.stream.id+":{"+f+"} .\n            Current media status: "+e});d=x(a,c);if(!d)return a;f=d;a.callInfo.protocol==="multiway"&&(f=f.removeAllStreams());f=a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(f.addStream(c.stream)));return w(f,{type:"TOGGLE_REMOTE_STREAM",mediaStatus:f.mediaStatus.toJS()});case"REMOVE_REMOTE_STREAM":d=x(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.removeStream(c.stream)));case"REMOVE_ALL_REMOTE_STREAMS":d=x(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.removeAllStreams().removeAllScreenStreams()))}return a};e=e();return e}function u(a,b){var c,d=function(){switch(b.type){case"ADD_REMOTE_TRACK":c=x(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.clone()));case"REMOVE_REMOTE_TRACK":c=x(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.clone()))}return a};d=d();return d}function v(a,b){var c,d=function(){switch(b.type){case"ADD_REMOTE_SCREEN_STREAM":c=x(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.addScreenStream(b.stream)));case"REMOVE_REMOTE_SCREEN_STREAM":c=x(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.removeScreenStream(b.stream)))}return a};d=d();return d}function w(a,c){var d,e=function(){switch(c.type){case"TOGGLE_REMOTE_STREAM":if(b("gkx")("1439080")&&c.mediaStatus!=null){var e=Object.keys(c.mediaStatus).reduce(function(a,b){return""+a+b+":"+String(c.mediaStatus[b])+";"},"");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_toggleRemoteStream.\n            Action type: "+c.type+" mediaStatus: "+e})}var f=new Map(),g=a.remoteUsers;a.mediaStatus.forEach(function(a,c){var d=g.reduce(function(b,a){var d=a.streams.map(function(a){return a.getTracks().find(function(a){return a.id===c})}).find(Boolean);return d?{user:a,track:d}:b},{}),b=d.user;d=d.track;if(b&&d){var e=Boolean(b.audioStreamMuteStates.get(d.id));d.kind==="video"&&b.isVideoDisabled()===a?g=g["delete"](b).add(b.toggleDisableVideo(!b.isVideoDisabled())):d.kind==="audio"&&e===a&&(g=g["delete"](b).add(b.toggleAudioTrackMutedByUser(d.id,!e)))}else f.set(c,a)});Object.entries(c.mediaStatus).forEach(function(b){var c=b[0];b=b[1];var d=g.reduce(function(b,a){var d=a.streams.map(function(a){return a.getTracks().find(function(a){return a.id===c})}).find(Boolean);return d?{user:a,track:d}:b},{}),a=d.user;d=d.track;if(a&&d){var e=Boolean(a.audioStreamMuteStates.get(d.id));d.kind==="video"&&a.isVideoDisabled()===b?g=g["delete"](a).add(a.toggleDisableVideo(!a.isVideoDisabled())):d.kind==="audio"&&e===b&&(g=g["delete"](a).add(a.toggleAudioTrackMutedByUser(d.id,!e)))}else f.set(c,!!b)});return a.set("remoteUsers",g).set("mediaStatus",b("immutable").Map(f));case"REMOTE_VIDEO_MUTED":d=x(a,c);if(!d)return a;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_toggleRemoteStream. REMOTE_VIDEO_MUTED. mute user"+d.FBID});return a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.toggleDisableVideo(!0)));case"REMOTE_VIDEO_UNMUTED":d=x(a,c);if(!d)return a;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_toggleRemoteStream. REMOTE_VIDEO_UNMUTED. unmute user"+d.FBID});return a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.toggleDisableVideo(!1)))}return a};e=e();return e}function x(a,b){return a.remoteUsers.find(function(a){return b.userID?a.FBID==b.userID:a.FBID===b.stream.id.split(":")[0]})}function y(a,b){switch(b.type){case"WAIT_FOR_USER_INPUT":return a.callInfo.conferenceState==="NEW"?a.setIn(["callInfo","conferenceState"],"AWAITING_USER_START"):a}return a}},null);
__d("ScotchRTCCallStore",["FBRTCCallSummaryStore","FluxReduceStore","ScotchFBRTCCallSummaryReducer","ScotchRTCAppDispatcher","ScotchRTCCallReducer","ScotchRTCCallStoreState","ScotchRTWebUserActionLogger","gkx"],function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchFBRTCCallSummaryReducer")).onCallEnded,a.onCallStarted,a.onMessageSignaling,a.onSurveyResult,a.setCallSummary,(c=b("ScotchRTCCallReducer")).abortMultiwayEscalationProcess,c.callEnd,c.callInit,c.callStart,c.completeTransitionToMultiway,c.incomingCallStart,c.onParticipantsChanged,c.processConferenceState,c.processJoinResponse,c.processLocalScreenStream,c.processLocalStream,c.processRemoteScreenStream,c.processRemoteStream,c.processRemoteTrack,c.processUsers,c.processRemoteScreenSharingUserID,c.setPendingApproval,c.toggleLocalStream,c.toggleRemoteStream,c.waitForUserInput],h=function(a){return a.map(function(a){return a.streams.map(function(b){return{state:a.getParticipantState(),active:b.active,streamID:b.id,tracks:b.getTracks().map(function(a){return{trackID:a.id,kind:a.kind,enabled:a.enabled,muted:a.muted,readyState:a.readyState}})}})})};d=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCallStoreState"))()};d.reduce=function(a,c){var d=g.reduce(function(a,b){return b(a,c)},a);if(b("gkx")("1439080")&&a.remoteUsers!==d.remoteUsers){a=h(a.remoteUsers);var e=h(d.remoteUsers);JSON.stringify(a)!==JSON.stringify(e)&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallStore.reduce: "+JSON.stringify({beforeStreams:a,afterStreams:e,action:c.type})})}return d};d.hasRemoteVideo=function(){return this.getState().remoteUsers.some(function(a){return a.hasStream()&&!a.areAllTracksDisabled(a.streams.first().getVideoTracks())})};d.hasLocalVideo=function(){var a=this.getState();a=a.localUser;return a.hasStream()&&!a.areAllTracksDisabled(a.streams.first().getVideoTracks())};d.getConnection=function(a){var b=this.getState();b=b.connections;a&&(b=b.filter(function(b){return b.getSignalingProtocol()===a}));return b.first()};d.mutateCallSummary=function(a){var c=this.getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())};d.getSortedRemoteUsers=function(){return this.getState().remoteUsers.toList().sort(function(a,b){return a.lastConnectedAt===b.lastConnectedAt?a.FBID>b.FBID?1:-1:a.lastConnectedAt-b.lastConnectedAt})};return c}(b("FluxReduceStore"));d.__moduleID=e.id;f=new d(b("ScotchRTCAppDispatcher"));e.exports=f},null);
__d("FBRTCMediaType",[],function(a,b,c,d,e,f){e.exports=Object.freeze({AUDIO:0,VIDEO:1,DATA:2})},null);
__d("ScotchRTCSessionDescription",["invariant","FBRTCConfig","FBRTCConstants","FBRTCMediaType","ScotchFBRTCSdpUtils","ScotchRTCSignalingExperiments","ScotchRTWebUserActionLogger","gkx"],function(a,b,c,d,e,f,g){"use strict";var h=window.RTCSessionDescription||window.mozRTCSessionDescription,i=2,j="o",k="m",l="a",m="rtpmap",n="ssrc-group",o="ssrc",p="cname",q="msid",r="mslabel",s="label",t="sendonly",u="recvonly",v="sendrecv",w="inactive",x="offer",y="answer",z="=",A=" ",B=":",C="\r\n",D="audio",E="video",F="application",G="http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",H="http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",I=function(a,b){return a.startsWith(b+z)},J=function(a){return a.substr(i)},K=function(a,b){return a.startsWith(b+C)||a.startsWith(b+B)},L=function(a,b){return a.substr(b.length+1)},M=function(){function a(a){var b=this;this.$1=[];this.$2="-";this.$3="multiway";this.$4=1;this.$5="IN";this.$6="IP4";this.$7="127.0.0.1";a.forEach(function(a){if(I(a,j)){var c=J(a).split(A);c.length==6&&(b.$2=c[0],b.$3=c[1],b.$4=parseInt(c[2],10),b.$5=c[3],b.$6=c[4],b.$7=c[5])}b.$1.push(a)})}var b=a.prototype;b.setVersion=function(a){this.$4=a};b.getVersion=function(){return this.$4};b.toSdp=function(){var a=this;return this.$1.map(function(b){if(I(b,j))return j+z+a.$2+A+a.$3+A+a.$4+A+a.$5+A+a.$6+A+a.$7;else return b}).join(C)};return a}(),N=function(){function a(a,b,c){var d=this;c===void 0&&(c={});this.$1=[];var e={},f=[],g=[];a.forEach(function(a){var b=J(a);I(a,k)&&(d.$4=b.split(A)[0]);if(I(a,l)&&K(b,m)){var c=L(b,m);c=c.split(A);var h=c[0];c=c[1];e[c]=h}I(a,l)&&K(b,o)?d.$6(b,f):I(a,l)&&K(b,n)?d.$7(b,g):I(a,l)&&(b===t||b===u||b===v||b===w)?d.$5=b:d.$1.push(a)});Object.keys(c).forEach(function(a){if(e[a]){var b=Object.keys(c[a]).map(function(b){return b+"="+c[a][b]}).join(";");d.$1.push("a=fmtp:"+e[a]+" "+b)}});this.$3={};this.$2={};f.forEach(function(a){if(Object.prototype.hasOwnProperty.call(a,p)){var b=a.cname;!d.$3[b]?d.$3[b]=[a]:d.$3[b].push(a);a=d.findSsrcGroupForSsrc(g,a.ssrc);a&&(!d.$2[b]?d.$2[b]=[a]:d.$2[b].push(a),d.removeSsrcGroup(a,g))}});this.$4!==F&&(b===x?f.length===0?this.$5=u:this.$5=v:b===y&&(this.$5=v))}var b=a.prototype;b.getMediaType=function(){return this.$4};b.getEndpointCount=function(){return Object.keys(this.$3).length};b.findSsrcGroupForSsrc=function(a,b){return a.find(function(a){a=a.ssrcs;return a.some(function(a){return a===b})})};b.addStreamsForEndpoint=function(a,b){this.$3[a]=b};b.addSsrcGroupsForEndpoint=function(a,b){var c=this;this.$3[a].forEach(function(d){d=d.ssrc;d=c.findSsrcGroupForSsrc(b,d);d&&(!c.$2[a]?c.$2[a]=[d]:c.$2[a].push(d),c.removeSsrcGroup(d,b))})};b.removeSsrcGroup=function(a,b){a=b.indexOf(a);a!==-1&&b.splice(a,1)};b.$7=function(a,b){a=L(a,n);if(a){a=a.split(A);var c=a[0];a=a.slice(1);b.push({semantics:c,ssrcs:a.map(function(a){return parseInt(a,10)})})}};b.$6=function(a,b){var c=a.indexOf(A),d=a.substr(0,c),e=parseInt(L(d,o),10);d=a.substr(c+1);a=b.find(function(a){return a.ssrc===e});a||(a={},a.ssrc=e,b.push(a));if(K(d,p))a.cname=L(d,p);else if(K(d,q)){c=L(d,q).split(A);a.msid={id:c[0],appdata:c[1]}}else K(d,r)?a.mslabel=L(d,r):K(d,s)&&(a.label=L(d,s))};b.toSdp=function(){var a=[];this.$1.forEach(function(b){a.push(b)});for(var b in this.$2)this.$2[b].forEach(function(b){a.push(l+z+n+B+b.semantics+A+b.ssrcs.join(A))});a.push(l+z+this.$5);for(var c in this.$3)this.$3[c].forEach(function(b){b.cname&&a.push(l+z+o+B+b.ssrc+A+p+B+b.cname),b.msid&&a.push(l+z+o+B+b.ssrc+A+q+B+b.msid.id+(b.msid.appdata?A+b.msid.appdata:"")),b.mslabel&&a.push(l+z+o+B+b.ssrc+A+r+B+b.mslabel),b.label&&a.push(l+z+o+B+b.ssrc+A+s+B+b.label)});return a.join(C)};return a}();a=function(){function a(a,c,d){c===void 0&&(c={});d===void 0&&(d={});c=c;var e=c.type;e=e===void 0?"offer":e;c=c.sdp;c=c===void 0?"":c;this.$2=a;this.type=e;switch(a){case b("FBRTCConstants").SignalingProtocol.CUSTOM:this.$1=c;return;case b("FBRTCConstants").SignalingProtocol.MULTIWAY:this.$3(c,d);return;case b("FBRTCConstants").SignalingProtocol.P2P:this.$4(c,d);return}}var c=a.prototype;c.$3=function(a,c){if(this.type==="offer"){var d=b("ScotchRTCSignalingExperiments").shouldEnablePlayoutDelayRtpHeaderExtensionForMw()?[G]:null;b("ScotchRTCSignalingExperiments").shouldAllowContentTypeRtpHeaderExtensionForMw()&&(d=d==null?[H]:[H].concat(d));a=b("ScotchFBRTCSdpUtils").removeUnknownRtpHeaderExtensions(a,d);c.OFFER_SDP_TRANSFORM&&(a=c.OFFER_SDP_TRANSFORM.reduce(function(a,b){return b(a)},a))}if(this.type=="offer"||this.type=="answer"){d=b("ScotchRTCSignalingExperiments").shouldPreferOpusMultiway();d&&(a=b("ScotchFBRTCSdpUtils").preferCodec(a,"opus",!1));d=b("ScotchRTCSignalingExperiments").shouldPreferVp9Multiway();d?a=b("ScotchFBRTCSdpUtils").preferCodec(a,"VP9",!0):b("ScotchRTCSignalingExperiments").shouldPreferH264Multiway()&&(b("ScotchRTCSignalingExperiments").shouldPreferHWH264Multiway()?a=b("ScotchFBRTCSdpUtils").preferCodec(a,"H264",!0):a=b("ScotchFBRTCSdpUtils").promoteSpecificH264ProfileIfExists(a,{levelAsymmetryAllowed:!0,packetizationMode:!0,profileLevelId:"42e01f"}),b("gkx")("1720807")&&(a=b("ScotchFBRTCSdpUtils").addFmtp(a,"H264","sps-pps-idr-in-keyframe","1")))}c.DISABLE_OPUS_STEREO&&(a=b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","stereo","0"));b("ScotchRTCSignalingExperiments").isOpusPtimeMungeEnabled()&&(a=b("ScotchFBRTCSdpUtils").maybeAddPtimeForOpusOnly(a,b("ScotchRTCSignalingExperiments").getOpusPtimeMungeValue()));b("ScotchRTCSignalingExperiments").shouldMungeUseDtxForOpus()&&(a=b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","usedtx","1"));b("ScotchRTCSignalingExperiments").shouldEnableMWSAudioNack()&&(a=b("ScotchFBRTCSdpUtils").addAudioNack(a));d=a.trim().split(C);a=[];var e=0;while(e<d.length&&!I(d[e],k))a.push(d[e]),e++;this.sessionDescription=new M(a);this.mediaDescriptions=[];while(e<d.length){a=[];a.push(d[e]);e++;while(e<d.length&&!I(d[e],k))a.push(d[e]),e++;this.mediaDescriptions.push(new N(a,this.type,c.FORMAT_PARAMETERS))}};c.$4=function(a,c){var d=[function(a){return b("ScotchFBRTCSdpUtils").addIceOptionToSdp(a,"fb-force-5245")},function(a){return b("ScotchFBRTCSdpUtils").useDTLSOverCrypto(a)}];if(this.type=="offer"||this.type=="answer"){var e=b("ScotchRTCSignalingExperiments").shouldPreferOpus();e&&d.push(function(a){return b("ScotchFBRTCSdpUtils").preferCodec(a,"opus",!1)});e=b("ScotchRTCSignalingExperiments").shouldPreferVp9();e&&d.push(function(a){return b("ScotchFBRTCSdpUtils").preferCodec(a,"VP9",!0)})}if(this.type==="offer"){c.DISABLE_VIDEO&&d.push(function(a){return b("ScotchFBRTCSdpUtils").disableVideo(a)});e=b("ScotchRTCSignalingExperiments").shouldPreferIsac();e&&d.push(function(a){return b("ScotchFBRTCSdpUtils").preferIsac(a)});d.push(function(a){return b("ScotchFBRTCSdpUtils").replaceRTPSAVPFProfile(a)},function(a){return b("ScotchFBRTCSdpUtils").addSetup(a)},function(a){return b("ScotchFBRTCSdpUtils").removeUnknownRtpHeaderExtensions(a)});b("FBRTCConfig").isVCEndpointCall()||d.push(function(a){return b("ScotchFBRTCSdpUtils").removeSdparta(a)});if(c.FORMAT_PARAMETERS){var f=Object.entries(c.FORMAT_PARAMETERS);e=function(){var a=f[h],c=a[0];a=a[1];var e=Object.entries(a);a=function(){var a=e[i],f=a[0],h=a[1];typeof h==="string"||g(0,4169);d.push(function(a){return b("ScotchFBRTCSdpUtils").addFmtp(a,c,f,h)})};for(var i=0;i<e.length;i++)a()};for(var h=0;h<f.length;h++)e()}d.push(function(a){return b("ScotchFBRTCSdpUtils").clearFirefoxInactiveDataChannelBlock(a)})}c.ADD_FB_FEATURES!=null&&d.push(function(a){Array.isArray(c.ADD_FB_FEATURES)||g(0,4170);return b("ScotchFBRTCSdpUtils").addFBFeatures.apply(b("ScotchFBRTCSdpUtils"),[a].concat(c.ADD_FB_FEATURES))});c.ADD_AUDIO_NACK&&d.push(function(a){return b("ScotchFBRTCSdpUtils").addAudioNack(a)});c.DISABLE_OPUS_STEREO&&d.push(function(a){return b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","stereo","0")});var i=c.SSRC_CONTENT_TYPE;i&&d.push(function(a){return b("ScotchFBRTCSdpUtils").addSSRCContentType(a,i)});this.$1=d.reduce(function(a,b){return b(a)},a)};c.processServerMediaUpdate=function(a,c){var d=a.sourceKey,e=a.media,f=a.ssrcGroups,g=[],h=[],i="",j="";e.forEach(function(a){a.ssrcs.forEach(function(c){if(c===0)return;var e={ssrc:c,cname:d,msid:{id:d,appdata:a.id},label:a.id,mslabel:d};b("FBRTCMediaType").AUDIO===a.type?(g.push(e),i+=JSON.stringify({ssrc:c,label:e.label,enabled:a.enabled,owner:a.owner})+";"):b("FBRTCMediaType").VIDEO===a.type&&(h.push(e),j+=JSON.stringify({ssrc:c,label:e.label,enabled:a.enabled,owner:a.owner})+";")})});b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"SessionDescription_processServerMediaUpdate.key="+d+"audio="+i+"video="+j+"ssrgroupsCount="+f.length,callID:c==null?void 0:c.callID,conferenceName:c==null?void 0:c.conferenceName});this.mediaDescriptions.forEach(function(a){a.getMediaType()===D?(a.addStreamsForEndpoint(d,g),a.addSsrcGroupsForEndpoint(d,f)):a.getMediaType()===E&&(a.addStreamsForEndpoint(d,h),a.addSsrcGroupsForEndpoint(d,f))})};c.toDesc=function(){return new h({type:this.type,sdp:this.toSdp()})};c.$5=function(){var a=[this.sessionDescription.toSdp(),this.mediaDescriptions.map(function(a){return a.toSdp()}).join(C),""].join(C);if(this.type==="answer"){var c=Math.max.apply(null,this.mediaDescriptions.map(function(a){return a.getEndpointCount()}));c>b("ScotchRTCSignalingExperiments").mungeMinParticipantsForEnablingDtx()&&(a=b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","usedtx","1"))}return a};c.toSdp=function(){var a=this.$2;switch(a){case b("FBRTCConstants").SignalingProtocol.MULTIWAY:return this.$5();case b("FBRTCConstants").SignalingProtocol.CUSTOM:case b("FBRTCConstants").SignalingProtocol.P2P:default:return this.$1}};c.strongDiff=function(a){var b=this.toSdp();a=a.toSdp();return b!==a&&this.$6(b)!==this.$6(a)};c.$6=function(a){return this.$7(a).split("\r\n").filter(function(a){return!/^a=(candidate|setup):/.test(a)}).join("\r\n")};c.$7=function(a){return a.replace(/(o=\S+\s\S+)\s\S+\s/,"$1 - ")};return a}();e.exports=a},null);
__d("ScotchRTCMWSessionDescription",["regeneratorRuntime","Promise","FBLogger","FBRTCConsoleLogger","FBRTCConstants","FBRTCMediaType","ScotchFBRTCTransactions","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCSessionDescription","ScotchRTWebUserActionLogger","ZenonMWMessageTypes","gkx"],function(a,b,c,d,e,f){"use strict";f.serverMediaUpdate=a;f.maybeUpdatePausedDownlink=c;d={};f._videoEnabled=d;function a(a,c,d,e){var f=this,g,h,i,j,k,l,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:g=a.fromVersion,h=a.toVersion,i=a.mediaUpdates,j=a.offer;k=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);l=e==null?void 0:e.id;if(k){s.next=7;break}b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate no connection: "+JSON.stringify({transactionId:l}),callID:d==null?void 0:d.callID,conferenceName:d==null?void 0:d.conferenceName,callType:"mw"});c(h,!1,null,!0);return s.abrupt("return");case 7:m=k.getLocalDescription();n=k.getRemoteDescriptionForSMU();o=n.sessionDescription.getVersion();p=j!=null;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate: "+JSON.stringify({fromVersion:g,toVersion:h,currentVersion:o,transactionId:l,hasOffer:p}),callID:d==null?void 0:d.callID,conferenceName:d==null?void 0:d.conferenceName,callType:"mw"});if(!(o!==g)){s.next=16;break}b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate version mismatch: "+JSON.stringify({transactionId:l}),callID:d==null?void 0:d.callID,conferenceName:d==null?void 0:d.conferenceName,callType:"mw"});c(o,!1,null,!1);return s.abrupt("return");case 16:i.forEach(function(a){f.maybeUpdatePausedDownlink(a,d),n.processServerMediaUpdate(a,d)});n.sessionDescription.setVersion(h);q=null;s.prev=19;if(!(b("gkx")("1484828")&&j)){s.next=30;break}s.next=23;return b("regeneratorRuntime").awrap(k.setRemoteDescription(new(b("ScotchRTCSessionDescription"))(b("FBRTCConstants").SignalingProtocol.MULTIWAY,{type:"offer",sdp:j.sdpString})));case 23:s.next=25;return b("regeneratorRuntime").awrap(k.createAnswer());case 25:q=s.sent;s.next=28;return b("regeneratorRuntime").awrap(k.setLocalDescription(q));case 28:s.next=39;break;case 30:if(!(b("gkx")("1679118")&&m.type==="answer")){s.next=37;break}s.next=33;return b("regeneratorRuntime").awrap(k.setRemoteDescription(n));case 33:s.next=35;return b("regeneratorRuntime").awrap(k.setLocalDescription(m));case 35:s.next=39;break;case 37:s.next=39;return b("regeneratorRuntime").awrap(b("Promise").all([k.setLocalDescription(m),k.setRemoteDescription(n)]));case 39:b("ScotchRTCGroupCallActions").toggleRemoteStream((r=[]).concat.apply(r,i.map(function(a){a=a.media;return a})).reduce(function(a,b){var c=b.id;b=b.enabled;c=k.getWebrtcTrackIdFromMWTrackId(c);a[c]=b;return a},{}));c(h,!0,q,!1);s.next=48;break;case 43:s.prev=43,s.t0=s["catch"](19),b("FBLogger")("rtc_www").catching(s.t0).warn("Failed to apply SMU"),c(o,!1,null,!1);case 48:case"end":return s.stop()}},null,this,[[19,43]])}function c(a,c){var d=b("ScotchRTCCallStore").getState(),e=d.remoteUsers;d=a.media;d.forEach(function(a){if(a.type===b("FBRTCMediaType").VIDEO){var d=e.find(function(b){return b.streams.find(function(b){return b.id.split(":")[0]==a.owner})}),f=a.pausedDownlink===b("ZenonMWMessageTypes").ZenonMWMediaPauseStatus.Paused;d!=null&&d.pausedDownlink!==f&&(b("ScotchRTCCallActions").updateRemoteUsers(e.map(function(a){return a===d?a.setPausedDownlink(f):a})),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"pausedDownlink changed to "+f.toString()+" for user: "+d.FBID,callID:c==null?void 0:c.callID,conferenceName:c==null?void 0:c.conferenceName,callType:"mw"}))}})}},null);
__d("ScotchgenerateRTCCallID",["randomInt"],function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return b("randomInt")(0,4294967294)+1}},null);
__d("ZenonPlatformExperiments",["ScotchRTWebUserActionLogger","gkx","qex"],function(a,b,c,d,e,f){"use strict";f.getOpusPtimeMungeValue=a;f.isMwpp=c;f.isOpusMungeEnabled=d;f.shouldUseLobbyMode=e;f.shouldUseStateSync=g;f.shouldEnableMWSAudioNack=h;function a(){var a;return(a=b("qex")._("1426590"))!=null?a:60}function c(){var a;return(a=b("qex")._("1566745"))!=null?a:!1}function d(){var a;return(a=b("qex")._("1426589"))!=null?a:!0}function e(){var a;a=(a=b("gkx")("1450329"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"gk: rtc_www_lobby_mode"});return a}function g(){var a=b("gkx")("1418215");a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"gk: rtc_www_state_sync"});return a}function h(){var a;return(a=b("qex")._("1713531"))!=null?a:!1}},null);
__d("ScotchRTCMultiwayMessageHandler",["Promise","CurrentUser","FBMqttChannel","FBRTCConstants","FBRTCDeviceStatus","FBRTCHangupReason","FBRTCLogger","FBRTCRtcResponseStatusCode","Run","ScotchFBRTCMultiwayMessage","ScotchFBRTCTransactions","ScotchgenerateRTCCallID","ScotchMultiwayParticipantFetcher","ScotchMWDeviceCapabilities","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCMWProtocolHandler","ScotchRTCMWSessionDescription","ScotchRTCMWThreadDeltaHandler","ScotchRTCProxyUserStore","ScotchRTCProxyUserUtils","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","ZenonPlatformExperiments","gkx","immutable","promiseDone","recoverableViolation","requireCond","cr:1420073"],function(a,b,c,d,e,f){"use strict";var g=15e3;a=function(){function a(){this.$3=-1,this.$6=[],this.$7=!1,this.$8=new(b("ScotchFBRTCTransactions").FBRTCTransactionOwner)(),this.$9(),b("Run").onUnload(function(){b("FBMqttChannel").unsubscribeAll("/rtc_multi")}),b("FBMqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"onMQTTStateChanged: "+a+", document.visibilityState: "+document.visibilityState+", document.hasFocus: "+String(document.hasFocus())})}})}var c=a.prototype;c.initialize=function(a,b,c,d){this.$1=a,this.$2=b,this.$4=c,this.$5=d};c.setShouldDeferServerRequests=function(a){this.$7=a;if(this.$7===!1)while(this.$6.length>0)this.$10(this.$6.shift())};c.waitForSignalingConnected=function(){var a=this;return new(b("Promise"))(function(c,d){if(b("FBMqttChannel").getConnectionState()==="Connected")c();else{b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"MQTT not connected, deferring JOIN request",conferenceName:a.$1});b("ScotchRTWebUserActionLogger").startTimer("MQTT not connected");var e={onMQTTStateChanged:function(a){a==="Connected"&&(b("ScotchRTWebUserActionLogger").logStopTimer({checkpointName:"MQTT connected after deferring JOIN request",timerName:"MQTT not connected"}),b("FBMqttChannel").unsubscribeChannelEvents(e),window.clearTimeout(f),c())}},f=window.setTimeout(function(){b("FBMqttChannel").unsubscribeChannelEvents(e),b("ScotchRTWebUserActionLogger").logStopTimer({checkpointName:"MQTT never connected. Current status: "+b("FBMqttChannel").getConnectionState(),timerName:"MQTT not connected"}),d("timeout")},g);b("FBMqttChannel").subscribeChannelEvents(e)}})};c.$9=function(){var a=this;b("FBMqttChannel").subscribe("/rtc_multi",function(b){b=JSON.parse(b);a.$11(b)})};c.$11=function(a){var c=this,d=new(b("ScotchFBRTCMultiwayMessage"))(a);a=b("ScotchRTCCallStore").getState().callID;var e=b("ScotchRTCCallStore").getState().callInfo.conferenceState;b("FBRTCLogger").getInstance().logMultiwayMessageReceived(d,a);if(!d.isRequest())return;if(this.$1===d.conferenceName())this.$7===!0?this.$6.push(d):this.$10(d);else if(d.ringRequest()&&!this.$4&&e!=="TERMINATED"&&e!=="TERMINATING"){var f=this.$8.getTransaction(d);b("promiseDone")(f.start(),function(a){var e=b("ScotchgenerateRTCCallID")();b("promiseDone")(f.sendResponse(c.$12(a,e)),function(){return b("ScotchRTCMWProtocolHandler").otherUserInAnotherCall(d.conferenceName(),d.serverInfoData(),b("FBRTCHangupReason").IN_ANOTHER_CALL,e.toString(),"InAnotherCall")})})}};c.$12=function(a,c){var d=a.ringRequest(),e=a.serverInfoData();if(d==null||e==null)return a.createResponse(b("FBRTCRtcResponseStatusCode").BAD_REQUEST,{});d={deviceCapabilities:b("ScotchMWDeviceCapabilities").getDeviceCapabilities(),deviceStatus:b("FBRTCDeviceStatus").OK};return a.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{ringResponse:d},callID:c.toString()})};c.$13=function(a,c){b("promiseDone")(a.sendResponse(c.createResponse(b("FBRTCRtcResponseStatusCode").OK,{})))};c.$10=function(a){var c=this,d=this.$8.getTransaction(a);b("promiseDone")(d.start().then(function(e){if(e!=null){var f=b("ScotchRTCCallStore").getState(),g=f.callInfo;b("FBRTCLogger").getInstance().logServerRequestStartProcessing(a,g.callID);if(e.dismissRequest()!=null)e.serverInfoData()===g.serverInfoData&&(b("ScotchRTCGroupCallActions").handleDismissRequest(d,e),f.connections.forEach(function(a){return a.close()}),c.$5||b("ScotchRTCCallActions").removeAllLocalStreams(!0));else if(e.serverMediaUpdateRequest()!=null){f=e.serverMediaUpdateRequest();b("ScotchRTCProxyUserUtils").setProxyingAsUsersFromMessage(f);if(f.renegotiationRequested){if(!b("ZenonPlatformExperiments").shouldUseLobbyMode()){b("recoverableViolation")("[WR] SMU with renegotiation requested set to true but lobby mode disabled","rtc_www");b("FBRTCLogger").getInstance().logServerRequestFailedProcessing(a,g.callId,"SMU with renegotiation requested set to true but lobby mode disabled");return}b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[WR] Received SMU with renegotiation requested, sending CMU with offer",conferenceName:c.$1});var h=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(h==null){b("recoverableViolation")("Peer connection should not be null when receiving SMU","rtc_www");b("FBRTCLogger").getInstance().logServerRequestFailedProcessing(a,g.callId,"Peer connection should not be null when receiving SMU");return}var i=h.getLocalDescription(),j=i.sessionDescription.getVersion(),k=j+1;i.sessionDescription.setVersion(k);h.setLocalDescription(i);var l={},m=[];h=h.getLocalStreams();h.forEach(function(a){m=m.concat(a.getTracks())});m.forEach(function(a){l[a.id]=a.enabled});b("ScotchRTCMWProtocolHandler").clientMediaUpdate(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,j,k,[{mediaStatus:l}],i)}b("ScotchRTCMWSessionDescription").serverMediaUpdate(e.serverMediaUpdateRequest(),function(c,f,h,i){i?b("FBRTCLogger").getInstance().logServerRequestFailedProcessing(a,g.callId,"Peer connection should not be null when receiving SMU"):b("ScotchRTCGroupCallActions").onServerMediaUpdateSuccess();i=f?b("FBRTCRtcResponseStatusCode").OK:b("FBRTCRtcResponseStatusCode").CONDITIONAL_REQUEST_FAILED;f=d.id;var j=h!=null;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate response: "+JSON.stringify({statusCode:i,currentVersion:c,transactionId:f,hasAnswer:j}),callID:g.callID,conferenceName:g.conferenceName,callType:"mw"});b("FBRTCLogger").getInstance().logServerRequestDoneProcessing(a,g.callId);f={currentVersion:c};h!=null&&(f.answer={sdpString:h==null?void 0:h.toSdp()});d.sendResponse(e.createResponse(i,{body:{serverMediaUpdateResponse:f},callID:g.callID}));b("ScotchRTCMWProtocolHandler").resubscribeToRemoteFbids()},g,d);if(b("cr:1420073")!=null&&f.stateStore!=null&&Object.keys(f.stateStore).length>0){h=Object.keys(f.stateStore);for(var j=0;j<h.length;j++){k=h[j];b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] SMU request with ss payload for topic: "+k+" was received",conferenceName:c.$1});i=f.stateStore[k];b("cr:1420073").setOutputState(k,i)}}}else if(e.notifyRequest()!=null){if(b("cr:1420073")==null)return;k=e.notifyRequest();i=k.topic;h=k.version;j=k.data;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] Notify request for topic: "+i+" was received",conferenceName:c.$1});if(b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&i.localeCompare("simple_external")==0){b("FBRTCLogger").getInstance().logCallAction(null,c.$1,"STATE_SYNC_OUTPUT_NOTIFY_REQUEST","received output state: "+((f=j)!=null?f:"")+" on join response for topic simple_external",null)}b("cr:1420073").setOutputState(i,{version:h,data:j});d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{notifyResponse:{topic:i,version:h}},callID:g.callID}))}else if(e.conferenceStateRequest()!=null){k=e.conferenceStateRequest();b("gkx")("1509739")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_CSU received version "+String(k.version),callID:g==null?void 0:g.callID,conferenceName:g==null?void 0:g.conferenceName,callType:"mw"});f=b("ScotchRTCCallStore").getState();j=f.remoteUsers;var n=j.map(function(a){return a.FBID});i=Object.keys(k.participantStates);h=i.filter(function(a){return a!==b("CurrentUser").getID()&&!n.has(a)});b("ScotchRTCMWThreadDeltaHandler").processThreadUpdateFromSignaling(k);if(h.length>0){f=b("ScotchRTCProxyUserUtils").setProxyingAsUsersFromMessage(k);var o=new Set(h);f!=null&&f.forEach(function(a,b){o["delete"](b),a!==null&&!o.has(a)&&o.add(a)});j=b("ScotchRTCProxyUserStore").getState();i=j.proxyingAsToProxyUser;b("promiseDone")(b("ScotchMultiwayParticipantFetcher").fetchAllParticipants(c.$1,b("immutable").Set(o),{profileImageSize:100,proxyingAsToProxyUser:i}),function(a){b("ScotchRTCGroupCallActions").onParticipantsAdded(a.toJS()),b("ScotchRTCGroupCallActions").handleConferenceStateRequest(d,e,c.$3,function(a){c.$3=a})},function(c){b("FBRTCLogger").getInstance().logServerRequestFailedProcessing(a,g.callId,c),b("gkx")("1509739")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_CSU fetchAllParticipants failed "+c,callID:g==null?void 0:g.callID,conferenceName:g==null?void 0:g.conferenceName,callType:"mw"})})}else b("ScotchRTCGroupCallActions").handleConferenceStateRequest(d,e,c.$3,function(a){c.$3=a})}else if(e.startScreenSharingRequest()!=null){k=e.startScreenSharingRequest();b("ScotchRTCGroupCallActions").addRemoteScreenSharingUserID(k);c.$13(d,e)}else if(e.endScreenSharingRequest()!=null){h=e.endScreenSharingRequest();b("ScotchRTCGroupCallActions").removeRemoteScreenSharingUserID(h);c.$13(d,e)}}}))};return a}();e.exports=a},null);
__d("ScotchRTCP2PCallWindowHandler",["ScotchRTCCallStore","ScotchRTCP2PCallStore","ScotchRTWebUserActionLogger","setTimeout"],function(a,b,c,d,e,f){"use strict";f.init=a;f.updateCallInProgressIndicator=c;f.reload=d;f.close=e;f._monitorOpenerForChanges=h;f._passWindowToOpener=i;f._isWindowOpened=j;var g;function a(a){this._isWindowOpened()&&this.close(),g=a,this.updateCallInProgressIndicator(),this._monitorOpenerForChanges()}function c(a){if(!this._isWindowOpened())return;var c=b("ScotchRTCCallStore").getState();c=c.remoteUsers;a=a?a:b("ScotchRTCP2PCallStore").getState().connectionStatus;!c.count()||a==="DISCONNECTED"?g.rtcCallInProgessWith=null:g.rtcCallInProgessWith=c.first().FBID.toString()}function d(){this._isWindowOpened()&&g.location.reload()}function e(){this._isWindowOpened()&&g.close()}function h(){var a=this;if(g.opener)try{g.opener.addEventListener("unload",function(b){a._passWindowToOpener()})}catch(a){}}function i(a){var c=this;a===void 0&&(a=10);b("setTimeout")(function(){if(!c._isWindowOpened()||a<=1)return;try{if(g.opener&&!g.opener.closed){g.opener.rtcCallChildWindow=g;return}}catch(a){b("ScotchRTWebUserActionLogger").logErrorOnceforDomain("RTCP2PCallWindowHandler__passWindowToOpener",a)}c._passWindowToOpener(a-1)},1e3)}function j(){return!!(g&&!g.closed)}},null);
__d("XScreenSharingController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/screen_sharing/",{peer_id:{type:"FBID",required:!0},version:{type:"Int"}})},null);
__d("ScotchRTCScreenSharingWindowHandler",["ScotchRTCP2PCallActions","ScotchRTCUtils","SecurePostMessage","XScreenSharingController","promiseDone"],function(a,b,c,d,e,f){f.open=a;f._setupScreenSharingWindow=c;f._adjustScreenSize=d;f.close=e;f.isWindowOpened=j;f._onUnload=k;f._getWindowFeatures=l;f._getConstrainedSize=m;f._getUnsignedUri=n;var g=540,h=960,i;function a(a,c,d){var e=this;i=window.open("about:blank","Screen Sharing",this._getWindowFeatures());window.callInfo=d;b("promiseDone")(b("ScotchRTCUtils").getStreamVideoResolution(c)["catch"](function(b){e._setupScreenSharingWindow(a,c,null)}),function(b){e._setupScreenSharingWindow(a,c,b)})}function c(a,b,c){var d=this;window.getRemoteMediaStream=function(){return b};window.closeScreenSharingWindow=this._onUnload;if(c){c=this._getConstrainedSize(c.width,c.height);var e=c.width,f=c.height;i.resizeTo(e,f);window.setTimeout(function(){d._adjustScreenSize({width:e,height:f})},200)}i.location=this._getUnsignedUri(a);window.focus&&this.isWindowOpened()&&i.focus()}function d(a){if(!i)return;i.resizeTo(a.width,a.height+(a.height-i.innerHeight))}function e(){if(i){var a=null;i.opener&&!i.opener.closed&&(a=i.opener);i.close();i=null;a&&b("SecurePostMessage").sendMessageAllowAnyOrigin_UNSAFE(a,{recipient:"SC_CONTENT_SCRIPT",type:"SC_RESET_PORT",text:"reset comm port"})}}function j(){return!!(i&&!i.closed)}function k(){b("ScotchRTCP2PCallActions").togglePopOutScreenContent()}function l(){var a=screen.availLeft,b=screen.availTop,c=this._getConstrainedSize(Math.min(h,screen.width-a),Math.min(g,screen.height-b)),d=c.width;c=c.height;c={height:"height="+c.toString(),width:"width="+d.toString(),top:"top="+b.toString(),left:"left="+a.toString()};return["menubar=no","location=no","scrollbars=no","status=no","personalbar=no",c.height,c.width,c.top,c.left].join(",")}function m(a,b){var c;a>h&&(c=h/a,b*=c,a*=c);b>g&&(c=g/b,a*=c,b*=c);return{width:a,height:b}}function n(a){return b("XScreenSharingController").getURIBuilder().setFBID("peer_id",a).setInt("version",2).getURI()}},null);
__d("ScotchRTCP2PCallActions",["ScotchRTCAppDispatcher","ScotchRTCP2PCallWindowHandler"],function(a,b,c,d,e,f){"use strict";f.reload=a;f.setCallType=c;f.setConnectionStatus=d;f.setMultiwayEscalationSupport=e;f.setRemoteSignalingExperiments=g;f.togglePopOutScreenContent=h;f.processMessage=i;f.setIsCaller=j;f.togglePoorNetworkQualityIndicator=k;f.starRatingDone=l;function a(){b("ScotchRTCP2PCallWindowHandler").reload()}function c(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CALL_TYPE",callType:a})}function d(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CONNECTION_STATUS",connectionStatus:a})}function e(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"SET_MULTIWAY_ESCALATION_SUPPORT",offerEscalationSupport:a,escalationConferenceName:c})}function g(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_REMOTE_SIGNALING_EXPERIMENTS",remoteSignalingExperiments:a})}function h(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"POP_OUT_SCREEN_CONTENT":"POP_IN_SCREEN_CONTENT",stream:a})}function i(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_PROCESS_MESSAGE",message:a})}function j(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_SET_IS_CALLER",isCaller:a})}function k(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"SHOW_POOR_NETWORK_QUALITY":"DISMISS_POOR_NETWORK_QUALITY"})}function l(a){a===void 0&&(a=!0),b("ScotchRTCAppDispatcher").dispatch({type:"P2P_STAR_RATING_DONE",done:a})}},null);
__d("ScotchFBRTCClientMediaUpdateReducer",["FBRTCConstants","FBRTCRtcResponseStatusCode","ScotchFBRTCMWProtocolStore","ScotchRTCCallStore","ScotchRTCMWProtocolHandler","ScotchRTWebUserActionLogger","flatMapArray","gkx"],function(a,b,c,d,e,f){"use strict";f.reset=a;f.configureAudio=c;f.configureScreenSharing=d;f.configureVideo=e;f.onClientMediaUpdateResponse=g;f.setLocalClientVersion=h;f.onLocalTrackReplaced=i;function a(a,c){switch(c.type){case"RESET":return b("ScotchFBRTCMWProtocolStore").getInitialState()}return a}function c(a,b){switch(b.type){case"AUDIO_MUTED":return j(a,"audio",!1);case"AUDIO_UNMUTED":return j(a,"audio",!0)}return a}function d(a,c){switch(c.type){case"ADD_LOCAL_SCREEN_STREAM":return j(a,"video",!0);case"REMOVE_LOCAL_SCREEN_STREAM":return j(a,"video",!b("ScotchRTCCallStore").getState().localUser.isVideoDisabled())}return a}function e(a,c){var d=b("ScotchRTCCallStore").getState();d=d.localUser;if(d&&d.hasScreenStream())return a;switch(c.type){case"VIDEO_MUTED":return j(a,"video",!1);case"VIDEO_UNMUTED":return j(a,"video",!0)}return a}function g(a,c){switch(c.type){case"ON_CLIENT_MEDIA_UPDATE_RESPONSE":c.responseStatusCode===b("FBRTCRtcResponseStatusCode").OK&&(a=a.setIn(["clientMediaUpdateInfo","lastSyncedClientVersion"],c.currentVersion));if((b("gkx")("1704593")||c.responseStatusCode===b("FBRTCRtcResponseStatusCode").OK)&&a.clientMediaUpdateInfo.pendingResponse){a=a.setIn(["clientMediaUpdateInfo","pendingResponse"],!1);if(a.clientMediaUpdateInfo.pendingUpdate)return k(a.setIn(["clientMediaUpdateInfo","pendingUpdate"],!1))}return a}return a}function h(a,b){switch(b.type){case"SET_LOCAL_CLIENT_VERSION":return a.setIn(["clientMediaUpdateInfo","lastSyncedClientVersion"],b.version).setIn(["clientMediaUpdateInfo","localMediaUpdates"],a.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:{}}))}return a}function i(a,b){switch(b.type){case"ON_LOCAL_TRACK_REPLACED":var c=b.newTrack;b=b.oldTrack;if(b==null)return a;var d=a.clientMediaUpdateInfo.localToMWSTrackIDMap.get(b.id);d!=null?a=a.setIn(["clientMediaUpdateInfo","localToMWSTrackIDMap"],a.clientMediaUpdateInfo.localToMWSTrackIDMap["delete"](b.id)):d=b.id;return a.setIn(["clientMediaUpdateInfo","localToMWSTrackIDMap"],a.clientMediaUpdateInfo.localToMWSTrackIDMap.set(c.id,d))}return a}function j(a,c,d){var e=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(!e)return a;var f={};e=b("ScotchRTCCallStore").getState();e=e.localUser;var g=a.clientMediaUpdateInfo.localToMWSTrackIDMap;b("flatMapArray")([e.getScreenStream(),e.getStream()],function(a){return a!=null?a.getTracks():[]}).forEach(function(a){var b=g.get(a.id)||a.id;f[b]==null&&(f[b]=a.kind===c?d:a.enabled)});return k(a.setIn(["clientMediaUpdateInfo","localMediaUpdates"],a.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:f})))}function k(a){if(a.clientMediaUpdateInfo.pendingResponse){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCClientMediaUpdateReducer.sendClientMediaUpdate: not sending CMU because there is one pending."});return a.setIn(["clientMediaUpdateInfo","pendingUpdate"],!0)}var c=a.clientMediaUpdateInfo.localMediaUpdates.reduce(function(b,c,d){d>=a.clientMediaUpdateInfo.lastSyncedClientVersion&&b.push(c);return b},[]);if(c.length===0)return a;b("ScotchRTCMWProtocolHandler").clientMediaUpdate(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,a.clientMediaUpdateInfo.lastSyncedClientVersion,a.clientMediaUpdateInfo.localMediaUpdates.size,c);return a.setIn(["clientMediaUpdateInfo","pendingResponse"],!0)}},null);
__d("ScotchFBRTCGroupCallParticipantsReducer",["MercuryIDs","ScotchRTCCallStore","ScotchRTCMWProtocolHandler","immutable"],function(a,b,c,d,e,f){"use strict";f.initThread=a;f.onParticipantsChanged=c;f.addParticipantsToRing=d;var g=new Set();f._participantsToRing=g;function a(a,b){var c;switch(b.type){case"INIT_THREAD":return a.merge({participants:(c=b.participants)!=null?c:a.participants,thread:b.thread})}return a}function c(a,c){switch(c.type){case"ON_PARTICIPANT_LEFT":return a.set("participants",a.participants["delete"](b("MercuryIDs").getParticipantIDFromUserID(c.participantFBID)));case"ON_PARTICIPANTS_ADDED":var d=Object.keys(c.participants).map(function(a){return c.participants[a].fbid}).filter(function(a){return g.has(a)});d.length!==0&&(d.forEach(function(a){return g["delete"](a)}),b("ScotchRTCMWProtocolHandler").addParticipants(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,d));return a.set("participants",a.participants.merge(b("immutable").Map(c.participants)))}return a}function d(a,b){switch(b.type){case"ADD_PARTICIPANTS_TO_RING":b.participantFBIDs.forEach(function(a){return g.add(a)});return a}return a}},null);
__d("ScotchRTCStreamDurationTracker",["performanceNow"],function(a,b,c,d,e,f){"use strict";var g;a=function(){function a(a){var c=this;a===void 0&&(a="mixed");this.$3=0;this.$4=0;this.$5=!1;this.update=function(){if(!c.$5)return;c.$6()?c.$4===0&&(c.$4=(g||(g=b("performanceNow")))()):c.pause(c.$2)};this.$1=a}var c=a.prototype;c.isStarted=function(){return this.$5};c.track=function(a){if(a===this.$2){this.update();return}if(this.$2&&this.$5){var b=this.$2;b.removeEventListener("addtrack",this.update);b.removeEventListener("removetrack",this.update)}a?(this.$5&&this.$6()&&(this.$3=this.getDuration()),this.$2=a,this.$5&&this.start()):this.stop()};c.$6=function(){return!this.$2?!1:this.$7().some(function(a){return a.enabled&&a.readyState!=="ended"})};c.$7=function(){if(!this.$2)return[];switch(this.$1){case"audio":return this.$2.getAudioTracks();case"video":return this.$2.getVideoTracks();case"screen":return this.$2.getVideoTracks();default:return this.$2.getTracks()}};c.pause=function(a){if(!this.$5)return;if(this.$2!==a)return;this.$3=this.getDuration();this.$4=0};c.getDuration=function(){return this.$4===0?this.$3:this.$3+(g||(g=b("performanceNow")))()-this.$4};c.start=function(){this.$5=!0;this.$6()&&(this.$4=(g||(g=b("performanceNow")))());if(this.$2){var a=this.$2;a.addEventListener("addtrack",this.update);a.addEventListener("removetrack",this.update)}};c.stop=function(){if(!this.$5)return;this.$3=this.getDuration();this.$5=!1;this.$4=0;if(this.$2){var a=this.$2;a.removeEventListener("addtrack",this.update);a.removeEventListener("removetrack",this.update)}};return a}();e.exports=a},null);
__d("ScotchFBRTCGroupCallStoreState",["ScotchRTCStreamDurationTracker","immutable"],function(a,b,c,d,e,f){"use strict";a={localVideoDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("video"),remoteVideoDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("video"),localScreenDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("screen")};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));d={dominantSpeakerFBID:null,endCallReason:null,responseSubCode:null,layout:null,participants:b("immutable").Map(),pinnedSpeakerFBID:null,thread:null,videoDurationTrackerInfo:new c(),forceEncodingEnabled:!1,videoEscalateState:"initial"};f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(d));e.exports=f},null);
__d("ScotchFBRTCGroupCallReducer",["FBRTCConstants","FBRTCParticipantCallState","ScotchFBRTCGroupCallStoreState","ScotchRTCCallStore","ScotchRTCEndCallReason","ScotchRTCMWProtocolHandler"],function(a,b,c,d,e,f){"use strict";f.setDominantSpeaker=a;f.setLayout=c;f.processEndCallReason=d;f.onForceEncodingChanged=e;f.onVideoEscalationStarted=g;f.onVideoEscalationCompleted=h;f.onReset=i;function a(a,c){switch(c.type){case"SET_DOMINANT_SPEAKER":return a.set("dominantSpeakerFBID",c.dominantSpeakerFBID);case"SET_PINNED_SPEAKER":var d=b("ScotchRTCCallStore").getState();d=d.callInfo;var e=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(!e)return a;b("ScotchRTCMWProtocolHandler").subscription(d.conferenceName,d.serverInfoData,e.getRemoteStreams(),a.layout,c.pinnedSpeakerFBID);return a.set("pinnedSpeakerFBID",c.pinnedSpeakerFBID);case"ON_CONFERENCE_STATE":d=c.request.conferenceStateRequest();e=d.participantStates;c=e[a.pinnedSpeakerFBID];return c&&c.state!==b("FBRTCParticipantCallState").CONNECTED?a.set("pinnedSpeakerFBID",null):a}return a}function c(a,c){switch(c.type){case"SET_LAYOUT":var d=b("ScotchRTCCallStore").getState();d=d.callInfo;var e=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);e&&b("ScotchRTCMWProtocolHandler").subscription(d.conferenceName,d.serverInfoData,e.getRemoteStreams(),c.layout,a.pinnedSpeakerFBID);return a.set("layout",c.layout)}return a}function d(a,c){switch(c.type){case"CALL_ERROR":case"HANGUP":case"END_CALL":case"DISMISS":return a.set("endCallReason",c.endCallReason!=null?new(b("ScotchRTCEndCallReason"))(c.endCallReason):a.endCallReason)}return a}function e(a,c){switch(c.type){case"FORCE_ENCODING_ENABLED":var d=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);d&&b("ScotchRTCMWProtocolHandler").updateLocalEncodingActive(d,c.enabled);return a.set("forceEncodingEnabled",c.enabled)}return a}function g(a,b){switch(b.type){case"MW_VIDEO_ESCALATION_STARTED":return a.set("videoEscalateState","inProgress")}return a}function h(a,b){switch(b.type){case"MW_VIDEO_ESCALATION_COMPLETED":return a.set("videoEscalateState","escalated")}return a}function i(a,c){switch(c.type){case"RESET":case"RESET_FOR_REDIAL":return new(b("ScotchFBRTCGroupCallStoreState"))();case"MW_VIDEO_ESCALATION_RESET":return a.set("videoEscalateState","initial")}return a}},null);
__d("RTCCallActionTypes",[],function(a,b,c,d,e,f){a=Object.freeze({CALL:"CALL",CALL_SUCCESS:"CALL_SUCCESS",CALL_ERROR:"CALL_ERROR",INCOMING_CALL_SUCCESS:"INCOMING_CALL_SUCCESS",INIT:"INIT",RESET:"RESET",RESET_FOR_REDIAL:"RESET_FOR_REDIAL",CALL_COLLISION:"CALL_COLLISION",WAIT_FOR_USER_INPUT:"WAIT_FOR_USER_INPUT",SET_CALL_SUMMARY:"SET_CALL_SUMMARY",SET_MW_CALL_TYPE:"SET_MW_CALL_TYPE",SET_LAYOUT:"SET_LAYOUT",SET_LINKHASH:"SET_LINKHASH",SET_DOMINANT_SPEAKER:"SET_DOMINANT_SPEAKER",SET_PINNED_SPEAKER:"SET_PINNED_SPEAKER",SET_USE_DOMINANT_SPEAKE_VIEW:"SET_USE_DOMINANT_SPEAKE_VIEW",SET_GRID_VIEW:"SET_GRID_VIEW",SET_STRIP_VIEW:"SET_STRIP_VIEW",INIT_THREAD:"INIT_THREAD",ON_PARTICIPANT_LEFT:"ON_PARTICIPANT_LEFT",ON_PARTICIPANTS_ADDED:"ON_PARTICIPANTS_ADDED",ADD_PARTICIPANTS_TO_RING:"ADD_PARTICIPANTS_TO_RING",JOIN:"JOIN",JOIN_SUCCESS:"JOIN_SUCCESS",JOIN_ERROR:"JOIN_ERROR",HANGUP:"HANGUP",HANGUP_SUCCESS:"HANGUP_SUCCESS",HANGUP_ERROR:"HANGUP_ERROR",ON_CONFERENCE_STATE:"ON_CONFERENCE_STATE",DISMISS:"DISMISS",END_CALL:"END_CALL",ON_JOIN_REQUEST_SENT:"ON_JOIN_REQUEST_SENT",ON_JOIN_RESPONSE:"ON_JOIN_RESPONSE",ON_RECEIVED_JOIN_RESPONSE:"ON_RECEIVED_JOIN_RESPONSE",ON_PROCESSED_JOIN_RESPONSE:"ON_PROCESSED_JOIN_RESPONSE",ON_SERVER_MEDIA_UPDATE_SUCCESS:"ON_SERVER_MEDIA_UPDATE_SUCCESS",ON_CLIENT_MEDIA_UPDATE_RESPONSE:"ON_CLIENT_MEDIA_UPDATE_RESPONSE",SET_LOCAL_CLIENT_VERSION:"SET_LOCAL_CLIENT_VERSION",INIT_LOCAL_USER:"INIT_LOCAL_USER",INIT_REMOTE_USERS:"INIT_REMOTE_USERS",UPDATE_REMOTE_USERS:"UPDATE_REMOTE_USERS",ADD_REMOTE_STREAM:"ADD_REMOTE_STREAM",REMOVE_REMOTE_STREAM:"REMOVE_REMOTE_STREAM",REMOVE_ALL_REMOTE_STREAMS:"REMOVE_ALL_REMOTE_STREAMS",ADD_REMOTE_TRACK:"ADD_REMOTE_TRACK",REMOVE_REMOTE_TRACK:"REMOVE_REMOTE_TRACK",AUDIO_MUTED:"AUDIO_MUTED",AUDIO_UNMUTED:"AUDIO_UNMUTED",VIDEO_MUTED:"VIDEO_MUTED",VIDEO_UNMUTED:"VIDEO_UNMUTED",REMOTE_AUDIO_MUTED:"REMOTE_AUDIO_MUTED",REMOTE_AUDIO_UNMUTED:"REMOTE_AUDIO_UNMUTED",REMOTE_VIDEO_MUTED:"REMOTE_VIDEO_MUTED",REMOTE_VIDEO_UNMUTED:"REMOTE_VIDEO_UNMUTED",SELF_VIEW_COLLAPSED:"SELF_VIEW_COLLAPSED",SELF_VIEW_UNCOLLAPSED:"SELF_VIEW_UNCOLLAPSED",ADD_LOCAL_STREAM:"ADD_LOCAL_STREAM",REMOVE_LOCAL_STREAM:"REMOVE_LOCAL_STREAM",REPLACE_LOCAL_STREAM:"REPLACE_LOCAL_STREAM",REMOVE_ALL_LOCAL_STREAMS:"REMOVE_ALL_LOCAL_STREAMS",STOP_LOCAL_STREAM:"STOP_LOCAL_STREAM",ADD_LOCAL_SCREEN_STREAM:"ADD_LOCAL_SCREEN_STREAM",REMOVE_LOCAL_SCREEN_STREAM:"REMOVE_LOCAL_SCREEN_STREAM",REMOVE_ALL_LOCAL_SCREEN_STREAMS:"REMOVE_ALL_LOCAL_SCREEN_STREAMS",REPLACE_LOCAL_SCREEN_STREAM:"REPLACE_LOCAL_SCREEN_STREAM",ADD_REMOTE_SCREEN_STREAM:"ADD_REMOTE_SCREEN_STREAM",REMOVE_REMOTE_SCREEN_STREAM:"REMOVE_REMOTE_SCREEN_STREAM",TOGGLE_REMOTE_STREAM:"TOGGLE_REMOTE_STREAM",SUBMIT_RATING:"SUBMIT_RATING",SUBMIT_FEEDBACK:"SUBMIT_FEEDBACK",SUBMIT_FEEDBACK_OPTIONS:"SUBMIT_FEEDBACK_OPTIONS",SUBMIT_SURVEY_CHOICE:"SUBMIT_SURVEY_CHOICE",RATING_SHOWN:"RATING_SHOWN",FEEDBACK_SHOWN:"FEEDBACK_SHOWN",SET_CONFERENCE_STATE:"SET_CONFERENCE_STATE",SET_END_CALL_REASON:"SET_END_CALL_REASON",FLOOR_STATUS:"FLOOR_STATUS",SET_INPUT_SYNC_STATE:"SET_INPUT_SYNC_STATE",SET_OUTPUT_SYNC_STATE:"SET_OUTPUT_SYNC_STATE",STATE_SYNC_SUBSCRIBE:"STATE_SYNC_SUBSCRIBE",STATE_SYNC_UNSUBSCRIBE:"STATE_SYNC_UNSUBSCRIBE",ADD_REMOTE_SCREEN_SHARING_USER_ID:"ADD_REMOTE_SCREEN_SHARING_USER_ID",REMOVE_REMOTE_SCREEN_SHARING_USER_ID:"REMOVE_REMOTE_SCREEN_SHARING_USER_ID",SET_PENDING_APPROVAL:"SET_PENDING_APPROVAL",FORCE_ENCODING_ENABLED:"FORCE_ENCODING_ENABLED",MW_VIDEO_ESCALATION_STARTED:"MW_VIDEO_ESCALATION_STARTED",MW_VIDEO_ESCALATION_COMPLETED:"MW_VIDEO_ESCALATION_COMPLETED",MW_VIDEO_ESCALATION_RESET:"MW_VIDEO_ESCALATION_RESET",ON_LOCAL_TRACK_REPLACED:"ON_LOCAL_TRACK_REPLACED"});e.exports=a},null);
__d("RTCGroupCallEscalationActionTypes",[],function(a,b,c,d,e,f){a=Object.freeze({GROUP_ESCALATION_START:"GROUP_ESCALATION_START",GROUP_ESCALATION_SUCCESS:"GROUP_ESCALATION_SUCCESS",GROUP_ESCALATION_CANCEL:"GROUP_ESCALATION_CANCEL",GROUP_ESCALATION_SET_USERS_TO_RING:"GROUP_ESCALATION_SET_USERS_TO_RING",GROUP_ESCALATION_CLEAR_P2P_CONNECTION:"GROUP_ESCALATION_CLEAR_P2P_CONNECTION",GROUP_ESCALATION_SET_P2P_CALLSUMMARY:"GROUP_ESCALATION_SET_P2P_CALLSUMMARY",GROUP_ESCALATION_ADD_LOCAL_STREAM:"GROUP_ESCALATION_ADD_LOCAL_STREAM"});e.exports=a},null);
__d("ScotchRTCNotificationUtils",["fbt","immutable","intlList"],function(a,b,c,d,e,f,g){"use strict";f.addingUsersToCallText=a;f.unableToAddUsersToCallText=c;function a(a,c){if(c&&c.size>0){c=c.toArray().map(function(a){return a.short_name});c=a?g._("Adding {names of users being added to call} to your call...",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.AND))]):g._("Adding {names of users being added to call} to your video chat...",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.AND))])}else c=a?g._("Adding someone to your call..."):g._("Adding someone to your video chat...");return c}function c(a,c){if(c&&c.size>0){c=c.toArray().map(function(a){return a.short_name});return g._("Unable to add {names of users being added to call}",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.OR))])}return a?g._("Unable to add person to your call"):g._("Unable to add person to your video chat")}},null);
__d("ScotchRTCCallNotificationReducer",["RTCCallActionTypes","RTCGroupCallEscalationActionTypes","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCGroupCallEscalationStore","ScotchRTCNotificationUtils"],function(a,b,c,d,e,f){"use strict";f.onEscalationStarted=a;f.onEscalationCompletion=c;f.onAbortedEscalation=d;f.clearStore=e;function a(a,c){switch(c.type){case"GROUP_ESCALATION_START":c=!b("ScotchRTCCallStore").hasRemoteVideo()&&!b("ScotchRTCCallStore").hasLocalVideo();c=b("ScotchRTCNotificationUtils").addingUsersToCallText(c,b("ScotchRTCGroupCallEscalationStore").getState().usersToRing);return a.set("notificationText",c).set("useTimeout",!1)}return a}function c(a,c){switch(c.type){case"ON_CONFERENCE_STATE":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCGroupCallEscalationStore").getDispatchToken()]);return b("ScotchRTCGroupCallEscalationStore").getState().readyToTransition?a.set("notificationText",null).set("useTimeout",!1):a}return a}function d(a,c){switch(c.type){case"GROUP_ESCALATION_CANCEL":c=!b("ScotchRTCCallStore").hasRemoteVideo()&&!b("ScotchRTCCallStore").hasLocalVideo();c=b("ScotchRTCNotificationUtils").unableToAddUsersToCallText(c,b("ScotchRTCGroupCallEscalationStore").getState().usersToRing);return a.set("notificationText",c).set("useTimeout",!0)}return a}function e(a,b){switch(b.type){case"HANGUP":case"END_CALL":case"HANGUP_ERROR":case"HANGUP_SUCCESS":return a.withMutations(function(a){a.set("notificationText",null).set("useTimeout",!0)})}return a}},null);
__d("ScotchRTCGroupCallEscalationStoreState",["immutable"],function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({aborted:!1,inProgress:!1,toRing:!1,p2pCallSummary:null,readyToTransition:!1,usersToRing:null}));e.exports=a},null);
__d("ScotchRTCGroupCallEscalationStoreReducer",["FBRTCParticipantCallState","ScotchRTCCallStore","RTCGroupCallEscalationActionTypes","ScotchRTCGroupCallEscalationStore","ScotchRTCGroupCallEscalationStoreState","ScotchRTCMWProtocolHandler","ScotchRTCP2PCallStore","ScotchRTWebUserActionLogger","immutable"],function(a,b,c,d,e,f){"use strict";f.abortEscalation=a;f.clearStore=c;f.setP2PCallSummary=d;f.callStart=e;f.onMultiwayConnectionSignaling=h;f.onParticipantsConnected=i;f.setUsersToRing=j;var g=new Set([(a=b("FBRTCParticipantCallState")).UNKNOWN,a.DISCONNECTED,a.NO_ANSWER,a.REJECTED,a.UNREACHABLE,a.CONNECTION_DROPPED,a.PARTICIPANT_LIMIT_REACHED,a.IN_ANOTHER_CALL,a.RING_TYPE_UNSUPPORTED]);function a(a,c){switch(c.type){case"GROUP_ESCALATION_CANCEL":b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"group_escalation_cancel"});return a.withMutations(function(a){a.set("aborted",!0).set("inProgress",!1).set("toRing",!1).set("readyToTransition",!1).set("usersToRing",null)})}return a}function c(a,c){switch(c.type){case"HANGUP":case"END_CALL":case"HANGUP_ERROR":case"HANGUP_SUCCESS":return a.withMutations(function(a){a.set("aborted",!1).set("inProgress",!1).set("toRing",!1).set("usersToRing",null)});case"RESET":return new(b("ScotchRTCGroupCallEscalationStoreState"))()}return a}function d(a,b){switch(b.type){case"GROUP_ESCALATION_SET_P2P_CALLSUMMARY":var c=b.p2pCallSummary;if(c)return a.withMutations(function(a){a.set("p2pCallSummary",c)})}return a}function e(a,c){switch(c.type){case"GROUP_ESCALATION_START":b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"group_escalation_start"});return a.set("inProgress",!0).set("readyToTransition",!1)}return a}function h(a,c){if(!a.readyToTransition&&a.inProgress)switch(c.type){case"ON_JOIN_REQUEST_SENT":b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){return a.setEscalationConnectingToMultiway()});break;case"ON_JOIN_RESPONSE":b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationConnectedToMultiway(),c.serverInfoData&&a.setServerInfoData(c.serverInfoData)});break}return a}function i(a,c){if(!a.readyToTransition&&a.inProgress)switch(c.type){case"ON_CONFERENCE_STATE":c=c.request.conferenceStateRequest();if(c){var d=c.participantStates;c=a.toRing;var e=!1,f=Object.keys(d).every(function(a){return d[a].state===b("FBRTCParticipantCallState").CONNECTED});if(f){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"group_escalation_success"});b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationPeerConnectedToMultiway(),a.setEscalationConnectedToMultiway(),a.setReadyToEscalate()});var h=b("ScotchRTCP2PCallStore").getState();h=h.protocolHandler;h.shutDownP2PListenersForMultiwayEscalation();if(a.usersToRing&&c){h=a.usersToRing.valueSeq().map(function(a){return a.fbid}).filter(Boolean).toArray();b("ScotchRTCMWProtocolHandler").addParticipants(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,h);c=!1}}else e=Object.keys(d).some(function(a){return g.has(d[a].state)}),e&&b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){return a.setInvalidP2PEscalationState()});return a.set("aborted",e).set("readyToTransition",f).set("inProgress",!(f||e)).set("toRing",c)}}return a}function j(a,b){switch(b.type){case"GROUP_ESCALATION_SET_USERS_TO_RING":if(b.usersToRing)return a.set("usersToRing",b.usersToRing).set("toRing",!0)}return a}},null);
__d("ScotchRTCCallType",[],function(a,b,c,d,e,f){"use strict";a=Object.freeze({AUDIO_ONLY:"AUDIO_ONLY",VIDEO_ONLY:"VIDEO_ONLY",AUDIO_VIDEO:"AUDIO_VIDEO",NO_AUDIO_VIDEO:"NO_AUDIO_VIDEO"});b=a;e.exports=b},null);
__d("ScotchRTCP2PCallEscalationStoreState",["FBRTCConstants","immutable"],function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({awaitingACK:!1,callType:b("FBRTCConstants").CallType.VOIP,escalated:!1,escalateMediaStream:null,failureReason:null,initiatedEscalation:!1,inProgress:!1,request:null,response:null,token:null}));e.exports=a},null);
__d("ScotchRTCP2PCallEscalationStoreReducers",["FBRTCConstants","ScotchRTCCallType","ScotchRTCP2PCallEscalationStoreState","ScotchRTCP2PCallEscalator","ScotchRTCP2PCallStore","ScotchRTWebUserActionLogger"],function(a,b,c,d,e,f){"use strict";a=function(a,c){switch(c.type){case"P2P_CALL_ESCALATION_START":if(a.inProgress)return a;if(a.escalated||!b("ScotchRTCP2PCallStore").isAudioOnly())return a;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_start"});return a.withMutations(function(a){a.set("awaitingACK",!0).set("initiatedEscalation",!0).set("failureReason",null).set("inProgress",!0).set("token",b("ScotchRTCP2PCallStore").getState().protocolHandler.generateEscalationRequestToken(!0))});case"P2P_CALL_ESCALATION_SUCCESS":if(!a.inProgress)return a;else if("token"in c&&c.token!==a.token)return a;b("ScotchRTCP2PCallEscalator").onEscalationSucceeded();b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_success"});return a.withMutations(function(a){a.set("awaitingACK",!1).set("callType",b("FBRTCConstants").CallType.ESCALATED).set("escalated",!0).set("inProgress",!1).set("request",null).set("response",!0).set("token",null)});case"P2P_CALL_ESCALATION_FAILURE":if(!a.inProgress)return a;else if("token"in c&&c.token!==a.token)return a;b("ScotchRTCP2PCallEscalator").onEscalationFailed();if(c.reason==="denied"){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_denied"});return a.withMutations(function(a){a.set("awaitingACK",!1).set("initiatedEscalation",!1).set("callType",b("FBRTCConstants").CallType.ESCALATION_DECLINED).set("escalated",!1).set("failureReason",c.reason||null).set("inProgress",!1).set("request",null).set("response",c.response||null).set("token",null).set("escalateMediaStream",null)})}else c.reason==="cancelled"?b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_cancelled"}):c.reason==="timeout"?b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_timeout"}):b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_failed"});b("ScotchRTCP2PCallStore").getState().protocolHandler.generateEscalationRequestToken(!1);return a.withMutations(function(a){a.set("awaitingACK",!1).set("inProgress",!1).set("initiatedEscalation",!1).set("callType",b("FBRTCConstants").CallType.ESCALATION_DECLINED).set("escalated",!1).set("failureReason",c.reason).set("token",null).set("escalateMediaStream",null)});case"SET_P2P_CALL_ESCALATION_MEDIA":return a.set("escalateMediaStream",c.stream);default:return a}};f.Alice=a;c=function(a,c){switch(c.type){case"P2P_CALL_ESCALATION_SET_REQUEST":var d=c.request;if(d==null)return a;return!b("ScotchRTCP2PCallEscalator").requestVideoOn(d.msg)?a.withMutations(function(a){a.set("awaitingACK",!1).set("inProgress",!1).set("request",null).set("response",null).set("token",null)}):a.withMutations(function(a){a.set("inProgress",!0).set("request",c.request).set("response",null).set("token",null)});case"P2P_CALL_ESCALATION_SET_RESPONSE":if(c.response==null)return a;else if(a.request==null)return a;return a.withMutations(function(a){a.set("awaitingACK",!0).set("callType",c.response?b("FBRTCConstants").CallType.ESCALATED:b("FBRTCConstants").CallType.ESCALATION_DECLINED).set("response",c.response).set("token",b("ScotchRTCP2PCallStore").getState().protocolHandler.generateEscalationResponseToken(a.request,c.response))});case"P2P_CALL_ESCALATION_ACK":if(c.token==null)return a;return a.response==null||a.request==null||c.token!==a.token||!a.awaitingACK?a:a.withMutations(function(a){a.set("awaitingACK",!1).set("callType",a.response?b("FBRTCConstants").CallType.ESCALATED:b("FBRTCConstants").CallType.ESCALATION_DECLINED).set("escalated",a.response).set("inProgress",!1).set("request",null).set("response",null).set("token",null)});default:return a}};f.Bob=c;d=function(a,c){switch(c.type){case"RESET":return new(b("ScotchRTCP2PCallEscalationStoreState"))();case"SET_CALL_TYPE":switch(c.callType){case b("ScotchRTCCallType").AUDIO_VIDEO:case b("ScotchRTCCallType").VIDEO_ONLY:return a.set("callType",b("FBRTCConstants").CallType.DIRECT_VIDEO)}return a;case"P2P_CALL_ESCALATION_ACK":if(c.token==null)return a;if(!a.awaitingACK)return a;else if(c.token!==a.token)return a;return a.set("awaitingACK",!1);default:return a}};f.common=d},null);
__d("ScotchRTCP2PCallReducer",["FBRTCConfig","FBRTCConsoleLogger","FBRTCConstants","ScotchFBRTCUserCapabilities","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallStoreState","ScotchRTCP2PCallWindowHandler","ScotchRTCP2PProtocolHandler","ScotchRTCScreenSharingWindowHandler","ScotchRTWebClientFeatureGating"],function(a,b,c,d,e,f){"use strict";f.callInit=a;f.callEnd=c;f.processCallType=d;f.processConnectionStatus=e;f.processEndCallReason=g;f.processMultiwayEscalationSupport=h;f.processPoppedOutScreenContent=i;f.processSignalingExperiments=j;f.processMessage=k;f.processIsCaller=l;f.processWasConnected=m;f.processWasStarRatingDone=n;f.processPoorNetworkQuality=o;function a(a,c){switch(c.type){case"INIT":var d=c.callType,e=c.isCaller,f=c.protocol;return f===b("FBRTCConstants").SignalingProtocol.P2P&&d&&e!=null?a.set("protocolHandler",a.protocolHandler||new(b("ScotchRTCP2PProtocolHandler"))()).set("isCaller",e).set("callType",d):a;case"RESET":return new(b("ScotchRTCP2PCallStoreState"))();case"RESET_FOR_REDIAL":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCCallStore").getDispatchToken()]);f=b("ScotchRTCCallStore").getState().remoteUsers.first();if(f==null)return a;a.protocolHandler.destroy();return a.set("connectionStatus","INIT").set("endCallReason",null).set("protocolHandler",new(b("ScotchRTCP2PProtocolHandler"))().init(f.FBID,Number(c.conferenceName))).set("signalingExperiments",new(b("ScotchFBRTCUserCapabilities"))());case"CALL_COLLISION":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCCallStore").getDispatchToken()]);a.protocolHandler.init(c.peerID,Number(c.conferenceName));return a.set("connectionStatus","INIT").set("endCallReason",null).set("signalingExperiments",new(b("ScotchFBRTCUserCapabilities"))());default:return a}}function c(a,c){switch(c.type){case"HANGUP":case"DISMISS":case"HANGUP_ERROR":case"HANGUP_SUCCESS":case"END_CALL":case"REMOVE_REMOTE_SCREEN_STREAM":case"RESET_FOR_REDIAL":b("ScotchRTCScreenSharingWindowHandler").close();return a.withMutations(function(a){return a.set("isScreenContentPoppedOut",b("ScotchRTCScreenSharingWindowHandler").isWindowOpened()).set("isRedialFooterButtonShown",(b("ScotchRTWebClientFeatureGating").shouldAlwaysShowRedial()||b("ScotchRTCP2PProtocolHandler").showRedialButton())&&!b("FBRTCConfig").isVCEndpointCall()).set("isStarRatingShown",b("ScotchRTCP2PProtocolHandler").showStarRating())});default:return a}}function d(a,c){switch(c.type){case"SET_CALL_TYPE":return a.set("callType",c.callType);case"P2P_CALL_ESCALATION_SET_RESPONSE":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCP2PCallEscalationStore").getDispatchToken()]);return a.set("callType",c.response?b("ScotchRTCCallType").AUDIO_VIDEO:b("ScotchRTCCallType").AUDIO_ONLY);case"P2P_CALL_ESCALATION_FAILURE":return a.set("callType",b("ScotchRTCCallType").AUDIO_ONLY);case"P2P_CALL_ESCALATION_SUCCESS":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCP2PCallEscalationStore").getDispatchToken()]);return b("ScotchRTCP2PCallEscalationStore").isEscalated()?a.set("callType",b("ScotchRTCCallType").AUDIO_VIDEO):a;default:return a}}function e(a,c){switch(c.type){case"SET_CONNECTION_STATUS":if(a.connectionStatus!==c.connectionStatus){b("ScotchRTCP2PCallWindowHandler").updateCallInProgressIndicator(c.connectionStatus);return a.set("connectionStatus",c.connectionStatus)}default:return a}}function g(a,b){switch(b.type){case"SET_END_CALL_REASON":return a.set("endCallReason",b.endCallReason);default:return a}}function h(a,b){switch(b.type){case"SET_MULTIWAY_ESCALATION_SUPPORT":a=a.set("offerEscalationSupport",b.offerEscalationSupport);b.escalationConferenceName&&(a=a.set("escalationConferenceName",b.escalationConferenceName));return a;default:return a}}function i(a,c){switch(c.type){case"POP_IN_SCREEN_CONTENT":b("ScotchRTCScreenSharingWindowHandler").close();return a.set("isScreenContentPoppedOut",b("ScotchRTCScreenSharingWindowHandler").isWindowOpened());case"POP_OUT_SCREEN_CONTENT":var d=b("ScotchRTCCallStore").getState(),e=d.remoteUsers.first().FBID;d=d.callInfo;b("ScotchRTCScreenSharingWindowHandler").open(e,c.stream,d);return a.set("isScreenContentPoppedOut",b("ScotchRTCScreenSharingWindowHandler").isWindowOpened());default:return a}}function j(a,b){switch(b.type){case"SET_REMOTE_SIGNALING_EXPERIMENTS":return a.set("signalingExperiments",a.signalingExperiments.setRemote(b.remoteSignalingExperiments));default:return a}}function k(a,b){switch(b.type){case"P2P_PROCESS_MESSAGE":return a.set("isRemoteVideoSupported",b.message.isRemoteVideoSupported()).set("isPeerOnMobile",b.message.isFromMobile());default:return a}}function l(a,b){switch(b.type){case"P2P_SET_IS_CALLER":return a.set("isCaller",b.isCaller);case"CALL_COLLISION":return a.set("isCaller",!0);default:return a}}function m(a,b){switch(b.type){case"SET_CONNECTION_STATUS":return b.connectionStatus==="CONNECTED"?a.set("wasConnected",!0):a;case"RESET_FOR_REDIAL":return a.set("wasConnected",!1);case"CALL_COLLISION":return a.set("wasConnected",!1);default:return a}}function n(a,b){switch(b.type){case"P2P_STAR_RATING_DONE":return a.set("isStarRatingShown",!1).set("wasStarRatingDone",b.done);case"RESET_FOR_REDIAL":return a.set("isStarRatingShown",!1).set("wasStarRatingDone",!1);default:return a}}function o(a,b){switch(b.type){case"SHOW_POOR_NETWORK_QUALITY":return a.set("isPoorNetworkQualityShown",!0);case"DISMISS_POOR_NETWORK_QUALITY":return a.set("isPoorNetworkQualityShown",!1);default:return a}}},null);
__d("ScotchFBRTCVideoDurationTrackerReducer",["FBRTCCallSummaryStore","ScotchRTCCallStore"],function(a,b,c,d,e,f){"use strict";f.track=a;f.update=c;f.stop=d;function a(a,c){var d=a.videoDurationTrackerInfo,e=d.localVideoDurationTracker,f=d.remoteVideoDurationTracker;d=d.localScreenDurationTracker;switch(c.type){case"ADD_LOCAL_SCREEN_STREAM":d.track(c.stream),d.isStarted()||d.start();case"ADD_LOCAL_STREAM":e.track(c.stream);e.isStarted()||e.start();return a;case"REMOVE_LOCAL_SCREEN_STREAM":d.pause(c.stream);return a;case"REPLACE_LOCAL_SCREEN_STREAM":d.track(c.newStream);e.track(c.newStream);return a;case"ADD_REMOTE_STREAM":case"TOGGLE_REMOTE_STREAM":d=b("ScotchRTCCallStore").getState().remoteUsers.find(function(a){return!a.isVideoDisabled()});f.stop();f.start();f.track(d&&d.streams.first());return a}return a}function c(a,b){switch(b.type){case"VIDEO_MUTED":case"VIDEO_UNMUTED":a.videoDurationTrackerInfo.localVideoDurationTracker.update()}return a}function d(a,c){switch(c.type){case"DISMISS":case"END_CALL":case"HANGUP":c=a.videoDurationTrackerInfo;var d=b("ScotchRTCCallStore").getState();d=d.callSummary;c.localVideoDurationTracker.stop();c.remoteVideoDurationTracker.stop();c.localScreenDurationTracker.stop();d.setVideoDurations(c.localVideoDurationTracker.getDuration(),c.remoteVideoDurationTracker.getDuration());d.setScreenDuration(c.localScreenDurationTracker.getDuration());d.save(b("FBRTCCallSummaryStore").getInstance());return a}return a}},null);
__d("ScotchFBRTCGroupCallStore",["FluxReduceStore","ScotchFBRTCGroupCallParticipantsReducer","ScotchFBRTCGroupCallReducer","ScotchFBRTCGroupCallStoreState","ScotchFBRTCVideoDurationTrackerReducer","ScotchRTCAppDispatcher"],function(a,b,c,d,e,f){"use strict";var g=[b("ScotchFBRTCGroupCallParticipantsReducer").addParticipantsToRing,b("ScotchFBRTCGroupCallParticipantsReducer").initThread,b("ScotchFBRTCGroupCallParticipantsReducer").onParticipantsChanged,(a=b("ScotchFBRTCGroupCallReducer")).processEndCallReason,a.setDominantSpeaker,a.setLayout,a.onForceEncodingChanged,a.onVideoEscalationStarted,a.onVideoEscalationCompleted,a.onReset,b("ScotchFBRTCVideoDurationTrackerReducer").track,b("ScotchFBRTCVideoDurationTrackerReducer").update,b("ScotchFBRTCVideoDurationTrackerReducer").stop];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchFBRTCGroupCallStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.hadVideoDuration=function(){var a=this.getState().videoDurationTrackerInfo,b=a.localVideoDurationTracker;a=a.remoteVideoDurationTracker;return b.getDuration()>0||a.getDuration()>0};return c}(b("FluxReduceStore"));c.__moduleID=e.id;d=new c(b("ScotchRTCAppDispatcher"));e.exports=d},null);
__d("ScotchFBRTCMWProtocolStoreState",["ScotchRTCStreamDurationTracker","immutable"],function(a,b,c,d,e,f){"use strict";c={pendingResponse:!1,pendingUpdate:!1,lastSyncedClientVersion:1,localToMWSTrackIDMap:(a=b("immutable")).Map(),localMediaUpdates:a.List([{mediaStatus:{}}])};d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.Record(c));f={clientMediaUpdateInfo:new d(),localScreenDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("screen")};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.Record(f));e.exports=c},null);
__d("ScotchFBRTCMWProtocolStore",["FluxReduceStore","ScotchFBRTCClientMediaUpdateReducer","ScotchFBRTCMWProtocolStoreState","ScotchRTCAppDispatcher","ScotchRTWebUserActionLogger","gkx"],function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchFBRTCClientMediaUpdateReducer")).configureAudio,a.configureVideo,a.configureScreenSharing,a.onClientMediaUpdateResponse,a.setLocalClientVersion,a.reset,a.onLocalTrackReplaced];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ScotchFBRTCMWProtocolStore1="",b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchFBRTCMWProtocolStoreState"))()};d.reduce=function(a,c){var d=g.reduce(function(a,b){return b(a,c)},a);if(b("gkx")("1439080")){a=a.clientMediaUpdateInfo.localMediaUpdates;var e=d.clientMediaUpdateInfo,f=e.pendingResponse,h=e.pendingUpdate,i=e.lastSyncedClientVersion,j=e.localToMWSTrackIDMap;e=e.localMediaUpdates;var k=[];for(var a=a.size;a<e.size;a++)k.push(e.get(a));a=JSON.stringify({pendingResponse:f,pendingUpdate:h,lastSyncedClientVersion:i,localToMWSTrackIDMap:j.toJS(),localMediaUpdatesChange:k,localMediaUpdateSize:e.size});this.$ScotchFBRTCMWProtocolStore1!==a&&(b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCMWProtocolStore.reduce: "+JSON.stringify({beforeCMUInfo:this.$ScotchFBRTCMWProtocolStore1,afterCMUInfo:a,action:c})}),this.$ScotchFBRTCMWProtocolStore1=a)}return d};return c}(b("FluxReduceStore"));c.__moduleID=e.id;d=new c(b("ScotchRTCAppDispatcher"));e.exports=d},null);
__d("ScotchRTCCallNotificationStoreState",["immutable"],function(a,b,c,d,e,f){"use strict";a={useTimeout:!0,notificationText:null};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c},null);
__d("ScotchRTCCallNotificationStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallNotificationReducer","ScotchRTCCallNotificationStoreState"],function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchRTCCallNotificationReducer")).clearStore,a.onEscalationStarted,a.onEscalationCompletion,a.onAbortedEscalation];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCallNotificationStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));c.__moduleID=e.id;d=new c(b("ScotchRTCAppDispatcher"));e.exports=d},null);
__d("ScotchRTCGroupCallEscalationStore",["FBRTCCallSummaryStore","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCGroupCallEscalationStoreReducer","ScotchRTCGroupCallEscalationStoreState"],function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchRTCGroupCallEscalationStoreReducer")).abortEscalation,a.callStart,a.clearStore,a.onMultiwayConnectionSignaling,a.onParticipantsConnected,a.setP2PCallSummary,a.setUsersToRing];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCGroupCallEscalationStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.isInProgress=function(){return this.getState().inProgress};d.isEscalated=function(){return this.getState().readyToTransition};d.logToP2PCallSummary=function(a){var c=this.getState();c=c.p2pCallSummary;c&&(a(c),c.save(b("FBRTCCallSummaryStore").getInstance()))};return c}(b("FluxReduceStore"));c.__moduleID=e.id;d=new c(b("ScotchRTCAppDispatcher"));e.exports=d},null);
__d("ScotchRTCP2PCallEscalationStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCP2PCallEscalationStoreReducers","ScotchRTCP2PCallEscalationStoreState","ScotchRTCP2PCallStore"],function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCP2PCallEscalationStoreReducers").Alice,b("ScotchRTCP2PCallEscalationStoreReducers").Bob,b("ScotchRTCP2PCallEscalationStoreReducers").common];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCP2PCallEscalationStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.didCurrentUserInitiate=function(){return this.getState().initiatedEscalation};d.isInProgress=function(){return this.getState().inProgress};d.isEscalated=function(){return this.getState().escalated};d.getEscalateMediaStream=function(){return this.getState().escalateMediaStream};d.remoteWillNotInitSDPUpdate=function(){return b("ScotchRTCP2PCallStore").getState().isPeerOnMobile||b("ScotchRTCP2PCallStore").getState().signalingExperiments.remoteSupport("video_escalation_by_unmute")};d.isNegotiationAllowed=function(){var a=this.getState();return this.remoteWillNotInitSDPUpdate()||!a.request};d.isStarted=function(){var a=this.getState();return a.inProgress&&a.token!==null};d.getToken=function(){return this.getState().token};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a(b("ScotchRTCAppDispatcher"));e.exports=c},null);
__d("ScotchRTCP2PCallAdminMessageReducers",["FBRTCCallConstants","ScotchFBRTCAdminMessage","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCallType"],function(a,b,c,d,e,f){"use strict";f.processCallInit=a;f.processCallStart=c;f.processCallEnd=d;var g=b("FBRTCCallConstants").FBRTCCallType;function a(a,c){switch(c.type){case"SET_CALL_SUMMARY":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCCallStore").getDispatchToken()]);c=b("ScotchRTCCallStore").getState();c=c.callSummary;return a.set("adminMessage",new(b("ScotchFBRTCAdminMessage"))(c.peerID,c.callID));default:return a}}function c(a,b){switch(b.type){case"SET_CONNECTION_STATUS":var c=a.adminMessage;c&&b.connectionStatus==="CONNECTED"&&c.onCallConnected();return a;default:return a}}function d(a,c){switch(c.type){case"SET_END_CALL_REASON":var d=a.adminMessage,e=a.escalationConferenceName;d&&(d.onCallEnded(),a.isCaller&&d.submit(a.callType===b("ScotchRTCCallType").AUDIO_ONLY?g.VOICE_CALL:g.VIDEO_CALL,c.endCallReason.getReasonID(),e));return a;default:return a}}},null);
__d("ScotchRTCP2PCallStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallType","ScotchRTCP2PCallAdminMessageReducers","ScotchRTCP2PCallReducer","ScotchRTCP2PCallStoreState"],function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchRTCP2PCallReducer")).callEnd,a.callInit,a.processCallType,a.processConnectionStatus,a.processEndCallReason,a.processPoppedOutScreenContent,a.processMultiwayEscalationSupport,a.processSignalingExperiments,a.processMessage,a.processIsCaller,a.processWasConnected,a.processWasStarRatingDone,a.processPoorNetworkQuality,b("ScotchRTCP2PCallAdminMessageReducers").processCallInit,b("ScotchRTCP2PCallAdminMessageReducers").processCallStart,b("ScotchRTCP2PCallAdminMessageReducers").processCallEnd];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCP2PCallStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.isAudioOnly=function(){return this.getState().callType===b("ScotchRTCCallType").AUDIO_ONLY};d.isCaller=function(){return this.getState().isCaller};return c}(b("FluxReduceStore"));c.__moduleID=e.id;d=new c(b("ScotchRTCAppDispatcher"));e.exports=d},null);
__d("ScotchRTCP2PCallStoreState",["ScotchFBRTCUserCapabilities","ScotchRTCCallType","ScotchRTCP2PProtocolHandler","immutable"],function(a,b,c,d,e,f){"use strict";a={adminMessage:null,callType:b("ScotchRTCCallType").AUDIO_ONLY,connectionStatus:"INIT",endCallReason:null,escalationConferenceName:null,isCaller:!1,isPeerOnMobile:!1,isPoorNetworkQualityShown:!1,isRedialFooterButtonShown:!1,isRemoteVideoSupported:!0,isScreenContentPoppedOut:!1,isStarRatingShown:!1,offerEscalationSupport:!1,protocolHandler:new(b("ScotchRTCP2PProtocolHandler"))(),signalingExperiments:new(b("ScotchFBRTCUserCapabilities"))(),wasConnected:!1,wasStarRatingDone:!1};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c},null);
__d("ScotchRTCCallInitUtils",["invariant","CurrentUser","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","MercuryIDs","MessengerParticipants.bs","MessengerParticipantsImages.re","MessengerState.bs","RTCUser","ScotchFBRTCGroupCallStore","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCMWThreadDeltaHandler","URI","immutable"],function(a,b,c,d,e,f,g){"use strict";f.initializeCallSummary=a;f.initializeRTCUsers=c;f.initializeParticipantsAndStartCall=d;f.initializeThreadFromCollisionContext=e;f._createRTCUser=i;var h;function a(a){var c=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),a.peerID,a.callID,a.isCaller);b("ScotchRTCCallActions").setCallSummary(c);b("ScotchRTCCallStore").mutateCallSummary(function(c){c.onPopupOpened(),c.setCallType(a.protocol===b("FBRTCConstants").SignalingProtocol.P2P?a.isAudio?b("FBRTCConstants").CallType.VOIP:b("FBRTCConstants").CallType.DIRECT_VIDEO:"mws"),c.setActiveConnection(a.protocol===b("FBRTCConstants").SignalingProtocol.P2P?"p2p":"mws")})}function c(a,c){var d=this;a=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});b("MessengerParticipants.bs").getMulti(a,function(a){a=b("immutable").Map(a);d.initializeParticipantsAndStartCall(a,!0,c)})}function d(a,c,d){var e=this,f=a.keySeq().toArray();b("MessengerParticipantsImages.re").getBigImageMultiWithSize({ids:f,callback:function(f){c&&b("ScotchRTCCallActions").initRemoteUsers(a.filter(function(a){a=a.fbid;return a!==b("CurrentUser").getID()}).map(function(a){return e._createRTCUser(a,f)}).toSet());var g=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());b("ScotchRTCCallActions").initLocalUser(e._createRTCUser(a.get(g),f));d()},size:100})}function e(a){var c=a.peerID;a=a.groupThreadID;var d=c!=null?c:a;if(d==null)return;a=c!=null?b("MercuryIDs").getThreadIDFromUserID(d):b("MercuryIDs").getThreadIDFromThreadFBID(d);if(a===null)return;c=(c=b("ScotchFBRTCGroupCallStore").getState().thread)==null?void 0:c.thread_fbid;a!==c&&b("MessengerState.bs").getThreadMeta(b("CurrentUser").getID(),a,function(a){b("ScotchRTCGroupCallActions").initThread(a,null),b("ScotchRTCMWThreadDeltaHandler").initHandler(d)})}function i(a,c){var d=a.big_image_src,e=a.fbid,f=a.user_type,i=a.href,j=a.image_src,k=a.is_messenger_user,l=a.name,m=a.room_location,n=a.short_name;a=a.vanity;e||g(0,1174);if(c){var o=b("MercuryIDs").getParticipantIDFromUserID(e);d=c[o]}return new(b("RTCUser"))({FBID:e,isGuestUser:f==="guest",isMessengerUser:!!k,profileUrl:new(h||(h=b("URI")))(i),profilePictureUrl:d||j,roomLocation:m,userName:l,userShortName:n,vanity:a?a:""})}},null);
__d("ScotchRTCGroupCallEscalationActions",["ScotchRTCAppDispatcher","immutable"],function(a,b,c,d,e,f){"use strict";f.start=a;f.cancel=c;f.approve=d;f.setUsersToRing=e;f.setP2PCallSummary=g;function a(){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_START"})}function c(a){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_CANCEL",p2pCallSummary:a})}function d(){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_SUCCESS"})}function e(a){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_SET_USERS_TO_RING",usersToRing:a})}function g(a){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_SET_P2P_CALLSUMMARY",p2pCallSummary:a})}},null);
__d("ScotchRTCGroupCallEscalator",["CurrentUser","FBRTCConsoleLogger","FBRTCConstants","MercuryIDs","MessengerParticipants.bs","ScotchFBRTCGroupCallStore","ScotchFBRTCMWProtocolStore","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCGroupCallEscalationActions","ScotchRTCGroupCallEscalationStore","ScotchRTCMWProtocolHandler","immutable"],function(a,b,c,d,e,f){"use strict";var g=45e3;a=function(){function a(a,c,d,e){this.$3=a,this.$4=c,this.$5=d,this.$1=String(e),b("ScotchRTCGroupCallEscalationActions").setP2PCallSummary(b("ScotchRTCCallStore").getState().callSummary),this.$6=[d],this.$8=null}var c=a.prototype;c.getParticipants=function(){return this.$8};c.$9=function(){var a=this.$3,c=this.$1;return window.setTimeout(function(){var d=b("ScotchRTCGroupCallEscalationStore").isEscalated(),e=b("ScotchRTCCallStore").getState();e=e.callInfo;!d&&(e.callID===c||e.conferenceName===a)&&(h("Group Escalation timed out"),b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationTimedOut(),b("ScotchRTCGroupCallEscalationActions").cancel(a)}))},g)};c.startEscalationToMultiway=function(){var a=this;h("Escalating P2P call to Multiway call %o",this.$3);var c=b("ScotchRTCGroupCallEscalationStore").getState().inProgress;if(c)return;b("ScotchRTCGroupCallEscalationActions").start();this.$2=this.$9();this.$7=new(b("ScotchRTCMWProtocolHandler"))();b("ScotchRTCAppDispatcher").explicitlyRegisterStores([b("ScotchFBRTCGroupCallStore"),b("ScotchFBRTCMWProtocolStore")]);b("ScotchRTCGroupCallActions").setLayout(b("FBRTCConstants").GroupVideoViewLayout.GRID);var d=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());b("MessengerParticipants.bs").get(d,function(c){var e={};e[d]=c;c=b("immutable").Map(e);a.$8=c;b("ScotchRTCGroupCallActions").initThread(null,c);a.$10()})};c.$10=function(){var a=b("ScotchRTCCallStore").getState().localUser.getStream();a=a;a&&this.$7.onStreamReady(a,this.$6,this.$3,!0,{callTrigger:"multiway_escalation",p2pCallID:this.$1})};return a}();e.exports=a;a.ESCALATION_TIMEOUT=g;function h(){}},null);
__d("ScotchFBRTCPeerConnection",["requireCond","cr:1429706"],function(a,b,c,d,e,f){"use strict";e.exports=b("cr:1429706")},null);
__d("ScotchRTCP2PCallEscalationActions",["ScotchRTCAppDispatcher"],function(a,b,c,d,e,f){"use strict";f.start=a;f.setRequest=c;f.cancel=d;f.timeout=e;f.handleACK=g;f.approve=h;f.decline=i;f.setResponse=j;f.parseResponse=k;f.muteRemoteVideo=l;f.setEscalateToMediaStream=m;function a(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_START"})}function c(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SET_REQUEST",request:a})}function d(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"cancelled"})}function e(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"timeout"})}function g(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_ACK",token:a})}function h(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SUCCESS"})}function i(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"denied",token:a,response:!1})}function j(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SET_RESPONSE",response:a})}function k(a,c){a?b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SUCCESS",token:c}):b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"denied",token:c,response:!1})}function l(){b("ScotchRTCAppDispatcher").dispatch({type:"REMOTE_VIDEO_MUTED"})}function m(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_P2P_CALL_ESCALATION_MEDIA",stream:a})}},null);
__d("ScotchRTCP2PCallEscalator",["Promise","FBRTCCallSummaryStore","FBRTCConsoleLogger","FBRTCConstants","FBRTCSupport","ScotchFBRTCPeerConnection","ScotchRTCCallStore","ScotchRTCP2PCallEscalationActions","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallStore","ScotchRTCP2PProtocolHandler","ScotchRTCUtils","dangerouslyBypassDispatchError"],function(a,b,c,d,e,f){"use strict";var g=25e3;a=function(){a.initVideoInAudioCall=function(){return b("FBRTCSupport").videoEscalationByUnmuteWorkaround()};a.isEscalated=function(){return b("ScotchRTCP2PCallEscalationStore").isEscalated()};a.isNegotiationAllowed=function(){return b("ScotchRTCP2PCallEscalationStore").isNegotiationAllowed()};function a(a,b,c){this.$3=a,this.$1=b,this.$2=c,this.$6()}var c=a.prototype;c.$6=function(){var a=this,c=b("ScotchRTCP2PCallEscalationStore").getState();this.$4=b("ScotchRTCP2PCallEscalationStore").addListener(function(){var d=b("ScotchRTCP2PCallEscalationStore").getState();if(d===c)return;!d.awaitingACK&&d.awaitingACK!==c.awaitingACK&&!d.inProgress&&window.clearTimeout(a.$5);if(d.callType!==c.callType&&d.inProgress){var e=b("ScotchRTCCallStore").getState();e=e.callSummary;e.setCallType(d.callType);e.save(b("FBRTCCallSummaryStore").getInstance())}c=d})};c.destroy=function(){h("P2P Escalator %o","destroy"),this.$4.remove(),window.clearTimeout(this.$5)};c.generateRequestToken=function(a){var c=b("ScotchRTCP2PCallEscalationStore").getState();c=c.token;if(c!=null&&a){h("P2P Escalator %o","request token","reuse");return c}h("P2P Escalator %o","request token");c=this.$2.sendVideoEscalationRequest(this.$3,this.$1,a);window.clearTimeout(this.$5);this.$5=this.$7();return c.msg_id.toString()};c.generateResponseToken=function(a,c){var d=b("ScotchRTCP2PCallEscalationStore").getState();d=d.token;if(d!=null){h("P2P Escalator %o","response token","reuse");return d}h("P2P Escalator %o %o %o","response token",c,a);d=a.peerID;var e=a.callID;a=a.msgID;d=this.$2.sendVideoRequestResponse(d,e,a,c);window.clearTimeout(this.$5);var f=d.msg_id.toString();!c?b("dangerouslyBypassDispatchError")(function(){return b("ScotchRTCP2PCallEscalationActions").decline(f)}):this.$5=this.$7();return f};c.$7=function(){return window.setTimeout(b("ScotchRTCP2PCallEscalationActions").timeout,g)};c.parseMessage=function(a){h("P2P Escalator %o","parse message",this.$3,a.msgType);switch(a.msgType){case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:a.ackID?this.$8(a):this.$9(a);break;case b("FBRTCConstants").PayloadType.ACK:a.msg.ack_type===b("FBRTCConstants").PayloadType.VIDEO_REQUEST&&b("ScotchRTCP2PCallEscalationActions").handleACK(a.ackID.toString());break}};c.$8=function(c){h("P2P Escalator %o","parse response",c);var d=c.ackID.toString();b("ScotchRTCP2PCallEscalationStore").getToken()===d&&this.$10(c);b("ScotchRTCP2PCallEscalationActions").parseResponse(a.requestVideoOn(c.msg),d);window.clearTimeout(this.$5)};c.$9=function(c){h("P2P Escalator %o","parse request",c);if(b("ScotchRTCP2PCallEscalationStore").isInProgress()&&!a.requestVideoOn(c.msg)){b("ScotchRTCP2PCallEscalationStore").didCurrentUserInitiate()?b("ScotchRTCP2PCallEscalationActions").cancel():(this.$10(c),b("ScotchRTCP2PCallEscalationActions").setRequest(c));return}if(b("ScotchRTCP2PCallEscalationStore").isInProgress()&&b("ScotchRTCP2PCallEscalationStore").didCurrentUserInitiate()){h("P2P Escalator %o","auto-approve","mutual consent");b("ScotchRTCP2PCallEscalationActions").approve();this.$10(c);this.generateResponseToken(c,!0);return}if(b("ScotchRTCP2PCallEscalationStore").isEscalated()){a.requestVideoOn(c.msg)?(h("P2P Escalator %o","auto-approve"),this.$10(c),this.generateResponseToken(c,!0),window.clearTimeout(this.$5)):(h("P2P Escalator %o","mute remote video"),b("ScotchRTCP2PCallEscalationActions").muteRemoteVideo());return}h("P2P Escalator %o %o","request",c);this.$10(c);b("ScotchRTCP2PCallEscalationActions").setRequest(c)};c.$10=function(a){var b=a.peerID,c=a.callID;a=a.msg;h("P2P Escalator %o","ACK","sent");this.$2.sendAck(b,c,a)};a.requestVideoOn=function(a){var b=a.reqVideoOn;a=a.videoon;return Boolean(b||a)};a.initEscalation=function(){var a=b("ScotchRTCP2PCallStore").getState(),c=a.protocolHandler;a=b("ScotchRTCCallStore").getState();a=a.localUser;var d=a.getStream();a=a.hasVideo();return(d&&a?b("Promise").resolve(d).then(function(a){c.updateLocalVideoTracker();return a}):b("ScotchRTCP2PProtocolHandler").initStream(!0).then(function(a){c.startLocalVideoTracker(a);return a})).then(function(a){b("ScotchRTCP2PCallEscalationActions").setEscalateToMediaStream(a);b("ScotchRTCP2PCallEscalationActions").start();return a})};a.onEscalationSucceeded=function(){var c=b("ScotchRTCP2PCallEscalationStore").getEscalateMediaStream(),d=b("ScotchRTCCallStore").getState();d=d.localUser;if(d.getStream()===c){var e=b("ScotchRTCCallStore").getState();e=e.remoteUsers;d.toggleDisableVideo(!1);e.first()&&e.first().toggleDisableVideo(!1)}else c&&b("dangerouslyBypassDispatchError")(function(){a.updateEscalationStream(c)})};a.onEscalationFailed=function(){var a=b("ScotchRTCP2PCallEscalationStore").getEscalateMediaStream(),c=b("ScotchRTCCallStore").getState();c=c.localUser;if(c.getStream()===a){var d=b("ScotchRTCCallStore").getState();d=d.remoteUsers;c.toggleDisableVideo(!0);d.first()&&d.first().toggleDisableVideo(!0)}else if(a){b("ScotchRTCUtils").stopMediaStream(a);c=b("ScotchRTCP2PCallStore").getState();d=c.protocolHandler;d.updateLocalVideoTracker()}};a.acceptEscalation=function(c){var d=b("ScotchRTCCallStore").getState(),e=d.localUser;d=d.remoteUsers;c=Boolean(c==null?void 0:c.muteVideo);if(e.hasVideo()){e.toggleDisableVideo(c);d.first()&&d.first().toggleDisableVideo(!1);d=b("ScotchRTCP2PCallStore").getState();d=d.protocolHandler;d.updateLocalVideoTracker();b("ScotchRTCP2PCallEscalationActions").setResponse(!0);return b("Promise").resolve(e.streams.first())}else return b("ScotchRTCP2PProtocolHandler").initStream(!c).then(function(c){b("ScotchRTCP2PCallEscalationActions").setResponse(!0);a.updateEscalationStream(c);return c})};a.declineEscalation=function(){b("ScotchRTCP2PCallEscalationActions").setResponse(!1)};a.updateEscalationStream=function(a){var c=b("ScotchRTCCallStore").getState().localUser.getStream();if(b("ScotchFBRTCPeerConnection").shouldUseAddTrackForUnifiedPlan()&&c){for(var d=a.getVideoTracks(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.addTrack(g)}g=b("ScotchRTCP2PCallStore").getState();f=g.protocolHandler;f.updateStreamForUnifiedPlan(c)}else b("ScotchRTCP2PProtocolHandler").replaceLocalStream(a)};return a}();e.exports=a;a.ACK_TIMEOUT=g;function h(){}},null);
__d("FBRTCVideoQuality",[],function(a,b,c,d,e,f){e.exports=Object.freeze({LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4})},null);
__d("ScotchFBRTCStatsHelpers",["Promise"],function(a,b,c,d,e,f){var g=!1,h=function(a){if(a==="host"||a==="local")return"local";if(a==="serverreflexive"||a==="srflx")return"srflx";if(a==="peerreflexive"||a==="prflx")return"prflx";return a==="relayed"||a==="relay"?"relay":"unknown_"+a},i={UNKNOWN_CONNECTION:"l:unknown-unknown;r:unknown-unknown",connectionType:function(a,b,c,d){return a!==null&&a!==void 0&&b!==null&&c!==null&&c!==void 0&&d!==null?["l:",h(a),"-",b,";","r:",h(c),"-",d].join(""):null},getVideoCapabilitiesInfo:function(a){a=a.getVideoTracks();a=a[0];if(a==null)return null;if(typeof a.getCapabilities!=="function")return null;a=a.getCapabilities();var b=a.aspectRatio,c=a.facingMode,d=a.frameRate,e=a.height;a=a.width;return{facing_mode:(c=c)!=null?c:null,max_aspect_ratio:(c=b==null?void 0:b.max)!=null?c:null,max_frame_rate:(c=d==null?void 0:d.max)!=null?c:null,max_height:(d=e==null?void 0:e.max)!=null?d:null,max_width:(c=a==null?void 0:a.max)!=null?c:null,min_aspect_ratio:(e=b==null?void 0:b.min)!=null?e:null}},getMediaInputs:function(a){var b={audio_inputs:[],video_inputs:[]};a.forEach(function(a){switch(a.kind){case"videoinput":b.video_inputs.push(a.label);break;case"audioinput":b.audio_inputs.push(a.label);break}});return b},logCapabilities:function(a,b,c){a.setVideoCapabilities(i.getVideoCapabilitiesInfo(b)),a.setMediaInputs(i.getMediaInputs(c))},internalGetWindow:function(){return window},getBatteryStats:function(){return new(b("Promise"))(function(a,b){var c=i.internalGetWindow().navigator.getBattery;typeof c==="function"?a(c.call(navigator)):b()}).then(function(a){a.charging?g=!0:a.onchargingchange=function(a){a.target.charging&&(g=!0),a.target.onchargingchange=null};return{level:a.level*100,wasCharged:g}})["catch"](function(){return{placeholder:!0,level:-1,wasCharged:!1}})}};a=i;e.exports=a},null);
__d("ScotchMessengerChatLinksFunnelLogger",["UserAgentData","WebFunnelLogger"],function(a,b,c,d,e,f){"use strict";f.startFunnel=a;f.getLinkHashTag=c;f.appendAction=d;f.setSessionKey=e;var g="MessengerVideoChatLinksFunnelDefinition",h="defaultSessionKey",i="marker",j="link_hash:",k,l;function a(a){var b=n(),c=m();a&&(l=c=[].concat(c,a));b.setFunnelTags(c);b.markStart().setAction(i).log()}function m(){var a={bn:b("UserAgentData").browserName,bv:b("UserAgentData").browserVersion,os:b("UserAgentData").platformName},c=Object.keys(a).map(function(b){return b+":"+((b=a[b])!=null?b:"unknown")});return c}function c(a){return j+a}function d(a,b){var c=n();c.setAction(a);b&&b.actionTag&&c.setActionTag(b.actionTag);b&&b.funnelTags&&(l=(l||[]).concat(b.funnelTags),c.setFunnelTags(l));c.log()}function e(a){k=(a=a)!=null?a:h}function n(){return new(b("WebFunnelLogger"))(g).setSessionKey(k)}},null);
__d("XGroupCallSendRequestController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/groupcall/sendrequest/",{webrtc_fbtrace:{type:"Int"}})},null);
__d("ScotchMultiwayRequests",["Promise","AsyncRequest","FBLogger","FBRTCLogger","FBRTCMessageType","ScotchFBRTCMultiwayMessage","ScotchFBRTCUserCapabilities","ScotchMWDeviceCapabilities","ScotchRTCUtils","ScotchRTWebUserActionLogger","XGroupCallSendRequestController","ZenonScreenSharingConstants"],function(a,b,c,d,e,f){"use strict";var g=15e3;a=function(){function a(){}var c=a.prototype;c.sendJoinRequest=function(a,c,d,e,f,g,h,i,j){var k=h.callID,l=h.numParticipants;h=h.callTrigger;var m=i.userToEscalate,n=i.isEscalator;i=i.escP2PCallID;c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").JOIN,c,d,k,i);d={offer:{sdpString:e.toSdp()},deviceCapabilities:b("ScotchMWDeviceCapabilities").getDeviceCapabilities()};j!=null&&(d.syncPayload={stateStore:j});k=b("ScotchRTCUtils").createClientContextMessage(l,h?h:"");d.appMessages=[k];f&&f.length>0&&!m&&(d.usersToCall=f);m&&n&&(d.userToEscalate=m);g&&(d.mediaStatus=g);i=b("ScotchFBRTCUserCapabilities").getLocal();if(i.length>0){var o={};i.forEach(function(a){return o[a]=!0});d.userCapabilities=JSON.stringify(o)}e={joinRequest:d};j=this.$1(a,c,e);return this.$2(j)};c.sendHangupRequest=function(a,c,d,e,f,g){(d==null||d==="")&&b("FBLogger")("rtc_hangup_debug").warn("serverInfoData null when hanging up call: %s, conf: %s, reason: %s",g,c,f);c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").HANGUP,c,d,g);d={reason:e,detailedReasonString:f};g={hangupRequest:d};e=this.$1(a,c,g);return this.$2(e)};c.sendAddParticipantsRequest=function(a,c,d,e,f){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").ADD_PARTICIPANTS,c,d,f);d={usersToInvite:e};f={addParticipantsRequest:d};e=this.$1(a,c,f);return this.$2(e)};c.sendRemoveParticipantsRequest=function(a,c,d,e,f){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").REMOVE_PARTICIPANTS,c,d,f);d={usersToRemove:e};f={removeParticipantsRequest:d};e=this.$1(a,c,f);return this.$2(e)};c.sendStartScreenSharingRequest=function(a,c,d,e,f,g){return this.sendGenericDataMessageRequest(a,c,d,e,f,g,[],b("ZenonScreenSharingConstants").ZenonScreenSharingDataMessageTopic.Start,JSON.stringify((a={},a[b("ZenonScreenSharingConstants").SCREEN_SHARE_DATA_USER_ID_KEY]=f,a)))};c.sendEndScreenSharingRequest=function(a,c,d,e,f,g){return this.sendGenericDataMessageRequest(a,c,d,e,f,g,[],b("ZenonScreenSharingConstants").ZenonScreenSharingDataMessageTopic.End,JSON.stringify((a={},a[b("ZenonScreenSharingConstants").SCREEN_SHARE_DATA_USER_ID_KEY]=f,a)))};c.sendGenericDataMessageRequest=function(a,c,d,e,f,g,h,i,j){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").DATA_MESSAGE,c,d,e);d={message:{body:{genericMessage:{data:j,topic:i}},header:{recipients:g,sender:f,serviceRecipients:h,topic_DEPRECATED:""}}};e={dataMessageRequest:d};j=this.$1(a,c,e);return this.$2(j)};c.sendSubscriptionRequest=function(a,c,d,e,f){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").SUBSCRIPTION,c,d,f);d={subscriptions:e};f={subscriptionRequest:d};e=this.$1(a,c,f);return this.$2(e)};c.sendClientMediaUpdateRequest=function(a,c,d,e,f,g,h,i){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").CLIENT_MEDIA_UPDATE,c,d,h);d={fromVersion:e,toVersion:f,mediaUpdates:g};i!=null&&(d.offer={sdpString:i.toSdp()});h={clientMediaUpdateRequest:d};e=this.$1(a,c,h);return this.$2(e)};c.sendUpdateRequest=function(a,c,d,e,f,g,h){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").UPDATE,c,d,e);d={topic:f,version:g};h!=null&&(d.data=h);e={updateRequest:d};f=this.$1(a,c,e);return this.$2(f)};c.sendUnsubscribeRequest=function(a,c,d,e,f,g){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").UNSUBSCRIBE,c,d,e);d={topic:f,version:g};e={unsubscribeRequest:d};f=this.$1(a,c,e);return this.$2(f)};c.sendApprovalRequest=function(a,c,d,e,f,g){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").APPROVAL,c,d,e);d={targetUsers:f,approvalStatus:g};e={approvalRequest:d};f=this.$1(a,c,e);return this.$2(f)};c.$2=function(a){var c=a.jsonPayload.header,d=c.conferenceName;c=c.type;d||b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchMultiwayRequests._sendMessage: no conference name. Msg type: "+b("FBRTCLogger").multiwayMessageTypeName(c)});return new(b("Promise"))(function(c,d){var e=b("XGroupCallSendRequestController").getURIBuilder().getURI(),f=new(b("ScotchFBRTCMultiwayMessage"))(a);b("FBRTCLogger").getInstance().logSendingMultiwayMessage(f);e=new(b("AsyncRequest"))(e).setMethod("POST").setData({request:JSON.stringify(a)}).setAllowCrossPageTransition(!0).setHandler(function(a){b("FBRTCLogger").getInstance().logMultiwayResponseReceived(a.payload,f.header().clientSessionId),b("FBRTCLogger").getInstance().logSentMultiwayMessage(f),c(a.payload)}).setErrorHandler(function(a){b("FBRTCLogger").getInstance().logSendMultiwayMessageFailed(f);a=a.getErrorDescription();a=a!=null?a.toString():"AsyncRequest error";b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchMultiwayRequests._sendMessage error: "+a});a=Error(a);d(a)}).setTimeoutHandler(g,function(){b("FBRTCLogger").getInstance().logSendMultiwayMessageFailed(f),d("timeout")});e.send()})};c.$1=function(a,b,c){return{endpoint:a,jsonPayload:{header:b,body:c}}};return a}();c=new a();e.exports=c},null);
__d("ZenonRTCVideoResolutionHelper",["ZenonExperiments","gkx","qex","recoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){}a.getMaxParticipants180=function(){var a;return(a=b("qex")._("1437297"))!=null?a:0};a.getMaxParticipants360=function(){var a;return(a=b("qex")._("1437296"))!=null?a:0};a.getMaxParticipants720=function(){var a;return(a=b("qex")._("1437295"))!=null?a:0};a.shouldUseSupportedScaleFactorList=function(){var a;return(a=b("gkx")("1742654"))!=null?a:!1};a.shouldUseConservativeWayWhenSearchingForScalingRatio=function(){var a;return(a=b("gkx")("1761876"))!=null?a:!1};a.getMaxEncResolution=function(b){var c=a.getMaxParticipants720(),d=a.getMaxParticipants360(),e=a.getMaxParticipants180(),f={height:720,width:1280},g={height:360,width:640},h={height:180,width:320};if(c>0&&b<=c)return f;if(d>0&&b<=d)return g;if(e>0&&b<=e)return h;if(e>0)return h;if(d>0)return g;return c>0?f:null};a.getMaxEncResolutionSimulcast=function(a,c,d){var e={height:720,width:1280},f={height:360,width:640},g={height:180,width:320};if(c<=d&&d<=2&&c>=0)if(d===1)if(c===d)return a>2?f:e;else return g;else{if(c===d)return e;if(c===d-1)return f;if(c===d-2)return g}b("recoverableViolation")("Unsupported simulcast parameters passed to getMaxEncResolutionSimulcast","rtc_www");return null};a.getScalingFactor=function(b,c,d,e,f){f===void 0&&(f=!1);if(b.width==null||b.width<=0||b.height==null||b.height<=0||c.width==null||c.width<=0||c.height==null||c.height<=0)return null;var g=c.width;c=c.height;var h=b.width;b=b.height;if(f){f=[1,2,4];var i=Math.sqrt(g*c/(h*b));if(i<1+e)return 1;var j=1,k=Number.MAX_VALUE;for(var l=0;l<f.length;l++){var m=f[l],n=Math.abs(m-i);(a.shouldUseConservativeWayWhenSearchingForScalingRatio()?n<k:n<=k)&&Math.floor(g/m)%2===0&&Math.floor(c/m)%2===0&&(j=m,k=Math.abs(m-i))}return j}else{n=Math.sqrt(g*c/(h*b));if(n<1+e)return 1;return d?Math.floor(n+e):n}};a.encoderScalingEnabled=function(){return b("ZenonExperiments").limitEncodeResolutionEnabled()};a.maybeLimitEncodingResolutionByParticipantCountHelper=function(c,d,e,f){if(!a.encoderScalingEnabled()||f)return;f=d.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});d=f.length;f=d+1;d=a.getMaxEncResolution(f);if(!d)return;f=[d];a.maybeLimitEncodingResolution(c,f,b("ZenonExperiments").integerScaling(),b("ZenonExperiments").minThresholdScalingPct()/100,e,a.shouldUseSupportedScaleFactorList())};a.maybeLimitEncodingResolution=function(b,c,d,e,f,g){g===void 0&&(g=!1);b=b.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});if(b.length>0){var h;b=b[0];var i=b.getParameters();h=(h=b.track)==null?void 0:h.getSettings();if(!h)return;if(c.length!==i.encodings.length)return;for(var c=c.entries(),j=Array.isArray(c),k=0,c=j?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=c.length)break;l=c[k++]}else{k=c.next();if(k.done)break;l=k.value}l=l;var m=l[0];l=l[1];l=f?1:a.getScalingFactor(l,{height:h.height,width:h.width},d,e,g);if(l==null)continue;l===1?delete i.encodings[m].scaleResolutionDownBy:i.encodings[m].scaleResolutionDownBy=l}b.setParameters(i)}};a.maybeLimitEncodingResolutionByParticipantCount=function(b,c,d){return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,a.$1>0,d)};a.handleStartScreenSharing=function(b,c,d){a.$1++;return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,a.$1>0,d)};a.handleStopScreenSharing=function(b,c,d){a.$1--;return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,a.$1>0,d)};return a}();e.exports=a;a.$1=0},null);
__d("ZenonSimulcastManager",["ZenonRTCVideoResolutionHelper"],function(a,b,c,d,e,f){"use strict";f.getSimulcastEncodingParameters=a;f.getSimulcastSingleLayerParameters=c;f.getSimulcastLayerToTargetBitrateMap=i;f.getSimulcastSsrcToLayerMap=d;var g=25e5,h=5e3;function a(a,b,c,d,e,f,m,n,o,p){e===void 0&&(e=!1);f===void 0&&(f={height:720,width:1280});m===void 0&&(m=!0);n===void 0&&(n=!0);o===void 0&&(o=1);p===void 0&&(p=1);d=i(b.perSsrcTargetBitrateBpsMap,d);var q=0,r=[],s=[];for(var t=0;t<a.encodings.length;t++)if(k(t,b.qualityMask)){q++;r.push(j(t,a.encodings.length-1,c,f,e));var u=d.get(t);u!=null?s.push(u):s.push(g)}u=!1;for(var f=0;f<a.encodings.length;f++)if(f<q){t=a.encodings[f].scaleResolutionDownBy!==r[f];d=a.encodings[f].maxBitrate;c=s[f];b=d==null||c<d*p||c>d*o||c<d&&d-c>h;if(t||b||n){u=!0;break}}for(var d=0;d<a.encodings.length;d++)d<q?(a.encodings[d].active=!0,a.encodings[d].scaleResolutionDownBy=r[d],q===1?a.encodings[d].maxBitrate=g:u&&(a.encodings[d].maxBitrate=s[d])):a.encodings[d].active=!1;e&&!m&&l(a);return{params:a,updated:u}}function c(a){for(var b=0;b<a.encodings.length;b++)b===0?(a.encodings[b].active=!0,a.encodings[b].scaleResolutionDownBy=1,a.encodings[b].maxBitrate=g):a.encodings[b].active=!1;return a}function i(a,b){var c=new Map();if(a==null||b==null)return c;for(var b=b,d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];g=a.get(g);g!=null&&c.set(f,g)}return c}function j(a,c,d,e,f){e===void 0&&(e={height:720,width:1280});f===void 0&&(f=!1);if(f)return 1;f=b("ZenonRTCVideoResolutionHelper").getMaxEncResolutionSimulcast(d,a,c);return!f?1:(d=b("ZenonRTCVideoResolutionHelper").getScalingFactor(f,e,!0,0,b("ZenonRTCVideoResolutionHelper").shouldUseSupportedScaleFactorList()))!=null?d:1}function k(a,b){return(1<<a&b)!==0}function l(a){for(var b=1;b<a.encodings.length;b++)a.encodings[b].active=!1}function d(a){var b=new Map(),c="\r\n";a=a.split(c).filter(function(a){return a.startsWith("a=ssrc-group:SIM")});if(a.length===0)return b;c=a[0].split(" ").slice(1);for(var a=0;a<c.length;a++)b.set(c[a],a);return b}},null);
__d("ScotchRTCMWProtocolHandler",["invariant","Promise","regeneratorRuntime","ChannelManager","CurrentUser","DateConsts","FBLogger","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCLogger","FBRTCRtcResponseStatusCode","FBRTCVideoQuality","MercuryIDs","ScotchFBRTCGroupCallStore","ScotchFBRTCMediaMetricParser","ScotchFBRTCMWProtocolStore","ScotchFBRTCPeerConnection","ScotchFBRTCSdpUtils","ScotchFBRTCStatsHelpers","ScotchgenerateRTCCallID","ScotchMessengerChatLinksFunnelLogger","ScotchMultiwayParticipantFetcher","ScotchMultiwayRequests","ScotchRTCAppData","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCGroupCallEscalationStore","ScotchRTCMultiwayMessageHandler","ScotchRTCProxyUserStore","ScotchRTCProxyUserUtils","ScotchRTCSessionDescription","ScotchRTCSignalingExperiments","ScotchRTCUtils","ScotchRTWebClientFeatureGating","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","UserAgent","ZenonLocalMediaSDK","ZenonPlatformExperiments","ZenonRTCVideoResolutionHelper","ZenonRTWebBrowserFeatureSupport","ZenonSimulcastManager","ZenonTSLogDataHelper","emptyFunction","gkx","immutable","promiseDone","qex","recoverableViolation","requireCond","cr:1420073"],function(a,b,c,d,e,f,g){"use strict";var h=30*b("DateConsts").MS_PER_SEC,i={appId:b("ScotchRTCAppData").getMWAppID(),deviceId:b("ChannelManager").getCompleteConfig().sessionID,userId:b("CurrentUser").getID()},j=250,k=null,l=function(){function a(a){var c=this;this.$9=!1;this.$10=!1;this.$11=!1;this.$12=b("FBRTCLogger").getInstance();this.$13=Date.now();this.$18=function(a){a=a.target;a=a.iceConnectionState;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"RTCMWProtocolHandler_PC_iceconnectionstatechange: "+a});b("ScotchRTCCallActions").emit("onIceConnectionStateChange",a);var d=b("ScotchRTCCallStore").getState();d=d.callSummary;d==null?void 0:d.setPCIsConnected(a==="completed"||a==="connected");b("gkx")("965758")&&b("ZenonTSLogDataHelper").onIceConnectionStateChange(a);switch(a){case"completed":case"connected":window.clearTimeout(c.$7);c.$7=null;b("FBRTCLogger").getInstance().logMultiwayRelayConnected(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,c.$5.toString());d==null?void 0:d.onNetworkReady();b("ScotchFBRTCMediaMetricParser").startCollectingMediaStats();break;case"disconnected":case"failed":c.$7||(c.$7=window.setTimeout(function(){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Ending call due to iceConnectionState disconnection timeout"}),b("ScotchRTCCallActions").endCall(b("FBRTCConstants").CallEndReason.CONNECTION_DROPPED,"ConnectionDropped"),c.$26()},h));break}d==null?void 0:d.save(b("FBRTCCallSummaryStore").getInstance())};this.$5=(a=a)!=null?a:b("ScotchgenerateRTCCallID")();this.$6="MW_PEER_ID"}var c=a.prototype;c.setKeepLocalStreamsOnClose=function(a){this.$10=a;return this};c.setAllowIncomingCalls=function(a){this.$11=a;return this};c.startCall=function(c,d,e,f){var g=this,h=f.addStreamCallback;h=h===void 0?b("emptyFunction"):h;var i=f.callTrigger,j=f.formatParameters;j=j===void 0?{}:j;var k=f.preferredCodecs;k=k===void 0?{}:k;var l=f.offerSdpTransform,m=f.serverInfoData,n=f.shouldSetDescriptions;n=n===void 0?!0:n;var o=f.isEscalatedCall;o=o===void 0?!1:o;var p=f.connectedOnJoin;p=p===void 0?!1:p;var q=f.escP2PCallID;q=q===void 0?"":q;f=f.initialSyncStates;f=f===void 0?null:f;b("ScotchRTCCallActions").initialize({protocol:b("FBRTCConstants").SignalingProtocol.MULTIWAY,conferenceName:e,serverInfoData:m,callID:this.$5.toString(),callTrigger:i});b("ScotchMessengerChatLinksFunnelLogger").appendAction("init_mw_call",{funnelTags:["conf_name:"+e,"call_id:"+this.$5]});var r=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),this.$6,this.$5,!1);i&&r.onCallStarted(i);r.setJoinWithSID(m!=null);r.setActiveConnection("mws");r.setCallType("mws");r.onPopupOpened();r.setConferenceName(e);r.setServerInfoData(m);if(o){var s=b("ScotchRTCCallStore").getState().callSummary;r.setEscalationP2PCallID(s.callID)}this.$14(r);r.save(b("FBRTCCallSummaryStore").getInstance());b("ScotchRTCCallActions").setCallSummary(r);s={mandatory:{},optional:[{DtlsSrtpKeyAgreement:!1},{googNumUnsignalledRecvStreams:10},{RtpDataChannels:!0}]};var t=new(b("ScotchFBRTCPeerConnection"))(b("FBRTCConstants").SignalingProtocol.MULTIWAY,{iceServers:[]},s);if(e.split(":")[0]!=="LIVE"&&!(b("UserAgent").isBrowser("Safari")||b("UserAgent").isBrowser("Mobile Safari"))){s=t.createDataChannel("data");s&&(s.onmessage=function(a){a=a.data;try{a=JSON.parse(a);a=a.body;g.$15(a)}catch(a){g.$12.logError(g.$6,g.$5,a)}})}t.getSdpSemantics()===b("FBRTCConstants").SDPSemantics.UNIFIED_PLAN?t.addEventListener("track",function(b){g.$16(e,t,b),a.maybeLimitEncodingResolutionByParticipantCount(t)}):t.addEventListener("addstream",function(c){g.$17(e,c.stream),a.maybeLimitEncodingResolutionByParticipantCount(t),a.updateLocalEncodingActive(t,b("ScotchFBRTCGroupCallStore").getState().forceEncodingEnabled)});t.addEventListener("removestream",function(c){b("ScotchRTCCallActions").removeRemoteStream(c.stream),a.maybeLimitEncodingResolutionByParticipantCount(t),a.updateLocalEncodingActive(t,b("ScotchFBRTCGroupCallStore").getState().forceEncodingEnabled)});t.addEventListener("iceconnectionstatechange",this.$18);this.$19(t,d,e,m,c,h,j,k,n,o,p,q,i?i:r.getCallTrigger(),l,f);!m?b("ScotchRTCCallActions").call(c,t):b("ScotchRTCCallActions").join(t);return t};c.$14=function(a){b("promiseDone")(b("ScotchFBRTCStatsHelpers").getBatteryStats(),function(c){a.addExtraInfo(b("FBRTCLogger").Key.BATTERY_START,c.level)})};c.$16=function(c,d,e){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:this.$5.toString(),checkpoint:"ScotchRTCMWProtocolHandler_onAddTrack",conferenceName:c});a.resubscribeToRemoteFbids();if(d.getSdpSemantics()===b("FBRTCConstants").SDPSemantics.UNIFIED_PLAN){var f,g;g=(g=e)!=null?(g=g.track)!=null?g.id:g:g;f=(f=e)!=null?(f=f.transceiver)!=null?f.mid:f:f;if(f===void 0){var h;f=(h=e.target.getTransceivers().find(function(a){return a.receiver===e.transceiver.receiver}))==null?void 0:h.mid}d.processUnifiedTrackIdTranslation(g,f)}e.streams.length>0&&this.$17(c,e.streams[0])};c.$17=function(c,d){var e=this;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:this.$5.toString(),checkpoint:"ScotchRTCMWProtocolHandler_onAddStream. Stream id="+d.id,conferenceName:c});a.resubscribeToRemoteFbids();d.addEventListener("addtrack",function(){a.resubscribeToRemoteFbids()});var f=d.id.split(":")[0],g=b("MercuryIDs").getParticipantIDFromUserID(f);if(f!==b("CurrentUser").getID()){f=b("ScotchRTCProxyUserUtils").getUserIDToFetch(f);var h=b("ScotchRTCProxyUserStore").getState();h=h.proxyingAsToProxyUser;b("promiseDone")(b("ScotchMultiwayParticipantFetcher").fetchAllParticipants(c,b("immutable").Set([f]),{proxyingAsToProxyUser:h}),function(a){a=a.get(g);e.$20(g,a,d)})}};c.$20=function(c,d,e){var f={};f[c]=d;b("ScotchRTCGroupCallActions").onParticipantsAdded(f);b("ScotchRTCCallActions").addRemoteStream(e);c=b("ScotchRTCCallStore").getState();d=c.callInfo;f=b("ScotchFBRTCGroupCallStore").getState();e=f.layout;c=f.pinnedSpeakerFBID;f=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);f&&a.subscription(d.conferenceName,d.serverInfoData,f.getRemoteStreams(),e,c)};c.$21=function(a){var c=new Map();Object.keys(a).forEach(function(d){var e=parseInt(a[d],10);if(isNaN(e)){b("recoverableViolation")("Simulcast bitrate string could not be parsed as int","rtc_www");return}c.set(d,e)});return c};c.$15=function(a){a.dominantSpeakerNotification&&this.$22(a.dominantSpeakerNotification);if(a.videoUploadRequest){var b=null;a.videoUploadRequest.perSsrcTargetBitrateBpsMap&&(b=this.$21(a.videoUploadRequest.perSsrcTargetBitrateBpsMap));b={perSsrcTargetBitrateBpsMap:b,qualityMask:a.videoUploadRequest.qualityMask};this.$23(b)}};c.setDescriptions=function(){this.$9=!0;var a=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);this.$8&&a&&a.setRemoteDescription(this.$8)};a.maybeLimitEncodingResolutionByParticipantCount=function(a){b("ZenonRTCVideoResolutionHelper").maybeLimitEncodingResolutionByParticipantCount(a.getSenders(),a.getReceivers(),a.supportsSimulcast())};a.escalateLocalStream=function(c){c===void 0&&(c=!0);var d=b("ScotchFBRTCGroupCallStore").getState();d=d.videoEscalateState;if(c&&d!=="initial")return b("Promise").resolve();b("ScotchRTCGroupCallActions").videoEscalationStarted();return a.initStream(c).then(function(a){var d=b("ScotchRTCCallStore").getState(),e=d.callInfo,f=e.conferenceName;e=e.serverInfoData;var g=d.localUser;d=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(!d)return;var h=null;c&&(a.getTracks().forEach(function(a){a.kind==="audio"&&(a.enabled=!g.isAudioDisabled())}),h=g.streams.first(),d.removeStream(h));return n(d,[a],f,e,[]).then(function(){h&&b("ScotchRTCCallActions").removeLocalStream(h),b("ScotchRTCCallActions").addLocalStream(a),b("ScotchRTCGroupCallActions").videoEscalationCompleted()})})["catch"](function(a){b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchFBRTCPeerConnection_escalateLocalStream",errorType:a.toString()}),b("ScotchRTCGroupCallActions").resetVideoEscalation()})};c.onStreamReady=function(a,c,d,e,f){var g={};e||b("ScotchRTCCallActions").addLocalStream(a);g.isEscalatedCall=e;f.p2pCallID&&(g.escP2PCallID=f.p2pCallID);f.serverInfoData&&(g.serverInfoData=f.serverInfoData);f.callTrigger&&(g.callTrigger=f.callTrigger);b("ScotchRTWebClientFeatureGating").preferIsacForGroupCalls()&&(g.preferredCodecs={audio:"ISAC/16000"});this.startCall(c,[a],d,g)};a.initStream=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c===void 0&&(c=!0);e.next=3;return b("regeneratorRuntime").awrap(m(a,c));case 3:d=e.sent;return e.abrupt("return",d);case 5:case"end":return e.stop()}},null,this)};a.updateLocalStream=function(c,d){d===void 0&&(d=!1);var e=b("ScotchRTCCallStore").getState(),f=e.callInfo,g=f.callID,h=f.conferenceName;f=f.serverInfoData;e=e.localUser;var i=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(!i)return b("Promise").resolve();if(b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()&&b("gkx")("1507314")){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"ScotchRTCMWProtocolHandler_updateLocalStream: use replaceTrack to swap media tracks",conferenceName:h});var j=d?e.getStream():e.getActiveStream();if(j!=null){var k=[],l=j.getAudioTracks(),m=l[0];l=j.getVideoTracks();var o=l[0];j=c.getAudioTracks();var p=j[0];l=c.getVideoTracks();var q=l[0];p!=null&&m!=null&&k.push(i.replaceTrack(p,m).then(function(){b("ScotchRTCGroupCallActions").onLocalTrackReplaced(p,m)}));q!=null&&o!=null&&e.hasVideo()&&!e.hasScreenStream()&&k.push(i.replaceTrack(q,o).then(function(){b("ScotchRTCGroupCallActions").onLocalTrackReplaced(q,o),a.maybeLimitEncodingResolutionByParticipantCount(i)}));return b("Promise").all(k).then(function(){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"ScotchRTCMWProtocolHandler_updateLocalStream: dispatch actions to Flux store",conferenceName:h}),b("ScotchRTCCallActions").removeAllLocalStreams(d===!1),b("ScotchRTCCallActions").addLocalStream(c)})["catch"](function(a){b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchRTCMWProtocolHandler_updateLocalStream",errorType:a.message})})}}return n(i,[c],h,f,[]).then(function(){b("ScotchRTCCallActions").removeAllLocalStreams(!0),b("ScotchRTCCallActions").addLocalStream(c)})};a.updateLocalEncodingActive=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(b("qex")._("1755786")){f.next=2;break}return f.abrupt("return");case 2:d=a.getRemoteStreams().length;e=d>0||c;f.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(a.getSenders().map(function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.prev=0;c=a.getParameters();c.encodings.forEach(function(a){a.active=e});d.next=5;return b("regeneratorRuntime").awrap(a.setParameters(c));case 5:d.next=10;break;case 7:d.prev=7,d.t0=d["catch"](0),b("FBLogger")("rtc_www").catching(d.t0).mustfix("Error while trying to toggle encoding");case 10:case"end":return d.stop()}},null,this,[[0,7]])})));case 6:case"end":return f.stop()}},null,this)};a.startScreenStream=function(a){var c=b("ScotchRTCCallStore").getState(),d=c.callInfo,e=d.callID,f=d.conferenceName;d=d.serverInfoData;var h=c.localUser;c=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);var i=b("ScotchFBRTCMWProtocolStore").getState(),j=i.localScreenDurationTracker;if(!c)return;b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()||g(0,21463);b("ZenonRTCVideoResolutionHelper").handleStartScreenSharing(c.getSenders(),c.getReceivers(),c.supportsSimulcast());i=c.getSenders().find(function(a){return a.track&&a.track.kind==="video"});var k=i==null?void 0:i.track;if(i===void 0||!k){var l=h.getStream();l!=null&&b("ScotchRTCUtils").transferAudioTracks(a,l);l=n(c,[a],f,d,[])}else l=b("Promise").resolve(i.replaceTrack(a.getVideoTracks()[0])).then(function(){b("ScotchRTCGroupCallActions").onLocalTrackReplaced(a.getVideoTracks()[0],k)});b("promiseDone")(l,function(){for(var c=h.screenStreams,d=Array.isArray(c),g=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(d){if(g>=c.length)break;i=c[g++]}else{g=c.next();if(g.done)break;i=g.value}i=i;i!==a&&(b("ScotchRTCCallActions").removeLocalScreenStream(i),b("ScotchRTCUtils").stopMediaStream(i))}j.track(a);!j.isStarted()?j.start():j.update();b("ScotchRTCCallActions").addLocalScreenStream(a);b("ScotchRTWebUserActionLogger").logCheckpoint({callID:e,checkpoint:"screen_sharing_started",conferenceName:f})})};a.updateScreenStream=function(b,c){a.startScreenStream(c)};a.replaceScreenTrackWithVideo=function(a,c,d){if(!b("ZenonRTCVideoResolutionHelper").encoderScalingEnabled())a.replaceTrack(c);else{a=b("Promise").resolve(a.replaceTrack(c));b("promiseDone")(a,function(){b("ZenonRTCVideoResolutionHelper").handleStopScreenSharing(d.getSenders(),d.getReceivers(),d.supportsSimulcast())},function(a){b("ZenonRTCVideoResolutionHelper").handleStopScreenSharing(d.getSenders(),d.getReceivers(),d.supportsSimulcast())})}};a.stopScreenStream=function(c){var d,e=b("ScotchRTCCallStore").getState(),f=e.callInfo;e=e.localUser;var h=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY),i=b("ScotchFBRTCMWProtocolStore").getState();i=i.localScreenDurationTracker;if(!h)return;b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()||g(0,21463);d=(d=e.getStream())==null?void 0:d.getVideoTracks();if(d&&d.length>0){var j=h.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});a.replaceScreenTrackWithVideo(j[0],d[0],h);b("ScotchRTCGroupCallActions").onLocalTrackReplaced(d[0],(h=j[0])==null?void 0:h.track)}else{d=e.getStream();d!=null&&b("ScotchRTCUtils").transferAudioTracks(d,c)}b("ScotchRTCCallActions").removeLocalScreenStream(c);b("ScotchRTCUtils").stopMediaStream(c);i.update();b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f.callID,checkpoint:"screen_sharing_stopped",conferenceName:f.conferenceName})};a.endCall=function(c,d,e,f){f===void 0&&(f=""),b("promiseDone")(a.genEndCall(c,e,{serverInfoData:d,detailedReasonString:f,keepLocalStream:!1}))};a.genEndCall=function(a,c,d){var e=b("ScotchRTCCallStore").getState(),f=e.callSummary;e=e.callInfo;var g=b("ScotchFBRTCMWProtocolStore").getState();g=g.localScreenDurationTracker;d.keepLocalStream||b("ScotchRTCCallActions").removeAllLocalStreams(!0);b("ScotchRTCCallActions").removeAllLocalScreenStreams(!0);var h=d.detailedReasonString||"Hangup by user";b("ScotchRTCCallActions").hangup(b("ScotchRTCUtils").endCallReasonFromHangupReason(c),h);if(b("gkx")("965758")){e=b("ZenonTSLogDataHelper").serialize(e.tsLogData);b("FBRTCLogger").getInstance().logTsLogData(e,f.peerID,f.callID,a,d.serverInfoData)}g.stop();f.setScreenDuration(g.getDuration());return b("ScotchMultiwayRequests").sendHangupRequest(i,a,d.serverInfoData,c,h,b("ScotchRTCCallStore").getState().callInfo.callID).then(function(){b("ScotchRTCCallActions").hangupSuccess()})["catch"](function(a){b("ScotchRTCCallActions").hangupError();throw a})};a.otherUserInAnotherCall=function(a,c,d,e,f){f===void 0&&(f=""),b("promiseDone")(b("ScotchMultiwayRequests").sendHangupRequest(i,a,c,d,f||"User receiving this call is in another call",e))};c.iceRestart=function(a,c){var d=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);d&&n(d,[],a,c,[],{iceRestart:!0})};a.addParticipants=function(a,c,d){return b("ScotchMultiwayRequests").sendAddParticipantsRequest(i,a,c,d,b("ScotchRTCCallStore").getState().callInfo.callID)};a.removeParticipants=function(a,c,d){return b("ScotchMultiwayRequests").sendRemoveParticipantsRequest(i,a,c,d,b("ScotchRTCCallStore").getState().callInfo.callID)};a.notifyScreenShareStart=function(a){var c=b("ScotchRTCCallStore").getState(),d=c.callInfo;c=c.localUser;var e=d.callID,f=d.conferenceName;d=d.serverInfoData;return b("ScotchMultiwayRequests").sendStartScreenSharingRequest(i,f,d,e,c.FBID,a)};a.notifyScreenShareEnd=function(a){var c=b("ScotchRTCCallStore").getState(),d=c.callInfo;c=c.localUser;var e=d.callID,f=d.conferenceName;d=d.serverInfoData;return b("ScotchMultiwayRequests").sendEndScreenSharingRequest(i,f,d,e,c.FBID,a)};a.sendGenericDataMessageRequest=function(a,c,d,e){var f=b("ScotchRTCCallStore").getState(),g=f.callInfo;f=f.localUser;var h=g.callID,j=g.conferenceName;g=g.serverInfoData;return b("ScotchMultiwayRequests").sendGenericDataMessageRequest(i,j,g,h,f.FBID,d,Array.from(e),a,c)};a.subscription=function(a,c,d,e,f){if(!b("gkx")("1390244")){var g=e===b("FBRTCConstants").GroupVideoViewLayout.DOMINANT_SPEAKER?b("FBRTCVideoQuality").LOW:e===b("FBRTCConstants").GroupVideoViewLayout.GRID?b("FBRTCVideoQuality").MEDIUM:b("FBRTCVideoQuality").HIGH;d=d.map(function(a){a=a.id;return{cname:a,options:{videoQuality:e===b("FBRTCConstants").GroupVideoViewLayout.DOMINANT_SPEAKER&&f===a.split(":")[0]?b("FBRTCVideoQuality").HIGH:g}}});e===b("FBRTCConstants").GroupVideoViewLayout.DOMINANT_SPEAKER&&!f&&d.push({cname:""});b("ScotchMultiwayRequests").sendSubscriptionRequest(i,a,c,d,b("ScotchRTCCallStore").getState().callInfo.callID)}};a.subscriptionV2=function(c,d){c=c.map(function(a){var b=a.stream;a=a.videoQuality;return{cname:b.id,options:{videoQuality:a}}});d&&c.push({cname:""});!b("gkx")("1414812")?a.$24(c):a.$1!=null?a.$2=c:(a.$24(c),a.$1=window.setTimeout(function(){a.$2!=null&&(a.$24(a.$2),a.$2=null),window.clearTimeout(a.$1),a.$1=null},j))};a.subscribeToRemoteFbids=function(c,d){a.$3=c;a.$4=d;var e=b("ScotchRTCCallStore").getState(),f=e.callInfo,g=f.callID,h=f.conferenceName,i=f.conferenceState;f=f.protocol;var j=e.remoteUsers;e=i==="TERMINATED"||i==="TERMINATING";e&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({callID:g,checkpoint:"subscribeToRemoteVideo when call terminated or terminating",conferenceName:h});if(f==="multiway"&&!e){var k=[],l=[];c.forEach(function(a){var b=a.user;a=a.videoQuality;var c=j.find(function(a){return a.FBID===b});if(!c){l.push({error:"remote user doesn't exist",user:b});return}c=c.getActiveStream();c&&c.getVideoTracks().length>0?k.push({stream:c,videoQuality:a}):l.push({error:"no active video track found",user:b})});l.length>0&&b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchUtils.subscribeToRemoteVideo: missing subscriptions: "+JSON.stringify(l)});a.subscriptionV2(k,d)}};a.resubscribeToRemoteFbids=function(){var b=a.$3,c=a.$4;b!=null&&a.subscribeToRemoteFbids(b,c)};a.$24=function(a){var c=b("ScotchRTCCallStore").getState();c=c.callInfo;var d=c.conferenceName,e=c.serverInfoData,f=c.callID;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:c.callID,checkpoint:"SendingSubscriptionRequest:"+JSON.stringify(a),conferenceName:c.conferenceName});b("ScotchMultiwayRequests").sendSubscriptionRequest(i,d,e,a,f)};a.clientMediaUpdate=function(a,c,d,e,f,g){var h=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchMultiwayRequests").sendClientMediaUpdateRequest(i,a,c,d,e,f,b("ScotchRTCCallStore").getState().callInfo.callID,g).then(function(c){var d,e,f,g,i,j,k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:d=c.header,e=c.body.clientMediaUpdateResponse,f=e.currentVersion,g=e.answer,i=e.mediaStatus;j=d.responseStatusCode,k=d.transactionId;if(!(g!=null&&b("ZenonPlatformExperiments").shouldUseLobbyMode()&&j==b("FBRTCRtcResponseStatusCode").OK)){p.next=16;break}b("ScotchRTWebUserActionLogger").logCheckpoint({callID:h,checkpoint:"[WR] Received answer SDP in CMU response and lobby mode is enabled: "+JSON.stringify({transactionId:k}),conferenceName:a});l=new(b("ScotchRTCSessionDescription"))(b("FBRTCConstants").SignalingProtocol.MULTIWAY,{type:"answer",sdp:g.sdpString});m=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(!(m==null)){p.next=9;break}b("recoverableViolation")("Peer Connection should not be null if renegotiation is requested","rtc_www");return p.abrupt("return");case 9:b("ScotchRTWebUserActionLogger").logCheckpoint({callID:h,checkpoint:"[WR] ScotchRTCMWProtocolHandler_onClientMediaUpdateResponse setting remote description: "+JSON.stringify({transactionId:k}),conferenceName:a});p.next=12;return b("regeneratorRuntime").awrap(m.setRemoteDescription(l));case 12:n=i,m.getSdpSemantics()===b("FBRTCConstants").SDPSemantics.UNIFIED_PLAN&&(o={},Object.keys(n).forEach(function(a){var b=m.getWebrtcTrackIdFromMWTrackId(a);o[b]=n[a]}),n=o),b("ScotchRTCGroupCallActions").toggleRemoteStream(n,h),b("ScotchRTCCallActions").callSuccess(!0);case 16:b("FBRTCLogger").getInstance().logMultiwayResponseProcessed(d,h),b("ScotchRTCGroupCallActions").onClientMediaUpdateResponse(j,f);case 18:case"end":return p.stop()}},null,this)})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};a.sendUpdateRequest=function(a,c,d,e,f){var g=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"[SS] Update request for topic: "+d+" and version "+e+" is being sent",conferenceName:a});b("ScotchMultiwayRequests").sendUpdateRequest(i,a,c,b("ScotchRTCCallStore").getState().callInfo.callID,d,e,f).then(function(d){var f=d.header,h=f.responseStatusCode;f=f.responseSubCode;d=d.body.updateResponse;var c=d.topic;d=d.version;h!==b("FBRTCRtcResponseStatusCode").OK&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"MW response status code "+h+" with subcode: "+f+" to update request",conferenceName:a});d!=e&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"Update response for topic "+c+" had version "+d+" which did not match sent version "+e,conferenceName:a})})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};a.sendUnsubscribeRequest=function(a,c,d,e){var f=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchMultiwayRequests").sendUnsubscribeRequest(i,a,c,f,d,e).then(function(d){var g=d.header,h=g.responseStatusCode;g=g.responseSubCode;d=d.body.updateResponse;var c=d.topic;d=d.version;h!==b("FBRTCRtcResponseStatusCode").OK&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f,checkpoint:"MW response status code "+h+" with subcode: "+g+" to update request",conferenceName:a});d!=e&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f,checkpoint:"Unsubscribe response for topic "+c+" had version "+d+" which did not match sent version "+e,conferenceName:a})})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};a.sendApprovalRequest=function(a,c,d,e){var f=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchMultiwayRequests").sendApprovalRequest(i,a,c,f,d,e).then(function(c){c=c.header;var d=c.responseStatusCode;c=c.responseSubCode;d!==b("FBRTCRtcResponseStatusCode").OK&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f,checkpoint:"MW response status code "+d+" with subcode: "+c+" to approval request",conferenceName:a})})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};c.$19=function(a,c,d,e,f,g,h,i,j,k,l,m,o,p,q){var r=this;this.$25(d,e);b("promiseDone")(n(a,c,d,e,f,{},g,h,i,j,k,m,o,p,q),function(a){a!=null&&(r.$8=a,r.$9&&r.setDescriptions()),b("ScotchRTCCallActions").callSuccess(a==null?!1:l)},function(a){a==="timeout"?b("ScotchRTCCallActions").endCall(b("FBRTCConstants").CallEndReason.INCOMING_TIMEOUT):b("ScotchRTCCallActions").callError(a.responseStatusCode,a.responseSubCode),r.$26()})};c.$26=function(){var a=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);a&&a.close();this.$10||b("ScotchRTCCallActions").removeAllLocalStreams(!0)};c.$25=function(a,c){k==null&&(k=new(b("ScotchRTCMultiwayMessageHandler"))()),k.initialize(a,c,this.$11,this.$10)};c.$22=function(a){a=a.userId;if(b("ScotchFBRTCGroupCallStore").getState().dominantSpeakerFBID===a)return;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:this.$5.toString(),checkpoint:"newDominantSpeakerID: "+a});b("ScotchRTCGroupCallActions").setDominantSpeaker(a)};c.$23=function(a){var c=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(c==null)return;if(!c.supportsSimulcast())return;var d=c.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(d.length==0)return;d=d[0];var e=!1,f=b("ScotchRTCCallStore").getState();f=f.localUser;f=f.getScreenStream();f&&f.getTrackById((f=d.track)==null?void 0:f.id)!=null&&(e=!0);f=c.getReceivers().filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});var g=Date.now()-this.$13;a=b("ZenonSimulcastManager").getSimulcastEncodingParameters(d.getParameters(),a,f.length+1,c.getSsrcToSimulcastLayerMap(),e,{height:(f=(a=d.track)==null?void 0:a.getSettings().height)!=null?f:720,width:(e=(c=d.track)==null?void 0:c.getSettings().width)!=null?e:1280},(a=b("qex")._("1718199"))!=null?a:!0,g>=((f=b("qex")._("1728155"))!=null?f:0),(c=b("qex")._("1722576"))!=null?c:1,(e=b("qex")._("1722577"))!=null?e:1);g=a.params;f=a.updated;d.setParameters(g);f&&(this.$13=Date.now())};a.maybeLimitBitrate=function(a){a=a.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(a.length>0&&b("ScotchRTCSignalingExperiments").shouldCapMWBitrate()){a=a[0];var c=a.getParameters();c.encodings[0].maxBitrate=72e4;b("Promise").resolve(a.setParameters(c))}};return a}();e.exports=l;l.$1=null;l.$2=null;l.$3=null;l.$4=!1;function m(a,c){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d={requestAudio:c};e={requestVideo:a,width:{ideal:b("FBRTCConstants").RTCConstraints.HD_WIDTH},height:{ideal:b("FBRTCConstants").RTCConstraints.HD_HEIGHT},frameRate:{ideal:b("FBRTCConstants").RTCConstraints.FRAME_RATE}};g.next=4;return b("regeneratorRuntime").awrap(b("ZenonLocalMediaSDK").getUserMedia(d,e));case 4:f=g.sent;return g.abrupt("return",f[0].webrtcStream);case 6:case"end":return g.stop()}},null,this)}function n(a,c,d,e,f,g,h,j,m,n,o,p,q,r,s){var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y;return b("regeneratorRuntime").async(function(Z){while(1)switch(Z.prev=Z.next){case 0:g===void 0&&(g={}),h===void 0&&(h=b("emptyFunction")),j===void 0&&(j={}),m===void 0&&(m={}),n===void 0&&(n=!0),o===void 0&&(o=!1),p===void 0&&(p=""),q===void 0&&(q=""),r===void 0&&(r=[]),v={},w=[],(x=a.getLocalStreams()||[],y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 12:if(!y){Z.next=18;break}if(!(z>=x.length)){Z.next=15;break}return Z.abrupt("break",26);case 15:A=x[z++];Z.next=22;break;case 18:z=x.next();if(!z.done){Z.next=21;break}return Z.abrupt("break",26);case 21:A=z.value;case 22:B=A,a.removeStream(B);case 24:Z.next=12;break;case 26:c.forEach(function(b){w=w.concat(b.getTracks()),a.addStream(b,h)});w.forEach(function(a){v[a.id]=a.enabled});(t=k)==null?void 0:t.setShouldDeferServerRequests(!0);Z.next=31;return b("regeneratorRuntime").awrap(a.createOffer(babelHelpers["extends"]({preserveH264:b("ScotchRTCUtils").isWatchPartyCall(d)||b("gkx")("1406693")},g),{DISABLE_OPUS_STEREO:b("ScotchRTWebClientFeatureGating").disableOpusStereo(),FORMAT_PARAMETERS:j,OFFER_SDP_TRANSFORM:r},m));case 31:C=Z.sent;if(b("ScotchFBRTCSdpUtils").validateOfferSdp(d,C.toSdp())){Z.next=34;break}throw b("FBRTCRtcResponseStatusCode").BAD_REQUEST;case 34:D=b("ScotchFBRTCMWProtocolStore").getState().clientMediaUpdateInfo.lastSyncedClientVersion+1;C.sessionDescription.setVersion(D);b("ScotchRTCGroupCallActions").setLocalClientVersion(D);Z.next=39;return b("regeneratorRuntime").awrap(a.setLocalDescription(C));case 39:(b("ScotchRTCUtils").isGroupCall(d)||b("ScotchRTCUtils").isMessengerCall(d))&&l.maybeLimitBitrate(a);Z.next=42;return b("regeneratorRuntime").awrap(l.updateLocalEncodingActive(a,b("ScotchFBRTCGroupCallStore").getState().forceEncodingEnabled));case 42:E={};F=!1;G=b("ScotchRTCCallStore").getState().callInfo.callID;s!=null&&b("cr:1420073")!=null&&s.forEach(function(c,a){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:G,checkpoint:"[SS] JOIN request with ss payload for topic: "+a+" is being sent",conferenceName:d}),a.localeCompare("simple_external")==0&&(F=!0),E[a]=b("cr:1420073").setUpdatedInputState(a,c),b("ScotchRTCGroupCallActions").setStateSyncSubscribe(a)});if(!(k!=null)){Z.next=49;break}Z.next=49;return b("regeneratorRuntime").awrap(k.waitForSignalingConnected());case 49:b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&(F&&b("FBRTCLogger").getInstance().logCallAction(null,d,"STATE_SYNC_SUBSCRIBE_ON_JOIN","sending subscription to topic simple_external on JOIN request",null));b("ScotchRTCGroupCallActions").onJoinRequestSent();Z.next=53;return b("regeneratorRuntime").awrap(b("ScotchMultiwayRequests").sendJoinRequest(i,d,e,C,f.length>0?f:null,w.length>0?v:null,{callID:G,callTrigger:q,numParticipants:b("ScotchRTCCallStore").getState().remoteUsers.size},{userToEscalate:o&&f.length>0?f[0]:null,isEscalator:b("ScotchRTCGroupCallEscalationStore").getState().toRing,escP2PCallID:p},E.size<=0?null:E));case 53:H=Z.sent;b("FBRTCLogger").getInstance().logMultiwayResponseStartProcessing(H.header,G);I=Date.now();b("ScotchRTCGroupCallActions").onReceivedJoinResponse();J=H.header,K=J.responseStatusCode,L=J.responseSubCode;if(!(K!==b("FBRTCRtcResponseStatusCode").OK)){Z.next=61;break}b("ScotchRTWebUserActionLogger").logCheckpoint({callID:G,checkpoint:"MW response status code "+K+" subcode "+L,conferenceName:d});return Z.abrupt("return",new(b("Promise"))(function(a,b){b({responseStatusCode:K,responseSubCode:L})}));case 61:b("ScotchRTCGroupCallActions").onJoinResponse(H.header.serverInfoData);b("ScotchRTCProxyUserUtils").setProxyingAsUsersFromMessage(H.body.joinResponse);M=Date.now();if(!(H.body.joinResponse.isPendingApproval&&b("ZenonPlatformExperiments").shouldUseLobbyMode())){Z.next=71;break}b("ScotchRTWebUserActionLogger").logCheckpoint({callID:G,checkpoint:"[WR] Received isPendingApproval in JOIN response with lobby mode enabled, not connecting fully",conferenceName:d});b("ScotchRTCGroupCallActions").onPendingApproval();b("ScotchRTCGroupCallActions").onProcessedJoinResponse(G);b("FBRTCLogger").getInstance().logMultiwayResponseProcessedFromResponsePayload(H,G);(N=k)==null?void 0:N.setShouldDeferServerRequests(!1);return Z.abrupt("return",null);case 71:O=new(b("ScotchRTCSessionDescription"))(b("FBRTCConstants").SignalingProtocol.MULTIWAY,{type:"answer",sdp:H.body.joinResponse.answer.sdpString},{FORMAT_PARAMETERS:j});b("ScotchRTWebUserActionLogger").logCheckpoint({callID:G,checkpoint:"ScotchRTCMWProtocolHandler_initPeerConnection shouldSetDescriptions on answer : "+String(n),conferenceName:d});if(!n){Z.next=77;break}b("FBRTCLogger").getInstance().logMultiwaySetRemoteDescription(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData);Z.next=77;return b("regeneratorRuntime").awrap(a.setRemoteDescription(O));case 77:P=Date.now();if(H.body.joinResponse.stateStore!=null&&Object.keys(H.body.joinResponse.stateStore).length>0&&b("cr:1420073")!=null){Q=Object.keys(H.body.joinResponse.stateStore);for(R=0;R<Q.length;R++)S=Q[R],b("ScotchRTWebUserActionLogger").logCheckpoint({callID:G,checkpoint:"[SS] JOIN response with ss payload for topic: "+S+" was received",conferenceName:d}),T=H.body.joinResponse.stateStore[S],b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&(S.localeCompare("simple_external")==0&&b("FBRTCLogger").getInstance().logCallAction(null,d,"STATE_SYNC_OUTPUT_JOIN_RESPONSE","received output state: "+((U=T.data)!=null?U:"")+" on join response for topic simple_external",null)),b("cr:1420073").setOutputState(S,T)}V=Date.now();W=H.body.joinResponse.mediaStatus;a.getSdpSemantics()===b("FBRTCConstants").SDPSemantics.UNIFIED_PLAN&&(X={},Object.keys(W).forEach(function(b){var c=a.getWebrtcTrackIdFromMWTrackId(b);X[c]=W[b]}),W=X);Y=Date.now();b("ScotchRTCGroupCallActions").toggleRemoteStream(W,G);b("ScotchRTCGroupCallActions").onProcessedJoinResponse(G);b("FBRTCLogger").getInstance().logMultiwayResponseProcessedFromResponsePayload(H,G,JSON.stringify({initial_logging_duration:M-I,set_remote_description_duration:P-M,state_sync_duration:V-P,unified_plan_duration:Y-V,is_meetup:b("gkx")("1369511")}));(u=k)==null?void 0:u.setShouldDeferServerRequests(!1);return Z.abrupt("return",O);case 88:case"end":return Z.stop()}},null,this)}},null);
__d("ScotchFBRTCRetriableMessage",["FBRTCConstants","clearTimeout","mixInEventEmitter","setTimeout"],function(a,b,c,d,e,f){var g=1e4,h=7e3;a=function(){function a(a){this.$1=a,this.$2=g,this.$3=2,this.$6=null}var c=a.prototype;c.sendMessage=function(a,c,d,e){var f=e.sdp,g=e.hasVideo,i=e.attributes,j=e.multiwayInfo;e=e.callTrigger;this.$4=c;switch(a){case b("FBRTCConstants").PayloadType.PCRESTART_OFFER:this.$5=this.$1.sendPCRestartOffer(c,d,f,g,i);break;case b("FBRTCConstants").PayloadType.OFFER:this.$5=this.$1.sendOffer(c,d,f,g,i,e);break;case b("FBRTCConstants").PayloadType.ANSWER:this.$2=h;this.$5=this.$1.sendAnswer(c,d,f,g,i,j);break}this.$7()};c.isAckMsg=function(a){return this.$5&&this.$5.msg_id===a.ack_id};c.stopRetrying=function(){this.$6&&(b("clearTimeout")(this.$6),this.$4=null,this.$5=null,this.$6=null)};c.$7=function(){this.$6=b("setTimeout")(this.$8.bind(this),this.$2)};c.$8=function(){this.$3<1?this.emit("timeoutFailure"):(this.emit("sendingRetry"),this.$1.resendSdpMessage(this.$4,this.$5),this.$7(),this.$3-=1)};return a}();e.exports=a;b("mixInEventEmitter")(a,{sendingRetry:!0,timeoutFailure:!0})},null);
__d("XGroupCallSigningController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/groupcall/init/",{call_context:{type:"String",required:!0},call_id:{type:"Int"},users_to_ring:{type:"FBIDSet",defaultValue:[]},has_video:{type:"Bool",defaultValue:!1},initialize_video:{type:"Bool",defaultValue:!1},server_info_data:{type:"String"},nonce:{type:"String"},multiway_www_tier:{type:"String"},multiway_core_tier:{type:"String"}})},null);
__d("XVideoCallController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/incall/",{peer_id:{type:"FBID",required:!0},call_id:{type:"Int"},is_caller:{type:"Bool",defaultValue:!1},audio_only:{type:"Bool",defaultValue:!1},nonce:{type:"String"},meeting_id:{type:"Int"},meeting_pass:{type:"String"},initialize_video:{type:"Bool",defaultValue:!0},locale:{type:"String"}})},null);
__d("ScotchFBRTCUrlManager",["invariant","regeneratorRuntime","Promise","CurrentUser","FBRTCConfig","FBRTCLogger","ScotchFBRTCUtils","URI","XGroupCallController","XGroupCallSigningController","XVideoCallController"],function(a,b,c,d,e,f,g){f.onCallStarted=a;f.getGroupCallUri=c;f.getP2PCallUriWithNonce=d;var h;function i(a){b("FBRTCLogger").getInstance().logCallAction(a,void 0,b("FBRTCLogger").CallAction.OLD_URI);return b("XVideoCallController").getURIBuilder().setFBID("peer_id",a).getURI()}function j(a){if(b("CurrentUser").isEmployee()){var c=a.setSubdomain(b("CurrentUser").hasWorkUser()||b("CurrentUser").isWorkUser()?"fb":"www"),d="/intern/";return(h||(h=b("URI"))).getRequestURI().getPath().substr(0,d.length)!==d?c:c.setDomain(c.getDomain().toString().replace(/\.(intern|internmc|cstools)\./,"."))}return a}function k(a){var c,d,e,f,g,h,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:c=a.callContext,d=a.callID,e=a.usersToRing,f=a.hasVideo,g=a.initializeVideo,h=a.multiwayCoreTier,i=a.multiwayWwwTier,j=a.nonce,k=a.serverInfoData;l=b("XGroupCallSigningController").getURIBuilder().setString("call_context",c).setInt("call_id",d).setFBIDSet("users_to_ring",e).setBool("has_video",f).setBool("initialize_video",g).setString("server_info_data",k).setString("nonce",j).setString("multiway_www_tier",i).setString("multiway_core_tier",h).getURI();return m.abrupt("return",new(b("Promise"))(function(a,c){b("ScotchFBRTCUtils").sendServerRequest(l,function(b){a(b.payload.uri)},function(a){c(a)})}));case 3:case"end":return m.stop()}},null,this)}var l=function(a){if(b("FBRTCConfig").disableURLManager())return;window.history.replaceState({},"",a)};function m(a){var c=b("XVideoCallController").getURIBuilder().setFBID("peer_id","0").getURI().getPath();return a.getPath()===c}function n(a,b){a&&(b&&g(0,11934))}function a(a){m(new(h||(h=b("URI")))(window.location))&&l(i(a))}function c(a,c,d,e,f,g,h,i,j){var l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:n(!e,f),l=0;case 2:if(!(l<3)){m.next=15;break}m.prev=3;m.next=6;return b("regeneratorRuntime").awrap(k({callContext:a,callID:c,usersToRing:d,hasVideo:e,initializeVideo:f,multiwayCoreTier:g,multiwayWwwTier:h,nonce:i,serverInfoData:j}));case 6:return m.abrupt("return",m.sent);case 9:m.prev=9,m.t0=m["catch"](3),b("FBRTCLogger").getInstance().logToConsole(m.t0);case 12:l++;m.next=2;break;case 15:return m.abrupt("return",b("XGroupCallController").getURIBuilder().setString("call_context",a).setInt("call_id",c).setFBIDSet("users_to_ring",d).setBool("has_video",e).setBool("initialize_video",f).setString("server_info_data",j).setString("nonce",i).setString("multiway_www_tier",h).setString("multiway_core_tier",g).getURI());case 16:case"end":return m.stop()}},null,this,[[3,9]])}function d(a,c,d,e,f,g,h){h===void 0&&(h="");n(e,g);c=b("XVideoCallController").getURIBuilder().setFBID("peer_id",a).setInt("call_id",c).setBool("is_caller",d).setBool("audio_only",e).setString("nonce",f).setBool("initialize_video",g).getURI();return b("ScotchFBRTCUtils").isPeerVCEndpoint(a)||b("ScotchFBRTCUtils").isCollabTrigger(h)?j(c):c}},null);
__d("ScotchFBRTCUserSettings",["Promise","ScotchRTCMediaDevices","emptyFunction","mixInEventEmitter"],function(a,b,c,d,e,f){"use strict";a={audioInput:"",audioOutput:"default",videoInput:"",remoteStream:null,_audioInputLabel:null,_videoInputLabel:null,isEnabled:function(){return Boolean(b("ScotchRTCMediaDevices").isSupported("enumerateDevices"))},selectAudioInputByLabel:function(a){this.audioInput||(this.audioInput=this._selectByLabel(a,this._audioInputLabel));return this.audioInput},selectVideoInputByLabel:function(a){this.videoInput||(this.videoInput=this._selectByLabel(a,this._videoInputLabel));return this.videoInput},_selectByLabel:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(b&&b===d.label)return d.deviceId}return null},previewStart:function(){this.emit("previewStarted")},previewEnd:function(){this.emit("previewEnded")},save:function(a){var c=this,d=a.audioInput,e=a.audioOutput,f=a.videoInput;return new(b("Promise"))(function(a){var b=!!(d&&c.audioInput!==d||f&&c.videoInput!==f);c.audioInput=d;c.audioOutput=e;c.videoInput=f;c.emit("saved",b);a(b)})},updateForLocalStream:function(a){if(a.videoMediaSourceId)this.videoInput=a.videoMediaSourceId;else{var b=a.getVideoTracks();b=b[0];b&&(this._videoInputLabel=b.label)}if(a.audioMediaSourceId)this.audioInput=a.audioMediaSourceId;else{b=a.getAudioTracks();a=b[0];a&&(this._audioInputLabel=a.label)}},updateForRemoteStream:function(a){this.remoteStream=a,this.emit("remoteStreamChanged")},addListener:function(){},emit:b("emptyFunction")};b("mixInEventEmitter")(a,{previewStarted:!0,previewEnded:!0,remoteStreamChanged:!0,saved:!0});c=a;e.exports=c},null);
__d("XRTCCallNUXController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/rtc/call/nuxstatus/",{})},null);
__d("ScotchRTCCallNUXActions",["FBRTCLogger","ScotchFBRTCUtils","ScotchRTCAppDispatcher","XRTCCallNUXController","dangerouslyBypassDispatchError"],function(a,b,c,d,e,f){"use strict";f.refreshNUXState=a;f.markNUXViewed=c;f.dismissNUX=d;function a(){b("ScotchFBRTCUtils").sendServerRequest(b("XRTCCallNUXController").getURIBuilder().getURI(),function(a){a=a.payload;b("ScotchRTCAppDispatcher").dispatch({type:"INIT_NUX_STATE",payload:a})},function(){})}function c(a){try{b("ScotchRTCAppDispatcher").dispatch({type:"MARK_NUX_VIEWED",nuxID:a})}catch(c){b("dangerouslyBypassDispatchError")(function(){return b("ScotchRTCAppDispatcher").dispatch({type:"MARK_NUX_VIEWED",nuxID:a})})}}function d(a){b("ScotchRTCAppDispatcher").dispatch({type:"DISMISS_NUX",nuxID:a})}},null);
__d("ScotchRTCOneVCActions",["ScotchRTCAppDispatcher"],function(a,b,c,d,e,f){"use strict";f.storeParticipants=a;f.setMeetingID=c;f.setMeetingPassword=d;function a(a){b("ScotchRTCAppDispatcher").dispatch({type:"STORE_PARTICIPANTS",participants:a})}function c(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_MEETING_ID",meetingID:a})}function d(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_MEETING_PASSWORD",meetingPassword:a})}},null);
__d("ScotchRTCPeerConnectionQueue",[],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[],this.$2=[]}var b=a.prototype;b.push=function(a,b){switch(a){case"add":this.$1.push(b);break;case"remove":this.$2.push(b);break}};b.drain=function(){this.$3(this.$2),this.clear("remove"),this.$3(this.$1),this.clear("add")};b.$3=function(a){if(a.length<1)return;for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;try{d()}catch(a){}}};b.clear=function(a){switch(a){case"add":this.$1=[];break;case"remove":this.$2=[];break;default:this.$1=[],this.$2=[]}};return a}();e.exports=a},null);
__d("XRtcFetchProvisionalRingController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/provisionalring/",{user_id:{type:"Int",required:!0}})},null);
__d("ZenonRTCPeerConnectionConfig",["FBRTCConfig","ZenonBrowsers","ZenonSignalingTypes","gkx","qex"],function(a,b,c,d,e,f){"use strict";var g="stun:stun.fbsbx.com:3478";function h(a,b,c){a={urls:a};b!==void 0&&c!==void 0&&(a.username=b,a.credential=c);return[a]}function i(a,c,d){if(b("ZenonBrowsers").isChromium()&&b("ZenonBrowsers").webrtcVersion()>=34){var e={urls:a};c!==void 0&&d!==void 0&&(e.username=c,e.credential=d);return[e]}e=[];for(var f=0;f<a.length;f++)c!==void 0&&d!==void 0?e.push({credential:d,url:a[f],username:c}):e.push({url:a[f]});return e}a=function(){function a(){this.sslPort="",this.tcpPort="",this.turnIP="",this.turnPassword="",this.turnUsername="",this.udpPort=""}var c=a.prototype;c.setTurnCredentials=function(a){this.turnIP=a.ip,this.udpPort=a.udp_port,this.tcpPort=a.tcp_port,this.sslPort=a.ssl_tcp_port,this.turnUsername=a.username,this.turnPassword=a.password};c.getConfig=function(){if(b("FBRTCConfig").isVCEndpointCall())return{iceServers:[]};var a=i([g]).concat(i(this.$1(),this.turnUsername,this.turnPassword));return{iceServers:a}};c.getConfigZenonPlatform=function(){if(b("FBRTCConfig").isVCEndpointCall())return{iceServers:[],sdpSemantics:b("ZenonSignalingTypes").ZenonSdpFormat.PLAN_B};var a=!b("qex")._("1566745")&&b("gkx")("1755550"),c=this.turnIP==="",d=b("qex")._("1688994")===!0?b("ZenonSignalingTypes").ZenonSdpFormat.UNIFIED_PLAN:b("ZenonSignalingTypes").ZenonSdpFormat.PLAN_B;if(a&&c)return{sdpSemantics:d};else a?a=h(this.$1(),this.turnUsername,this.turnPassword):c?a=h([g]):a=h([g]).concat(h(this.$1(),this.turnUsername,this.turnPassword));return{iceServers:a,sdpSemantics:d}};c.getConstraints=function(a){a===void 0&&(a=!1);var c=!0;b("ZenonBrowsers").isChromium()&&b("ZenonBrowsers").webrtcVersion()<57&&a&&(c=!1);return{mandatory:{},optional:[{DtlsSrtpKeyAgreement:c}]}};c.$2=function(a){var b=this.turnIP,c,d=a;switch(a){case"tcp":c=this.tcpPort;break;case"udp":c=this.udpPort;break;case"ssl":c=this.sslPort;d="tcp";break;default:c=this.udpPort;d=null;break}return!((b==null?void 0:b.length)&&((a=c)==null?void 0:a.length))?null:d!=null&&d.length>0?"turn:"+b+":"+c+"?transport="+d:"turn:"+b+":"+c};c.$1=function(){if(b("ZenonBrowsers").isFirefox()&&b("ZenonBrowsers").webrtcVersion()<27)return[this.$2()].filter(Boolean);else return[this.$2("udp"),this.$2("tcp"),this.$2("ssl")].filter(Boolean)};return a}();c=new a();e.exports=c},null);
__d("ZenonRTCPeerConnectionHelper",["RTCPeerConnection"],function(a,b,c,d,e,f){"use strict";f.closePeerConnection=a;f.createPeerConnection=c;f.isRTCPeerConnectionInstance=d;function a(a){a.signalingState!=="closed"&&a.close()}function c(a,c,d){c===void 0&&(c={});d===void 0&&(d={});return new(b("RTCPeerConnection"))(babelHelpers["extends"]({},c),babelHelpers["extends"]({optional:[{googNumUnsignalledRecvStreams:10},{DtlsSrtpKeyAgreement:a.getZenonPeerConnectionConfig().isDtlsSrtpKeyAgreement()},{RtpDataChannels:a.getZenonPeerConnectionConfig().isRtpDataChannels()}]},d))}function d(a){return a instanceof b("RTCPeerConnection")}},null);
__d("XVideoCallTurnDiscoveryController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/turndiscovery/",{version:{type:"Int",required:!0},call_id:{type:"String"}})},null);
__d("ZenonUtils",["AsyncRequest","AsyncResponse","emptyFunction"],function(a,b,c,d,e,f){"use strict";f.sendServerRequest=a;var g=6e3;function a(a,c,d,e,f,h){c===void 0&&(c=b("emptyFunction"));d===void 0&&(d=b("emptyFunction"));e===void 0&&(e=!1);f===void 0&&(f=g);h===void 0&&(h={});a=new(b("AsyncRequest"))().setURI(a).setData(h).setAllowCrossPageTransition(!0).setHandler(c).setErrorHandler(d).setTimeoutHandler(f,function(a){d(new(b("AsyncResponse"))(a,{}))});e&&a.setOption("asynchronous_DEPRECATED",!1);a.send()}},null);
__d("ZenonTurnDiscovery",["Promise","FBRTCLogger","XVideoCallTurnDiscoveryController","ZenonUtils"],function(a,b,c,d,e,f){"use strict";f.requestTurnCreds=a;var g=3,h=null;function a(a,c,d){d===void 0&&(d=g);if(h)return h;var e=1,f=b("XVideoCallTurnDiscoveryController").getURIBuilder().setInt("version",e).setString("call_id",a).getURI();h=new(b("Promise"))(function(e,g){h(d);function h(d){b("ZenonUtils").sendServerRequest(f,function(a){a=a.payload;return e(a)},function(){d>0?(b("FBRTCLogger").getInstance().logError(c,a,"Failed turn; going to retry"),h(d-1)):g(new Error("failed"))})}});return h}},null);
__d("ScotchRTCP2PProtocolHandler",["Promise","regeneratorRuntime","AsyncTypedRequest","Bootloader","CurrentUser","DateConsts","FBLogger","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConfig","FBRTCConsoleLogger","FBRTCConstants","FBRTCExperiment","FBRTCLocalMessageQueue","FBRTCLocalUploadLogLevel","FBRTCLogger","FBRTCMessageListener","FBRTCSupport","RTCConfig","ScotchFBRTCIceCache","ScotchFBRTCMediaMetricParser","ScotchFBRTCMessage","ScotchFBRTCMessageDedup","ScotchFBRTCMessageSender","ScotchFBRTCPeerConnection","ScotchFBRTCPeerConnectionHelper","ScotchFBRTCRetriableMessage","ScotchFBRTCSdpUtils","ScotchFBRTCStatsHelpers","ScotchFBRTCUrlManager","ScotchFBRTCUserSettings","ScotchRTCCallActions","ScotchRTCCallNUXActions","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCEndCallReason","ScotchRTCGroupCallEscalationStore","ScotchRTCGroupCallEscalator","ScotchRTCOneVCActions","ScotchRTCP2PCallActions","ScotchRTCP2PCallEscalationActions","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallEscalator","ScotchRTCP2PCallStore","ScotchRTCP2PCallWindowHandler","ScotchRTCPeerConnectionQueue","ScotchRTCSessionDescription","ScotchRTCSignalingExperiments","ScotchRTCStreamDurationTracker","ScotchRTCUtils","ScotchRTWebClientFeatureGating","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","UserAgent","XRtcFetchProvisionalRingController","ZenonImmutableMediaTrack","ZenonLocalMediaSDK","ZenonRTCPeerConnectionConfig","ZenonRTCPeerConnectionHelper","ZenonRTWebBrowserFeatureSupport","ZenonTSLogDataHelper","ZenonTurnDiscovery","clearTimeout","debounce","gkx","promiseDone","setTimeout"],function(a,b,c,d,e,f){"use strict";var g=(a=b("FBRTCConstants")).CallEndReason,h=a.CallType,i=a.RTCConstraints,j=a.SignalingProtocol,k=a.VideoQuality,l=a.ClientReportedEventType,m=1*(c=b("DateConsts")).MS_PER_MIN,n=15*c.MS_PER_SEC,o=30*c.MS_PER_SEC,p=10*c.MS_PER_SEC;d=function(){function a(){var c=this;this.$5={streams:{}};this.$6=b("FBRTCLogger").getInstance();this.$7=!1;this.$8=!0;this.$9=!1;this.$10="passive";this.$11=new(b("ScotchFBRTCMessageSender"))();this.$16=new(b("ScotchFBRTCIceCache"))();this.$17=!1;this.$18=[];this.$19=!1;this.$22=null;this.$23=null;this.$24=null;this.$26=new(b("ScotchRTCStreamDurationTracker"))("video");this.$27=new(b("ScotchRTCStreamDurationTracker"))("video");this.$28=new(b("ScotchRTCStreamDurationTracker"))("screen");this.$29=!1;this.$30=new(b("ScotchRTCPeerConnectionQueue"))();this.$33=!1;this.$50=function(a){a=a.candidate;a&&c.$64(a)};this.$51=function(a){a=a.target;a=a.iceConnectionState;c.$35("RTCP2PProtocolHandler_PC_iceconnectionstatechange: "+a);var d=b("ScotchRTCCallStore").getState();d=d.callSummary;d&&(d.setPCIsConnected(a==="completed"||a==="connected"),d.save(b("FBRTCCallSummaryStore").getInstance()));(c.$23==="disconnected"||c.$23==="failed")&&a==="connected"&&c.$34("connection recovery",c.$23);c.$34("ICE connection state change",a);b("clearTimeout")(c.$22);switch(a){case"checking":c.$9=!0;break;case"connected":case"completed":c.$65();c.$66();c.$67();b("ScotchFBRTCMediaMetricParser").startCollectingMediaStats();break;case"failed":c.$22=b("setTimeout")(function(){if(b("RTCConfig").CollaborationBrowserConfig.ICE_recovery&&b("FBRTCConfig").isVCEndpointCall()){c.$68("ICE failure");return}c.$63(new Error("ICE failed"));b("ScotchRTCP2PCallActions").setConnectionStatus("DISCONNECTED")},b("RTCConfig").CollaborationBrowserConfig.ICE_failed_timeout);break;case"disconnected":c.$22=b("setTimeout")(function(){c.$38(g.CONNECTION_DROPPED,!1,!0,!1)},b("RTCConfig").CollaborationBrowserConfig.ICE_disconnected_timeout);break;case"closed":break}};this.$71=function(){var a=c.$4.getCreatedIceCandidates();for(var b=0;b<a.length;b++)c.$64(a[b])};this.$52=function(a){a=a.target;a=a.iceGatheringState;c.$35("RTCP2PProtocolHandler_PC_icegatheringstatechange: "+a);c.$34("ICE gathering state change",a)};this.$53=function(a){var b=a.errorCode,d=a.errorText,e=a.hostCandidate;a=a.url;c.$72("ScotchRTCP2PProtocolHandler: PC icecandidateerror "+b+": "+d+". candidate: "+e);c.$34("ICE candidate error",{errorCode:b,errorText:d,hostCandidate:e,url:a})};this.$73=function(){var a;c.$25?a=g.UNSUPPORTED_VERSION:a=g.OTHER_NOT_CAPABLE;c.$38(a,!1,!0,!1,"TimedOut")};this.$56=b("debounce")(function(a){var d=a.target,e=d.iceConnectionState,f=d.signalingState;if(!b("ZenonRTCPeerConnectionHelper").isRTCPeerConnectionInstance(d))e=c.$4.getIceConnectionState(),f=c.$4.getSignalingState();else if(e!==c.$4.getIceConnectionState()||f!==c.$4.getSignalingState()){d="onNegotiationNeeded. iceConnectionState="+e+", pc="+c.$4.getIceConnectionState()+", signalingState="+f+", pc="+c.$4.getSignalingState();c.$6.logInfo(c.$2,c.$3,d)}c.$34("offer renegotiation",{iceConnectionState:e,isNegotiationExpected:c.$8});if(e==="closed")return;else if(!c.$8){c.$34("offer renegotiation","ignore");return}else if(!b("ScotchRTCP2PCallEscalator").isNegotiationAllowed()){c.$34("offer renegotiation","not allowed - escalating");return}else if(c.$7){c.$34("offer renegotiation","retry");b("setTimeout")(function(){return c.$56(a)},100);return}c.$8=!1;var g=[];f==="stable"&&(c.$9&&(c.internalResetConnection(),g.push("new offer"),c.$10="passive"),c.$34("offer renegotiation","create offer"),c.$69().then(function(a){if(a.strongDiff(c.$4.getLocalDescription())){c.$34("offer renegotiation",g);return a}return null}).then(function(a){a&&(c.$9&&b("ScotchRTCP2PCallActions").setConnectionStatus("RECONNECTING"),c.$70(a)),c.$10="active"})["catch"](function(a){c.$63(new Error("Failed to create offer onNegotiationNeeded: "+a.message))}))},50);this.$57=function(d){if(c.$29){c.$30.push("add",function(){return c.$57(d)});return}var e=d.stream,f=c.$74(e),g=c.$2;f===b("FBRTCConstants").StreamType.SCREEN_CONTENT?(b("ScotchRTCCallActions").addRemoteScreenStream(e,g),!a.supportMultipleStreams()&&e.getAudioTracks().length>0&&c.$27.track(e)):(b("ScotchFBRTCUserSettings").updateForRemoteStream(e),b("ScotchRTCCallActions").addRemoteStream(e,g),c.$27.track(e),b("ScotchRTCP2PCallStore").addListener(b("debounce")(function(){b("ScotchRTCP2PCallStore").getState().callType!==b("ScotchRTCCallType").AUDIO_ONLY&&c.$65()},50)));c.$19=!0;while(c.$18.length>0)c.$75(c.$18.shift());c.$34("remote stream: added",e)};this.$58=function(a){a=b("ScotchRTCCallStore").getState().remoteUsers.first();a&&!a.isVideoDisabled()&&(b("ScotchRTCCallActions").toggleMuteRemoteVideo(!1,a.FBID),c.$34("on media track event",{action:"toggleMuteRemoteVideo",muted:!1,remoteUserID:a.FBID}))};this.$59=function(a){if(c.$29){c.$30.push("remove",function(){return c.$59(a)});return}var d=a.stream,e=c.$74(d),f=c.$2;if(e===b("FBRTCConstants").StreamType.SCREEN_CONTENT){b("ScotchRTCCallActions").removeRemoteScreenStream(d,f);e=b("ScotchRTCCallStore").getState().remoteUsers.first();if(e){e=e.streams.first();e&&c.$27.track(e)}}else b("ScotchRTCCallActions").removeRemoteStream(d,f);c.$34("remote stream: removed",d)};this.$36=function(a){c.$35("RTCP2PProtocolHandler_Received_TURN_Creds");c.$34("TURN credentials received",a);b("ZenonRTCPeerConnectionConfig").setTurnCredentials(a);var d=b("ScotchRTCCallStore").getState();d=d.callSummary;d.isNull()||r(function(b){return b.setRelayIP(a.ip)})};this.$37=function(){c.$6.logError(c.$2,c.$3,"Failed to get turn creds"),c.$38(g.CLIENT_ERROR,!1,!b("ScotchRTCP2PCallStore").isCaller(),!1,"NoTurnCreds")};this.$44=function(a,b){c.$38(a,!1,!1,!1,b.toString())};this.$43=function(a,b){var d=b.call_id;if(c.$83()){c.$6.logError(c.$2,c.$3,"Message sent after call ended: "+b.type);return}if(c.$2!==a||c.$3!==d)return;r(function(a){return a.onMessageSent(b)});c.$34("message sent",b)};this.$34("call controller init");this.$35("RTCP2PProtocolHandler_constructed")}var c=a.prototype;c.init=function(a,c){this.$1=b("CurrentUser").getID();this.$2=a;this.$3=c;this.$35("RTCP2PProtocolHandler_init_call");if(!b("ScotchRTWebExperiments").passOfferWithWindowMessages()){a=b("FBRTCLocalMessageQueue").getPeerOfferFromStorage(this.$2);this.$34("local message queue updates",{action:"getOffer",cachedOffer:a,callID:this.$3});if(a){this.$34("call: try","not ready");c=new(b("ScotchFBRTCMessage"))(a);b("ScotchRTCP2PCallActions").processMessage(c)}}return this};c.setPreserveLocalStream=function(a){this.$32=a;return this};c.fetchTURNCredentials=function(){if(b("FBRTCConfig").isVCEndpointCall()){this.$35("RTCP2PProtocolHandler_skip_TURN_discovery");return b("Promise").resolve()}this.$34("call: try","not ready");return b("ZenonTurnDiscovery").requestTurnCreds(this.$3.toString(),this.$2).then(this.$36,this.$37)};c.endCall=function(a,c,d){a===void 0&&(a=g.HANGUP_CALL),c===void 0&&(c=""),d===void 0&&(d=!1),b("ScotchRTCCallActions").hangup(a,c),this.$38(a,!1,!0,d,c)};c.startCall=function(a,c){var d=this,e=b("ScotchRTCP2PCallStore").isCaller();this.$34("call: start process",{callTrigger:a,userCallType:this.$39(),isCaller:b("ScotchRTCP2PCallStore").isCaller()});this.$4=this.$40();this.$41();this.$30=new(b("ScotchRTCPeerConnectionQueue"))();this.$34("local message queue updates",{action:"getOffer",offer:c});var f=null;c?(this.$20=new(b("ScotchFBRTCMessage"))(c),b("ScotchFBRTCMessageDedup").check(this.$2,this.$20.callID,this.$20.msgID),f=!1):(f=!0,b("ScotchRTCP2PCallActions").setIsCaller(f));e&&!f&&this.handleCallCollision(this.$20,!1);f!==e&&(this.$34("caller mismatch",{initialValue:e,actualValue:f}),e?this.$35("RTCP2ProtocolHandler_offer_mismatch_caller_found_unexpected_cached_offer"):this.$35("RTCP2PProtocolHandler_offer_mismatch_callee_did_not_find_cached_offer"));this.$8=f;this.$20 instanceof b("ScotchFBRTCMessage")&&b("ScotchRTCP2PCallActions").processMessage(this.$20);this.$42(a,f);this.$11=new(b("ScotchFBRTCMessageSender"))();this.$11.onMessageSent=this.$43;this.$11.onSendFailure=this.$44;this.$31=new(b("ScotchRTCP2PCallEscalator"))(this.$2,this.$3,this.$11);b("FBRTCConfig").isVCEndpointCall()&&b("FBRTCMessageListener").setOneVCMessegeHandler(function(a){d.$45(a)});this.$46();b("ScotchRTCP2PCallActions").setConnectionStatus("CONTACTING");b("ScotchRTCCallActions").call([this.$2],this.$4);if(b("ScotchRTWebExperiments").shouldUseZenonSignaling()){c=b("ScotchRTCP2PCallStore").getState().signalingChild;c!=null&&c.addListener("messageReceived",function(a){d.$47(a)})}else b("FBRTCMessageListener").setMessageHandler(function(a){d.$47(a)});f&&(this.$24=b("setTimeout")(function(){d.__fetchProvisionalRing()},p))};c.__fetchProvisionalRing=function(){var a=this,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:c=b("XRtcFetchProvisionalRingController").getURIBuilder().setInt("user_id",this.$2).getURI();d.next=3;return b("regeneratorRuntime").awrap(new(b("AsyncTypedRequest"))(c).setPayloadHandler(function(b){a.__onFetchProvisionalRingResponse(b)}).send());case 3:case"end":return d.stop()}},null,this)};c.__onFetchProvisionalRingResponse=function(a){a&&b("ScotchRTCP2PCallStore").getState().connectionStatus==="CONTACTING"&&b("ScotchRTCP2PCallActions").setConnectionStatus("PROVISIONAL_RINGING")};c.$42=function(a,c){c=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),this.$2,this.$3,c,this.$20,a);c.onPopupOpened();c.setCallType(b("ScotchRTCP2PCallStore").getState().callType===b("ScotchRTCCallType").AUDIO_ONLY?h.VOIP:h.DIRECT_VIDEO);c.setActiveConnection("p2p");this.$48(c);b("ScotchRTCCallActions").setCallSummary(c)};c.$48=function(a){b("promiseDone")(b("ScotchFBRTCStatsHelpers").getBatteryStats(),function(c){a.addExtraInfo(b("FBRTCLogger").Key.BATTERY_START,c.level)})};c.startScreenStream=function(c){if(!a.supportMultipleStreams()){var d=b("ScotchRTCCallStore").getState();d=d.localUser;d=d.streams.first();b("ScotchRTCUtils").transferAudioTracks(c,d)}b("ScotchRTCCallActions").addLocalScreenStream(c);this.$35("screen_sharing_started")};c.stopScreenStream=function(c){var d=b("ScotchRTCCallStore").getState();d=d.localUser;if(!d.screenStreams.includes(c))return;if(!a.supportMultipleStreams()){d=d.streams.first();b("ScotchRTCUtils").transferAudioTracks(d,c)}b("ScotchRTCCallActions").removeLocalScreenStream(c);b("ScotchRTCUtils").stopMediaStream(c);this.$35("screen_sharing_stopped")};c.updateScreenStream=function(a,c){b("ScotchRTCUtils").transferAudioTracks(c,a),b("ScotchRTCCallActions").replaceLocalScreenStream(a,c),b("ScotchRTCUtils").stopMediaStream(a)};c.$49=function(b){if(!a.supportMultipleStreams()&&b.hasScreenStream())return!0;else return!b.isVideoDisabled()};c.$40=function(){var a=this,c=b("ScotchRTCP2PCallStore").getState();c=c.isPeerOnMobile;c=new(b("ScotchFBRTCPeerConnection"))(j.P2P,b("ZenonRTCPeerConnectionConfig").getConfig(),b("ZenonRTCPeerConnectionConfig").getConstraints(c));var d,e=null,f,g;b("ScotchRTCCallStore").addListener(b("debounce")(function(){var c=b("ScotchRTCCallStore").getState();c=c.localUser;if(!c||c===d)return;d=c;var h=a.$49(c);e!==h&&e!==null&&a.$11&&a.$11.sendMuteStateUpdate(a.$2,a.$3,h);e=h;h=c.streams;c=c.screenStreams;var i=c!==g,j=h!==f;j||i?(f=h,g=c,a.$41(i)):a.$26.update()},50));b("FBRTCConfig").isVCEndpointCall()&&c.createDataChannel("noop");c.addEventListener("icecandidate",this.$50);c.addEventListener("iceconnectionstatechange",this.$51);c.addEventListener("icegatheringstatechange",this.$52);c.addEventListener("icecandidateerror",this.$53);c.addEventListener("connectionstatechange",this.$54);c.addEventListener("signalingstatechange",this.$55);c.addEventListener("negotiationneeded",this.$56);c.addEventListener("addstream",this.$57);c.addEventListener("track",this.$58);c.addEventListener("removestream",this.$59);c.addEventListener("datachannel",this.$60);this.$61(c);return c};a.supportMultipleStreams=function(){var a=b("ScotchRTCP2PCallStore").getState();a=a.signalingExperiments;return a.support("multiple_streams_plan_b")||a.support("multiple_streams_unified")};c.$62=function(a){var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=a.getStream();d=a.getScreenStream();e=!1;if(!c){f.next=8;break}d!=null?(this.$28.track(d),this.$26.track(d)):(this.$28.update(),this.$26.track(c));f.next=7;return b("regeneratorRuntime").awrap(b("ScotchFBRTCPeerConnectionHelper").resetLocalStreamsByTrack(this.$4,c,d));case 7:e=f.sent;case 8:this.$8=this.$8||e;case 9:case"end":return f.stop()}},null,this)};c.$41=function(c){c===void 0&&(c=!1);if(this.$4.getSignalingState()==="closed")return;var d=b("ScotchRTCCallStore").getState();d=d.localUser;if(!d)return;if(b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()){b("promiseDone")(this.$62(d));return}var e=d.getStream();d=d.getScreenStream();var f=[];a.supportMultipleStreams()?(d?(f.push(d),this.$28.track(d)):this.$28.update(),e?(f.push(e),this.$26.track(e)):this.$26.update()):d?(this.$28.track(d),this.$26.track(d),f.push(d)):(this.$28.update(),e&&(this.$26.track(e),f.push(e)));if(b("ScotchRTWebClientFeatureGating").restartVideoWithTrackAPI()&&f.length===1){d=b("ScotchFBRTCPeerConnectionHelper").resetLocalStreamWithTrackAPI(this.$4,f[0],c);this.$8=this.$8||d}else{e=b("ScotchFBRTCPeerConnectionHelper").resetLocalStreams(this.$4,f);this.$8=this.$8||e}};c.updateStreamForUnifiedPlan=function(c){b("ScotchFBRTCPeerConnection").shouldUseAddTrackForUnifiedPlan()||b("FBLogger")("rtc_www").mustfix("This function must be called within Firefox context"),this.$8=!0,this.$4.addStream(c),a.replaceLocalStream(c)};c.$63=function(a){this.$38(g.WEBRTC_ERROR,!1,!0,!1,a.message)};c.$68=function(a){var c=this;this.$7=!0;this.$8=!1;this.$10="passive";this.internalResetConnection();this.$35("RTCP2PProtocolHandler_connection_recovery_"+a);this.$34("connection recovery",a);this.$69().then(function(a){b("ScotchRTCP2PCallActions").setConnectionStatus("RECONNECTING"),c.$70(a),c.$10="active"})["catch"](function(b){c.$63(new Error("Failed recovering from "+a))})};c.$69=function(){var a=!b("ScotchRTCP2PCallStore").isAudioOnly()||b("ScotchRTCP2PCallEscalator").initVideoInAudioCall(),c={ADD_AUDIO_NACK:b("ScotchRTCSignalingExperiments").shouldEnableAudioNack(),DISABLE_OPUS_STEREO:b("ScotchRTWebClientFeatureGating").disableOpusStereo(),SSRC_CONTENT_TYPE:b("ScotchRTWebClientFeatureGating").addScreenContentTypeInSDP()?b("ScotchRTCCallStore").getState().localUser.getMediaTypeForTracks():void 0};return this.$4.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:a,preserveH264:b("ScotchRTCSignalingExperiments").shouldP2PPreserveH264()},c)};c.$64=function(a){var b=a.sdpMid;if(b!=null){b=this.$4.rewriteLocalIceCandidate(b,a.sdpMLineIndex);var c=b[0];b=b[1];if(window.RTCIceCandidate){var d=a.candidate;a=new RTCIceCandidate(babelHelpers["extends"]({candidate:d,sdpMid:c},b!=null?{sdpMLineIndex:b}:null))}else a.sdpMid=c}a.candidate!==""&&this.$11.sendIceCandidate(this.$2,this.$3,a)};c.$54=function(a){};c.$55=function(a){};c.internalResetConnection=function(){var a=this;this.$8=!1;var c=this.$2,d=b("ScotchRTCCallStore").getState().remoteUsers.first(),e=d.streams,f=d.screenStreams;this.$29=!0;this.$30.clear("add");this.$30.push("remove",function(){for(var a=e,d=Array.isArray(a),g=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(d){if(g>=a.length)break;h=a[g++]}else{g=a.next();if(g.done)break;h=g.value}h=h;b("ScotchRTCCallActions").removeRemoteStream(h,c)}for(var h=f,g=Array.isArray(h),d=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(d>=h.length)break;a=h[d++]}else{d=h.next();if(d.done)break;a=d.value}a=a;b("ScotchRTCCallActions").removeRemoteScreenStream(a,c)}});this.$4.reset().then(function(){a.$29=!1,a.$30.drain()})["catch"](function(b){a.$63(new Error("Failed to reset peer connection: "+b.message))});b("FBRTCConfig").isVCEndpointCall()&&this.$4.createDataChannel("noop")};c.$74=function(a){var c=b("FBRTCConstants").StreamType;try{switch(this.$5.streams[a.id].type){case c.SCREEN_CONTENT:return c.SCREEN_CONTENT;case c.AUDIO_VIDEO:return c.AUDIO_VIDEO;case c.AUDIO_ONLY:return c.AUDIO_ONLY;default:throw Error("no known stream type found, detecting")}}catch(b){return a.getVideoTracks().length>0?c.AUDIO_VIDEO:c.AUDIO_ONLY}};c.$65=function(){this.$26.isStarted()?this.$26.update():this.$26.start();var a=b("ScotchRTCP2PCallStore").getState();a=a.callType;a!==b("ScotchRTCCallType").AUDIO_ONLY&&(this.$27.isStarted()?this.$27.update():this.$27.start());this.$28.isStarted()?this.$28.update():this.$28.start()};c.$66=function(){var a=b("ScotchRTCP2PCallStore").getState().connectionStatus;if(a==="ESCALATING_TO_BJN")return;b("ScotchRTCP2PCallActions").setConnectionStatus("CONNECTED");this.$33||(this.$33=!0,this.$11.sendClientReportedEvent(this.$2,this.$3,l.MEDIA_CONNECTED),this.$35("RTCP2PProtocolHandler_first_time_media_connected"));r(function(a){a.onCallConnected(),a.onNetworkReady()})};c.$60=function(a){};c.startLocalVideoTracker=function(a){this.$26.track(a)};c.updateLocalVideoTracker=function(){this.$26.update()};a.initStream=function(c,d,e){b("ScotchRTWebUserActionLogger").startTimer("RTCP2PProtocolHandler_initStream");return a.internalInitStream(c,d,e).then(function(a){b("ScotchRTWebUserActionLogger").logStopTimer({timerName:"RTCP2PProtocolHandler_initStream",checkpointName:"RTCP2PProtocolHandler_initStream_success"});return a})["catch"](function(a){b("ScotchRTWebUserActionLogger").logStopTimer({timerName:"RTCP2PProtocolHandler_initStream",checkpointName:"RTCP2PProtocolHandler_initStream_failed"});throw a})};a.internalInitStream=function(a,c,d){var e=!a&&b("ScotchRTCP2PCallEscalator").initVideoInAudioCall();return s(a,e,c,d)};a.replaceLocalStream=function(a,c){c===void 0&&(c=!1);var d=b("ScotchRTCCallStore").getState().localUser.streams.first();b("ScotchRTCCallActions").replaceLocalStream(d,a);c&&b("ScotchRTCUtils").stopMediaStream(d)};c.escalateToMultiway=function(){var a=b("ScotchRTCP2PCallStore").getState(),c=a.callType,d=a.offerEscalationSupport;a=a.escalationConferenceName;if(d&&a){r(function(a){return a.setEscalationInitiated()});d=c!==b("ScotchRTCCallType").AUDIO_ONLY&&(b("ScotchRTCCallStore").hasRemoteVideo()||b("ScotchRTCCallStore").hasLocalVideo());c=new(b("ScotchRTCGroupCallEscalator"))(a,d,this.$2,this.$3);c.startEscalationToMultiway()}};c.handleSwitchToMultiway=function(){var a=b("ScotchRTCP2PCallStore").getState(),c=a.callType,d=a.offerEscalationSupport;a=a.escalationConferenceName;this.$7=!1;if(d&&a){r(function(a){return a.setReceivedEscalationRequest()});d=c!==b("ScotchRTCCallType").AUDIO_ONLY&&(b("ScotchRTCCallStore").hasRemoteVideo()||b("ScotchRTCCallStore").hasLocalVideo());c=new(b("ScotchRTCGroupCallEscalator"))(a,d,this.$2,this.$3);c.startEscalationToMultiway()}};c.$76=function(a,c){var d=b("gkx")("678353"),e=a&&d&&b("FBRTCSupport").isGroupCallWebtrcSupported();this.$14=e;this.$15=c;b("ScotchRTCP2PCallActions").setMultiwayEscalationSupport(e,c);r(function(a){a.setConferenceName(c),e&&a.setEscalationAvailable()})};c.$77=function(a){return b("gkx")("1606501")&&!b("ScotchRTCSignalingExperiments").shouldP2PPreserveH264()?b("ScotchFBRTCSdpUtils").removeH264(a):a};c.$46=function(){b("ScotchFBRTCUrlManager").onCallStarted(this.$2);if(this.$20){this.$7=!0;this.$8=!1;var a=this.$20.msg,c=a.sdp,d=a.attributes,e=a.offer_escalation_support;a=a.escalation_conference_name;b("ScotchRTCP2PCallActions").setRemoteSignalingExperiments(this.$20.getSignalingExperiments());this.$76(!!e,a);this.onReceivedRemoteSDP(this.$77(c),"offer",d);b("ScotchRTWebExperiments").passOfferWithWindowMessages()||b("FBRTCLocalMessageQueue").clearPeerOfferFromStorage(this.$2);this.$34("local message queue updates",{action:"removeOffer",offer:this.$20,callID:this.$3});this.$20=null}this.$34("call: try",{initialOffer:this.$20})};c.$70=function(a){var b=this;this.$7=!0;return this.$4.setLocalDescription(a).then(function(a){a=a.toDesc();var c=a.sdp;a=a.type;c=b.$4.transformLocalSdp(c);switch(a){case"offer":b.$78(c);b.$17=!1;break;case"answer":b.$79(c);break;default:break}})["catch"](function(a){b.$63(new Error("Failed to set local description: unexpected SDP type"))})};c.$80=function(){var c={},d=b("ScotchRTCCallStore").getState();d=d.localUser.screenStreams;if(a.supportMultipleStreams()===!1)for(var e=this.$4.getLocalStreams(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;var i=h.getVideoTracks().length?b("FBRTCConstants").StreamType.AUDIO_VIDEO:b("FBRTCConstants").StreamType.AUDIO_ONLY;c[h.id]={type:i}}else for(var h=this.$4.getLocalStreams(),i=Array.isArray(h),g=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(i){if(g>=h.length)break;f=h[g++]}else{g=h.next();if(g.done)break;f=g.value}e=f;f=d.includes(e)?b("FBRTCConstants").StreamType.SCREEN_CONTENT:e.getVideoTracks().length?b("FBRTCConstants").StreamType.AUDIO_VIDEO:b("FBRTCConstants").StreamType.AUDIO_ONLY;c[e.id]={type:f}}return{streams:c}};c.$81=function(a){var c=b("ScotchRTCCallStore").getState();c=c.localUser;this.$11.sendSdpUpdate(this.$2,this.$3,a,!b("ScotchRTCP2PCallStore").isAudioOnly()&&!c.isVideoDisabled(),this.$80())};c.$78=function(a){var c=this,d=this.$9?b("FBRTCConstants").PayloadType.PCRESTART_OFFER:b("FBRTCConstants").PayloadType.OFFER,e=b("ScotchRTCCallStore").getState();e=e.callSummary;e=e?e.getCallTrigger():"";this.$12=new(b("ScotchFBRTCRetriableMessage"))(this.$11);this.$12.addListener("sendingRetry",this.$71);this.$12.addListener("timeoutFailure",this.$73);this.$12.sendMessage(d,this.$2,this.$3,{sdp:a,hasVideo:!b("ScotchRTCP2PCallStore").isAudioOnly(),attributes:this.$80(),callTrigger:e});this.$21=b("setTimeout")(function(){c.$38(g.NO_ANSWER_TIMEOUT,!1,!0,!1,"NoAnswerTimeout")},m)};c.$82=function(a){if(!Object.prototype.hasOwnProperty.call(a,"videoon"))return;a=!a.videoon;b("ScotchRTCCallActions").toggleMuteRemoteVideo(a,this.$2);for(var a=this.$4.getRemoteStreams(),c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(e.getAudioTracks().length>0){this.$34("remote steam: mute toggled",e);return}}this.$27.update()};c.$79=function(a){this.$13=new(b("ScotchFBRTCRetriableMessage"))(this.$11);this.$13.addListener("sendingRetry",this.$71);var c={escalationConferenceName:this.$15,negotiatedEscalationSupport:this.$14};this.$13.sendMessage(b("FBRTCConstants").PayloadType.ANSWER,this.$2,this.$3,{sdp:a,hasVideo:!b("ScotchRTCP2PCallStore").isAudioOnly(),attributes:this.$80(),multiwayInfo:c})};c.processQueuedMessages=function(){var a=this;b("FBRTCLocalMessageQueue").drainQueue(this.$2,function(b){a.$47(b,{skipDupeCheck:!0})})};c.$47=function(a,c){var d;try{d=new(b("ScotchFBRTCMessage"))(a)}catch(b){this.$6.logError(this.$2,this.$3,"Unknown data: "+JSON.stringify(a));return}this.$6.logReceivedMessage(d.peerID,d.callID,d.msg);this.$34("message received",d.msg);if(this.$83()){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (call ended): "+d.msgID);return}if(!(c==null?void 0:c.skipDupeCheck)&&!b("ScotchFBRTCMessageDedup").check(d.peerID,d.callID,d.msgID)){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (duplicate): "+d.msgID);return}if(b("ScotchRTCCallStore").getState().callInfo.conferenceState==="AWAITING_USER_START"){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (awaiting user start): "+d.msgID);return}if(this.$2&&this.$2!==d.peerID){d.isOffer()&&this.$84(d);this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (different peer): "+d.msgID);return}if(d.selfID!=null&&d.selfID!==this.$1){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (wrong receiver): "+d.msgID);return}if(!d.isForCall(this.$3,this.$15)){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (different call): "+d.msgID+"(callID: "+d.callID+")");return}this.$3&&this.$3===d.callID&&r(function(a){return a.onFullMessageReceived(d)});a=b("ScotchRTCGroupCallEscalationStore").getState().inProgress;switch(d.msgType){case b("FBRTCConstants").PayloadType.ICERESTART_OFFER:case b("FBRTCConstants").PayloadType.PCRESTART_OFFER:this.internalResetConnection();this.$85(d);break;case b("FBRTCConstants").PayloadType.OFFER:this.$85(d);break;case b("FBRTCConstants").PayloadType.ANSWER:case b("FBRTCConstants").PayloadType.ICERESTART_ANSWER:case b("FBRTCConstants").PayloadType.PCRESTART_ANSWER:b("ScotchRTCP2PCallActions").setRemoteSignalingExperiments(d.getSignalingExperiments());this.$86(d);break;case b("FBRTCConstants").PayloadType.SDP_UPDATE:this.$87(d);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$88(d);break;case b("FBRTCConstants").PayloadType.HANGUP:this.$89(d);break;case b("FBRTCConstants").PayloadType.OFFER_ACK:this.$90(d);break;case b("FBRTCConstants").PayloadType.OFFER_NACK:this.$25=!0;break;case b("FBRTCConstants").PayloadType.ANSWER_ACK:this.$91();break;case b("FBRTCConstants").PayloadType.MSG_ACK:this.$92(d);break;case b("FBRTCConstants").PayloadType.SET_VIDEO:this.$93(d);break;case b("FBRTCConstants").PayloadType.SWITCH_TO_MULTIWAY:a||this.handleSwitchToMultiway();break;case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:case b("FBRTCConstants").PayloadType.ACK:case b("FBRTCConstants").PayloadType.OK:case b("FBRTCConstants").PayloadType.PING:case b("FBRTCConstants").PayloadType.PING_ACK:case b("FBRTCConstants").PayloadType.OTHER_DISMISS:case b("FBRTCConstants").PayloadType.PRANSWER:break;default:break}this.$31.parseMessage(d)};c.$45=function(a){switch(a.msg_type){case"bjn_escalating":var c=b("ScotchRTCP2PCallStore").getState().connectionStatus;b("ScotchRTCP2PCallActions").setConnectionStatus("ESCALATING_TO_BJN");b("setTimeout")(function(){b("ScotchRTCP2PCallActions").setConnectionStatus(c)},n);break;case"participants":b("ScotchRTCOneVCActions").storeParticipants(JSON.parse(a.payload).list);break;default:break}};c.$84=function(a){var c=a.peerID,d=a.callID;this.$35("RTCP2PProtocolHanlder_collision_offer_from_another_peer");var e=a.msg,f=new(b("FBRTCCallSummary"))({peerID:c,callID:d,isCaller:!1});f.setActiveConnection("p2p");f.onFullMessageReceived(a);f.setCallType(b("ScotchFBRTCSdpUtils").isVideoSupported(e.sdp)?h.DIRECT_VIDEO:h.VOIP);this.$11.sendOfferAck(c,d,e);f.onOfferAckSent(e);a=new(b("ScotchRTCEndCallReason"))(g.IN_ANOTHER_CALL);this.$94(c,d,a,!1);f.onCallEnded(a.getReasonID(),!1);f.save(b("FBRTCCallSummaryStore").getInstance())};c.$85=function(a){var c=a.msg;if(!b("ScotchRTWebExperiments").enableCallCollisionFix()){this.$3&&c.call_id!==this.$3&&this.$35("RTCP2PProtcolHandler_call_collision");var d=this.$4.getSignalingState();if(d!=="stable")return}if(c.calltype){this.$11.sendOfferNack(this.$2,c.call_id,c);return}this.$11.sendOfferAck(this.$2,c.call_id,c);this.$11.sendOtherDismiss(c.call_id);this.$95(c)?this.$96(a):this.$97(a)};c.resetCollisionSummary=function(a,c){var d=a.msg;r(function(a){a.onCallEnded(g.OTHER_INSTANCE_HANDLED,!1,!1,"call_collision"+(c?"_resetConnection":"_atStart"))});var e=new(b("FBRTCCallSummary"))({peerID:this.$2,callID:d.call_id,isCaller:!1});b("ScotchRTCCallActions").setCallSummary(e);r(function(c){c.setActiveConnection("p2p"),c.onFullMessageReceived(a),c.onOfferAckSent(d),c.setCallType(b("ScotchFBRTCSdpUtils").isVideoSupported(d.sdp)?h.DIRECT_VIDEO:h.VOIP),c.setCallTrigger("call_collision")})};c.handleCallCollision=function(a,c){this.$6.logEvent(this.$2,this.$3,"Handling offer collision");this.resetCollisionSummary(a,c);if(b("ScotchRTWebExperiments").enableCallCollisionFix()){this.$3=a.callID;a=a.msg;c?this.internalResetConnection():this.$11.sendOtherDismiss(a.call_id);b("ScotchRTCCallActions").callCollision(a.call_id.toString(),this.$2);this.$35("RTCP2PProtocolHandler_handling_call_collision"+(c?"_resetConnection":"_atStart"))}};c.$96=function(a){var c=a.msg;this.$82(c);b("clearTimeout")(this.$24);this.$98();this.$99();this.$100();if(this.$3!==c.call_id){c=new(b("ScotchRTCEndCallReason"))(g.OTHER_INSTANCE_HANDLED);this.$94(this.$2,this.$3,c,!1);this.handleCallCollision(a,!0)}else this.$6.logEvent(this.$2,this.$3,"Handling offer refresh");this.$17=!1;this.$20=a;b("ScotchRTCP2PCallActions").processMessage(a);this.$46();this.$34("offer accepted",a.msgID)};c.$97=function(a){this.$6.logEvent(this.$2,this.$3,"Ignoring offer"),this.$34("offer ignored",a.msgID)};c.$87=function(a){var c=this,d=a.msg;b("ScotchRTCP2PCallActions").processMessage(a);this.$82(d);switch(this.$4.getSignalingState()){case"stable":this.onReceivedRemoteSDP(this.$101("offer",a),"offer",d.attributes);break;case"have-local-offer":this.onReceivedRemoteSDP(this.$101("answer",a),"answer",d.attributes).then(function(){return c.$102()})["catch"](function(a){c.$63(new Error("Failed to handle sdp update when signaling state is 'have-local-offer': "+a.message))});break;case"have-remote-offer":b("setTimeout")(function(){return c.$87(a)},1e3);break;case"have-local-pranswer":case"have-remote-pranswer":break;case"closed":break}this.$34("SDP update",[d.sdp,d.attributes])};c.$101=function(a,c){c=c.msg;var d=b("ScotchRTCP2PCallStore").getState();d=d.isPeerOnMobile;var e=b("ScotchRTCP2PCallStore").isCaller();return a==="offer"?!d&&e&&b("UserAgent").isBrowser("Firefox")?b("ScotchFBRTCSdpUtils").setDtlsRole(c.sdp,this.$10):c.sdp:b("ScotchFBRTCSdpUtils").setDtlsRole(c.sdp,d&&!e?"passive":this.$10)};c.$102=function(){this.$7=!1};c.$67=function(){var a=this.$4.getSenders().find(function(a){var b;return(a==null?void 0:(b=a.track)==null?void 0:b.kind)==="audio"&&typeof a.getParameters==="function"&&typeof a.setParameters==="function"});if(a==null)return;if(b("ScotchRTCSignalingExperiments").shouldCapAudioBitrate()){var c=b("FBRTCExperiment").getMediaQualityExperiments().getInt("max_audio_bitrate",0);if(c>0){var d=a.getParameters();d.encodings!=null?d.encodings[0].maxBitrate=c:d.encodings=[{maxBitrate:c}];b("Promise").resolve(a.setParameters(d))}else this.$6.logError(this.$2,this.$3,"received 0 for max audio bitrate")}};c.onReceivedRemoteSDP=function(a,c,d){var e=this;this.$103(d);d=b("ScotchRTCP2PCallStore").getState();d=d.isPeerOnMobile;d&&(a=b("ScotchFBRTCSdpUtils").setVideoBitrateConstraint(a));c==="answer"?a=this.$4.transformRemoteSdp(a):b("ScotchRTCP2PCallEscalationStore").isEscalated()&&(a=this.$4.processRemoteOfferSdpForP2PVideoEscalation(a));return this.$4.setRemoteDescription(new(b("ScotchRTCSessionDescription"))(j.P2P,{type:c,sdp:a})).then(function(){e.$17=!0,e.$16.drainCandidates(e.$2,e.$3,function(a){return e.$4.onReceivedRemoteIceCandidate(a)})}).then(function(){e.$66();return c!=="offer"?void 0:e.$4.createAnswer({DISABLE_OPUS_STEREO:b("ScotchRTWebClientFeatureGating").disableOpusStereo(),ADD_AUDIO_NACK:b("ScotchRTCSignalingExperiments").shouldEnableAudioNack()}).then(function(a){e.$70(a),e.$34("SDP update",{answer:a.toSdp()})})}).then(function(){e.$39()===b("ScotchRTCCallType").AUDIO_ONLY&&e.$11.sendMuteStateUpdate(e.$2,e.$3,!1)})["catch"](function(a){e.$63(a);throw a})};c.$103=function(a){if(a){var b=a.streams;this.$5=babelHelpers["extends"]({},this.$5,a,{streams:babelHelpers["extends"]({},this.$5.streams,b)})}};c.$95=function(a){return a.call_id===this.$3?!0:Boolean((this.$21||!this.$20)&&(!this.$3||a.call_id!==this.$3)&&b("ScotchRTCP2PCallStore").isCaller()&&(!a.handlescollision||a.call_id<this.$3))};c.$86=function(a){var c=this,d=this.$4.getSignalingState();if(d!=="have-local-offer")return;d=a.msg;this.$76(!!d.negotiated_escalation_support,d.escalation_conference_name);b("clearTimeout")(this.$24);this.$98();this.$99();this.$11.sendAnswerAck(this.$2,this.$3,d);b("ScotchRTCP2PCallActions").processMessage(a);b("ScotchRTCP2PCallActions").setConnectionStatus("CONNECTING");this.onReceivedRemoteSDP(d.sdp,"answer",d.attributes).then(function(){c.$102(),b("ScotchRTCCallActions").callSuccess(!0)})["catch"](function(a){c.$63(new Error("Failed to handle answer on receiving remote SDP"))});this.$82(d)};c.$92=function(a){var b=a.msg;this.$12&&this.$12.isAckMsg(b)?(r(function(b){b.onMsgAckReceived(a,!0)}),this.$90(a)):this.$13&&this.$13.isAckMsg(b)&&(r(function(b){b.onMsgAckReceived(a,!1)}),this.$91())};c.$90=function(a){b("ScotchRTCP2PCallActions").setConnectionStatus("RINGING"),r(function(c){c.setUploadLogLevel(b("FBRTCLocalUploadLogLevel").getUploadLogLevel(b("FBRTCConstants").convertToUploadLogLevel(a.msg.ull)))}),b("clearTimeout")(this.$24),this.$98()};c.$91=function(){this.$100(),this.$102(),b("ScotchRTCCallActions").incomingCallSuccess()};c.$93=function(a){this.$19?this.$75(a):(this.$72("ScotchRTCP2PProtocolHandler: P2P message "+a.msgType+" queued for delay handling"),this.$18.push(a))};c.$75=function(a){b("ScotchRTCP2PCallStore").getState().isRemoteVideoSupported&&!b("ScotchRTCP2PCallStore").isAudioOnly()&&this.$82(a.msg)};c.$88=function(a){var b=this,c=a.msg;c.call_id===this.$3&&this.$17?this.$4.onReceivedRemoteIceCandidate(c)["catch"](function(a){b.$104(c)}):this.$104(c)};c.$104=function(a){this.$16.cacheCandidate(this.$2,a.call_id,a)};c.$89=function(a){a=a.msg;var b=a.call_id,c=a.reason;a=a.subreason;b===this.$3?this.$38(c,!0,!1,!1,a):(this.$6.logError(this.$2,this.$3,"Receiving hangup for a different call: "+b.toString()),this.$34("hangup callID missmatch",b.toString()))};c.$38=function(a,c,d,e,f){var h=this,i=new(b("ScotchRTCEndCallReason"))(a).setSubreason(f).setRemoteEnded(c);b("ScotchRTCCallActions").setEndCallReason(i);b("ScotchRTCCallNUXActions").refreshNUXState();a=b("ScotchRTCP2PCallEscalationStore").getState().inProgress;a&&b("ScotchRTCP2PCallEscalationActions").cancel();b("clearTimeout")(this.$24);this.$98();this.$99();this.$100();if(this.$83()){this.$6.logError(this.$2,this.$3,"Ending an already-ended call");return}this.$6.logCallAction(this.$2,this.$3,b("FBRTCLogger").CallAction.END_CALL,i.toStrName());this.$34("call: ended",{reason:i.toStrName(),reasonID:i.getReasonID(),subReason:i.getSubreason(),isRemoteEnded:c,userCallType:this.$39(),isCaller:b("ScotchRTCP2PCallStore").isCaller()});d&&this.$94(this.$2,this.$3,i,e);this.$26.stop();this.$27.stop();this.$28.stop();b("ScotchRTCCallActions").hangupSuccess();this.$32||b("ScotchRTCCallActions").removeAllLocalStreams(!0);b("ScotchRTCCallActions").removeAllLocalScreenStreams(!0);b("ScotchRTCCallActions").removeAllRemoteStreams(this.$2);b("ScotchRTCP2PCallActions").setConnectionStatus("DISCONNECTED");if(b("gkx")("965758")){f=b("ScotchRTCCallStore").getState();a=f.callSummary;d=f.callInfo;e=b("ZenonTSLogDataHelper").serialize(d.tsLogData);this.$6.logTsLogData(e,a.peerID,a.callID,d.conferenceName)}r(function(a){a.setCallType(b("ScotchRTCP2PCallEscalationStore").getState().callType),a.setVideoDurations(h.$26.getDuration(),h.$27.getDuration()),a.setScreenDuration(h.$28.getDuration()),a.onCallEnded(i.getReasonID(),c,null,i.getSubreason()),h.$35("logged end call to call summary")});this.$4&&this.$4.close();i.getReasonID()===g.HANGUP_CALL&&i.getSubreason()==="CallReset"&&c&&b("ScotchRTCP2PCallWindowHandler").close()};c.$39=function(){var a=b("ScotchRTCCallStore").getState();a=a.localUser;var c=this.$49(a);return c===!1&&a.isAudioDisabled()?b("ScotchRTCCallType").NO_AUDIO_VIDEO:c===!1&&!a.isAudioDisabled()?b("ScotchRTCCallType").AUDIO_ONLY:b("ScotchRTCCallType").AUDIO_VIDEO};c.shutDownP2PListenersForMultiwayEscalation=function(){var a=this;b("clearTimeout")(this.$24);this.$98();this.$99();this.$100();this.$26.stop();this.$27.stop();this.$4&&this.$4.removeAllListeners();b("setTimeout")(function(){b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(c){c.setCallType(b("ScotchRTCP2PCallEscalationStore").getState().callType),c.setVideoDurations(a.$26.getDuration(),a.$27.getDuration()),c.setScreenDuration(a.$28.getDuration()),c.onCallEnded(g.HANGUP_CALL,!1,!1,"multiway escalation")}),b("ScotchRTCCallActions").completeTransitionToMultiway()},100);this.destroy()};c.$94=function(a,b,c,d){if(!this.$11)return;this.$11.sendHangup(a,b,c.getReasonID(),d,c.getSubreason());this.$11.sendOtherDismiss(b)};c.$98=function(){this.$12&&this.$12.stopRetrying()};c.$100=function(){this.$13&&this.$13.stopRetrying()};c.$99=function(){this.$21&&b("clearTimeout")(this.$21),this.$21=null};c.$83=function(){return b("ScotchRTCCallStore").getState().callInfo.conferenceState==="TERMINATED"};c.$61=function(a){var c=this;q(function(d){d=d.logConnectionStats(function(){var c=a.getSignalingState();return c!=="closed"?a.getStats():b("Promise").reject("peer connection closed")},c.$2,c.$3);var e=d.start,f=d.stop;d=function b(d){d=d.target;d=d.iceConnectionState;(d==="completed"||d==="connected")&&(c.$35("RTCP2PProtocolHandler_call_connected"),c.$34("call: connected"),e(),a.removeEventListener("iceconnectionstatechange",b),a.addEventListener("iceconnectionstatechange",g))};var g=function b(c){c=c.target;c=c.iceConnectionState;c==="closed"&&(f(),a.removeEventListener("iceconnectionstatechange",b))};a.addEventListener("iceconnectionstatechange",d)})};c.$34=function(a,b){var c=this;q(function(d){return d.log(a,{peerID:c.$2,callID:c.$3,eventDetails:b})})};c.destroy=function(){this.$30.clear();if(b("ScotchRTWebExperiments").shouldUseZenonSignaling()){var a=b("ScotchRTCP2PCallStore").getState().signalingChild;a!=null&&a.removeAllListeners("messageReceived")}else b("FBRTCMessageListener").removeMessageHandler();b("FBRTCConfig").isVCEndpointCall()&&b("FBRTCMessageListener").removeOneVCMessageHandler();this.$11.onMessageSent=null,this.$11.onSendFailure=null};c.generateEscalationRequestToken=function(a){return this.$31.generateRequestToken(a)};c.generateEscalationResponseToken=function(a,b){return this.$31.generateResponseToken(a,b)};a.getDefaultVideoQuality=function(){return b("FBRTCConfig").isVCEndpointCall()||b("FBRTCConfig").shouldUseHDVideoQuality()?k.HD_VIDEO:b("CurrentUser").isWorkUser()?k.SD_VIDEO:k.LQ_VIDEO};a.showRedialButton=function(){var a=b("ScotchRTCP2PCallStore").getState();a=a.endCallReason;var c=b("ScotchRTCCallStore").getState();c=c.callSummary;return a!=null&&(a.getReasonID()===g.IGNORE_CALL||a.getReasonID()===g.NO_ANSWER_TIMEOUT)||c.getCallDuration()<=o};a.showStarRating=function(){if(!b("FBRTCConfig").isVCEndpointCall()){var c=b("ScotchRTCP2PCallStore").getState(),d=c.endCallReason;c=c.wasConnected;return c&&d!=null&&d.getReasonID()===g.HANGUP_CALL}else return!a.showRedialButton()};c.$72=function(a){this.$6.logInfo(this.$2,this.$3,a)};c.$35=function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:a,callID:this.$3?this.$3.toString():null,callType:"p2p"})};return a}();e.exports=d;function q(a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["ScotchCollabMessengerLogger"],a,"ScotchRTCP2PProtocolHandler")}function r(a){var c=b("ScotchRTCCallStore").getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())}function s(a,c,d,e){var f,g,h,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:f={requestAudio:!0};d!=null&&(f.deviceId={ideal:d});g={requestVideo:a||c,aspectRatio:{ideal:Number((16/9).toFixed(10))},height:{max:i.SD_HEIGHT,min:i.LQ_HEIGHT,ideal:i.LQ_HEIGHT},width:{max:i.SD_WIDTH,min:i.LQ_WIDTH,ideal:i.LQ_WIDTH},frameRate:{max:i.FRAME_RATE,min:10,ideal:i.LQ_FRAME_RATE}};e!=null&&(g.deviceId={ideal:e});k.next=6;return b("regeneratorRuntime").awrap(b("ZenonLocalMediaSDK").getUserMediaWithFallback(f,a||c?g:{requestVideo:!1}));case 6:h=k.sent;if(!(c&&!a)){k.next=11;break}j=[];h.forEach(function(a){a.contentType==="video"&&(a.webrtcTrack.enabled=!1,j.push(new(b("ZenonImmutableMediaTrack"))({trackId:a.trackId,label:a.label,webrtcStream:a.webrtcStream,webrtcTrack:a.webrtcTrack,enabled:!1,userMuted:a.userMuted,remote:a.remote,contentType:a.contentType,contentHint:a.contentHint}))),j.push(a)});return k.abrupt("return",j[0].webrtcStream);case 11:return k.abrupt("return",h[0].webrtcStream);case 12:case"end":return k.stop()}},null,this)}},null);
__d("ScotchFBRTCMediaMetricsConst",[],function(a,b,c,d,e,f){"use strict";a="jitter";f.JITTER=a;b="accelerate_rate";f.ACCELERATE_RATE=b;c="decoding_cng";f.DECODING_CNG=c;d="decoding_normal";f.DECODING_NORMAL=d;e="decoding_plc";f.DECODING_PLC=e;a="decoding_plc_cng";f.DECODING_PLC_CNG=a;b="decoding_neteq_call";f.DECODING_NETEQ_CALL=b;c="discard_rate";f.DISCARD_RATE=c;d="expand_rate";f.EXPAND_RATE=d;e="speech_expand_rate";f.SPEECH_EXPAND_RATE=e;a="preemptive_rate";f.PREEMPTIVE_RATE=a;b="audio_send_total_energy";f.AUDIO_SEND_TOTAL_ENERGY=b;c="audio_receive_total_energy";f.AUDIO_RECEIVE_TOTAL_ENERGY=c;d="audio_send_log_level";f.AUDIO_SEND_LOG_LEVEL=d;e="audio_send_log_level_count";f.AUDIO_SEND_LOG_LEVEL_COUNT=e;a="audio_receive_log_level";f.AUDIO_RECEIVE_LOG_LEVEL=a;b="audio_receive_log_level_count";f.AUDIO_RECEIVE_LOG_LEVEL_COUNT=b;c="audio_packets_received";f.AUDIO_PACKETS_RECEIVED=c;d="audio_fec_packets_received";f.AUDIO_FEC_PACKETS_RECEIVED=d;e="audio_fec_packets_discarded";f.AUDIO_FEC_PACKETS_DISCARDED=e;a="audio_packets_received_lost";f.AUDIO_PACKETS_RECEIVED_LOST=a;b="audio_packets_sent";f.AUDIO_PACKETS_SENT=b;c="audio_packets_sent_lost";f.AUDIO_PACKETS_SENT_LOST=c;d="video_bytes_received";f.VIDEO_BYTES_RECEIVED=d;e="video_bytes_sent";f.VIDEO_BYTES_SENT=e;a="inbound_qp";f.INBOUND_QP=a;b="outbound_qp";f.OUTBOUND_QP=b;c="frames_encoded";f.FRAMES_ENCODED=c;d="frames_decoded";f.FRAMES_DECODED=d;e="frames_received";f.FRAMES_RECEIVED=e;a="frames_sent";f.FRAMES_SENT=a;b="keyframes_decoded";f.KEYFRAMES_DECODED=b;c="picture_less_indication_received";f.PICTURE_LOSS_INDICAION_RECEIVED=c;d="full_intra_request_received";f.FULL_INTRA_REQUEST_RECEIVED=d;e="videobwe_send_bandwidth";f.VIDEOBWE_SEND_BANDWIDTH=e;a="videobwe_transmit_bitrate";f.VIDEOBWE_TRANSMIT_BITRATE=a;b="videobwe_retransmit_bitrate";f.VIDEOBWE_RETRANSMIT_BITRATE=b;c="audio_bytes_sent";f.AUDIO_BYTES_SENT=c;d="audio_bytes_received";f.AUDIO_BYTES_RECEIVED=d;e="video_pkts_sent";f.VIDEO_PKTS_SENT=e;a="video_pkts_send_lost";f.VIDEO_PKTS_SEND_LOST=a;b="video_pkts_received";f.VIDEO_PKTS_RECEIVED=b;c="video_fec_pkts_received";f.VIDEO_FEC_PKTS_RECEIVED=c;d="video_fec_pkts_discarded";f.VIDEO_FEC_PKTS_DISCARDED=d;e="video_pkts_receive_lost";f.VIDEO_PKTS_RECV_LOST=e;a="audio_rtt_received";f.AUDIO_RTT_RECEIVED=a;b="audio_rtt_sent";f.AUDIO_RTT_SENT=b;c="audio_dev_rec_stalls";f.AUDIO_DEV_REC_STALLS=c;d="audio_dev_total_stalls";f.AUDIO_DEV_TOTAL_STALLS=d;e="audio_dev_is_stalled";f.AUDIO_DEV_IS_STALLED=e;a="audio_dev_stall_duration";f.AUDIO_DEV_STALL_DURATION=a;b="video_freeze_cnt";f.VIDEO_FREEZE_COUNT=b;c="video_freeze_duration";f.VIDEO_FREEZE_DURATION=c;d="video_pause_cnt";f.VIDEO_PAUSE_COUNT=d;e="video_pause_duration";f.VIDEO_PAUSE_DURATION=e;a="video_capture_width";f.VIDEO_CAPTURE_WIDTH=a;b="video_capture_height";f.VIDEO_CAPTURE_HEIGHT=b;c="video_sum_capture_pixel";f.VIDEO_SUM_CAPTURE_PIXEL=c;d="video_capture_frame_count";f.VIDEO_CAPTURE_FRAME_COUNT=d;e="video_decoded_width";f.VIDEO_DECODED_WIDTH=e;a="video_decoded_height";f.VIDEO_DECODED_HEIGHT=a;b="video_encoded_width";f.VIDEO_ENCODED_WIDTH=b;c="video_encoded_height";f.VIDEO_ENCODED_HEIGHT=c;d="video_sum_decoded_pixel";f.VIDEO_SUM_DECODED_PIXEL=d;e="video_sum_encoded_pixel";f.VIDEO_SUM_ENCODED_PIXEL=e;a="audio_total_packet_send_delay";f.AUDIO_TOTAL_PACKET_SEND_DELAY=a;b="video_total_packet_send_delay";f.VIDEO_TOTAL_PACKET_SEND_DELAY=b;c="audio_total_encode_time";f.AUDIO_TOTAL_ENCODE_TIME=c;d="video_total_encode_time";f.VIDEO_TOTAL_ENCODE_TIME=d;e="audio_total_decode_time";f.AUDIO_TOTAL_DECODE_TIME=e;a="video_total_decode_time";f.VIDEO_TOTAL_DECODE_TIME=a;b="audio_jitter_buffer_delay";f.AUDIO_JITTER_BUFFER_DELAY=b;c="video_jitter_buffer_delay";f.VIDEO_JITTER_BUFFER_DELAY=c;d="audio_jitter_buffer_emitted_count";f.AUDIO_JITTER_BUFFER_EMITTED_COUNT=d;e="video_jitter_buffer_emitted_count";f.VIDEO_JITTER_BUFFER_EMITTED_COUNT=e;a="audio_e2e_latency";f.AUDIO_E2E_LATENCY=a;b="video_e2e_latency";f.VIDEO_E2E_LATENCY=b;c="av_sync";f.AV_SYNC=c;d="av_sync_abs";f.AV_SYNC_ABS=d;e="av_sync_count";f.AV_SYNC_COUNT=e;a="av_sync_oob";f.AV_SYNC_OOB=a;b="video_debugFPS";f.VIDEO_DEBUGFPS=b;c="video_debuglastUpdate";f.VIDEO_DEBUGLASTUPDATE=c;d="video_debugtracktimestamp";f.VIDEO_DEBUGTRACKTIMESTAMP=d;e="audio_neteq_wait_time";f.AUDIO_NETEQ_WAIT_TIME=e;a="audio_packet_loss_rate";f.AUDIO_PACKET_LOSS_RATE=a;b="audio_plc_cng_rate";f.AUDIO_PLC_CNG_RATE=b;c="audio_plc_rate";f.AUDIO_PLC_RATE=c;d="global_audio_bitrate";f.GLOBAL_AUDIO_BITRATE=d;e="global_battery_usage";f.GLOBAL_BATTERY_USAGE=e;a="global_cpu_usage";f.GLOBAL_CPU_USAGE=a;b="global_video_bitrate";f.GLOBAL_VIDEO_BITRATE=b;c="video_av_sync_abs";f.VIDEO_AV_SYNC_ABS=c;d="video_av_sync_oob";f.VIDEO_AV_SYNC_OOB=d;e="video_frame_rate";f.VIDEO_FRAME_RATE=e;a="video_freeze_count_per_min";f.VIDEO_FREEZE_COUNT_PER_MIN=a;b="video_freeze_duration_per_min";f.VIDEO_FREEZE_DURATION_PER_MIN=b;c="video_neteq_wait_time";f.VIDEO_NETEQ_WAIT_TIME=c;d="video_packet_loss_rate";f.VIDEO_PACKET_LOSS_RATE=d;e="video_render_scale_ratio";f.VIDEO_RENDER_SCALE_RATIO=e;a="video_cropping_ratio";f.VIDEO_CROPPING_RATIO=a;b="video_rtt_received";f.VIDEO_RTT_RECEIVED=b;c="video_rtt_sent";f.VIDEO_RTT_SENT=c;d="simulcast_layer_changes";f.SIMULCAST_LAYER_CHANGES=d;e="video_quality_sent";f.VIDEO_QUALITY_SENT=e;a="video_encoded_frame_rate";f.VIDEO_ENCODED_FRAME_RATE=a;b="video_qp_sent";f.VIDEO_QP_SENT=b;c="video_decode_time";f.VIDEO_DECODE_TIME=c},null);
__d("ZenonNetworkQualityMonitor",["ScotchRTWebUserActionLogger","UserAgent","ZenonExperiments","$InternalEnum"],function(a,b,c,d,e,f){"use strict";var g=2;a=function(){function a(){var a;this.$3=0;this.$4=h.Good;this.$1=(a=b("ZenonExperiments").getNetworkMonitorRttThreshold())!=null?a:Number.POSITIVE_INFINITY;this.$2=(a=b("ZenonExperiments").getNetworkMonitorPacketLossRateThreshold())!=null?a:Number.POSITIVE_INFINITY;b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ZenonNetworkQualityMonitor constructed: rtt "+this.$1+", packetLoss "+this.$2,eventName:"checkpoint"})}var c=a.prototype;c.$5=function(a,b,c){a=a.get(b);if(a!=null){b=a.deltaStat[c];if(b!=null){return((a=b.getLastAddedValue())!=null?a:0)>this.$1}}return!1};c.$6=function(a,b){a=a<0?0:a/(a+b);return a>=this.$2};c.$7=function(a,b,c,d){a=a.get(b);if(a!=null){b=a.cumulativeStat[c];c=a.cumulativeStat[d];if(b!=null&&c!=null)return this.$6(b.getDeltaFromLastUpdate(),c.getDeltaFromLastUpdate())}return!1};c.$8=function(a,b,c){var d=this,e=c.packetLostKey,f=c.packetsKey,g=c.rttKey;c=b.some(function(b){var c=d.$7(a,b,e,f);return c||d.$5(a,b,g)});return c};c.getMetricKeys=function(a){return{packetLostKey:"packetsLost",packetsKey:a?"packetsSent":"packetsReceived",rttKey:b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera")?"googRtt":"roundTripTime"}};c.getCount=function(){return this.$3};c.determineQuality=function(a){var b=this.$3,c=this.$8(a,Array.from(a.keys()),this.getMetricKeys(!0));a=this.$8(a,Array.from(a.keys()),this.getMetricKeys(!1));c||a?this.$3<g&&this.$3++:this.$3>0&&this.$3--;b!==this.$3&&this.$3>=g?this.$4=h.Poor:b>0&&this.$3<=0&&(this.$4=h.Good);return this.$4};return a}();f.ZenonNetworkQualityMonitor=a;var h=b("$InternalEnum").Mirrored(["Good","Poor","Fair"]);f.ZenonNetworkQuality=h},null);
__d("ZenonHistogram",[],function(a,b,c,d,e,f){"use strict";function g(a,b){return(a.value||0)-(b.value||0)}a=function(){function a(){this.$1=[],this.$2=!0}var b=a.prototype;b.$3=function(){this.$2===!1&&this.$1.sort(g),this.$2=!0};b.add=function(a){this.$1.push(a),this.$2=!1};b.getAvgAndPercentile=function(a,b){this.$2||this.$3();var c=b?this.$1.filter(b):this.$1;if(c.length===0)return{avg:null,percentiles:null};b=c.reduce(function(a,b){return a+b.value},0)/c.length;a=a.map(function(a){a=Math.min(100,Math.max(0,a));a=(c.length-1)*a/100;var b=Math.floor(a),d=Math.ceil(a);if(b===d)return c[b].value;var e=c[b].value*(d-a);d=c[d].value*(a-b);return e+d});return{avg:b,percentiles:a}};return a}();e.exports=a},null);
__d("ZenonPercentMediaStat",["ZenonHistogram","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new(b("ZenonHistogram"))()}var c=a.prototype;c.add=function(a,b,c,d){c={contentType:c,value:a,view:b,voiceEnergy:d};this.$1.add(c)};c.getAvgAndPercentile=function(a,c,d,e){var f;e==null?f=function(a){return a.view===c&&a.contentType===d}:f=function(a){var f=a.voiceEnergy>b("ZenonMediaStatsConfig").VOICE_ENERGY_THRESHOLD;return a.view===c&&a.contentType===d&&f===e};return this.$1.getAvgAndPercentile(a,f)};return a}();e.exports=a},null);
__d("ScotchFBRTCMediaMetricParser",["regeneratorRuntime","FBRTCLogger","FBRTCMediaMetricTracker","FBRTCParticipantCallState","ScotchCallModelEmitter","ScotchFBRTCMediaMetricsConst","ScotchFBRTCStatsHelpers","ScotchRTCCallStore","ScotchRTCP2PCallActions","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonMediaStatsReportPoller","ZenonNetworkQualityMonitor","ZenonPercentMediaStat","ZenonRenderedView","gkx","performanceNow","promiseDone","qex"],function(a,b,c,d,e,f){"use strict";f.startCollectingMediaStats=a;f.addZenonSpecialTrackStatsToScotch=q;f.updateBatteryStats=r;f.addZenonPercentStatsToScotch=s;f.addZenonFilteredStatsToScotch=t;f.getMediaMetricConst=u;var g,h=5e3;f.DEFAULT_POLL_RATE_MS=h;var i=[(c=b("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_ABS],j=[{trackId:c.OUTBOUND_AUDIO_STATS_TRACKID,contentType:"audio",renderedView:(d=b("ZenonRenderedView")).GRID,isRemote:!1},{trackId:c.OUTBOUND_VIDEO_STATS_TRACKID,contentType:"video",renderedView:d.GRID,isRemote:!1},{trackId:c.OUTBOUND_SCREEN_STATS_TRACKID,contentType:"screen",renderedView:d.GRID,isRemote:!1}],k=[{trackId:c.GLOBAL_STATS_TRACKID,contentType:c.GLOBAL_STATS_CONTENT_TYPE,renderedView:c.GLOBAL_STATS_RENDERED_VIEW,isRemote:!1},{trackId:c.PINNED_AUDIO_STATS_TRACKID,contentType:"audio",renderedView:d.PINNED,isRemote:!0},{trackId:c.PINNED_VIDEO_STATS_TRACKID,contentType:"video",renderedView:d.PINNED,isRemote:!0}].concat(j),l=null;function a(){var a;if(l!==null)return;var c=null,d=b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Good,e=0,f=new Map();b("gkx")("1657183")&&(c=new(b("ZenonNetworkQualityMonitor").ZenonNetworkQualityMonitor)());var g=(a=b("qex")._("1064222"))!=null?a:h;a=function(){var a,h,i,j,k,m,u,v,w,x,y,z,A,B;return b("regeneratorRuntime").async(function(C){while(1)switch(C.prev=C.next){case 0:a=b("ScotchRTCCallStore").getState().callInfo.conferenceState;h=b("ScotchRTCCallStore").getState().callSummary;i=b("ScotchRTCCallStore").getState().connections.first();j=b("ScotchRTCCallStore").getState().callInfo.tsLogData;if(!(a==="TERMINATED"||a==="TERMINATING")){C.next=8;break}window.clearInterval(l);l=null;return C.abrupt("return");case 8:if(!i){C.next=28;break}k=b("ScotchCallModelEmitter").CallsModelEmitterInstance.getCallsModel().get("0");m=Array.from(k.mediaTracks.values());if(!b("gkx")("1760602")){C.next=16;break}C.next=14;return b("regeneratorRuntime").awrap(b("ZenonMediaStatsReportPoller").updateStatsFromConnection(m,f,i,j,g,k.participants));case 14:C.next=17;break;case 16:b("ZenonMediaStatsReportPoller").updateStatsFromConnection(m,f,i,j,g,k.participants);case 17:u=h.getMediaMetricTracker(),m.forEach(function(a){var c=f.get(a.trackId);if(c!=null){t(f,u,a.trackId,a.contentType,a.remote);var d=[b("ZenonRenderedView").GRID,b("ZenonRenderedView").THUMBNAIL];for(var e=0;e<d.length;e++){var g=d[e];s(f,u,a.trackId,a.contentType,g,a.remote)}n(f,h,a.trackId,a.contentType,a.remote);p(c,h)}}),b("promiseDone")(b("ScotchFBRTCStatsHelpers").getBatteryStats(),function(a){h.addExtraInfo(b("FBRTCLogger").Key.BATTERY_END,a.level),h.setDeviceCharged(a.wasCharged),r(f,a.level)}),m.forEach(function(a){a.remote===!1&&a.enabled===!0&&(a.contentType==="video"?h.setVideoDevice(a.label):a.contentType==="audio"&&h.setAudioDevice(a.label))}),q(f,u,h),o(f,h),c!=null&&(v=d,d=c.determineQuality(f),v!==d&&b("ScotchRTCP2PCallActions").togglePoorNetworkQualityIndicator(d===b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Poor)),w=0,(x=b("ScotchRTCCallStore").getState(),y=x.callInfo),(y==null?void 0:y.conferenceState)==="CONNECTED"&&(y.protocol==="p2p"?w=2:((z=b("ScotchRTCCallStore").getState(),A=z.remoteUsers),A!=null&&(B=A.filter(function(a){a=a.participantState;return(a==null?void 0:a.state)===b("FBRTCParticipantCallState").CONNECTED}),w=B.count()),w++)),w>e&&(e=w,h.addExtraInfo(b("FBRTCLogger").Key.MAX_CONCURRENT_CONNECTED_PARTICIPANTS,e));case 28:case"end":return C.stop()}},null,this)};l=window.setInterval(a,g);a()}function m(a){switch(a){case b("ZenonRenderedView").GRID:return"grid";case b("ZenonRenderedView").PINNED:return"pinned";case b("ZenonRenderedView").THUMBNAIL:return"thumbnail"}return"grid"}function n(a,c,d,e,f){a=a.get(d);if(a==null)return;if(f)a.codec!=null&&e==="video"&&c.setVideoReceivedCodec(a.codec);else{if(d!==b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID&&d!==b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID&&d!==b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID)return;a.codec!=null&&(e==="audio"?c.setAudioSentCodec(a.codec):c.setVideoSentCodec(a.codec));if(e==="video"&&a.codecHistory!=null){f=Object.fromEntries(a.codecHistory.map(function(a){var b=a.codec;a=a.updateTime;return[Math.round(a).toString(),b]}));c.setEhist(f)}}}function o(a,b){var c=0;a.forEach(function(a){a.cumulativeStat.framesDecoded!=null&&a.maxTotalDecodeTime!=null&&(c=Math.max(c,a.maxTotalDecodeTime))});b.setVideoMaxTotalDecodeTime(c)}function p(a,b){a=a.cumulativeStat;var c=a.totalDecodeTime,d=a.totalEncodeTime;a=a.keyFramesEncoded;if(c){var e;b.setTotalDecodeTime(((e=b.getTotalDecodeTime())!=null?e:0)+c.getDeltaFromLastUpdate())}if(d){b.setTotalEncodeTime(((e=b.getTotalEncodeTime())!=null?e:0)+d.getDeltaFromLastUpdate())}if(a){b.setKeyFramesEncoded(((c=b.getKeyFramesEncoded())!=null?c:0)+a.getDeltaFromLastUpdate())}}function q(a,b,c){for(var d=0;d<j.length;d++){var e=j[d];t(a,b,e.trackId,e.contentType,e.isRemote);n(a,c,e.trackId,e.contentType,e.isRemote)}for(var e=k,d=Array.isArray(e),c=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(c>=e.length)break;f=e[c++]}else{c=e.next();if(c.done)break;f=c.value}f=f;s(a,b,f.trackId,f.contentType,f.renderedView,f.isRemote)}}function r(a,c){a=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(a,b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID);var d=b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_BATTERY_USAGE;if(a.batteryLevel!=null&&a.batteryLevel!==c){var e=a.batteryLevel-c,f=(g||(g=b("performanceNow")))();a.batteryLastChangeTimestamp!=null&&f>a.batteryLastChangeTimestamp&&e>0&&a.batteryCharging!==!0&&(a.percentStat[d]==null&&(a.percentStat[d]=new(b("ZenonPercentMediaStat"))()),a.percentStat[d].add(e*100*6e4/(f-a.batteryLastChangeTimestamp),b("ZenonMediaStatsConfig").GLOBAL_STATS_RENDERED_VIEW,b("ZenonMediaStatsConfig").GLOBAL_STATS_CONTENT_TYPE,0));a.batteryLastChangeTimestamp=f;e<0?a.batteryCharging=!0:a.batteryCharging=!1}a.batteryLevel=c}function s(a,c,d,e,f,g){var h=a.get(d),j=m(f),k=e==="audio";h!=null&&Object.keys(h.percentStat).forEach(function(a){var l=u(a,g,k),m=null;i.includes(a)&&(m=!0);if(l!=null){a=h.percentStat[a].getAvgAndPercentile(b("ZenonMediaStatsConfig").PERCENTILES_REQUESTED,f,e,m);if(a.avg!=null&&a.percentiles!=null){m=((m=a.percentiles)==null?void 0:m.length)||0;if(k){c.addMetricStat(d,b("FBRTCMediaMetricTracker").getAvgMediaKey(l,j),a.avg);for(var n=0;n<m;n++){var o;c.addMetricStat(d,b("FBRTCMediaMetricTracker").getPercentMediaKey(l,j,b("ZenonMediaStatsConfig").PERCENTILES_REQUESTED[n]),(o=a.percentiles)==null?void 0:o[n])}}else{c.setVideoMetric(d,b("FBRTCMediaMetricTracker").getAvgMediaKey(l,j),a.avg);for(var o=0;o<m;o++){c.setVideoMetric(d,b("FBRTCMediaMetricTracker").getPercentMediaKey(l,j,b("ZenonMediaStatsConfig").PERCENTILES_REQUESTED[o]),(n=a.percentiles)==null?void 0:n[o])}}}}})}function t(a,c,d,e,f){var g=e==="audio",h=a.get(d);if(h==null)return;if(!f&&d!==b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID&&d!==b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID&&d!==b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID)return;if(g&&h.deltaStat.googCurrentDelayMs!=null){var i;a=(a=h.cumulativeStat.jitterBufferDelay)==null?void 0:a.getDeltaFromLastUpdate();i=(i=h.cumulativeStat.jitterBufferEmittedCount)==null?void 0:i.getDeltaFromLastUpdate();a!=null&&i>0&&c.addJitterBufferDelay(d,a/i)}!g&&f===!1&&(c.setHistResScale(d,e,h.histResScale),c.setVideoContentType(d,e),e==="video"&&h.sender!=null&&c.updateVideoSender(d,e,h.sender));Object.keys(h.deltaStat).forEach(function(a){var b=u(a,f,g);b!=null&&(g?c.addMetricStat(d,b,h.deltaStat[a].getLastAddedValue()):c.setVideoMetric(d,b,h.deltaStat[a].getLastAddedValue()))});Object.keys(h.cumulativeStat).forEach(function(a){var b=u(a,f,g);b!=null&&(g?c.addMetricStat(d,b,h.cumulativeStat[a].getCurrentValue()):c.setVideoMetric(d,b,h.cumulativeStat[a].getCurrentValue()))})}function u(a,c,d){switch(a){case"packetsReceived":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_RECEIVED;case"fecPacketsReceived":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_FEC_PACKETS_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_FEC_PKTS_RECEIVED;case"fecPacketsDiscarded":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_FEC_PACKETS_DISCARDED:b("ScotchFBRTCMediaMetricsConst").VIDEO_FEC_PKTS_DISCARDED;case b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED:return c?d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED_LOST:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_RECV_LOST:d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_SENT_LOST:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_SEND_LOST;case"packetsSent":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_SENT:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_SENT;case"bytesSent":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_BYTES_SENT:b("ScotchFBRTCMediaMetricsConst").VIDEO_BYTES_SENT;case"bytesReceived":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_BYTES_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_BYTES_RECEIVED;case"framesDecoded":return b("ScotchFBRTCMediaMetricsConst").FRAMES_DECODED;case"framesEncoded":return b("ScotchFBRTCMediaMetricsConst").FRAMES_ENCODED;case"framesReceived":return b("ScotchFBRTCMediaMetricsConst").FRAMES_RECEIVED;case"framesSent":return b("ScotchFBRTCMediaMetricsConst").FRAMES_SENT;case"keyFramesDecoded":return b("ScotchFBRTCMediaMetricsConst").KEYFRAMES_DECODED;case"pliCount":return b("ScotchFBRTCMediaMetricsConst").PICTURE_LOSS_INDICAION_RECEIVED;case"firCount":return b("ScotchFBRTCMediaMetricsConst").FULL_INTRA_REQUEST_RECEIVED;case"googDecodingPLC":return b("ScotchFBRTCMediaMetricsConst").DECODING_PLC;case"googDecodingPLCCNG":return b("ScotchFBRTCMediaMetricsConst").DECODING_PLC_CNG;case"googDecodingCNG":return b("ScotchFBRTCMediaMetricsConst").DECODING_CNG;case"googDecodingNormal":return b("ScotchFBRTCMediaMetricsConst").DECODING_NORMAL;case"googDecodingCTN":return b("ScotchFBRTCMediaMetricsConst").DECODING_NETEQ_CALL;case"googRtt":return d?c?b("ScotchFBRTCMediaMetricsConst").AUDIO_RTT_RECEIVED:b("ScotchFBRTCMediaMetricsConst").AUDIO_RTT_SENT:c?b("ScotchFBRTCMediaMetricsConst").VIDEO_RTT_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_RTT_SENT;case"googJitterReceived":case"jitter":return b("ScotchFBRTCMediaMetricsConst").JITTER;case"googAccelerateRate":return b("ScotchFBRTCMediaMetricsConst").ACCELERATE_RATE;case"googExpandRate":return b("ScotchFBRTCMediaMetricsConst").EXPAND_RATE;case"googPreemptiveExpandRate":return b("ScotchFBRTCMediaMetricsConst").PREEMPTIVE_RATE;case"googSecondaryDiscardedRate":return b("ScotchFBRTCMediaMetricsConst").DISCARD_RATE;case"googSpeechExpandRate":return b("ScotchFBRTCMediaMetricsConst").SPEECH_EXPAND_RATE;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME:return b("ScotchFBRTCMediaMetricsConst").VIDEO_DECODE_TIME;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_DURATION;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT:return b("ScotchFBRTCMediaMetricsConst").VIDEO_PAUSE_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION:return b("ScotchFBRTCMediaMetricsConst").VIDEO_PAUSE_DURATION;case"width":return b("ScotchFBRTCMediaMetricsConst").VIDEO_CAPTURE_WIDTH;case"height":return b("ScotchFBRTCMediaMetricsConst").VIDEO_CAPTURE_HEIGHT;case"availableOutgoingBitrate":return b("ScotchFBRTCMediaMetricsConst").VIDEOBWE_SEND_BANDWIDTH;case"frameWidth":return c?b("ScotchFBRTCMediaMetricsConst").VIDEO_DECODED_WIDTH:b("ScotchFBRTCMediaMetricsConst").VIDEO_ENCODED_WIDTH;case"frameHeight":return c?b("ScotchFBRTCMediaMetricsConst").VIDEO_DECODED_HEIGHT:b("ScotchFBRTCMediaMetricsConst").VIDEO_ENCODED_HEIGHT;case"totalPacketSendDelay":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_TOTAL_PACKET_SEND_DELAY:b("ScotchFBRTCMediaMetricsConst").VIDEO_TOTAL_PACKET_SEND_DELAY;case"totalDecodeTime":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_TOTAL_DECODE_TIME:b("ScotchFBRTCMediaMetricsConst").VIDEO_TOTAL_DECODE_TIME;case"totalEncodeTime":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_TOTAL_ENCODE_TIME:b("ScotchFBRTCMediaMetricsConst").VIDEO_TOTAL_ENCODE_TIME;case"totalAudioEnergy":return c?b("ScotchFBRTCMediaMetricsConst").AUDIO_RECEIVE_TOTAL_ENERGY:b("ScotchFBRTCMediaMetricsConst").AUDIO_SEND_TOTAL_ENERGY;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL:return c?b("ScotchFBRTCMediaMetricsConst").AUDIO_RECEIVE_LOG_LEVEL:b("ScotchFBRTCMediaMetricsConst").AUDIO_SEND_LOG_LEVEL;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT:return c?b("ScotchFBRTCMediaMetricsConst").AUDIO_RECEIVE_LOG_LEVEL_COUNT:b("ScotchFBRTCMediaMetricsConst").AUDIO_SEND_LOG_LEVEL_COUNT;case"jitterBufferDelay":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_DELAY:b("ScotchFBRTCMediaMetricsConst").VIDEO_JITTER_BUFFER_DELAY;case"jitterBufferEmittedCount":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_EMITTED_COUNT:b("ScotchFBRTCMediaMetricsConst").VIDEO_JITTER_BUFFER_EMITTED_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY:return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_E2E_LATENCY:b("ScotchFBRTCMediaMetricsConst").VIDEO_E2E_LATENCY;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC_ABS;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC_OOB;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_IS_STALLED;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_REC_STALLS;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_TOTAL_STALLS;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_STALL_DURATION;case b("ZenonMediaStatsConfig").DERIVED_METRICS.SIMULCAST_LAYER_CHANGES:return b("ScotchFBRTCMediaMetricsConst").SIMULCAST_LAYER_CHANGES;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL:return c?b("ScotchFBRTCMediaMetricsConst").VIDEO_SUM_DECODED_PIXEL:b("ScotchFBRTCMediaMetricsConst").VIDEO_SUM_ENCODED_PIXEL;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL:return b("ScotchFBRTCMediaMetricsConst").VIDEO_SUM_CAPTURE_PIXEL;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT:return b("ScotchFBRTCMediaMetricsConst").VIDEO_CAPTURE_FRAME_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM:return c?b("ScotchFBRTCMediaMetricsConst").INBOUND_QP:b("ScotchFBRTCMediaMetricsConst").OUTBOUND_QP;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_NETEQ_WAIT_TIME:return b("ScotchFBRTCMediaMetricsConst").AUDIO_NETEQ_WAIT_TIME;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PACKET_LOSS_RATE:return b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKET_LOSS_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_CNG_RATE:return b("ScotchFBRTCMediaMetricsConst").AUDIO_PLC_CNG_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_RATE:return b("ScotchFBRTCMediaMetricsConst").AUDIO_PLC_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_AUDIO_BITRATE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_AUDIO_BITRATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_BATTERY_USAGE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_BATTERY_USAGE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_CPU_USAGE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_CPU_USAGE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_VIDEO_BITRATE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_VIDEO_BITRATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_ABS:return b("ScotchFBRTCMediaMetricsConst").VIDEO_AV_SYNC_ABS;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_OOB:return b("ScotchFBRTCMediaMetricsConst").VIDEO_AV_SYNC_OOB;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FRAME_RATE:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FRAME_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_COUNT_PER_MIN:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_COUNT_PER_MIN;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_DURATION_PER_MIN:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_DURATION_PER_MIN;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_NETEQ_WAIT_TIME:return b("ScotchFBRTCMediaMetricsConst").VIDEO_NETEQ_WAIT_TIME;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_PACKET_LOSS_RATE:return b("ScotchFBRTCMediaMetricsConst").VIDEO_PACKET_LOSS_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_RENDER_SCALE_RATIO:return b("ScotchFBRTCMediaMetricsConst").VIDEO_RENDER_SCALE_RATIO;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_CROPPING_RATIO:return b("ScotchFBRTCMediaMetricsConst").VIDEO_CROPPING_RATIO;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.ROUND_TRIP_TIME:return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_RTT_SENT:b("ScotchFBRTCMediaMetricsConst").VIDEO_RTT_SENT;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_QUALITY:return b("ScotchFBRTCMediaMetricsConst").VIDEO_QUALITY_SENT;case"video_debugFPS":return b("ScotchFBRTCMediaMetricsConst").VIDEO_DEBUGFPS;case"video_debuglastUpdate":return b("ScotchFBRTCMediaMetricsConst").VIDEO_DEBUGLASTUPDATE;case"video_debugtracktimestamp":return b("ScotchFBRTCMediaMetricsConst").VIDEO_DEBUGTRACKTIMESTAMP;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_ENCODED_FRAME_RATE:return b("ScotchFBRTCMediaMetricsConst").VIDEO_ENCODED_FRAME_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_QP:return b("ScotchFBRTCMediaMetricsConst").VIDEO_QP_SENT}}},null);
__d("ZenonScreenSharingAvailabilityType",["$InternalEnum"],function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["AudioCallUnsupported","Available","GroupCallUnsupported","RemoteUnsupported","Unknown"]);c=a;e.exports=c},null);
__d("ZenonCallFeatures",["immutable","ZenonNetworkQualityMonitor","ZenonScreenSharingAvailabilityType"],function(a,b,c,d,e,f){"use strict";a=b("ZenonNetworkQualityMonitor").ZenonNetworkQuality;c=b("immutable").Record({canAddParticipants:!1,canReplaceLocalStreams:!1,cowatchEnabled:!1,cowatchGroupEnabled:!1,dominantSpeaker:null,networkStatus:a.Good,screenSharingAvailability:b("ZenonScreenSharingAvailabilityType").Available,supportMultipleStreams:!1});d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c);e.exports=d},null);
__d("ZenonCall",["immutable","ZenonCallFeatures","ZenonCallsModelTypes"],function(a,b,c,d,e,f){"use strict";a=b("ZenonCallsModelTypes").ZenonCallState;d=(c=b("immutable")).Record({callState:a.New,clientCallId:"",collisionContext:{groupThreadID:null,peerID:null,serverInfoData:null},endCallReason:null,features:new(b("ZenonCallFeatures"))(),groupEscalationStatus:null,mediaTracks:c.Map(),participants:c.Map(),remoteScreenSharingUserIDs:c.OrderedSet(),responseSubCode:null,rtpReceivers_I_KNOW_WHAT_I_AM_DOING:c.Set(),rtpSenders_I_KNOW_WHAT_I_AM_DOING:c.Set(),stateSyncInputStates:c.Map(),stateSyncOutputStates:c.Map(),videoEscalationStatus:null});f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(d);e.exports=f},null);
__d("ZenonCallParticipant",["immutable","ZenonCallsModelTypes"],function(a,b,c,d,e,f){"use strict";a=b("ZenonCallsModelTypes").ZenonCallParticipantState;c=b("immutable").Record({id:void 0,isVideoSubscribed:!1,participantType:void 0,state:a.Disconnected,trackIDs:void 0});d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c);e.exports=d},null);
__d("ScotchCallModelEmitter",["invariant","EventEmitter","FBLogger","FBRTCConfig","FBRTCParticipantCallState","RTWebCallModelTypedLogger","ScotchFBRTCGroupCallStore","ScotchFBRTCScreenSharingUtils","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCGroupCallEscalationStore","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallStore","ScotchRTWebExperiments","UserAgent","ZenonCall","ZenonCallFeatures","ZenonCallParticipant","ZenonCallsModelTypes","ZenonImmutableMediaTrack","ZenonNetworkQualityMonitor","ZenonRTWebBrowserFeatureSupport","ZenonScreenSharingAvailabilityType","gkx","immutable","requireCond","cr:1420073"],function(a,b,c,d,e,f,g){"use strict";var h=[b("ScotchFBRTCGroupCallStore"),b("ScotchRTCCallStore"),b("ScotchRTCP2PCallStore"),b("ScotchRTCP2PCallEscalationStore"),b("ScotchRTCGroupCallEscalationStore")];f.ScotchCallModelEmitterStores=h;b("cr:1420073")&&h.push(b("cr:1420073"));var i=[b("ZenonCallsModelTypes").ZenonEndCallReason.IgnoreCall,b("ZenonCallsModelTypes").ZenonEndCallReason.HangupCall,b("ZenonCallsModelTypes").ZenonEndCallReason.InAnotherCall,b("ZenonCallsModelTypes").ZenonEndCallReason.CallEndAcceptAfterHangUp,b("ZenonCallsModelTypes").ZenonEndCallReason.NoAnswerTimeout,b("ZenonCallsModelTypes").ZenonEndCallReason.IncomingTimeout,b("ZenonCallsModelTypes").ZenonEndCallReason.OtherInstanceHandled,b("ZenonCallsModelTypes").ZenonEndCallReason.SignalingMessageFailed,b("ZenonCallsModelTypes").ZenonEndCallReason.ConnectionDropped,b("ZenonCallsModelTypes").ZenonEndCallReason.ClientInterrupted,b("ZenonCallsModelTypes").ZenonEndCallReason.WebRTCError,b("ZenonCallsModelTypes").ZenonEndCallReason.ClientError,b("ZenonCallsModelTypes").ZenonEndCallReason.NoPermission,b("ZenonCallsModelTypes").ZenonEndCallReason.OtherNotCapable,b("ZenonCallsModelTypes").ZenonEndCallReason.NoUIShown,b("ZenonCallsModelTypes").ZenonEndCallReason.VersionUnsupported,b("ZenonCallsModelTypes").ZenonEndCallReason.CallerNotVisible,b("ZenonCallsModelTypes").ZenonEndCallReason.CarrierBlocked,b("ZenonCallsModelTypes").ZenonEndCallReason.OtherCarrierBlocked,b("ZenonCallsModelTypes").ZenonEndCallReason.ClientEncryptionError,b("ZenonCallsModelTypes").ZenonEndCallReason.InactiveTimeout];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;c.$ScotchCallModelEmitter1=b("ScotchRTCAppDispatcher").explicitlyRegisterStores(h);return c}var d=c.prototype;d.getDispatchTokens=function(){return this.$ScotchCallModelEmitter1};d.$ScotchCallModelEmitter3=function(){return b("ScotchRTCCallStore").getState().callInfo.collisionContext};d.$ScotchCallModelEmitter4=function(){var a=b("ScotchRTCCallStore").getState().callInfo.conferenceState;switch(a){case"CONNECTED":case"RENEGOTIATING":return b("ZenonCallsModelTypes").ZenonCallState.Connected;case"CONNECTING":var c=b("ScotchRTCCallStore").getState().remoteUsers.find(function(a){return a.hasStream()});return c?b("ZenonCallsModelTypes").ZenonCallState.Connected:b("ZenonCallsModelTypes").ZenonCallState.Connecting;case"TERMINATING":return b("ZenonCallsModelTypes").ZenonCallState.Terminating;case"TERMINATED":return b("ZenonCallsModelTypes").ZenonCallState.Terminated;case"PENDING_APPROVAL":return b("ZenonCallsModelTypes").ZenonCallState.PendingApproval;case"NEW":case"AWAITING_USER_START":return b("ZenonCallsModelTypes").ZenonCallState.New;default:new(b("RTWebCallModelTypedLogger"))().setCallID(b("ScotchRTCCallStore").getState().callInfo.callID).setCallModelEvent("invalid_conference_state").log(),g(0,14242,a)}};d.$ScotchCallModelEmitter5=function(a){a=this.$ScotchCallModelEmitter4();if(a!==b("ZenonCallsModelTypes").ZenonCallState.Terminating&&a!==b("ZenonCallsModelTypes").ZenonCallState.Terminated)return null;a=b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway";a=a?b("ScotchFBRTCGroupCallStore").getState().endCallReason:b("ScotchRTCP2PCallStore").getState().endCallReason;return a!==null&&a!==void 0?(a=i[a.getReasonID()])!=null?a:b("ZenonCallsModelTypes").ZenonEndCallReason.Unknown:null};d.$ScotchCallModelEmitter6=function(){return b("ScotchRTCCallStore").getState().callInfo.responseSubCode};d.$ScotchCallModelEmitter7=function(a){a=b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway";var c;if(a)c=!0;else{var d=b("ScotchRTCP2PCallStore").getState(),e=d.offerEscalationSupport;d=d.escalationConferenceName;c=e&&d!=null}e=b("ScotchFBRTCGroupCallStore").getState().dominantSpeakerFBID;if(a)b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()?d=b("ZenonScreenSharingAvailabilityType").Available:d=b("ZenonScreenSharingAvailabilityType").GroupCallUnsupported;else{var f=b("ScotchRTCP2PCallStore").getState(),g=f.callType;f=f.signalingExperiments;g===b("ScotchRTCCallType").AUDIO_ONLY?d=b("ZenonScreenSharingAvailabilityType").AudioCallUnsupported:!b("ScotchFBRTCScreenSharingUtils").canPeerReceiveScreenSharing(f)?d=b("ZenonScreenSharingAvailabilityType").RemoteUnsupported:d=b("ZenonScreenSharingAvailabilityType").Available}g=b("ScotchRTCP2PCallStore").getState().isPoorNetworkQualityShown?b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Poor:b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Good;f=b("ScotchRTCP2PCallStore").getState();var h=f.isPeerOnMobile;f=f.signalingExperiments;h=h&&b("UserAgent").isBrowser("Firefox");var i=a&&b("gkx")("1409396");i=(!a||i)&&!h;h=!a&&(f.support("multiple_streams_plan_b")||f.support("multiple_streams_unified"));return new(b("ZenonCallFeatures"))({canAddParticipants:c,canReplaceLocalStreams:i,dominantSpeaker:e,screenSharingAvailability:d,supportMultipleStreams:h,networkStatus:g})};d.$ScotchCallModelEmitter8=function(a,c,d){for(var e=a.streams.toArray(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;for(var i=h.getTracks(),j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{k=i.next();if(k.done)break;l=k.value}l=l;c.set(l.id,new(b("ZenonImmutableMediaTrack"))({trackId:l.id,label:l.label,webrtcStream:h,webrtcTrack:l,enabled:l.enabled,userMuted:Boolean(a.audioStreamMuteStates.get(l.id)),remote:d,contentType:l.kind==="video"?"video":"audio",contentHint:(l=l.contentHint)!=null?l:"",pausedDownlink:a.pausedDownlink}))}}for(var l=a.screenStreams.toArray(),k=Array.isArray(l),j=0,l=k?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(j>=l.length)break;i=l[j++]}else{j=l.next();if(j.done)break;i=j.value}h=i;for(var g=h.getTracks(),f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;i=g[e++]}else{e=g.next();if(e.done)break;i=e.value}i=i;c.set(i.id,new(b("ZenonImmutableMediaTrack"))({trackId:i.id,label:i.label,webrtcStream:h,webrtcTrack:i,enabled:i.enabled,userMuted:Boolean(a.audioStreamMuteStates.get(i.id)),remote:d,contentType:i.kind==="video"?"screen":"audio",contentHint:(i=i.contentHint)!=null?i:"",pausedDownlink:a.pausedDownlink}))}}};d.$ScotchCallModelEmitter9=function(a){a=new Map();this.$ScotchCallModelEmitter8(b("ScotchRTCCallStore").getState().localUser,a,!1);for(var c=b("ScotchRTCCallStore").getState().remoteUsers.toArray(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;this.$ScotchCallModelEmitter8(f,a,!0)}return b("immutable").Map(a)};d.$ScotchCallModelEmitter10=function(a){a=new Map();var c=this.$ScotchCallModelEmitter11(b("ScotchRTCCallStore").getState().localUser,!0);a.set(c.id,c);c=b("ScotchRTCCallStore").getState().remoteUsers.toArray();for(var c=c,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f=this.$ScotchCallModelEmitter11(f,!1);a.set(f.id,f)}f=this.$ScotchCallModelEmitter12();return b("immutable").Map(a).merge(b("immutable").Map(f))};d.$ScotchCallModelEmitter11=function(a,c){var d=a.isMessengerUser?b("ZenonCallsModelTypes").ZenonCallParticipantType.Messenger:a.isGuestUser?b("ZenonCallsModelTypes").ZenonCallParticipantType.Guest:b("FBRTCConfig").isVCEndpointCall()?b("ZenonCallsModelTypes").ZenonCallParticipantType.Workplace:b("ZenonCallsModelTypes").ZenonCallParticipantType.Facebook;c?c=this.$ScotchCallModelEmitter13():(c=this.$ScotchCallModelEmitter14(a.participantState),a.getStream()!=null&&(c=b("ZenonCallsModelTypes").ZenonCallParticipantState.Connected));var e=new Set();for(var f=a.streams.toArray(),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;for(var i=i.getTracks(),j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{k=i.next();if(k.done)break;l=k.value}l=l;e.add(l.id)}}for(var l=a.screenStreams.toArray(),k=Array.isArray(l),j=0,l=k?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(j>=l.length)break;i=l[j++]}else{j=l.next();if(j.done)break;i=j.value}h=i;for(var g=h.getTracks(),f=Array.isArray(g),i=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(i>=g.length)break;h=g[i++]}else{i=g.next();if(i.done)break;h=i.value}h=h;e.add(h.id)}}h=new(b("ZenonCallParticipant"))({id:a.FBID,isVideoSubscribed:a.isVideoSubscribed,participantType:d,state:c,trackIDs:b("immutable").Set(e)});return h};d.$ScotchCallModelEmitter13=function(){var a=this.$ScotchCallModelEmitter4();if(a===b("ZenonCallsModelTypes").ZenonCallState.Terminating||a===b("ZenonCallsModelTypes").ZenonCallState.Terminated)return b("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected;else return b("ZenonCallsModelTypes").ZenonCallParticipantState.Connected};d.$ScotchCallModelEmitter14=function(a){if(b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway"&&!b("ScotchRTCGroupCallEscalationStore").isInProgress())return this.$ScotchCallModelEmitter15(a);else return this.$ScotchCallModelEmitter16()};d.$ScotchCallModelEmitter15=function(a){if(!a)return b("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected;a=a.state;switch(a){case b("FBRTCParticipantCallState").DISCONNECTED:case b("FBRTCParticipantCallState").NO_ANSWER:case b("FBRTCParticipantCallState").REJECTED:case b("FBRTCParticipantCallState").UNREACHABLE:case b("FBRTCParticipantCallState").CONNECTION_DROPPED:case b("FBRTCParticipantCallState").PARTICIPANT_LIMIT_REACHED:case b("FBRTCParticipantCallState").IN_ANOTHER_CALL:case b("FBRTCParticipantCallState").RING_TYPE_UNSUPPORTED:case b("FBRTCParticipantCallState").HANGUP_IN_WAITING_ROOM:case b("FBRTCParticipantCallState").UNKNOWN:return b("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected;case b("FBRTCParticipantCallState").CONTACTING:return b("ZenonCallsModelTypes").ZenonCallParticipantState.Contacting;case b("FBRTCParticipantCallState").RINGING:return b("ZenonCallsModelTypes").ZenonCallParticipantState.Ringing;case b("FBRTCParticipantCallState").CONNECTING:return b("ZenonCallsModelTypes").ZenonCallParticipantState.Connecting;case b("FBRTCParticipantCallState").CONNECTED:return b("ZenonCallsModelTypes").ZenonCallParticipantState.Connected;case b("FBRTCParticipantCallState").PENDING_APPROVAL:return b("ZenonCallsModelTypes").ZenonCallParticipantState.PendingApproval;case b("FBRTCParticipantCallState").APPROVED:return b("ZenonCallsModelTypes").ZenonCallParticipantState.Approved;case b("FBRTCParticipantCallState").FAILED_APPROVAL:return b("ZenonCallsModelTypes").ZenonCallParticipantState.FailedApproval;default:new(b("RTWebCallModelTypedLogger"))().setCallID(b("ScotchRTCCallStore").getState().callInfo.callID).setCallModelEvent("invalid_participant_state").log(),g(0,14312,a)}};d.$ScotchCallModelEmitter16=function(){var a=b("ScotchRTCP2PCallStore").getState();a=a.connectionStatus;switch(a){case"CONNECTED":return b("ZenonCallsModelTypes").ZenonCallParticipantState.Connected;case"ESCALATING_TO_BJN":case"CONNECTING":return b("ZenonCallsModelTypes").ZenonCallParticipantState.Connecting;case"CONTACTING":return b("ZenonCallsModelTypes").ZenonCallParticipantState.Contacting;case"RECONNECTING":return b("ZenonCallsModelTypes").ZenonCallParticipantState.Reconnecting;case"RINGING":return b("ZenonCallsModelTypes").ZenonCallParticipantState.Ringing;case"PROVISIONAL_RINGING":return b("ZenonCallsModelTypes").ZenonCallParticipantState.ProvisionalRinging;case"INIT":case"DISCONNECTED":default:return b("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected}};d.$ScotchCallModelEmitter17=function(){var a=b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway";if(a)return null;a=b("ScotchRTCP2PCallEscalationStore").getState();var c=a.awaitingACK,d=a.inProgress,e=a.failureReason,f=a.initiatedEscalation;a=a.escalated;if(a)return null;if(e&&!d)switch(e){case"cancelled":return b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.Cancelled;case"denied":return b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.Declined;case"timeout":return b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.TimedOut}if(d&&f)return b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.PendingPeerFeedback;if(d&&!f&&!c)return b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.InitiatedFromPeer;return c?b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.Accepted:null};d.$ScotchCallModelEmitter12=function(){var a=new Map(),c=b("ScotchRTCGroupCallEscalationStore").getState().usersToRing;c!==null&&b("ScotchRTCGroupCallEscalationStore").isInProgress()&&c.forEach(function(c){if(c.fbid!=null){c=new(b("ZenonCallParticipant"))({id:c.fbid,participantType:b("ZenonCallsModelTypes").ZenonCallParticipantType.Facebook,state:b("ZenonCallsModelTypes").ZenonCallParticipantState.Precontacting,trackIDs:b("immutable").Set()});a.set(c.id,c)}});return a};d.$ScotchCallModelEmitter18=function(){if(b("ScotchRTCGroupCallEscalationStore").isInProgress())return b("ZenonCallsModelTypes").ZenonGroupEscalationStatus.Started;if(b("ScotchRTCGroupCallEscalationStore").isEscalated())return b("ZenonCallsModelTypes").ZenonGroupEscalationStatus.Completed;return b("ScotchRTCGroupCallEscalationStore").getState().aborted?b("ZenonCallsModelTypes").ZenonGroupEscalationStatus.Cancelled:null};d.$ScotchCallModelEmitter19=function(){return b("cr:1420073")?b("cr:1420073").getState().inputStates:b("immutable").Map()};d.$ScotchCallModelEmitter20=function(){return b("cr:1420073")?b("cr:1420073").getState().outputStates:b("immutable").Map()};d.$ScotchCallModelEmitter21=function(a){return new(b("ZenonCall"))({callState:this.$ScotchCallModelEmitter4(),collisionContext:this.$ScotchCallModelEmitter3(),clientCallId:a,endCallReason:this.$ScotchCallModelEmitter5(a),responseSubCode:this.$ScotchCallModelEmitter6(),features:this.$ScotchCallModelEmitter7(a),groupEscalationStatus:this.$ScotchCallModelEmitter18(),mediaTracks:this.$ScotchCallModelEmitter9(a),participants:this.$ScotchCallModelEmitter10(a),remoteScreenSharingUserIDs:b("ScotchRTCCallStore").getState().remoteScreenSharingUserIDs,videoEscalationStatus:this.$ScotchCallModelEmitter17(),stateSyncInputStates:this.$ScotchCallModelEmitter19(),stateSyncOutputStates:this.$ScotchCallModelEmitter20(),rtpSenders_I_KNOW_WHAT_I_AM_DOING:this.$ScotchCallModelEmitter22(),rtpReceivers_I_KNOW_WHAT_I_AM_DOING:this.$ScotchCallModelEmitter23()})};d.$ScotchCallModelEmitter22=function(){return b("ScotchRTCCallStore").getState().connections.map(function(a){try{return b("immutable").Set(a.getSenders())}catch(a){b("FBLogger")("rtc_www").catching(a).mustfix("error while trying to getSenders()");return[]}}).flatten().toSet()};d.$ScotchCallModelEmitter23=function(){return b("ScotchRTCCallStore").getState().connections.map(function(a){try{return b("immutable").Set(a.getReceivers())}catch(a){b("FBLogger")("rtc_www").catching(a).mustfix("error while trying to getReceivers()");return[]}}).flatten().toSet()};d.getCallsModel=function(){var a=b("immutable").Map({0:this.$ScotchCallModelEmitter21("0")});return a};d.emitCallsModel=function(){var a=this.getCallsModel();try{var c=JSON.stringify(a);c!==this.$ScotchCallModelEmitter2&&(this.$ScotchCallModelEmitter2=c,this.emit("callsModelUpdate",a))}catch(c){b("FBLogger")("rtc_www").catching(c).mustfix("error while diffing callsModel"),this.$ScotchCallModelEmitter2=null,this.emit("callsModelUpdate",a)}};return c}(b("EventEmitter"));c=new a();f.CallsModelEmitterInstance=c},null);
__d("PlatformType",["$InternalEnum"],function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Scotch","Zenon"]);c=a;e.exports=c},null);
__d("RTWebFluxDebugger",["FluxDebugUtils","WebStorage"],function(a,b,c,d,e,f){"use strict";f.attach=a;f.fluxDumpState=c;var g,h=(g||b("WebStorage")).getLocalStorage(),i=!!(h&&h.getItem("__fluxDebug")==="1"),j=new Map(),k;function a(a,b){Object.keys(b).forEach(function(a){j.set(a,b[a])}),k&&s(),k={dispatcher:a,originalDispatch:a.dispatch,patchedDispatch:null},i&&r()}function l(a){return a&&typeof a.toJS==="function"?a.toJS():a}function c(){var a={};for(var b=j.entries(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];a[f]=l(e.getState())}return a}function m(a,b,c){var d=Date.now(),e=Array.from(j.entries()).map(function(a){var b=a[0];a=a[1];return{name:b,stateBefore:a.getState(),stateAfter:null}});b.call(a,c);if(!i)return;b=Date.now()-d;e=e.map(function(a,b){b=j.get(a.name);return b!=null?babelHelpers["extends"]({},a,{stateAfter:b.getState()}):null}).filter(Boolean);a=c.type;d=babelHelpers.objectWithoutPropertiesLoose(c,["type"]);console.groupCollapsed("Flux:",a);try{n(e)}finally{console.groupEnd()}}function n(a){a.filter(function(a){return a.stateBefore!==a.stateAfter}).forEach(function(a){p(a.name,function(){var c=l(a.stateBefore),d=l(a.stateAfter);c&&d&&b("FluxDebugUtils").diff(c,d).forEach(o)})})}function o(a){var b=a.path.join(".");switch(a.op){case"add":break;case"update":break;case"delete":break}}function p(a,b){q(a,function(){console.group(a),b()})}function q(a,b){try{b()}finally{console.groupEnd()}}function r(){if(!k)return;k.patchedDispatch&&s();k.patchedDispatch=k.dispatcher.dispatch=m.bind(null,k.dispatcher,k.dispatcher.dispatch)}function s(){if(!k||!k.patchedDispatch)return;k.dispatcher.dispatch=k.originalDispatch;k.patchedDispatch=null}window.__fluxDebugOn=function(){i=!0,h&&h.setItem("__fluxDebug","1"),r()};window.__fluxDebugOff=function(){i=!1,h&&h.setItem("__fluxDebug","0"),s()};window.__fluxDump=function(){var a=function(){if(c){if(d>=b.length)return"break";e=b[d++]}else{d=b.next();if(d.done)return"break";e=d.value}var a=e,f=a[0];a=a[1];p(f,function(){return!1})};for(var b=j,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e,f=a();if(f==="break")break}};window.__fluxDumpState=c},null);
__d("ScotchRTCCallNUXReducer",["ScotchFBRTCUtils","XBasicFBNuxDismissController","XBasicFBNuxViewController"],function(a,b,c,d,e,f){"use strict";f.dismissNUX=a;f.refreshNUXState=c;f.markNUXViewed=d;function a(a,c){switch(c.type){case"DISMISS_NUX":var d=b("XBasicFBNuxDismissController").getURIBuilder().setInt("nux_id",c.nuxID).getURI();b("ScotchFBRTCUtils").sendServerRequest(d);switch(c.nuxID){case 6265:return a.set("showVideoChatFiltersNUX",!1);case 5609:return a.set("showAddGroupMemberNUX",!1);case 4775:return a.set("showRemoteCameraControlsNUX",!1);case 4774:return a.set("showRemoteScreenContentPopOutNUX",!1);case 4773:return a.set("showRemoteStreamsSliderNUX",!1);case 4776:return a.set("showSettingsNUX",!1);default:return a}default:return a}}function c(a,b){switch(b.type){case"INIT_NUX_STATE":b=b.payload;return a.set("showVideoChatFiltersNUX",b.showVideoChatFiltersNUX).set("showAddGroupMemberNUX",b.showAddGroupMemberNUX).set("showRemoteCameraControlsNUX",b.showRemoteCameraControlsNUX).set("showRemoteScreenContentPopOutNUX",b.showRemoteScreenContentPopOutNUX).set("showRemoteStreamsSliderNUX",b.showRemoteStreamsSliderNUX).set("showSettingsNUX",b.showSettingsNUX);default:return a}}function d(a,c){switch(c.type){case"MARK_NUX_VIEWED":c=b("XBasicFBNuxViewController").getURIBuilder().setInt("nux_id",c.nuxID).getURI();b("ScotchFBRTCUtils").sendServerRequest(c);return a;default:return a}}},null);
__d("ScotchRTCCallNUXStoreState",["immutable"],function(a,b,c,d,e,f){"use strict";a={showVideoChatFiltersNUX:!1,showAddGroupMemberNUX:!1,showRemoteCameraControlsNUX:!1,showRemoteScreenContentPopOutNUX:!1,showRemoteStreamsSliderNUX:!1,showSettingsNUX:!1};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c},null);
__d("ScotchRTCCallNUXStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallNUXActions","ScotchRTCCallNUXReducer","ScotchRTCCallNUXStoreState"],function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCCallNUXReducer").dismissNUX,b("ScotchRTCCallNUXReducer").markNUXViewed,b("ScotchRTCCallNUXReducer").refreshNUXState];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this,b("ScotchRTCAppDispatcher"))||this;b("ScotchRTCCallNUXActions").refreshNUXState();return c}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCallNUXStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a();e.exports=c},null);
__d("RTCCoExperienceActionTypes",[],function(a,b,c,d,e,f){a=Object.freeze({TOGGLE_CHAT_WINDOW:"TOGGLE_CHAT_WINDOW",SET_FILTER:"SET_FILTER"});e.exports=a},null);
__d("RtcExpressionWWWTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:RtcExpressionWWWLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:RtcExpressionWWWLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:RtcExpressionWWWLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAuthFlag=function(a){this.$1.auth_flag=a;return this};c.setBundleID=function(a){this.$1.bundle_id=a;return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setConferenceName=function(a){this.$1.conference_name=a;return this};c.setOsBuildNumber=function(a){this.$1.os_build_number=a;return this};c.setPeerID=function(a){this.$1.peer_id=a;return this};c.setRadioType=function(a){this.$1.radio_type=a;return this};c.setRawClientTime=function(a){this.$1.raw_client_time=a;return this};c.setRtcExpressionAction=function(a){this.$1.rtc_expression_action=a;return this};c.setRtcExpressionDuration=function(a){this.$1.rtc_expression_duration=a;return this};c.setRtcExpressionID=function(a){this.$1.rtc_expression_id=a;return this};c.setRtcExpressionIntent=function(a){this.$1.rtc_expression_intent=a;return this};c.setRtcExpressionName=function(a){this.$1.rtc_expression_name=a;return this};c.setRtcExpressionParticipantCount=function(a){this.$1.rtc_expression_participant_count=a;return this};c.setRtcExpressionType=function(a){this.$1.rtc_expression_type=a;return this};c.setSamplingFrequency=function(a){this.$1.sampling_frequency=a;return this};return a}();c={auth_flag:!0,bundle_id:!0,call_id:!0,conference_name:!0,os_build_number:!0,peer_id:!0,radio_type:!0,raw_client_time:!0,rtc_expression_action:!0,rtc_expression_duration:!0,rtc_expression_id:!0,rtc_expression_intent:!0,rtc_expression_name:!0,rtc_expression_participant_count:!0,rtc_expression_type:!0,sampling_frequency:!0};e.exports=a},null);
__d("ScotchRTCExpressionWWWLogger",["invariant","FBRTCConsoleLogger","FBRTCParticipantCallState","RtcExpressionWWWTypedLogger","immutable","performanceNow"],function(a,b,c,d,e,f,g){"use strict";var h,i=b("immutable").Map;a=function(){function a(){this.$1=i()}var c=a.prototype;c.logStartTimer=function(a){var c=(h||(h=b("performanceNow")))(),d=a.rtcExpressionIntent;this.$1=this.$1.set(d,c);a.rtcExpressionAction="enabled";this.logEvent(a);this.$2(d,{startTime:c})};c.$3=function(a){var c=this.$1.get(a);c||g(0,2586);this.$1=this.$1.remove(a);return parseInt((h||(h=b("performanceNow")))()-c,10)};c.logStopTimer=function(a){var b=a.rtcExpressionIntent;b=this.$3(b);a.rtcExpressionDuration=b;a.rtcExpressionAction="disabled";this.logEvent(a);return b};c.logEvent=function(a){var c=new(b("RtcExpressionWWWTypedLogger"))().setCallID(a.callID||123).setConferenceName(a.conferenceName).setPeerID(a.peerID).setRawClientTime((h||(h=b("performanceNow")))()).setRtcExpressionAction(a.rtcExpressionAction).setRtcExpressionDuration(a.rtcExpressionDuration).setRtcExpressionID(a.rtcExpressionId).setRtcExpressionIntent(a.rtcExpressionIntent).setRtcExpressionName(a.rtcExpressionName).setRtcExpressionParticipantCount(a.rtcExpressionParticipantCount).setRtcExpressionType(a.rtcExpressionType),d=c.getData();this.$2(a.rtcExpressionName,d);c.log()};c.getExpressionLoggerInfoFromStore=function(a){var c=a.callInfo,d=c.callID;c=c.conferenceName;a=a.remoteUsers;a=a.filter(function(a){return a.getParticipantState()===b("FBRTCParticipantCallState").CONNECTED}).size+1;return{callID:d,conferenceName:c,rtcExpressionParticipantCount:a}};c.$2=function(a,b){};return a}();c=new a();e.exports=c},null);
__d("ScotchRTCCoExperienceReducer",["RTCCallActionTypes","RTCCoExperienceActionTypes","ScotchRTCCallStore","ScotchRTCCoExperienceStore","ScotchRTCExpressionWWWLogger"],function(a,b,c,d,e,f){"use strict";f.processChatWindowToggle=a;f.processSetVideoFilter=c;function a(a,c){switch(c.type){case"TOGGLE_CHAT_WINDOW":c=b("ScotchRTCExpressionWWWLogger").getExpressionLoggerInfoFromStore(b("ScotchRTCCallStore").getState());a.chatWindowVisible?b("ScotchRTCExpressionWWWLogger").logStopTimer(babelHelpers["extends"]({},c,{rtcExpressionName:"chat",rtcExpressionIntent:"chat"})):b("ScotchRTCExpressionWWWLogger").logStartTimer(babelHelpers["extends"]({},c,{rtcExpressionName:"chat",rtcExpressionIntent:"chat"}));return a.set("chatWindowVisible",!a.chatWindowVisible);default:return a}}function c(a,c){switch(c.type){case"HANGUP":case"END_CALL":case"HANGUP_ERROR":case"HANGUP_SUCCESS":case"SET_FILTER":var d=b("ScotchRTCExpressionWWWLogger").getExpressionLoggerInfoFromStore(b("ScotchRTCCallStore").getState()),e=a.currentVideoFilter,f=a.videoFilterHistory;if(e){var g=b("ScotchRTCExpressionWWWLogger").logStopTimer(babelHelpers["extends"]({},d,{rtcExpressionName:e,rtcExpressionIntent:"effect"})),h=f.get(e)||0;f=f.set(e,h+g);b("ScotchRTCCoExperienceStore").logCoExperienceDurationToSummary(f)}c.filter&&b("ScotchRTCExpressionWWWLogger").logStartTimer(babelHelpers["extends"]({},d,{rtcExpressionName:c.filter,rtcExpressionIntent:"effect"}));return a.set("currentVideoFilter",c.filter).set("videoFilterHistory",f);default:return a}}},null);
__d("ScotchRTCCoExperienceStoreState",["immutable"],function(a,b,c,d,e,f){"use strict";a={chatWindowVisible:!1,currentVideoFilter:null,videoFilterHistory:b("immutable").Map()};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c},null);
__d("ScotchRTCCoExperienceStore",["FBRTCCallSummaryStore","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCoExperienceReducer","ScotchRTCCoExperienceStoreState","immutable"],function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCCoExperienceReducer").processChatWindowToggle,b("ScotchRTCCoExperienceReducer").processSetVideoFilter];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCoExperienceStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.logCoExperienceDurationToSummary=function(a){var c=b("ScotchRTCCallStore").getState();c=c.callSummary;c.setEffectCount(a.size);var d=0;a.reduce(function(a,b){d+=b},0);c.setTotalVideoFilterDuration(d);c.setCoExperienceEffectDuration(d);c.save(b("FBRTCCallSummaryStore").getInstance())};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a(b("ScotchRTCAppDispatcher"));e.exports=c},null);
__d("ScotchRTCMediaDevicesActions",["ScotchRTCAppDispatcher"],function(a,b,c,d,e,f){"use strict";f.enumerate=a;function a(a){b("ScotchRTCAppDispatcher").dispatch({type:"ENUMERATE_MEDIA_DEVICES",devices:a})}},null);
__d("ScotchRTCMediaDevicesStore",["FBRTCConsoleLogger","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCMediaDevices","ScotchRTCMediaDevicesActions","ScotchRTWebUserActionLogger"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this,b("ScotchRTCAppDispatcher"))||this;c.$ScotchRTCMediaDevicesStore1();b("ScotchRTCMediaDevices").addEventListener("devicechange",c.$ScotchRTCMediaDevicesStore1);return c}var d=c.prototype;d.$ScotchRTCMediaDevicesStore1=function(){b("ScotchRTCMediaDevices").enumerateDevices().then(function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"enumerateDevices: "+JSON.stringify(a)}),b("ScotchRTCMediaDevicesActions").enumerate(a)})["catch"](function(a){})};d.getInitialState=function(){return null};d.reduce=function(a,b){var c=b.type;b=b.devices;switch(c){case"ENUMERATE_MEDIA_DEVICES":return[].concat(b);default:return a}};d.refresh=function(){this.$ScotchRTCMediaDevicesStore1()};d.getByLabel=function(a,b){var c=this.getState();return!c?null:c.find(function(c){return c.kind===b&&c.label===a})||c.find(function(c){return c.kind===b&&h(c.label,a)})};return c}(b("FluxReduceStore"));a.__moduleID=e.id;var g=/#\d+\s(\([\da-f]{4}:[\da-f]{4}\))$|\s#\d+$/;function h(a,b){return a.replace(g,"$1")===b.replace(g,"$1")}c=new a();e.exports=c},null);
__d("ScotchRTCP2PLoggerStore",["Bootloader","FBRTCConfig","FBRTCLogger","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallStore"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){var d=b("ScotchRTCCallStore").getState(),e=d.remoteUsers;d=d.callInfo;if(!e.count())return a;var f=b("FBRTCLogger").getInstance();e=e.first().FBID;switch(c.type){case"AUDIO_MUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_MUTE,!0);break;case"AUDIO_UNMUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_MUTE,!1);break;case"VIDEO_MUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_VIDEO_ON,!1);break;case"VIDEO_UNMUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_VIDEO_ON,!0);break;case"SELF_VIEW_COLLAPSED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_SELF_VIEW_ON,!1);break;case"SELF_VIEW_UNCOLLAPSED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_SELF_VIEW_ON,!0);break;case"ADD_LOCAL_STREAM":this.$ScotchRTCP2PLoggerStore1("local stream: set",c.stream,e,Number(d.conferenceName));break;case"USER_SETTINGS_SAVE":case"USER_SETTINGS_SET_AUDIO_INPUT":case"USER_SETTINGS_SET_AUDIO_OUTPUT":case"USER_SETTINGS_SET_VIDEO_INPUT":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.USER_SETTINGS_CHANGED),this.$ScotchRTCP2PLoggerStore1("user settings change",c,e,Number(d.conferenceName))}return a};d.$ScotchRTCP2PLoggerStore1=function(a,b,c,d){g(function(e){return e.log(a,{peerID:c,callID:d,eventDetails:b})})};return c}(b("FluxReduceStore"));a.__moduleID=e.id;function g(a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["ScotchCollabMessengerLogger"],a,"ScotchRTCP2PLoggerStore")}c=new a(b("ScotchRTCAppDispatcher"));e.exports=c},null);
__d("ScotchRTCUserSettingsReducers",["ScotchRTCMediaDevicesStore"],function(a,b,c,d,e,f){f.activelySetSettings=a;f.passivelySetSettings=c;function a(a,b){switch(b.type){case"USER_SETTINGS_EDIT":return a.set("editing",!0);case"USER_SETTINGS_CANCEL_EDITING":return a.set("editing",!1);case"USER_SETTINGS_SAVE":return a.set("audioInput",b.audioInput).set("audioOutput",b.audioOutput).set("editing",!1).set("videoInput",b.videoInput);case"USER_SETTINGS_SET_AUDIO_INPUT":return a.set("audioInput",b.audioInput);case"USER_SETTINGS_SET_AUDIO_OUTPUT":return a.set("audioOutput",b.audioOutput);case"USER_SETTINGS_SET_VIDEO_INPUT":return a.set("videoInput",b.videoInput);default:return a}}function c(a,b){switch(b.type){case"ADD_LOCAL_STREAM":return a.set("audioInput",g(b.stream.getAudioTracks()[0],"audioinput")||a.audioInput).set("videoInput",g(b.stream.getVideoTracks()[0],"videoinput")||a.videoInput);default:return a}}function g(a,c){if(!a)return null;a=b("ScotchRTCMediaDevicesStore").getByLabel(a.label,c);return a?a.deviceId:null}},null);
__d("ScotchRTCUserSettingsStoreState",["immutable"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({audioInput:null,audioOutput:null,editing:!1,videoInput:null}));e.exports=a},null);
__d("ScotchRTCUserSettingsStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCUserSettingsReducers","ScotchRTCUserSettingsStoreState"],function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCUserSettingsReducers").activelySetSettings,b("ScotchRTCUserSettingsReducers").passivelySetSettings];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.call(this,b("ScotchRTCAppDispatcher"))||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCUserSettingsStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a();e.exports=c},null);
__d("ScotchSignalingEventEmitter",["EventEmitter"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.emitJoinReady=function(a){this.emit("signalingPlatformEvent",{messageType:"joinReady",offer:a})};c.emitParentWindowConnectionTimeout=function(){this.emit("signalingPlatformEvent",{messageType:"parentWindowConnectionTimeout"})};return b}(b("EventEmitter"));c=new a();d=c;e.exports=d},null);
__d("ScotchUtils",["invariant","Promise","regeneratorRuntime","ChannelManager","CurrentUser","FBLogger","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConsoleLogger","FBRTCConstants","FBRTCHangupReason","FBRTCLogger","requireCond","FBRTCMessageListener","MercuryIDs","MessengerParticipants.re","PlatformType","RTCUser","RTWebFluxDebugger","ScotchFBRTCGroupCallStore","ScotchFBRTCMWProtocolStore","ScotchgenerateRTCCallID","ScotchRTCAppData","ScotchRTCAppDispatcher","ScotchRTCCallActions","ScotchRTCCallNotificationStore","ScotchRTCCallNUXStore","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCCoExperienceStore","ScotchRTCGroupCallActions","ScotchRTCGroupCallEscalationActions","ScotchRTCGroupCallEscalationStore","ScotchRTCMediaDevicesStore","ScotchRTCMWProtocolHandler","ScotchRTCP2PCallActions","ScotchRTCP2PCallEscalationActions","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallEscalator","ScotchRTCP2PCallStore","ScotchRTCP2PCallWindowHandler","ScotchRTCP2PLoggerStore","ScotchRTCP2PProtocolHandler","ScotchRTCProxyUserStore","ScotchRTCScreenSharing","cr:1420073","ScotchRTCUserSettingsStore","ZenonRTWebBrowserFeatureSupport","ScotchRTWebClientFeatureGating","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","ScotchSignalingEventEmitter","ZenonCallsModelTypes","gkx","immutable","isStringNullOrEmpty","promiseDone"],function(a,b,c,d,e,f,g){"use strict";var h=b("FBRTCLogger").Key;a=function(){function a(a){this.$2="",this.$1=a}var c=a.prototype;c.initializeSignaling=function(a,c,d){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"initializeSignaling",conferenceName:d});this.$2=d;if(this.$1.getConfigManager().getZenonStartCallImmediatelyConfig().isEnabled())b("ScotchSignalingEventEmitter").emitJoinReady(),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Signaling_JoinReady",conferenceName:d});else{c!=null&&b("FBRTCMessageListener").setParentWindowNonce(c);c=b("Promise").race([new(b("Promise"))(function(a){b("FBRTCMessageListener").setParentWindowStartCallHandler(function(b){a({offer:b,isTimeout:!1})})}),new(b("Promise"))(function(a){window.setTimeout(function(){a({offer:null,isTimeout:!0})},2e3)})]);b("promiseDone")(c,function(a){a.isTimeout?(b("FBRTCMessageListener").setParentWindowStartCallHandler(null),b("ScotchSignalingEventEmitter").emitParentWindowConnectionTimeout(),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Signaling_ParentWindowConnectionTimeout",conferenceName:d})):(b("ScotchSignalingEventEmitter").emitJoinReady(a.offer),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Signaling_JoinReady",conferenceName:d}))})}b("FBRTCMessageListener").init(!0,a)};c.initializeV2Infrastructure=function(a,b){b.peerID==="MW_PEER_ID"?this.initializeMW(b):this.initializeP2P(b)};c.initializeP2P=function(a){var c;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:(c=a.callID)==null?void 0:c.toString(),checkpoint:"initializeP2P",conferenceName:a.roomID});c={ScotchFBRTCGroupCallStore:b("ScotchFBRTCGroupCallStore"),ScotchRTCCallNotificationStore:b("ScotchRTCCallNotificationStore"),ScotchRTCCallStore:b("ScotchRTCCallStore"),ScotchRTCP2PCallEscalationStore:b("ScotchRTCP2PCallEscalationStore"),ScotchRTCCallNUXStore:b("ScotchRTCCallNUXStore"),ScotchRTCP2PCallStore:b("ScotchRTCP2PCallStore"),ScotchRTCCoExperienceStore:b("ScotchRTCCoExperienceStore"),ScotchRTCP2PLoggerStore:b("ScotchRTCP2PLoggerStore"),ScotchRTCMediaDevicesStore:b("ScotchRTCMediaDevicesStore"),ScotchRTCUserSettingsStore:b("ScotchRTCUserSettingsStore"),ScotchRTCGroupCallEscalationStore:b("ScotchRTCGroupCallEscalationStore"),ScotchFBRTCMWProtocolStore:b("ScotchFBRTCMWProtocolStore")};var d=[];for(var e in c)d.push(c[e]);b("gkx")("882839")||d.push(b("ScotchRTCProxyUserStore"));b("ScotchRTCAppDispatcher").explicitlyRegisterStores(d);d=a.roomID;b("isStringNullOrEmpty")(d)&&(d=b("ScotchgenerateRTCCallID")().toString(),b("ScotchRTWebUserActionLogger").logCheckpoint({callID:d,checkpoint:"ScotchgenerateRTCCallID",conferenceName:d}));b("ScotchRTCCallActions").initialize({protocol:b("FBRTCConstants").SignalingProtocol.P2P,conferenceName:d,serverInfoData:null,callID:d});var f=a.initializeVideo?b("ScotchRTCCallType").AUDIO_VIDEO:b("ScotchRTCCallType").AUDIO_ONLY;b("ScotchRTCP2PCallActions").setCallType(f);b("ChannelManager").startChannelManagerForApp(b("ScotchRTCAppData").getChannelManagerAppName());b("RTWebFluxDebugger").attach(b("ScotchRTCAppDispatcher"),c);c=a.usersToRing.length===1;b("ScotchRTCP2PCallActions").setIsCaller(c);b("ScotchRTCP2PCallWindowHandler").init(window);a=a.peerID;c=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),a,d,c);b("ScotchRTWebUserActionLogger").logCheckpoint({callID:d,checkpoint:"setCallSummaryFromStorage",conferenceName:d});c.onPopupOpened();c.setCallType(f);c.setActiveConnection("p2p");b("ScotchRTCCallActions").setCallSummary(c);f=b("ScotchRTCP2PCallStore").getState();c=f.protocolHandler;c.init(a,Number(d));f=new(b("RTCUser"))({FBID:b("CurrentUser").getID()});b("ScotchRTCCallActions").initLocalUser(f);c=new(b("RTCUser"))({FBID:a});b("ScotchRTCCallActions").initRemoteUsers(b("immutable").Set.of(c))};c.initializeMW=function(a){var c;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:(c=a.callID)==null?void 0:c.toString(),checkpoint:"initializeMW",conferenceName:a.roomID});b("ChannelManager").startChannelManagerForApp(b("ScotchRTCAppData").getChannelManagerAppName());if(b("cr:1420073")!=null){c={ScotchRTCCallStore:b("ScotchRTCCallStore"),ScotchFBRTCGroupCallStore:b("ScotchFBRTCGroupCallStore"),ScotchRTCCoExperienceStore:b("ScotchRTCCoExperienceStore"),ScotchFBRTCMWProtocolStore:b("ScotchFBRTCMWProtocolStore"),ScotchRTCCallNotificationStore:b("ScotchRTCCallNotificationStore"),ScotchRTCMediaDevicesStore:b("ScotchRTCMediaDevicesStore"),ScotchRTCGroupCallEscalationStore:b("ScotchRTCGroupCallEscalationStore"),ScotchRTCStateSyncStore:b("cr:1420073")};var d=b("gkx")("882839")?{}:{ScotchRTCProxyUserStore:b("ScotchRTCProxyUserStore")};b("ScotchRTCAppDispatcher").explicitlyRegisterStoresInMap(babelHelpers["extends"]({},c,d));b("RTWebFluxDebugger").attach(b("ScotchRTCAppDispatcher"),c)}else{d={ScotchRTCCallStore:b("ScotchRTCCallStore"),ScotchFBRTCGroupCallStore:b("ScotchFBRTCGroupCallStore"),ScotchRTCCoExperienceStore:b("ScotchRTCCoExperienceStore"),ScotchFBRTCMWProtocolStore:b("ScotchFBRTCMWProtocolStore"),ScotchRTCCallNotificationStore:b("ScotchRTCCallNotificationStore"),ScotchRTCMediaDevicesStore:b("ScotchRTCMediaDevicesStore"),ScotchRTCGroupCallEscalationStore:b("ScotchRTCGroupCallEscalationStore")};c=b("gkx")("882839")?{}:{ScotchRTCProxyUserStore:b("ScotchRTCProxyUserStore")};b("ScotchRTCAppDispatcher").explicitlyRegisterStoresInMap(babelHelpers["extends"]({},d,c));b("RTWebFluxDebugger").attach(b("ScotchRTCAppDispatcher"),d)}b("ScotchRTCGroupCallActions").setLayout(b("FBRTCConstants").GroupVideoViewLayout.GRID);c=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());d={};d[c]=null;c=b("immutable").Map(d);b("ScotchRTCGroupCallActions").initThread(null,c);d=new(b("RTCUser"))({FBID:b("CurrentUser").getID()});b("ScotchRTCCallActions").initLocalUser(d);c=a.callID;d=a.peerID;a=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),d,c,!1);b("ScotchRTCCallActions").setCallSummary(a)};c.join=function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:a.serverCallID,checkpoint:"join",conferenceName:a.roomID});if(j()){a.usersToRing.length<=1||g(0,17639);a.usersToRing.length===0&&(a.peerID!==""||g(0,17640));var c=b("ScotchRTCCallStore").getState().remoteUsers.toArray()[0].FBID;a.peerID===c||g(0,15117,a.peerID,c);if(a.callTrigger===b("FBRTCLogger").Trigger.REDIAL_BUTTON){c=b("ScotchgenerateRTCCallID")().toString();b("ScotchRTCCallActions").resetForRedial(c,c)}c=b("ScotchRTCP2PCallStore").getState();var d=c.protocolHandler;c=l(a.localMedia);for(var e=0;e<c.length;e++){var f=c[e];b("ScotchRTCCallActions").addLocalStream(f)}b("ScotchRTWebUserActionLogger").startTimer("fetchTurnCredentialsTimer");d.fetchTURNCredentials().then(function(){b("ScotchRTWebUserActionLogger").logStopTimer({timerName:"fetchTurnCredentialsTimer",checkpointName:"CallStart_fetchTurnCredentialsTimer"}),d.startCall(a.callTrigger,a.offer)})["catch"](function(){b("FBLogger")("rtc_www").warn("failed to fetch turn credentials"),b("ScotchRTWebUserActionLogger").logError({errorDomain:"failed to fetch turn credentials"})})}else{a.callTrigger===b("FBRTCLogger").Trigger.REDIAL_BUTTON&&b("ScotchRTCCallActions").updateRemoteUsers(b("immutable").Set());f=l(a.localMedia);for(var e=0;e<f.length;e++){c=f[e];b("ScotchRTCCallActions").addLocalStream(c)}c={};c.isEscalatedCall=!1;e=(e=b("ScotchFBRTCGroupCallStore").getState().thread)==null?void 0:(e=e.rtc_call_data)==null?void 0:e.server_info_data;c.serverInfoData=(e=e)!=null?e:a.serverInfoData;c.callTrigger=a.callTrigger;b("ScotchRTWebClientFeatureGating").preferIsacForGroupCalls()&&(c.preferredCodecs={audio:"ISAC/16000"});b("gkx")("1369511")&&(c.connectedOnJoin=!0);b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&(a.initialSyncStates!=null?a.initialSyncStates.set("simple_external",{number:42}):a.initialSyncStates=new Map([["simple_external",{number:42}]]));b("cr:1420073")!=null&&a.initialSyncStates!=null&&(c.initialSyncStates=a.initialSyncStates);e=new(b("ScotchRTCMWProtocolHandler"))(Number(a.serverCallID));e.startCall(a.usersToRing,f,a.roomID,c)}};c.approveParticipants=function(a,b){this.$3(b,1)};c.denyParticipants=function(a,b){this.$3(b,0)};c.$3=function(a,c){var d=b("ScotchRTCCallStore").getState().callInfo,e=d.callID,f=d.conferenceName;d=d.serverInfoData;var g=a.toArray().join(", ");b("ScotchRTWebUserActionLogger").logCheckpoint({callID:e,checkpoint:"[WR] User is setting approval status of "+g+" to "+c,conferenceName:f});b("ScotchRTCMWProtocolHandler").sendApprovalRequest(f,d,a.toArray(),c)};c.unsubscribeFromStateSyncTopic=function(a,c){if(b("cr:1420073")==null)return;a=b("ScotchRTCCallStore").getState().callInfo;var d=a.callID,e=a.conferenceName;a=a.serverInfoData;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:d,checkpoint:"[SS] User is unsubscribing from state with topic: "+c,conferenceName:e});d=b("cr:1420073").setUpdatedInputState(c,null);b("ScotchRTCGroupCallActions").setStateSyncUnsubscribe(c);b("ScotchRTCMWProtocolHandler").sendUnsubscribeRequest(e,a,c,d.version)};c.updateStateSyncTopic=function(a,c,d){if(b("cr:1420073")==null)return;a=b("ScotchRTCCallStore").getState().callInfo;var e=a.callID,f=a.conferenceName;a=a.serverInfoData;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:e,checkpoint:"[SS] User is updating state with topic: "+c,conferenceName:f});e=b("cr:1420073").setUpdatedInputState(c,d);b("ScotchRTCGroupCallActions").setStateSyncSubscribe(c);b("ScotchRTCMWProtocolHandler").sendUpdateRequest(f,a,c,e.version,e.data)};c.muteTrack=function(a,b){this.$4(b,!1)};c.unmuteTrack=function(a,b){this.$4(b,!0)};c.$4=function(a,c){var d=b("ScotchRTCCallStore").getState();d=d.localUser;d=[].concat(d.streams.toArray(),d.screenStreams.toArray());var e=null;for(var d=d,f=Array.isArray(d),g=0,d=f?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=d.length)break;h=d[g++]}else{g=d.next();if(g.done)break;h=g.value}h=h;for(var h=h.getTracks(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=h.length)break;k=h[j++]}else{j=h.next();if(j.done)break;k=j.value}k=k;k.id===a&&(e=k)}}if(!e)return;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Toggle track:"+a+" from:"+e.enabled.toString()+" to:"+c.toString()});if(e.enabled===c)return;e.kind==="audio"?b("ScotchRTCCallActions").toggleMuteAudio(c):e.kind==="video"&&b("ScotchRTCCallActions").toggleMuteVideo(c)};c.endCall=function(a,c,d){if(j()){a=b("FBRTCConstants").endCallReasonFromString(c);var e=b("ScotchRTCCallStore").getState().callInfo.conferenceState;if(e==="NEW"||e==="AWAITING_USER_START"){e=b("ScotchRTCCallStore").getState().callSummary;e.onCallEnded(a,!1,null,"DidNotInitiate");e.save(b("FBRTCCallSummaryStore").getInstance());return}e=b("ScotchRTCP2PCallStore").getState();e=e.protocolHandler;e.endCall(a,d)}else{e=b("ScotchRTCCallStore").getState().callInfo;a=e.conferenceName;e=e.serverInfoData;a=a==null||a==""?this.$2:a;c=m(c);b("ScotchRTCMWProtocolHandler").endCall(a,e,c,d)}};c.ringParticipants=function(a,c){if(c.length===0)return;if(j()){a=c.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});b("MessengerParticipants.re").getMulti(a,function(a){b("ScotchRTCGroupCallEscalationActions").setUsersToRing(b("immutable").Map(a));a=b("ScotchRTCP2PCallStore").getState();a=a.protocolHandler;a.escalateToMultiway()})}else b("ScotchRTCMWProtocolHandler").addParticipants(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,c)};c.addLocalTrack=function(a,c){c.contentType==="screen"||g(0,17183);j()||i()||g(0,14970);if(j()){a=b("ScotchRTCP2PCallStore").getState();a=a.protocolHandler;a.startScreenStream(c.webrtcStream)}else b("ScotchRTCMWProtocolHandler").startScreenStream(c.webrtcStream)};c.removeLocalTrack=function(a,c){j()||i()||g(0,14970);a=b("ScotchRTCCallStore").getState();a=a.localUser;a=a.screenStreams.toArray().find(function(a){return a.getTracks().find(function(a){return a.id===c})});if(!a)return;if(j()){var d=b("ScotchRTCP2PCallStore").getState();d=d.protocolHandler;d.stopScreenStream(a);b("ScotchRTCScreenSharing").stop()}else b("ScotchRTCMWProtocolHandler").stopScreenStream(a)};c.replaceLocalTrack=function(a,c,d,e){e===void 0&&(e=!1);a=b("ScotchRTCCallStore").getState();a=a.localUser;if(d.contentType==="screen"){var f=a.screenStreams.toArray().find(function(a){return a.getTracks().find(function(a){return a.id===c})});if(f)if(j()){var h=b("ScotchRTCP2PCallStore").getState();h=h.protocolHandler;h.updateScreenStream(f,d.webrtcStream)}else i()||g(0,21464),b("ScotchRTCMWProtocolHandler").updateScreenStream(f,d.webrtcStream);return b("Promise").resolve()}if(e){var k=a.streams.first();k!==void 0&&k.getTracks().forEach(function(a){a.kind!==d.webrtcTrack.kind&&(d.webrtcStream.addTrack(a),k.removeTrack(a))})}if(j()){b("ScotchRTCP2PProtocolHandler").replaceLocalStream(d.webrtcStream,!0);return b("Promise").resolve()}else{this.$5(a,d);return b("ScotchRTCMWProtocolHandler").updateLocalStream(d.webrtcStream,e)}};c.$5=function(a,b){var c;a=a.streams.toArray();c=(c=a.find(function(a){return(a=(a==null?void 0:(a=a.getAudioTracks())==null?void 0:a.length)>0)!=null?a:!1}))==null?void 0:c.getAudioTracks();a=(a=a.find(function(a){return(a=(a==null?void 0:(a=a.getVideoTracks())==null?void 0:a.length)>0)!=null?a:!1}))==null?void 0:a.getVideoTracks();c=(c=c&&c[0]&&!c[0].enabled)!=null?c:!1;a=(a=a&&a[0]&&!a[0].enabled)!=null?a:!1;if(c){c=b.webrtcStream.getAudioTracks()[0];c!=null&&(c.enabled=!1)}if(a){c=b.webrtcStream.getVideoTracks()[0];c!=null&&(c.enabled=!1)}};c.getCallProtocolType=function(){var a=b("ScotchRTCCallStore").getState().callInfo.protocol;return a==="p2p"?"p2p":a==="multiway"?"multiway":null};c.submitRating=function(a,c,d,e){c!==null&&b("ScotchRTCCallActions").submitRating(c),d!==null&&b("ScotchRTCCallActions").submitFeedback(d),e!==null&&b("ScotchRTCCallActions").submitSurveyChoice(e)};c.setRatingImpression=function(a,c){a&&b("ScotchRTCCallStore").mutateCallSummary(function(a){a.addExtraInfo(h.RATING_SHOWN,"1")}),c&&b("ScotchRTCCallStore").mutateCallSummary(function(a){a.addExtraInfo(h.SURVEY_SHOWN,"1")})};c.acceptVideoEscalation=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:k();b("ScotchRTCCallStore").mutateCallSummary(function(a){a.setVidEscalationAcceptedClick(),a.setVidEscalationMediaRequested()});a.prev=2;a.next=5;return b("regeneratorRuntime").awrap(b("ScotchRTCP2PCallEscalator").acceptEscalation());case 5:b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaSuccess()});a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](2),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaFailed()});case 12:case"end":return a.stop()}},null,this,[[2,8]])};c.declineVideoEscalation=function(){k(),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationDeclinedClick()}),b("ScotchRTCP2PCallEscalator").declineEscalation()};c.cancelVideoEscalation=function(){k(),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationInitClick()}),b("ScotchRTCP2PCallEscalationActions").cancel()};c.startVideoEscalation=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!j()){a.next=15;break}b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationInitClick()});b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaRequested()});a.prev=3;a.next=6;return b("regeneratorRuntime").awrap(b("ScotchRTCP2PCallEscalator").initEscalation());case 6:b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaSuccess()});a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](3),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaFailed()}),b("ScotchRTWebUserActionLogger").logError({errorDomain:"video_escalation_error",errorType:a.t0.toString()});case 13:a.next=16;break;case 15:b("ScotchRTCMWProtocolHandler").escalateLocalStream();case 16:case"end":return a.stop()}},null,this,[[3,9]])};c.removeParticipants=function(a,c){a=b("ScotchRTCCallStore").getState().callInfo;var d=a.conferenceName;a=a.serverInfoData;b("ScotchRTCMWProtocolHandler").removeParticipants(d,a,c)};c.notifyScreenShareStart=function(a){j()||b("ScotchRTCMWProtocolHandler").notifyScreenShareStart(a)};c.notifyScreenShareEnd=function(a){j()||b("ScotchRTCMWProtocolHandler").notifyScreenShareEnd(a)};c.forceEncodingEnabled=function(a,c){b("ScotchRTCGroupCallActions").forceEncodingEnabled(c)};c.createDataMessageSubscription=function(a,b,c){};c.removeDataMessageSubscription=function(a,b,c){};c.sendGenericDataMessage=function(a,c,d,e,f){j()||b("ScotchRTCMWProtocolHandler").sendGenericDataMessageRequest(c,d,e,f)};c.logWithLogIdentifiers=function(a,c){a=b("ScotchRTCCallStore").getState();var d=a.callInfo,e=a.callSummary;a=a.remoteUsers;if(j()){var f;c({sharedCallID:d.callID,localCallID:(f=e.localCallID)!=null?f:"",peerID:a.first().FBID})}else{d.serverInfoData!=null||g(0,21793);c({sharedCallID:d.serverInfoData,localCallID:(f=e.localCallID)!=null?f:"",peerID:"MW_PEER_ID"})}};c.subscribeToRemoteVideo=function(a,c,d){b("ScotchRTCMWProtocolHandler").subscribeToRemoteFbids(c,d)};c.getPlatformType=function(){return b("PlatformType").Scotch};c.stopLocalVideo=function(a,c){b("ScotchRTCCallActions").stopLocalVideo()};return a}();e.exports=a;function i(){return!j()&&b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()}function j(){return b("ScotchRTCCallStore").getState().callInfo.protocol==="p2p"}function k(){j()||g(0,15678),b("ScotchRTCP2PCallEscalationStore").getState().inProgress||g(0,15713)}function l(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;b.includes(e.webrtcStream)||b.push(e.webrtcStream)}return b}function m(a){switch(a){case b("ZenonCallsModelTypes").ZenonEndCallReason.HangupCall:return b("FBRTCHangupReason").HANGUP_CALL;case b("ZenonCallsModelTypes").ZenonEndCallReason.IgnoreCall:return b("FBRTCHangupReason").IGNORE_CALL;case b("ZenonCallsModelTypes").ZenonEndCallReason.NoAnswerTimeout:return b("FBRTCHangupReason").NO_ANSWER_TIMEOUT;case b("ZenonCallsModelTypes").ZenonEndCallReason.InAnotherCall:return b("FBRTCHangupReason").IN_ANOTHER_CALL;case b("ZenonCallsModelTypes").ZenonEndCallReason.ClientInterrupted:return b("FBRTCHangupReason").CLIENT_INTERRUPTED;case b("ZenonCallsModelTypes").ZenonEndCallReason.ClientError:case b("ZenonCallsModelTypes").ZenonEndCallReason.WebRTCError:return b("FBRTCHangupReason").CLIENT_ERROR;default:return b("FBRTCHangupReason").HANGUP_CALL}}},null);
__d("ZenonCallsContext",["React","ZenonCallSDK","ZenonCallsModelTypes","err","immutable"],function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext({callMediaTypes:b("immutable").Map(),callSDK:new(b("ZenonCallSDK"))({}),callTimers:b("immutable").Map(),calls:b("immutable").Map(),currentClientCallId:"0",endCallHooks:new Set(),setCurrentClientCallId:function(){throw b("err")("setCurrentClientCallId is not implemented!")}});d=c;e.exports=d},null);
__d("ZenonThreadContext",["React"],function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext(null);d=c;e.exports=d},null);
__d("ZenonThreadHooks",["MercuryIDs","React","ZenonThreadContext"],function(a,b,c,d,e,f){"use strict";f.useThreadFBID=a;f.useThreadAndCallParticipants=c;f.useThreadParticipants=d;f.useThreadImage=e;f.useThreadType=h;f.useThreadName=i;f.useOngoingCall=j;f.useMercuryThread=k;var g=b("React");function a(){var a=g.useContext(b("ZenonThreadContext"));a=a?a.id:null;g.useDebugValue(a);return a}function c(){var a=g.useContext(b("ZenonThreadContext"));a=a?a.participants:[];g.useDebugValue(a);return a}function d(){var a=g.useContext(b("ZenonThreadContext")),c=(a=a==null?void 0:(a=a.mercuryThread)==null?void 0:a.participants)!=null?a:null;a=g.useMemo(function(){return c?c.map(function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)}).filter(Boolean):[]},[c]);g.useDebugValue(a);return a}function e(){var a=g.useContext(b("ZenonThreadContext"));a=a?a.imageUrl:null;g.useDebugValue(a);return a}function h(){var a=g.useContext(b("ZenonThreadContext"));a=(a=a==null?void 0:a.type)!=null?a:"other";g.useDebugValue(a);return a}function i(){var a=g.useContext(b("ZenonThreadContext"));a=a?a.name:null;g.useDebugValue(a);return a}function j(){var a=g.useContext(b("ZenonThreadContext"));a=a?a.hasOngoingCall:null;g.useDebugValue(a);return a}function k(){var a=g.useContext(b("ZenonThreadContext"));a=a?a.mercuryThread:null;g.useDebugValue(a);return a}},null);
__d("ZenonCallsHooks",["CurrentUser","FBLogger","React","ZenonCallsContext","ZenonCallsModelTypes","ZenonNetworkQualityMonitor","ZenonScreenSharingAvailabilityType","ZenonThreadHooks","immutable","unrecoverableViolation"],function(a,b,c,d,e,f){"use strict";var g=b("React"),h={useCallConnectedTime:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callTimers;a=a.currentClientCallId;a=(c=c.get(a))!=null?c:null;g.useDebugValue(a);return a},useCallParticipant:function(a){var b=null,c=l();if(c){b=(c=c.get(a))!=null?c:null}g.useDebugValue(b);return b},useCallParticipants:function(){var a=l();return(a=a)!=null?a:b("immutable").Map()},useCallParticipantsIDs:function(){var a=l(),b=g.useMemo(function(){return a===null?[]:Array.from(a.keys()).sort()},[a]);g.useDebugValue(b);return b},useCallState:function(){var a=j();a=a?a.callState:b("ZenonCallsModelTypes").ZenonCallState.New;g.useDebugValue(a);return a},useCollisionContext:function(){var a=j();a=(a=a==null?void 0:a.collisionContext)!=null?a:null;g.useDebugValue(a);return a},useConnectedCallParticipantsIDs:function(){var a=l(),c=g.useMemo(function(){if(a!==null&&a.size>0){var c=a.filter(function(a){a=a.state;return a===b("ZenonCallsModelTypes").ZenonCallParticipantState.Connected});return Array.from(c.keys()).sort()}return[]},[a]);g.useDebugValue(c);return c},useConnectedRemoteUserCount:function(){var a=b("CurrentUser").getID(),c=l(),d=g.useMemo(function(){return c===null?0:c.filter(function(c){var d=c.id;c=c.state;return d!==a&&c===b("ZenonCallsModelTypes").ZenonCallParticipantState.Connected}).size},[a,c]);g.useDebugValue(d);return d},useConnectedRemoteUsersIDs:function(){var a=b("CurrentUser").getID(),c=l(),d=g.useMemo(function(){if(c!==null&&c.size>0){var d=c.filter(function(c){var d=c.id;c=c.state;return d!==a&&c===b("ZenonCallsModelTypes").ZenonCallParticipantState.Connected});return Array.from(d.keys()).sort()}return[]},[a,c]);g.useDebugValue(d);return d},useCoplayOutputState:function(){var a=j();if(a){a=(a=a.stateSyncOutputStates.get("coplay"))==null?void 0:a.data;return{eligibleParticipants:(a==null?void 0:a.eligibleParticipants)||[],matchState:(a==null?void 0:a.matchState)||null}}return null},useDominantSpeakerID_DEPRECATED:function(){var a=j();a=(a=a==null?void 0:a.features.dominantSpeaker)!=null?a:null;g.useDebugValue(a);return a},useEndCallReason:function(){var a=j();a=(a=a==null?void 0:a.endCallReason)!=null?a:null;g.useDebugValue(a);return a},useGroupEscalationStatus:function(){var a=j();a=(a=a==null?void 0:a.groupEscalationStatus)!=null?a:null;g.useDebugValue(a);return a},useIsAudioCall:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callMediaTypes;a=a.currentClientCallId;c=c.get(a,"audio");g.useDebugValue(c);return c==="audio"},useIsP2P_TEMP:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK;a=a.currentClientCallId;c=c.getCallProtocolType_DEPRECATED(a)==="p2p";return c},useLiveMediaTrack:function(a,b){var c=j(),d=null;if(c){a=c.participants.get(a);if(a){d=(a=a.trackIDs.map(function(a){return c.mediaTracks.get(a)}).find(function(a){return a.contentType===b&&a.enabled&&a.webrtcTrack.readyState==="live"}))!=null?a:null}}g.useDebugValue(d);return d},useMediaTrack_DEBUG:function(a,b){var c=j(),d=null;if(c){a=c.participants.get(a);if(a){d=(a=a.trackIDs.map(function(a){return c.mediaTracks.get(a)}).find(function(a){return a.contentType===b}))!=null?a:null}}g.useDebugValue(d);return d},useLiveMediaTracks_DEBUG:function(a,c){var d=j(),e=b("immutable").Set();if(d){a=d.participants.get(a);if(a){a=a.trackIDs.map(function(a){return d.mediaTracks.get(a)}).filter(function(a){return a.contentType===c&&a.enabled&&a.webrtcTrack.readyState==="live"});e=a}}g.useDebugValue(e);return e},useLocalAudio:function(){var a;a=(a=k().find(function(a){return a.contentType==="audio"}))!=null?a:null;g.useDebugValue(a);return a},useLocalScreen:function(){var a;a=(a=k().find(function(a){return a.contentType==="screen"}))!=null?a:null;g.useDebugValue(a);return a},useLocalVideo:function(){var a;a=(a=k().find(function(a){return a.contentType==="video"}))!=null?a:null;g.useDebugValue(a);return a},usePreContactingRemoteUsersIDs:function(){var a=b("CurrentUser").getID(),c=l(),d=g.useMemo(function(){if(c!==null&&c.size>0){var d=c.filter(function(c){var d=c.id;c=c.state;return d!==a&&c===b("ZenonCallsModelTypes").ZenonCallParticipantState.Precontacting});return Array.from(d.keys()).sort()}return[]},[a,c]);g.useDebugValue(d);return d},useRemoteScreen:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK;a=a.currentClientCallId;c=c.getCallProtocolType_DEPRECATED(a)==="p2p";a=j();var d=h.useSupportMultipleStreams(),e=null;if(c||d){e=a===null?null:(c=a.mediaTracks.find(function(a){return a.remote===!0&&a.contentType==="screen"&&a.enabled}))!=null?c:null}g.useDebugValue(e);return e},useRemoteVideoTracks:function(){var a=h.useIsAudioCall(),b=j();a=!a&&b!==null?b.mediaTracks.filter(function(a){return a.remote===!0&&a.contentType==="video"&&a.enabled}).toArray():[];g.useDebugValue(a);return a},useResponseSubCode:function(){var a=j();return(a=a==null?void 0:a.responseSubCode)!=null?a:null},useVideoEscalationStatus:function(){var a=j();a=(a=a==null?void 0:a.videoEscalationStatus)!=null?a:null;g.useDebugValue(a);return a},useAcceptVideoEscalation:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(){c.acceptVideoEscalation(d)},[c,d])},useAddLocalTrack:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){return c.addLocalTrack(d,a)},[c,d])},useApproveParticipants:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){c.approveParticipants(d,a)},[c,d])},useCallSpecificState:function(a){if(typeof a==="function")throw b("unrecoverableViolation")("Functional state types will break useCallSpecificState!","rtc_www");var c=g.useContext(b("ZenonCallsContext")),d=c.currentClientCallId;c=g.useState(function(){return b("immutable").Map([[d,a]])});var e=c[0],f=c[1];c=g.useCallback(function(b){typeof b==="function"?f(function(c){return c.set(d,b(c.get(d,a)))}):f(e.set(d,b))},[d,a,e]);g.useEffect(function(){e.has(d)||f(e.set(d,a))},[d,a,e]);return[e.get(d,a),c]},useCanAddParticipants:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.canAddParticipants)!=null?a:!1;g.useDebugValue(c);return c},useCanReplaceLocalStreams:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.canReplaceLocalStreams)!=null?a:!1;g.useDebugValue(c);return c},useCancelVideoEscalation:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(){c.cancelVideoEscalation(d)},[c,d])},useDataMessageSubscription:function(a,c){var d=g.useContext(b("ZenonCallsContext")),e=d.callSDK,f=d.currentClientCallId,i=h.useCallState();g.useEffect(function(){i===b("ZenonCallsModelTypes").ZenonCallState.Connected&&e.createDataMessageSubscription(f,a,c);return function(){e.removeDataMessageSubscription(f,a,c)}},[e,i,f,a,c])},useDeclineVideoEscalation:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(){c.declineVideoEscalation(d)},[c,d])},useDenyParticipants:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){c.denyParticipants(d,a)},[c,d])},useEndCall:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId,e=a.endCallHooks;return g.useCallback(function(a,b){c.endCall(d,a,b),e.forEach(function(c){return c(a,b)})},[c,d,e])},useGetPlatformType:function(){var a=g.useContext(b("ZenonCallsContext"));a=a.callSDK;return a.getPlatformType()},useIsGuest:function(a){var c=h.useCallParticipant(a),d=b("ZenonThreadHooks").useThreadParticipants();return g.useMemo(function(){return(c==null?void 0:c.participantType)===b("ZenonCallsModelTypes").ZenonCallParticipantType.Guest||!d.includes(a)},[c,a,d])},useMuteTrack:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){c.muteTrack(d,a)},[c,d])},useOnCallEnded:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.endCallHooks;return g.useCallback(function(a){c.add(a)},[c])},usePoorConnectionStatus:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=((c=c.get(a))==null?void 0:c.features.networkStatus)===b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Poor)!=null?a:!1;g.useDebugValue(c);return c},useRemoteScreenSharingUserIDs_DEPRECATED:function(){var a=j();return(a=a==null?void 0:a.remoteScreenSharingUserIDs)!=null?a:b("immutable").OrderedSet()},useRemoveAllGuestParticipants:function(){var a=h.useCallParticipantsIDs(),c=h.useRemoveParticipants(),d=g.useMemo(function(){return a.filter(function(a){return b("CurrentUser").getID()!==a})},[a]);return g.useCallback(function(){c(d)},[d,c])},useRemoveLocalTrack:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){return c.removeLocalTrack(d,a)},[c,d])},useRemoveParticipants:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){c.removeParticipants(d,a)},[c,d])},useReplaceLocalTrack:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a,b,e){return c.replaceLocalTrack(d,a,b,e)},[c,d])},useRingParticipants:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){c.ringParticipants(d,a)},[c,d])},useRtpReceivers_I_KNOW_WHAT_I_AM_DOING:function(){var a=j();a=(a=a==null?void 0:a.rtpReceivers_I_KNOW_WHAT_I_AM_DOING.toArray())!=null?a:[];i("useRtpReceivers");g.useDebugValue(a);return a},useRtpSenders_I_KNOW_WHAT_I_AM_DOING:function(){var a=j();a=(a=a==null?void 0:a.rtpSenders_I_KNOW_WHAT_I_AM_DOING.toArray())!=null?a:[];i("useRtpSenders");g.useDebugValue(a);return a},useScreenSharingAvailability:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.screenSharingAvailability)!=null?a:b("ZenonScreenSharingAvailabilityType").Unknown;g.useDebugValue(c);return c},useServerInfoData:function(){var a=h.useCollisionContext();return(a=a==null?void 0:a.serverInfoData)!=null?a:null},useStartVideoEscalation:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(){c.startVideoEscalation(d)},[c,d])},useSubscribeToRemoteVideo:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a,b){c.subscribeToRemoteVideo(d,a,b)},[c,d])},useSupportMultipleStreams:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.supportMultipleStreams)!=null?a:!1;g.useDebugValue(c);return c},useUnmuteTrack:function(){var a=g.useContext(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g.useCallback(function(a){c.unmuteTrack(d,a)},[c,d])}};function i(a){g.useEffect(function(){b("FBLogger")("ZenonCallsHooks").event(a)},[a])}function j(){var a=g.useContext(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;a=(c=c.get(a))!=null?c:null;g.useDebugValue(a);return a}function k(){var a=j();a=a==null?void 0:a.mediaTracks;return!a?[]:a.filter(function(a){return a.remote===!1}).toArray()}function l(){var a=j();a=(a=a==null?void 0:a.participants)!=null?a:null;g.useDebugValue(a);return a}a=h;e.exports=a},null);
__d("ZenonCallsModelEmitter",["EventEmitter","ZenonCall","ZenonCallParticipant","ZenonCallsModelTypes","ZenonDismissReason","ZenonParticipantState","gkx","immutable"],function(a,b,c,d,e,f){"use strict";var g=100;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$ZenonCallsModelEmitter1=b("immutable").Map(),d.$ZenonCallsModelEmitter2=null,d.$ZenonCallsModelEmitter3=null,c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.emitCallsModel=function(a,c){var d=this.$ZenonCallsModelEmitter1.get(a);c=new(b("ZenonCall"))({callState:this.$ZenonCallsModelEmitter4(c),clientCallId:a,collisionContext:c.collisionContext,endCallReason:this.$ZenonCallsModelEmitter5(c),features:c.capabilities,groupEscalationStatus:this.$ZenonCallsModelEmitter6(c),mediaTracks:this.$ZenonCallsModelEmitter7(c),participants:this.$ZenonCallsModelEmitter8(c),rtpReceivers_I_KNOW_WHAT_I_AM_DOING:this.$ZenonCallsModelEmitter9(c),rtpSenders_I_KNOW_WHAT_I_AM_DOING:this.$ZenonCallsModelEmitter10(c),stateSyncInputStates:this.$ZenonCallsModelEmitter11(c),stateSyncOutputStates:this.$ZenonCallsModelEmitter12(c),videoEscalationStatus:this.$ZenonCallsModelEmitter13(c)});d=JSON.stringify(d);var e=JSON.stringify(c);d!==e&&(this.$ZenonCallsModelEmitter1=this.$ZenonCallsModelEmitter1.set(a,c),b("gkx")("1774704")?this.$ZenonCallsModelEmitter14(this.$ZenonCallsModelEmitter1):this.emitCallsModelDelegate(this.$ZenonCallsModelEmitter1))};d.$ZenonCallsModelEmitter14=function(a){var b=this;this.$ZenonCallsModelEmitter3!=null?this.$ZenonCallsModelEmitter2=a:(this.emitCallsModelDelegate(a),this.$ZenonCallsModelEmitter3=window.setTimeout(function(){b.$ZenonCallsModelEmitter2!=null&&(b.emitCallsModelDelegate(b.$ZenonCallsModelEmitter2),b.$ZenonCallsModelEmitter2=null),window.clearTimeout(b.$ZenonCallsModelEmitter3),b.$ZenonCallsModelEmitter3=null},g))};d.emitCallsModelDelegate=function(a){this.emit("callsModelUpdate",a)};d.$ZenonCallsModelEmitter4=function(a){return h[a.connectionState]};d.$ZenonCallsModelEmitter5=function(a){return a.dismissReason!=null?b("ZenonDismissReason").dismissToEndCallReason(a.dismissReason):null};d.$ZenonCallsModelEmitter6=function(a){return null};d.$ZenonCallsModelEmitter7=function(a){return b("immutable").Map(a.getTracks())};d.$ZenonCallsModelEmitter8=function(a){var c=a.getConsolidatedParticipantStates(),d=a.getUserToTracksMap(),e=a.getTracks();a=b("immutable").Map().withMutations(function(a){c.forEach(function(c,f){a.set(f,new(b("ZenonCallParticipant"))({id:f,participantType:b("ZenonCallsModelTypes").ZenonCallParticipantType.Messenger,state:b("ZenonParticipantState").toCallParticipantState(c),trackIDs:b("immutable").Set(d.get(f)).filter(function(a){return e.has(a)})}))})});return a};d.$ZenonCallsModelEmitter11=function(a){return b("immutable").Map(a.getStateSyncInputs())};d.$ZenonCallsModelEmitter12=function(a){return b("immutable").Map(a.getStateSyncOutputs())};d.$ZenonCallsModelEmitter13=function(a){return null};d.$ZenonCallsModelEmitter10=function(a){return b("immutable").Set(a.getRtpSenders_I_KNOW_WHAT_I_AM_DOING())};d.$ZenonCallsModelEmitter9=function(a){return b("immutable").Set(a.getRtpReceivers_I_KNOW_WHAT_I_AM_DOING())};d.getCallsModel=function(){return this.$ZenonCallsModelEmitter1};return c}(b("EventEmitter"));c=new a();f.CallsModelEmitterInstance=c;var h=Object.freeze({clientInitiatedRenegotiation:(d=b("ZenonCallsModelTypes")).ZenonCallState.Connected,creatingSdp:d.ZenonCallState.Connecting,init:d.ZenonCallState.New,peerConnectionRestarting:d.ZenonCallState.Connected,pendingApproval:d.ZenonCallState.PendingApproval,sdpNegotiated:d.ZenonCallState.Connected,sdpRenegotiating:d.ZenonCallState.Connected,sdpSet:d.ZenonCallState.Connecting,terminated:d.ZenonCallState.Terminated,waitingForIncoming:d.ZenonCallState.New});f.CONNECTION_STATE_TO_CALL_STATE_MAP=h},null);
__d("ZenonCapabilities",[],function(a,b,c,d,e,f){"use strict";f.capabilitiesToString=a;function a(a){a={AddParticipantEnabled:a.addParticipantEnabled,GROUP_COWATCH:a.cowatchGroupEnabled,cowatch:a.cowatchEnabled};return JSON.stringify(a)}},null);
__d("ZenonConnectionInitState",["ZenonCapabilities","ZenonParticipantState"],function(a,b,c,d,e,f){"use strict";f.onCreateConnection=a;function a(a,c){var d;if(c.type!=="createConnection")return;var e=c.payload.direction==="outgoing";c=c.payload;var f=c.dataChannels,g=c.initialSyncStates,h=c.mwRingRequest,i=c.tracks;c=c.usersToRing;var j=e?c:h==null?void 0:(d=h.jsonPayload.body.ringRequest)==null?void 0:d.otherParticipants;a.updateConnectionModel(function(c){j==null?void 0:j.forEach(function(a){c.updateParticipantState(a,b("ZenonParticipantState").ZenonParticipantState.CONTACTING)}),c.registerTrackFetcher(function(){return a.peerConnectionManager.getTracks()}),c.registerRtpSendersFetcher(function(){return a.peerConnectionManager.getRtpSenders()}),c.registerRtpReceiversFetcher(function(){return a.peerConnectionManager.getRtpReceivers()}),i==null?void 0:i.forEach(function(a){c.addLocalTrackToTrackMap(a.trackId)})});e&&a.signalingClient.sendInvite(c);d=a.getConnectionModel();c=d.capabilities;d=d.selfUserID;c={addParticipantEnabled:c.get("canAddParticipants"),cowatchEnabled:c.get("cowatchEnabled"),cowatchGroupEnabled:c.get("cowatchGroupEnabled")};c=b("ZenonCapabilities").capabilitiesToString(c);a.signalingClient.sendClientInfo(new Map([[d,c]]),g);i&&a.peerConnectionManager.addLocalTracks(i);f&&f.forEach(function(b){return a.peerConnectionManager.createDataChannel(b)});(e||(h==null?void 0:(d=h.jsonPayload.body.ringRequest)==null?void 0:d.offer)==null)&&a.peerConnectionManager.applyLocalSdp()}},null);
__d("ZenonConnectionPeerConnectionRestartingState",["ZenonParticipantState"],function(a,b,c,d,e,f){"use strict";f.onAnswerSdpReceived=a;f.onSecondaryConnectionEstablished=c;function a(a,b){if(b.type!=="sdpReceived"||b.payload.sdp.type!=="answer")return;b=b.payload;var c=b.mediaStates,d=b.renegotiationOffer;b=b.sdp;a.updateConnectionModel(function(a){a.updateTrackMapFromMediaStates(c.tracks)});a.secondaryPeerConnectionManager.applyRemoteSdp(b,c,d)}function c(a,c){if(c.type!=="connectionEstablished"||c.payload.peerConnectionRole!=="secondary")return{};c=a.peerConnectionManager;var d=a.secondaryPeerConnectionManager,e=a.updateConnectionModel;d.setTrackListenersFromManager(c);e(function(a){a.registerTrackFetcher(function(){return d.getTracks()}),a.updateParticipantState(a.selfUserID,b("ZenonParticipantState").ZenonParticipantState.CONNECTED)});c.end(!1);a.logEvent({mediaMode:a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode(),name:"callEscalated"});return{peerConnectionManager:d}}},null);
__d("ZenonScreenShare",["ZenonExperiments"],function(a,b,c,d,e,f){"use strict";f.isScreenSharingTrack=a;function a(a){return a.length===1&&a[0].contentType==="screen"&&b("ZenonExperiments").screenShareWithReplaceTrack()}},null);
__d("ZenonConnectionSMGuards",["ZenonDebugLogger","ZenonScreenShare"],function(a,b,c,d,e,f){"use strict";f.addScreenShareTrackWithReplaceGuard=a;f.incomingConnectionGuard=c;f.outgoingConnectionGuard=d;f.removeScreenShareTrackWithReplaceGuard=e;f.sdpAnswerReceiveGuard=g;f.sdpOfferReceiveGuard=h;f.activePeerConnectionGuard=i;f.secondaryPeerConnectionGuard=j;function a(a,c){if(c.type!=="addLocalTracks"||a.getConnectionModel().capabilities.supportMultipleStreams){b("ZenonDebugLogger").getInstance().logGuardsResults("addScreenShareTrackWithReplaceGuard",!1);return!1}c=c.payload.tracks;if(!b("ZenonScreenShare").isScreenSharingTrack(c)){b("ZenonDebugLogger").getInstance().logGuardsResults("addScreenShareTrackWithReplaceGuard",!1);return!1}c=Array.from(a.getConnectionModel().getTracks().values()).some(function(a){return!a.remote&&(a.contentType==="video"||a.contentType==="screen")});b("ZenonDebugLogger").getInstance().logGuardsResults("addScreenShareTrackWithReplaceGuard",c);return c}function c(a,c){a=c.type==="createConnection"&&c.payload.direction==="incoming";b("ZenonDebugLogger").getInstance().logGuardsResults("incomingConnectionGuard",a);return a}function d(a,c){a=c.type==="createConnection"&&c.payload.direction==="outgoing";b("ZenonDebugLogger").getInstance().logGuardsResults("outgoingConnectionGuard",a);return a}function e(a,c){if(c.type!=="removeLocalTrack"||a.getConnectionModel().capabilities.supportMultipleStreams){b("ZenonDebugLogger").getInstance().logGuardsResults("removeScreenShareTrackWithReplaceGuard",!1);return!1}c=c.payload.trackID;var d=a.getConnectionModel().getTracks().get(c);if(d==null||!b("ZenonScreenShare").isScreenSharingTrack([d])){b("ZenonDebugLogger").getInstance().logGuardsResults("removeScreenShareTrackWithReplaceGuard",!1);return!1}c=Array.from(a.getConnectionModel().getTracks().values()).some(function(a){return a.trackId!==d.trackId&&!a.remote&&(a.contentType==="video"||a.contentType==="screen")});b("ZenonDebugLogger").getInstance().logGuardsResults("removeScreenShareTrackWithReplaceGuard",c);return c}function g(a,c){a=c.type==="sdpReceived"&&c.payload.sdp.type==="answer";b("ZenonDebugLogger").getInstance().logGuardsResults("sdpAnswerReceiveGuard",a);return a}function h(a,c){a=c.type==="sdpReceived"&&c.payload.sdp.type==="offer";b("ZenonDebugLogger").getInstance().logGuardsResults("sdpOfferReceiveGuard",a);return a}function i(a,c){c=c.payload!=null&&c.payload.peerConnectionRole!=null&&c.payload.peerConnectionRole===a.activePeerConnection;b("ZenonDebugLogger").getInstance().logGuardsResults("activePeerConnectionGuard",c);return c}function j(a,c){a=c.payload!=null&&c.payload.peerConnectionRole!=null&&c.payload.peerConnectionRole==="secondary";b("ZenonDebugLogger").getInstance().logGuardsResults("secondaryPeerConnectionGuard",a);return a}},null);
__d("ZenonConnectionSdpNegotiatedState",["ZenonScreenShare"],function(a,b,c,d,e,f){"use strict";f.onAddLocalTracks=a;f.onAddScreenShareLocalTrack=c;f.onInitiatePeerConnectionRestarting=d;f.onRemoveLocalTrack=e;f.onRemoveScreenShareLocalTrack=g;f.onReplaceLocalTrack=h;function a(a,b){if(b.type==="addLocalTracks"){var c=b.payload.tracks;a.peerConnectionManager.addLocalTracks(c);a.peerConnectionManager.applyLocalSdp();a.updateConnectionModel(function(a){c.forEach(function(b){a.addLocalTrackToTrackMap(b.trackId)})})}}function c(a,c){if(c.type!=="addLocalTracks")return;var d=c.payload.tracks;if(!b("ZenonScreenShare").isScreenSharingTrack(d))return;a.peerConnectionManager.addLocalTracks(d);a.updateConnectionModel(function(a){d.forEach(function(b){a.addLocalTrackToTrackMap(b.trackId)})})}function d(a,b){if(b.type==="initiatePeerConnectionRestarting"){b=a.peerConnectionManager;var c=a.secondaryPeerConnectionManager;c.setLocalMediaStateVersion(b.getLocalMediaStateVersion());c.addLocalTracks(Array.from(b.getTracks().values()).filter(function(a){return!a.remote}));b.getDataChannelLabels().forEach(function(a){c.createDataChannel(a)});c.applyLocalSdp();return{activePeerConnection:"secondary"}}return{}}function e(a,b){if(b.type==="removeLocalTrack"){var c=b.payload.trackID;a.peerConnectionManager.removeLocalTrack(c);a.peerConnectionManager.applyLocalSdp();a.updateConnectionModel(function(a){a.removeLocalTrackFromTrackMap(c)})}}function g(a,b){if(b.type==="removeLocalTrack"){var c=b.payload.trackID;a.peerConnectionManager.removeLocalTrack(c);a.updateConnectionModel(function(a){a.removeLocalTrackFromTrackMap(c)})}}function h(a,b){if(b.type!=="replaceLocalTrack")return;b=b.payload;var c=b.replacementTrack,d=b.trackIDToReplace;a.peerConnectionManager.replaceLocalTrack(d,c);a.updateConnectionModel(function(a){a.removeLocalTrackFromTrackMap(d),a.addLocalTrackToTrackMap(c.trackId)})}},null);
__d("ZenonConnectionSdpSetState",["ZenonMWMessageTypes","ZenonParticipantState"],function(a,b,c,d,e,f){"use strict";f.onConnectionEstablished=a;function a(a,c){c.type==="connectionEstablished"&&(a.signalingClient.sendClientEvent(b("ZenonMWMessageTypes").ZenonMWClientEventType.MEDIA_CONNECTED),a.updateConnectionModel(function(a){a.updateParticipantState(a.selfUserID,b("ZenonParticipantState").ZenonParticipantState.CONNECTED)}),a.logEvent({mediaMode:a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode(),name:"callConnected"}),a.logEvent({name:"connectionReady"}),a.logEvent({isCallOngoing:function(){return a.getConnectionModel().connectionState!=="terminated"},name:"startHeartbeat"}))}},null);
__d("ZenonConnectionSharedActions",["ScotchRTWebUserActionLogger","ZenonDismissReason","ZenonParticipantState","immutable"],function(a,b,c,d,e,f){"use strict";f.onAddParticipants=a;f.onAnswerReady=c;f.onCapabilitiesReceived=d;f.onConnectionDestroyed=e;f.onConnectionDropped=g;f.onCreateDataMessageSubscription=h;f.onDataMessageReceived=i;f.onEndConnection=j;f.onForceEncodingEnabled=k;f.onIceCandidateReady=l;f.onIceCandidateReceived=m;f.onLocalMediaStateUpdateProcessing=n;f.onLocalMediaStateUpdateReady=o;f.onLocalMediaStateUpdateRetry=p;f.onOfferReady=q;f.onParticipantUpdateReceivedEvent=r;f.onRemoveDataMessageSubscription=s;f.onRemoveParticipants=t;f.onRoomContextUpdateReceived=u;f.onSdpReceived=v;f.onSendGenericDataMessage=w;f.onStateSyncUnsubscribe=x;f.onStateSyncUpdate=y;f.onStopLocalTrack=z;f.onSubscriptionRequest=A;f.onUserApprovalRequest=B;function a(a,c){if(c.type==="addParticipants"){var d=!1,e=c.payload.usersToRing;a.updateConnectionModel(function(a){var c=a.getConsolidatedParticipantStates();e.forEach(function(e){C(e,c)||(a.updateParticipantState(e,b("ZenonParticipantState").ZenonParticipantState.CONTACTING),d=!0)})});d&&a.signalingClient.sendAddParticipantsMessage(e)}}function c(a,b){if(b.type==="answerReady"){b=b.payload;var c=b.mediaStates;b=b.sdp;a.signalingClient.sendSdp(b,c)}}function d(a,b){if(b.type==="capabilitiesReceived"){var c=b.payload.capabilities;a.updateConnectionModel(function(a){a.updateCapabilities(c)})}}function e(a,c){if(c.type==="connectionDestroyed"&&c.payload.error!==null){var d=b("ZenonDismissReason").mediaErrorToDismissReason(c.payload.error);a.updateConnectionModel(function(a){a.updateParticipantState(a.selfUserID,b("ZenonParticipantState").ZenonParticipantState.DISCONNECTED),a.dismissReason=d});a.logEvent({name:"connectionDestroyed"});a.logEvent({endCallReason:d,endCallSubreason:c.payload.error?c.payload.error:"",isRemoteEnded:!1,name:"callEnded"})}}function g(a,c){c.type==="connectionDropped"&&a.updateConnectionModel(function(a){C(a.selfUserID,a.getConsolidatedParticipantStates())&&a.updateParticipantState(a.selfUserID,b("ZenonParticipantState").ZenonParticipantState.CONNECTING)})}function h(a,c){if(c.type==="createDataMessageSubscription"){var d=c.payload.dataChannelLabel;c=c.payload.messageHandler;var e=a.dataMessageSubscriptions.get(d,b("immutable").Set());a=a.dataMessageSubscriptions.set(d,e.add(c));return{dataMessageSubscriptions:a}}return{}}function i(a,b){if(b.type==="dataMessageReceived"){b=b.payload;var c=b.data;b=b.dataChannelLabel;a=a.dataMessageSubscriptions.get(b);a&&a.forEach(function(a){return a(c)})}}function j(a,c){if(c.type==="endConnection"){c=c.payload;var d=c.dismissReason,e=c.dismissReasonSetByRemote,f=c.dismissSubreason;c=c.shouldInformPeer;a.updateConnectionModel(function(a){a.updateParticipantState(a.selfUserID,b("ZenonParticipantState").ZenonParticipantState.DISCONNECTED),a.dismissReason=d});c&&a.signalingClient.sendDismiss(d);a.logEvent({endCallReason:d,endCallSubreason:f,isRemoteEnded:e,name:"callEnded"});a.peerConnectionManager.end(!0)}}function k(a,b){if(b.type!=="forceEncodingEnabled")return;a.peerConnectionManager.forceEncodingEnabled(b.payload.enabled)}function l(a,b){if(b.type==="iceCandidateReady"){var c;b=b.payload.candidate;b={candidateSdpString:b.candidate,sdpMLineIndex:(c=b.sdpMLineIndex)!=null?c:0,sdpMid:(c=b.sdpMid)!=null?c:""};a.signalingClient.sendIceCandidate(b)}}function m(a,b){if(b.type==="iceCandidateReceived"){b=b.payload;b={candidate:b.candidateSdpString,sdpMLineIndex:b.sdpMLineIndex,sdpMid:b.sdpMid};a.peerConnectionManager.applyRemoteIceCandidate(b)}}function n(a,b){if(b.type==="localMediaStateUpdateProcessing"){b=b.payload;var c=b.enabled;b=b.trackID;c?a.peerConnectionManager.unmuteLocalTrack(b):a.peerConnectionManager.muteLocalTrack(b)}}function o(a,b){b.type==="localMediaStateUpdateReady"&&a.signalingClient.sendMediaUpdate(b.payload.mediaStates)}function p(a,b){b.type==="localMediaStateUpdateRetry"&&a.peerConnectionManager.localMediaStateUpdateRetry()}function q(a,b){b.type==="offerReady"&&a.signalingClient.sendSdp(b.payload.sdp,b.payload.mediaStates)}function r(a,b){if(b.type==="participantUpdateReceived"){var c=b.payload.participantStates;a.updateConnectionModel(function(a){c.forEach(function(b,c){c!==a.selfUserID&&a.updateParticipantState(c,b)})})}}function s(a,c){if(c.type==="removeDataMessageSubscription"){var d=c.payload.dataChannelLabel;c=c.payload.messageHandler;var e=a.dataMessageSubscriptions.get(d,b("immutable").Set());a=a.dataMessageSubscriptions.set(d,e["delete"](c));return{dataMessageSubscriptions:a}}return{}}function t(a,b){if(b.type==="removeParticipants"){b=b.payload.usersToRemove;a.signalingClient.sendRemoveParticipantsRequest(b)}}function u(a,b){if(b.type==="connectionRoomUpdateReceived"){var c=b.payload.context;a.updateConnectionModel(function(a){a.collisionContext=c})}}function v(a,b){if(b.type==="sdpReceived"){b=b.payload;var c=b.mediaStates,d=b.renegotiationOffer;b=b.sdp;a.updateConnectionModel(function(a){a.updateTrackMapFromMediaStates(c.tracks)});a.peerConnectionManager.applyRemoteSdp(b,c,d);b.type==="answer"?a.logEvent({name:"answerSdpReceived"}):b.type==="offer"&&a.logEvent({name:"offerSdpReceived"})}}function w(a,b){if(b.type==="sendGenericDataMessage"){b=b.payload;var c=b.data,d=b.recipientIDs,e=b.serviceRecipients;b=b.topic;a.signalingClient.sendGenericDataMessage(b,c,d,e)}}function x(a,b){if(b.type!=="stateSyncUnsubscribe")return;b=b.payload.topic;a.signalingClient.sendStateSyncUnsubscribe(b)}function y(a,b){if(b.type!=="stateSyncUpdate")return;b=b.payload;var c=b.inputData;b=b.topic;a.signalingClient.sendStateSyncUpdate(b,c)}function z(a,b){if(b.type!=="stopLocalTrack")return;b=b.payload.trackID;a.peerConnectionManager.stopLocalTrack(b)}function A(a,c){if(c.type!=="subscriptionRequest")return{};var d=c.payload,e=d.includeDominantSpeaker;d=d.subscriptions;var f=a.getConnectionModel(),g=f.getUserToTracksMap(),h=f.getTracks(),i=[],j=new Map(),k=[];d.forEach(function(a){var b=a.user,c=a.videoQuality;j.set(b,null);a=g.get(b);if(!a){k.push({error:"track map doesn't exist",user:b});return}var d=[],e=!1;a.forEach(function(a){var f=h.get(a);f&&f.webrtcStream.active&&f.contentType==="video"?(i.push({cname:f.webrtcStream.id,options:{videoQuality:c}}),j.set(b,f.webrtcStream.id),e=!0):d.push(a)});e||k.push({error:"no active video track found. found trackIDs: "+JSON.stringify(d),user:b})});k.length>0&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[ZP] Subscription request warnings: "+JSON.stringify(k)});e&&i.push({cname:""});a.signalingClient.sendSubscriptionRequest(i);return{currentVideoSubscriptions:{request:c,userToCnameMap:j}}}function B(a,b){if(b.type!=="userApprovalRequest")return;b=b.payload;var c=b.approvalStatus;b=b.targetUsers;a.signalingClient.sendUsersApprovalRequest(c,b)}function C(a,c){c=c.get(a);return c===b("ZenonParticipantState").ZenonParticipantState.CONNECTED}},null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("xstate-4.7.7",[],function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){Object.defineProperty(g,"__esModule",{value:!0}),g.STATE_DELIMITER=".",g.EMPTY_ACTIVITY_MAP={},g.DEFAULT_GUARD_TYPE="xstate.guard",g.TARGETLESS_KEY=""}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){Object.defineProperty(l,"__esModule",{value:!0}),l.IS_PRODUCTION=!0}var o=!1;function p(){o||(o=!0,n());return m.exports}var q={},r={exports:q};function s(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},d=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(c(arguments[b]));return a};Object.defineProperty(q,"__esModule",{value:!0});var e=k(),f=p();function g(a){return Object.keys(a)}q.keys=g;function h(a,b,c){c===void 0&&(c=e.STATE_DELIMITER);var d=n(a,c),f=n(b,c);if(J(f))return J(d)?f===d:!1;return J(d)?d in f:g(d).every(function(a){return!(a in f)?!1:h(d[a],f[a])})}q.matchesState=h;function i(a){try{return J(a)||typeof a==="number"?""+a:a.type}catch(a){throw new Error("Events must be strings or objects with a string event.type property.")}}q.getEventType=i;function j(a){try{return J(a)||typeof a==="number"?""+a:I(a)?a.name:a.type}catch(a){throw new Error("Actions must be strings or objects with a string action.type property.")}}q.getActionType=j;function l(a,b){try{return H(a)?a:a.toString().split(b)}catch(b){throw new Error("'"+a+"' is not a valid state path.")}}q.toStatePath=l;function m(a){return typeof a==="object"&&"value"in a&&"context"in a&&"event"in a&&"_event"in a}q.isStateLike=m;function n(a,b){if(m(a))return a.value;if(H(a))return o(a);if(typeof a!=="string")return a;a=l(a,b);return o(a)}q.toStateValue=n;function o(a){if(a.length===1)return a[0];var b={},c=b;for(var d=0;d<a.length-1;d++)d===a.length-2?c[a[d]]=a[d+1]:(c[a[d]]={},c=c[a[d]]);return b}q.pathToStateValue=o;function r(a,b){var c={},d=g(a);for(var e=0;e<d.length;e++){var f=d[e];c[f]=b(a[f],f,a,e)}return c}q.mapValues=r;function s(a,c,d){var e,f,h={};try{for(var i=b(g(a)),j=i.next();!j.done;j=i.next()){var k=j.value,l=a[k];if(!d(l))continue;h[k]=c(l,k,a)}}catch(a){e={error:a}}finally{try{j&&!j.done&&(f=i["return"])&&f.call(i)}finally{if(e)throw e.error}}return h}q.mapFilterValues=s;q.path=function(a){return function(c){var d,e;c=c;try{for(var f=b(a),g=f.next();!g.done;g=f.next()){var h=g.value;c=c[h]}}catch(a){d={error:a}}finally{try{g&&!g.done&&(e=f["return"])&&e.call(f)}finally{if(d)throw d.error}}return c}};function t(a,c){return function(d){var e,f;d=d;try{for(var g=b(a),h=g.next();!h.done;h=g.next()){var i=h.value;d=d[c][i]}}catch(a){e={error:a}}finally{try{h&&!h.done&&(f=g["return"])&&f.call(g)}finally{if(e)throw e.error}}return d}}q.nestedPath=t;function u(a){if(!a)return[[]];if(J(a))return[[a]];var b=w(g(a).map(function(b){var c=a[b];return typeof c!=="string"&&(!c||!Object.keys(c).length)?[[b]]:u(a[b]).map(function(a){return[b].concat(a)})}));return b}q.toStatePaths=u;function v(a){var c,d,e={};if(a&&a.length===1&&a[0].length===1)return a[0][0];try{for(var a=b(a),f=a.next();!f.done;f=a.next()){var g=f.value,h=e;for(var i=0;i<g.length;i++){var j=g[i];if(i===g.length-2){h[j]=g[i+1];break}h[j]=h[j]||{};h=h[j]}}}catch(a){c={error:a}}finally{try{f&&!f.done&&(d=a["return"])&&d.call(a)}finally{if(c)throw c.error}}return e}q.pathsToStateValue=v;function w(a){var b;return(b=[]).concat.apply(b,d(a))}q.flatten=w;function x(a){return H(a)?a:[a]}q.toArrayStrict=x;function y(a){return a===void 0?[]:x(a)}q.toArray=y;function z(a,c,d){var e,f;if(I(a))return a(c,d.data);var h={};try{for(var i=b(g(a)),j=i.next();!j.done;j=i.next()){var k=j.value,l=a[k];I(l)?h[k]=l(c,d.data):h[k]=l}}catch(a){e={error:a}}finally{try{j&&!j.done&&(f=i["return"])&&f.call(i)}finally{if(e)throw e.error}}return h}q.mapContext=z;function A(a){return/^(done|error)\./.test(a)}q.isBuiltInEvent=A;function B(a){if(a instanceof Promise)return!0;return a!==null&&(I(a)||typeof a==="object")&&I(a.then)?!0:!1}q.isPromiseLike=B;function C(a,d){var e,f,g=c([[],[]],2),h=g[0];g=g[1];try{for(var a=b(a),i=a.next();!i.done;i=a.next()){var j=i.value;d(j)?h.push(j):g.push(j)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(f=a["return"])&&f.call(a)}finally{if(e)throw e.error}}return[h,g]}q.partition=C;function D(a,b){return r(a.states,function(a,c){if(!a)return void 0;c=(J(b)?void 0:b[c])||(a?a.current:void 0);return!c?void 0:{current:c,states:D(a,c)}})}q.updateHistoryStates=D;function E(a,b){return{current:b,states:D(a,b)}}q.updateHistoryValue=E;function F(a,c,d,e){f.IS_PRODUCTION||G(!!a,"Attempting to update undefined context");d=a?d.reduce(function(a,d){var f,h,i=d.assignment;d={state:e,action:d,_event:c};var j={};if(I(i))j=i(a,c.data,d);else try{for(var k=b(g(i)),l=k.next();!l.done;l=k.next()){var m=l.value,n=i[m];j[m]=I(n)?n(a,c.data,d):n}}catch(a){f={error:a}}finally{try{l&&!l.done&&(h=k["return"])&&h.call(k)}finally{if(f)throw f.error}}return Object.assign({},a,j)},a):a;return d}q.updateContext=F;var G=function(){};q.warn=G;f.IS_PRODUCTION||(q.warn=G=function(a,b){var c=a instanceof Error?a:void 0;if(!c&&a)return;if(console!==void 0){a=["Warning: "+b];c&&a.push(c);console.warn.apply(console,a)}});function H(a){return Array.isArray(a)}q.isArray=H;function I(a){return typeof a==="function"}q.isFunction=I;function J(a){return typeof a==="string"}q.isString=J;function K(a,b){if(!a)return void 0;if(J(a))return{type:e.DEFAULT_GUARD_TYPE,name:a,predicate:b?b[a]:void 0};return I(a)?{type:e.DEFAULT_GUARD_TYPE,name:a.name,predicate:a}:a}q.toGuard=K;function L(a){try{return"subscribe"in a&&I(a.subscribe)}catch(a){return!1}}q.isObservable=L;q.symbolObservable=function(){return typeof Symbol==="function"&&Symbol.observable||"@@observable"}();function M(a){try{return"__xstatenode"in a}catch(a){return!1}}q.isMachine=M;function N(a){return!!a&&typeof a.send==="function"}q.isActor=N;q.uniqueId=function(){var a=0;return function(){a++;return a.toString(16)}}();function O(b,c){return J(b)||typeof b==="number"?a({type:b},c):b}q.toEventObject=O;function P(b,c){if(!J(b)&&"$$type"in b&&b.$$type==="scxml")return b;b=O(b);return a({name:b.type,data:b,$$type:"scxml",type:"external"},c)}q.toSCXMLEvent=P;function Q(b,c){c=x(c).map(function(c){return typeof c==="undefined"||typeof c==="string"||M(c)?{target:c,event:b}:a(a({},c),{event:b})});return c}q.toTransitionConfigArray=Q;function R(a){return a===void 0||a===e.TARGETLESS_KEY?void 0:y(a)}q.normalizeTarget=R;function S(a,b,c){if(!f.IS_PRODUCTION){var d=a.stack?" Stacktrace was '"+a.stack+"'":"";if(a===b)console.error("Missing onError handler for invocation '"+c+"', error was '"+a+"'."+d);else{var e=b.stack?" Stacktrace was '"+b.stack+"'":"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '"+c+"'. "+("Original error: '"+a+"'. "+d+" Current error is '"+b+"'."+e))}}}q.reportUnhandledExceptionOnInvocation=S}var t=!1;function u(){t||(t=!0,s());return r.exports}var v={},w={exports:v};function x(){var a=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(v,"__esModule",{value:!0});var b=u();function c(c,d){var e,f,g;try{for(var h=a(b.keys(c)),i=h.next();!i.done;i=h.next()){var j=i.value;b.matchesState(j,d)&&(!g||d.length>g.length)&&(g=j)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(f=h["return"])&&f.call(h)}finally{if(e)throw e.error}}return c[g]}v.mapState=c}var y=!1;function z(){y||(y=!0,x());return w.exports}var A={},B={exports:A};function C(){Object.defineProperty(A,"__esModule",{value:!0}),(function(a){a.Start="xstate.start",a.Stop="xstate.stop",a.Raise="xstate.raise",a.Send="xstate.send",a.Cancel="xstate.cancel",a.NullEvent="",a.Assign="xstate.assign",a.After="xstate.after",a.DoneState="done.state",a.DoneInvoke="done.invoke",a.Log="xstate.log",a.Init="xstate.init",a.Invoke="xstate.invoke",a.ErrorExecution="error.execution",a.ErrorCommunication="error.communication",a.ErrorPlatform="error.platform",a.ErrorCustom="xstate.error",a.Update="xstate.update",a.Pure="xstate.pure"})(A.ActionTypes||(A.ActionTypes={})),(function(a){a.Parent="#_parent",a.Internal="#_internal"})(A.SpecialTargets||(A.SpecialTargets={}))}var D=!1;function E(){D||(D=!0,C());return B.exports}var F={},G={exports:F};function H(){var a=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},b=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},c=this&&this.__spread||function(){for(var a=[],c=0;c<arguments.length;c++)a=a.concat(b(arguments[c]));return a};Object.defineProperty(F,"__esModule",{value:!0});var d=u();F.isLeafNode=function(a){return a.type==="atomic"||a.type==="final"};function e(a){return d.keys(a.states).map(function(b){return a.states[b]})}F.getChildren=e;function f(a){var b=[a];return F.isLeafNode(a)?b:b.concat(d.flatten(e(a).map(f)))}F.getAllStateNodes=f;function g(b,c){var d,f,g,h,j,k,l,m;b=new Set(b);b=i(b);var n=new Set(c);try{for(var c=a(n),o=c.next();!o.done;o=c.next()){var p=o.value,q=p.parent;while(q&&!n.has(q))n.add(q),q=q.parent}}catch(a){d={error:a}}finally{try{o&&!o.done&&(f=c["return"])&&f.call(c)}finally{if(d)throw d.error}}o=i(n);try{for(var c=a(n),r=c.next();!r.done;r=c.next()){var p=r.value;if(p.type==="compound"&&(!o.get(p)||!o.get(p).length))b.get(p)?b.get(p).forEach(function(a){return n.add(a)}):p.initialStateNodes.forEach(function(a){return n.add(a)});else if(p.type==="parallel")try{for(var s=(j=void 0,a(e(p))),t=s.next();!t.done;t=s.next()){var u=t.value;if(u.type==="history")continue;n.has(u)||(n.add(u),b.get(u)?b.get(u).forEach(function(a){return n.add(a)}):u.initialStateNodes.forEach(function(a){return n.add(a)}))}}catch(a){j={error:a}}finally{try{t&&!t.done&&(k=s["return"])&&k.call(s)}finally{if(j)throw j.error}}}}catch(a){g={error:a}}finally{try{r&&!r.done&&(h=c["return"])&&h.call(c)}finally{if(g)throw g.error}}try{for(var u=a(n),t=u.next();!t.done;t=u.next()){var p=t.value,q=p.parent;while(q&&!n.has(q))n.add(q),q=q.parent}}catch(a){l={error:a}}finally{try{t&&!t.done&&(m=u["return"])&&m.call(u)}finally{if(l)throw l.error}}return n}F.getConfiguration=g;function h(a,b){var c=b.get(a);if(!c)return{};if(a.type==="compound"){a=c[0];if(a){if(F.isLeafNode(a))return a.key}else return{}}var d={};c.forEach(function(a){d[a.key]=h(a,b)});return d}function i(b){var c,d,e=new Map();try{for(var b=a(b),f=b.next();!f.done;f=b.next()){var g=f.value;e.has(g)||e.set(g,[]);g.parent&&(e.has(g.parent)||e.set(g.parent,[]),e.get(g.parent).push(g))}}catch(a){c={error:a}}finally{try{f&&!f.done&&(d=b["return"])&&d.call(b)}finally{if(c)throw c.error}}return e}F.getAdjList=i;function j(a,b){b=g([a],b);return h(a,i(b))}F.getValue=j;function k(a,b){if(Array.isArray(a))return a.some(function(a){return a===b});return a instanceof Set?a.has(b):!1}F.has=k;function l(a){return d.flatten(c(new Set(a.map(function(a){return a.ownEvents}))))}F.nextEvents=l;function m(a,b){if(b.type==="compound")return e(b).some(function(b){return b.type==="final"&&k(a,b)});return b.type==="parallel"?e(b).every(function(b){return m(a,b)}):!1}F.isInFinalState=m}var I=!1;function J(){I||(I=!0,H());return G.exports}var K={},L={exports:K};function M(){Object.defineProperty(K,"__esModule",{value:!0});var a=E();K.start=a.ActionTypes.Start;K.stop=a.ActionTypes.Stop;K.raise=a.ActionTypes.Raise;K.send=a.ActionTypes.Send;K.cancel=a.ActionTypes.Cancel;K.nullEvent=a.ActionTypes.NullEvent;K.assign=a.ActionTypes.Assign;K.after=a.ActionTypes.After;K.doneState=a.ActionTypes.DoneState;K.log=a.ActionTypes.Log;K.init=a.ActionTypes.Init;K.invoke=a.ActionTypes.Invoke;K.errorExecution=a.ActionTypes.ErrorExecution;K.errorPlatform=a.ActionTypes.ErrorPlatform;K.error=a.ActionTypes.ErrorCustom;K.update=a.ActionTypes.Update;K.pure=a.ActionTypes.Pure}var N=!1;function O(){N||(N=!0,M());return L.exports}var P={},Q={exports:P};function R(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__rest||function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};Object.defineProperty(P,"__esModule",{value:!0});var c=E(),d=O();P.actionTypes=d;var e=u(),f=u();P.initEvent=e.toSCXMLEvent({type:d.init});function g(a,b){return b?b[a]||void 0:void 0}P.getActionFunction=g;function h(c,d){var f;if(e.isString(c)||typeof c==="number"){var h=g(c,d);e.isFunction(h)?f={type:c,exec:h}:h?f=h:f={type:c,exec:void 0}}else if(e.isFunction(c))f={type:c.name||c.toString(),exec:c};else{var h=g(c.type,d);if(e.isFunction(h))f=a(a({},c),{exec:h});else if(h){d=c.type;var i=b(c,["type"]);f=a(a({type:d},h),i)}else f=c}Object.defineProperty(f,"toString",{value:function(){return f.type},enumerable:!1,configurable:!0});return f}P.toActionObject=h;P.toActionObjects=function(a,b){if(!a)return[];a=f.isArray(a)?a:[a];return a.map(function(a){return h(a,b)})};function i(b){var c=h(b);return a(a({id:e.isString(b)?b:c.id},c),{type:c.type})}P.toActivityDefinition=i;function j(a){return!e.isString(a)?l(a,{to:c.SpecialTargets.Internal}):{type:d.raise,event:a}}P.raise=j;function k(a){return{type:d.raise,_event:e.toSCXMLEvent(a.event)}}P.resolveRaise=k;function l(a,b){return{to:b?b.to:void 0,type:d.send,event:e.isFunction(a)?a:e.toEventObject(a),delay:b?b.delay:void 0,id:b&&b.id!==void 0?b.id:e.isFunction(a)?a.name:e.getEventType(a)}}P.send=l;function m(b,c,d,f){var g={_event:d},h=e.toSCXMLEvent(e.isFunction(b.event)?b.event(c,d.data,g):b.event);if(e.isString(b.delay)){f=f&&f[b.delay];f=e.isFunction(f)?f(c,d.data,g):f}else f=e.isFunction(b.delay)?b.delay(c,d.data,g):b.delay;c=e.isFunction(b.to)?b.to(c,d.data,g):b.to;return a(a({},b),{to:c,_event:h,event:h.data,delay:f})}P.resolveSend=m;function n(b,d){return l(b,a(a({},d),{to:c.SpecialTargets.Parent}))}P.sendParent=n;function o(){return n(d.update)}P.sendUpdate=o;function p(b,c){return l(b,a(a({},c),{to:function(a,b,c){a=c._event;return a.origin}}))}P.respond=p;var q=function(a,b){return{context:a,event:b}};function r(a,b){a===void 0&&(a=q);return{type:d.log,label:b,expr:a}}P.log=r;P.resolveLog=function(b,c,d){return a(a({},b),{value:e.isString(b.expr)?b.expr:b.expr(c,d.data,{_event:d})})};P.cancel=function(a){return{type:d.cancel,sendId:a}};function s(a){a=i(a);return{type:c.ActionTypes.Start,activity:a,exec:void 0}}P.start=s;function t(a){a=i(a);return{type:c.ActionTypes.Stop,activity:a,exec:void 0}}P.stop=t;P.assign=function(a){return{type:d.assign,assignment:a}};function v(a){return typeof a==="object"&&"type"in a}P.isActionObject=v;function w(a,b){b=b?"#"+b:"";return c.ActionTypes.After+"("+a+")"+b}P.after=w;function x(a,b){var d=c.ActionTypes.DoneState+"."+a;a={type:d,data:b};a.toString=function(){return d};return a}P.done=x;function y(a,b){var d=c.ActionTypes.DoneInvoke+"."+a;a={type:d,data:b};a.toString=function(){return d};return a}P.doneInvoke=y;function z(a,b){var d=c.ActionTypes.ErrorPlatform+"."+a;a={type:d,data:b};a.toString=function(){return d};return a}P.error=z;function A(a){return{type:c.ActionTypes.Pure,get:a}}P.pure=A;function B(b,c){return l(function(a,b){return b},a(a({},c),{to:b}))}P.forwardTo=B;function C(b,f){return n(function(a,c,f){return{type:d.error,data:e.isFunction(b)?b(a,c,f):b}},a(a({},f),{to:c.SpecialTargets.Parent}))}P.escalate=C}var S=!1;function T(){S||(S=!0,R());return Q.exports}var U={},aa={exports:U};function ba(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__rest||function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c},c=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},d=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(c(arguments[b]));return a};Object.defineProperty(U,"__esModule",{value:!0});var e=k(),f=u(),g=J(),h=T();function i(a,b){if(a===b)return!0;if(a===void 0||b===void 0)return!1;if(f.isString(a)||f.isString(b))return a===b;var c=f.keys(a),d=f.keys(b);return c.length===d.length&&c.every(function(c){return i(a[c],b[c])})}U.stateValuesEqual=i;function j(a){return f.isString(a)?!1:"value"in a&&"history"in a}U.isState=j;function l(b,c){var d=b.exec,e=a(a({},b),{exec:d!==void 0?function(){return d(c.context,c.event,{action:b,state:c,_event:c._event})}:void 0});return e}U.bindActionToState=l;j=function(){function a(a){this.actions=[],this.activities=e.EMPTY_ACTIVITY_MAP,this.meta={},this.events=[],this.value=a.value,this.context=a.context,this._event=a._event,this._sessionid=a._sessionid,this.event=this._event.data,this.historyValue=a.historyValue,this.history=a.history,this.actions=a.actions||[],this.activities=a.activities||e.EMPTY_ACTIVITY_MAP,this.meta=a.meta||{},this.events=a.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=a.configuration,this.transitions=a.transitions,this.children=a.children,this.done=!!a.done,Object.defineProperty(this,"nextEvents",{get:function(){return g.nextEvents(a.configuration)}})}a.from=function(b,c){if(b instanceof a)return b.context!==c?new a({value:b.value,context:c,_event:b._event,_sessionid:null,historyValue:b.historyValue,history:b.history,actions:[],activities:b.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):b;var d=h.initEvent;return new a({value:b,context:c,_event:d,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})};a.create=function(b){return new a(b)};a.inert=function(b,c){if(b instanceof a){if(!b.actions.length)return b;var d=h.initEvent;return new a({value:b.value,context:c,_event:d,_sessionid:null,historyValue:b.historyValue,history:b.history,activities:b.activities,configuration:b.configuration,transitions:[],children:{}})}return a.from(b,c)};a.prototype.toStrings=function(a,b){var c=this;a===void 0&&(a=this.value);b===void 0&&(b=".");if(f.isString(a))return[a];var e=f.keys(a);return e.concat.apply(e,d(e.map(function(d){return c.toStrings(a[d],b).map(function(a){return d+b+a})})))};a.prototype.toJSON=function(){var a=this;a.configuration;a.transitions;a=b(a,["configuration","transitions"]);return a};a.prototype.matches=function(a){return f.matchesState(a,this.value)};return a}();U.State=j}var ca=!1;function V(){ca||(ca=!0,ba());return aa.exports}var W={},da={exports:W};function ea(){Object.defineProperty(W,"__esModule",{value:!0});function a(a){return{id:a,send:function(){return void 0},subscribe:function(){return{unsubscribe:function(){return void 0}}},toJSON:function(){return{id:a}}}}W.createNullActor=a;function b(b){var c=a(b.id);c.meta=b;return c}W.createInvocableActor=b;function c(a){try{return typeof a.send==="function"}catch(a){return!1}}W.isActor=c}var fa=!1;function ga(){fa||(fa=!0,ea());return da.exports}var X={},ha={exports:X};function ia(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__rest||function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c},c=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},d=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(c(arguments[b]));return a},e=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(X,"__esModule",{value:!0});var f=u(),g=E(),h=u(),i=V(),j=O(),l=T(),m=p(),n=k(),o=J(),q=ga(),r="",s="#",t="*",v={},w=function(a){return a[0]===s},x=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},y=function(a,b,c){c=c.slice(0,-1).some(function(a){return!("cond"in a)&&!("in"in a)&&(f.isString(a.target)||f.isMachine(a.target))});b=b===r?"the transient event":"event '"+b+"'";f.warn(!c,"One or more transitions for "+b+" on state '"+a.id+"' are unreachable. Make sure that the default transition is the last one defined.")},z=function(){function k(b,c,g){var h=this;this.config=b;this.context=g;this.order=-1;this.__xstatenode=!0;this.__cache={events:void 0,relativeValue:new Map(),initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0};this.idMap={};this.options=Object.assign(x(),c);this.parent=this.options._parent;this.key=this.config.key||this.options._key||this.config.id||"(machine)";this.machine=this.parent?this.parent.machine:this;this.path=this.parent?this.parent.path.concat(this.key):[];this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:n.STATE_DELIMITER);this.id=this.config.id||d([this.machine.key],this.path).join(this.delimiter);this.version=this.parent?this.parent.version:this.config.version;this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&f.keys(this.config.states).length?"compound":this.config.history?"history":"atomic");m.IS_PRODUCTION||f.warn(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '+(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '"+this.type+"'`")+" in the config for state node '"+this.id+"' instead.");this.initial=this.config.initial;this.states=this.config.states?f.mapValues(this.config.states,function(b,c){b=new k(b,{_parent:h,_key:c});Object.assign(h.idMap,a((c={},c[b.id]=b,c),b.idMap));return b}):v;var i=0;function p(a){var b,c;a.order=i++;try{for(var a=e(o.getChildren(a)),d=a.next();!d.done;d=a.next()){var f=d.value;p(f)}}catch(a){b={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(b)throw b.error}}}p(this);this.history=this.config.history===!0?"shallow":this.config.history||!1;this._transient=this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(a){a=a.event;return a===r}):r in this.config.on:!1;this.strict=!!this.config.strict;this.onEntry=f.toArray(this.config.entry||this.config.onEntry).map(function(a){return l.toActionObject(a)});this.onExit=f.toArray(this.config.exit||this.config.onExit).map(function(a){return l.toActionObject(a)});this.meta=this.config.meta;this.data=this.type==="final"?this.config.data:void 0;this.invoke=f.toArray(this.config.invoke).map(function(b,c){var d;if(f.isMachine(b)){h.machine.options.services=a((d={},d[b.id]=b,d),h.machine.options.services);return{type:j.invoke,src:b.id,id:b.id}}else if(typeof b.src!=="string"){d=h.id+":invocation["+c+"]";h.machine.options.services=a((c={},c[d]=b.src,c),h.machine.options.services);return a(a({type:j.invoke,id:d},b),{src:d})}else return a(a({},b),{type:j.invoke,id:b.id||b.src,src:b.src})});this.activities=f.toArray(this.config.activities).concat(this.invoke).map(function(a){return l.toActivityDefinition(a)});this.transition=this.transition.bind(this)}k.prototype._init=function(){if(this.__cache.transitions)return;o.getAllStateNodes(this).forEach(function(a){return a.on})};k.prototype.withConfig=function(b,c){c===void 0&&(c=this.context);var d=this.options,e=d.actions,f=d.activities,g=d.guards,h=d.services;d=d.delays;return new k(this.config,{actions:a(a({},e),b.actions),activities:a(a({},f),b.activities),guards:a(a({},g),b.guards),services:a(a({},h),b.services),delays:a(a({},d),b.delays)},c)};k.prototype.withContext=function(a){return new k(this.config,this.options,a)};Object.defineProperty(k.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,type:this.type,initial:this.initial,history:this.history,states:f.mapValues(this.states,function(a){return a.definition}),on:this.on,transitions:this.transitions,onEntry:this.onEntry,onExit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.data,invoke:this.invoke}},enumerable:!0,configurable:!0});k.prototype.toJSON=function(){return this.definition};Object.defineProperty(k.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var a=this.transitions;return this.__cache.on=a.reduce(function(a,b){a[b.eventType]=a[b.eventType]||[];a[b.eventType].push(b);return a},{})},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!0,configurable:!0});k.prototype.getCandidates=function(a){if(this.__cache.candidates[a])return this.__cache.candidates[a];var b=a===r,c=this.transitions.filter(function(c){var d=c.eventType===a;return b?d:d||c.eventType===t});this.__cache.candidates[a]=c;return c};k.prototype.getDelayedTransitions=function(){var b=this,c=this.config.after;if(!c)return[];var d=function(a,c){c=f.isFunction(a)?b.id+":delay["+c+"]":a;c=l.after(c,b.id);b.onEntry.push(l.send(c,{delay:a}));b.onExit.push(l.cancel(c));return c},e=f.isArray(c)?c.map(function(b,c){c=d(b.delay,c);return a(a({},b),{event:c})}):f.flatten(f.keys(c).map(function(b,e){var g=c[b];g=f.isString(g)?{target:g}:g;var h=isNaN(+b)?b:+b,i=d(h,e);return f.toArray(g).map(function(b){return a(a({},b),{event:i,delay:h})})}));return e.map(function(c){var d=c.delay;return a(a({},b.formatTransition(c)),{delay:d})})};k.prototype.getStateNodes=function(a){var b,c=this;if(!a)return[];var d=a instanceof i.State?a.value:f.toStateValue(a,this.delimiter);if(f.isString(d)){a=this.getStateNode(d).initial;return a!==void 0?this.getStateNodes((b={},b[d]=a,b)):[this.states[d]]}a=f.keys(d);b=a.map(function(a){return c.getStateNode(a)});return b.concat(a.reduce(function(a,b){b=c.getStateNode(b).getStateNodes(d[b]);return a.concat(b)},[]))};k.prototype.handles=function(a){a=f.getEventType(a);return this.events.includes(a)};k.prototype.resolveState=function(b){var c=Array.from(o.getConfiguration([],this.getStateNodes(b.value)));return new i.State(a(a({},b),{value:this.resolve(b.value),configuration:c}))};k.prototype.transitionLeafNode=function(a,b,c){a=this.getStateNode(a);a=a.next(b,c);return!a||!a.transitions.length?this.next(b,c):a};k.prototype.transitionCompoundNode=function(a,b,c){var d=f.keys(a),e=this.getStateNode(d[0]);e=e._transition(a[d[0]],b,c);return!e||!e.transitions.length?this.next(b,c):e};k.prototype.transitionParallelNode=function(a,b,c){var d,g,h={};try{for(var i=e(f.keys(a)),j=i.next();!j.done;j=i.next()){var k=j.value,l=a[k];if(!l)continue;var m=this.getStateNode(k);m=m._transition(l,b,c);m&&(h[k]=m)}}catch(a){d={error:a}}finally{try{j&&!j.done&&(g=i["return"])&&g.call(i)}finally{if(d)throw d.error}}l=f.keys(h).map(function(a){return h[a]});k=f.flatten(l.map(function(a){return a.transitions}));m=l.some(function(a){return a.transitions.length>0});if(!m)return this.next(b,c);a=f.flatten(l.map(function(a){return a.entrySet}));j=f.flatten(f.keys(h).map(function(a){return h[a].configuration}));return{transitions:k,entrySet:a,exitSet:f.flatten(l.map(function(a){return a.exitSet})),configuration:j,source:b,actions:f.flatten(f.keys(h).map(function(a){return h[a].actions}))}};k.prototype._transition=function(a,b,c){if(f.isString(a))return this.transitionLeafNode(a,b,c);return f.keys(a).length===1?this.transitionCompoundNode(a,b,c):this.transitionParallelNode(a,b,c)};k.prototype.next=function(a,b){var c,g,i=this,j=b.name,k=[],l=[],m;try{for(var n=e(this.getCandidates(j)),o=n.next();!o.done;o=n.next()){var p=o.value,q=p.cond,r=p["in"],s=a.context;r=r?f.isString(r)&&w(r)?a.matches(f.toStateValue(this.getStateNodeById(r).path,this.delimiter)):h.matchesState(f.toStateValue(r,this.delimiter),f.path(this.path.slice(0,-2))(a.value)):!0;var t=!1;try{t=!q||this.evaluateGuard(q,s,b,a)}catch(a){throw new Error("Unable to evaluate guard '"+(q.name||q.type)+"' in transition for event '"+j+"' in state node '"+this.id+"':\n"+a.message)}if(t&&r){p.target!==void 0&&(l=p.target);k.push.apply(k,d(p.actions));m=p;break}}}catch(a){c={error:a}}finally{try{o&&!o.done&&(g=n["return"])&&g.call(n)}finally{if(c)throw c.error}}if(!m)return void 0;if(!l.length)return{transitions:[m],entrySet:[],exitSet:[],configuration:a.value?[this]:[],source:a,actions:k};s=f.flatten(l.map(function(b){return i.getRelativeStateNodes(b,a.historyValue)}));q=!!m.internal;t=q?[]:f.flatten(s.map(function(a){return i.nodesFromChild(a)}));return{transitions:[m],entrySet:t,exitSet:q?[]:[this],configuration:s,source:a,actions:k}};k.prototype.nodesFromChild=function(a){if(a.escapes(this))return[];var b=[];a=a;while(a&&a!==this)b.push(a),a=a.parent;b.push(this);return b};k.prototype.escapes=function(a){if(this===a)return!1;var b=this.parent;while(b){if(b===a)return!1;b=b.parent}return!0};k.prototype.evaluateGuard=function(a,b,c,d){var e=this.machine.options.guards;d={state:d,cond:a,_event:c};if(a.type===n.DEFAULT_GUARD_TYPE)return a.predicate(b,c.data,d);e=e[a.type];if(!e)throw new Error("Guard '"+a.type+"' is not implemented on machine '"+this.machine.id+"'.");return e(b,c.data,d)};k.prototype.getActions=function(a,b,g,h){var i,j,k,m;h=o.getConfiguration([],h?this.getStateNodes(h.value):[this]);var n=a.configuration.length?o.getConfiguration(h,a.configuration):h;try{for(var p=e(n),q=p.next();!q.done;q=p.next()){var r=q.value;o.has(h,r)||a.entrySet.push(r)}}catch(a){i={error:a}}finally{try{q&&!q.done&&(j=p["return"])&&j.call(p)}finally{if(i)throw i.error}}try{for(var q=e(h),p=q.next();!p.done;p=q.next()){var r=p.value;(!o.has(n,r)||o.has(a.exitSet,r.parent))&&a.exitSet.push(r)}}catch(a){k={error:a}}finally{try{p&&!p.done&&(m=q["return"])&&m.call(q)}finally{if(k)throw k.error}}a.source||(a.exitSet=[],a.entrySet.push(this));h=f.flatten(a.entrySet.map(function(c){var d=[];if(c.type!=="final")return d;var e=c.parent;d.push(l.done(c.id,c.data),l.done(e.id,c.data?f.mapContext(c.data,b,g):void 0));if(e.parent){c=e.parent;c.type==="parallel"&&(o.getChildren(c).every(function(b){return o.isInFinalState(a.configuration,b)})&&d.push(l.done(c.id,c.data)))}return d}));a.exitSet.sort(function(a,b){return b.order-a.order});a.entrySet.sort(function(a,b){return a.order-b.order});n=new Set(a.entrySet);r=new Set(a.exitSet);p=c([f.flatten(Array.from(n).map(function(a){return d(a.activities.map(function(a){return l.start(a)}),a.onEntry)})).concat(h.map(l.raise)),f.flatten(Array.from(r).map(function(a){return d(a.onExit,a.activities.map(function(a){return l.stop(a)}))}))],2);q=p[0];n=p[1];h=l.toActionObjects(n.concat(a.actions).concat(q),this.machine.options.actions);return h};k.prototype.transition=function(a,b,c){a===void 0&&(a=this.initialState);b=f.toSCXMLEvent(b);var e;if(a instanceof i.State)e=c===void 0?a:this.resolveState(i.State.from(a,c));else{a=f.isString(a)?this.resolve(f.pathToStateValue(this.getResolvedPath(a))):this.resolve(a);c=c?c:this.machine.context;e=this.resolveState(i.State.from(a,c))}if(!m.IS_PRODUCTION&&b.name===t)throw new Error("An event cannot have the wildcard type ('"+t+"')");if(this.strict&&(!this.events.includes(b.name)&&!f.isBuiltInEvent(b.name)))throw new Error("Machine '"+this.id+"' does not accept event '"+b.name+"'");a=this._transition(e.value,e,b)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:e,actions:[]};c=o.getConfiguration([],this.getStateNodes(e.value));c=a.configuration.length?o.getConfiguration(c,a.configuration):c;a.configuration=d(c);return this.resolveTransition(a,e,b)};k.prototype.resolveRaisedTransition=function(a,b,c){var e=a.actions;a=this.transition(a,b);a._event=c;a.event=c.data;(b=a.actions).unshift.apply(b,d(e));return a};k.prototype.resolveTransition=function(b,d,h,k){var n,p,r=this;h===void 0&&(h=l.initEvent);k===void 0&&(k=this.machine.context);var s=b.configuration,t=!d||b.transitions.length>0;t=t?o.getValue(this.machine,s):void 0;var u=d?d.historyValue?d.historyValue:b.source?this.machine.historyValue(d.value):void 0:void 0;k=d?d.context:k;var v=this.getActions(b,k,h,d),w=d?a({},d.activities):{};try{for(var x=e(v),y=x.next();!y.done;y=x.next()){var z=y.value;z.type===j.start?w[z.activity.type]=z:z.type===j.stop&&(w[z.activity.type]=!1)}}catch(a){n={error:a}}finally{try{y&&!y.done&&(p=x["return"])&&p.call(x)}finally{if(n)throw n.error}}z=c(f.partition(v,function(a){return a.type===j.assign}),2);y=z[0];x=z[1];var A=y.length?f.updateContext(k,h,y,d):k;v=f.flatten(x.map(function(a){switch(a.type){case j.raise:return l.resolveRaise(a);case j.send:var b=l.resolveSend(a,A,h,r.machine.options.delays);m.IS_PRODUCTION||f.warn(!f.isString(a.delay)||typeof b.delay==="number","No delay reference for delay expression '"+a.delay+"' was found on machine '"+r.machine.id+"'");return b;case j.log:return l.resolveLog(a,A,h);case j.pure:return a.get(A,h.data)||[];default:return l.toActionObject(a,r.options.actions)}}));z=c(f.partition(v,function(a){return a.type===j.raise||a.type===j.send&&a.to===g.SpecialTargets.Internal}),2);k=z[0];x=z[1];z=v.filter(function(a){return a.type===j.start&&a.activity.type===j.invoke});v=z.reduce(function(b,a){b[a.activity.id]=q.createInvocableActor(a.activity);return b},d?a({},d.children):{});z=t?b.configuration:d?d.configuration:[];var B=z.reduce(function(a,b){b.meta!==void 0&&(a[b.id]=b.meta);return a},{}),C=o.isInFinalState(z,this);u=new i.State({value:t||d.value,context:A,_event:h,_sessionid:d?d._sessionid:null,historyValue:t?u?f.updateHistoryValue(u,t):void 0:d?d.historyValue:void 0,history:!t||b.source?d:void 0,actions:t?x:[],activities:t?w:d?d.activities:{},meta:t?B:d?d.meta:void 0,events:[],configuration:z,transitions:b.transitions,children:v,done:C});u.changed=h.name===j.update||!!y.length;x=u.history;x&&delete x.history;if(!t)return u;w=u;if(!C){B=this._transient||s.some(function(a){return a._transient});B&&(w=this.resolveRaisedTransition(w,{type:j.nullEvent},h));while(k.length){d=k.shift();w=this.resolveRaisedTransition(w,d._event,h)}}z=w.changed||(x?!!w.actions.length||!!y.length||typeof x.value!==typeof w.value||!i.stateValuesEqual(w.value,x.value):void 0);w.changed=z;w.historyValue=u.historyValue;w.history=x;return w};k.prototype.getStateNode=function(a){if(w(a))return this.machine.getStateNodeById(a);if(!this.states)throw new Error("Unable to retrieve child state '"+a+"' from '"+this.id+"'; no child states exist.");var b=this.states[a];if(!b)throw new Error("Child state '"+a+"' does not exist on '"+this.id+"'");return b};k.prototype.getStateNodeById=function(a){a=w(a)?a.slice(s.length):a;if(a===this.id)return this;var b=this.machine.idMap[a];if(!b)throw new Error("Child state node '#"+a+"' does not exist on machine '"+this.id+"'");return b};k.prototype.getStateNodeByPath=function(a){if(typeof a==="string"&&w(a))try{return this.getStateNodeById(a.slice(1))}catch(a){}a=f.toStatePath(a,this.delimiter).slice();var b=this;while(a.length){var c=a.shift();if(!c.length)break;b=b.getStateNode(c)}return b};k.prototype.resolve=function(a){var b,c=this;if(!a)return this.initialStateValue||v;switch(this.type){case"parallel":return f.mapValues(this.initialStateValue,function(b,d){return b?c.getStateNode(d).resolve(a[d]||b):v});case"compound":if(f.isString(a)){var d=this.getStateNode(a);return d.type==="parallel"||d.type==="compound"?(b={},b[a]=d.initialStateValue,b):a}return!f.keys(a).length?this.initialStateValue||{}:f.mapValues(a,function(a,b){return a?c.getStateNode(b).resolve(a):v});default:return a||v}};k.prototype.getResolvedPath=function(a){if(w(a)){var b=this.machine.idMap[a.slice(s.length)];if(!b)throw new Error("Unable to find state node '"+a+"'");return b.path}return f.toStatePath(a,this.delimiter)};Object.defineProperty(k.prototype,"initialStateValue",{get:function(){var a;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var b;if(this.type==="parallel")b=f.mapFilterValues(this.states,function(a){return a.initialStateValue||v},function(a){return!(a.type==="history")});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '"+this.initial+"' not found on '"+this.key+"'");b=o.isLeafNode(this.states[this.initial])?this.initial:(a={},a[this.initial]=this.states[this.initial].initialStateValue,a)}this.__cache.initialStateValue=b;return this.__cache.initialStateValue},enumerable:!0,configurable:!0});k.prototype.getInitialState=function(a,b){a=this.getStateNodes(a);return this.resolveTransition({configuration:a,entrySet:a,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,void 0,b)};Object.defineProperty(k.prototype,"initialState",{get:function(){this._init();var a=this.initialStateValue;if(!a)throw new Error("Cannot retrieve initial state from simple state '"+this.id+"'.");return this.getInitialState(a)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"target",{get:function(){var a;if(this.type==="history"){var b=this.config;f.isString(b.target)?a=w(b.target)?f.pathToStateValue(this.machine.getStateNodeById(b.target).path.slice(this.path.length-1)):b.target:a=b.target}return a},enumerable:!0,configurable:!0});k.prototype.getRelativeStateNodes=function(a,b,c){c===void 0&&(c=!0);return c?a.type==="history"?a.resolveHistory(b):a.initialStateNodes:[a]};Object.defineProperty(k.prototype,"initialStateNodes",{get:function(){var a=this;if(o.isLeafNode(this))return[this];if(this.type==="compound"&&!this.initial){m.IS_PRODUCTION||f.warn(!1,"Compound state node '"+this.id+"' has no initial state.");return[this]}var b=f.toStatePaths(this.initialStateValue);return f.flatten(b.map(function(b){return a.getFromRelativePath(b)}))},enumerable:!0,configurable:!0});k.prototype.getFromRelativePath=function(a){if(!a.length)return[this];a=c(a);var b=a[0];a=a.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '"+b+"' from node with no states");var d=this.getStateNode(b);if(d.type==="history")return d.resolveHistory();if(!this.states[b])throw new Error("Child state '"+b+"' does not exist on '"+this.id+"'");return this.states[b].getFromRelativePath(a)};k.prototype.historyValue=function(a){return!f.keys(this.states).length?void 0:{current:a||this.initialStateValue,states:f.mapFilterValues(this.states,function(b,c){if(!a)return b.historyValue();c=f.isString(a)?void 0:a[c];return b.historyValue(c||b.initialStateValue)},function(a){return!a.history})}};k.prototype.resolveHistory=function(a){var b=this;if(this.type!=="history")return[this];var c=this.parent;if(!a){var d=this.target;return d?f.flatten(f.toStatePaths(d).map(function(a){return c.getFromRelativePath(a)})):c.initialStateNodes}d=f.nestedPath(c.path,"states")(a).current;return f.isString(d)?[c.getStateNode(d)]:f.flatten(f.toStatePaths(d).map(function(a){return b.history==="deep"?c.getFromRelativePath(a):[c.states[a[0]]]}))};Object.defineProperty(k.prototype,"stateIds",{get:function(){var a=this,b=f.flatten(f.keys(this.states).map(function(b){return a.states[b].stateIds}));return[this.id].concat(b)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"events",{get:function(){var a,b,c,d;if(this.__cache.events)return this.__cache.events;var g=this.states,h=new Set(this.ownEvents);if(g)try{for(var i=e(f.keys(g)),j=i.next();!j.done;j=i.next()){var k=j.value;k=g[k];if(k.states)try{for(var k=(c=void 0,e(k.events)),l=k.next();!l.done;l=k.next()){var m=l.value;h.add(""+m)}}catch(a){c={error:a}}finally{try{l&&!l.done&&(d=k["return"])&&d.call(k)}finally{if(c)throw c.error}}}}catch(b){a={error:b}}finally{try{j&&!j.done&&(b=i["return"])&&b.call(i)}finally{if(a)throw a.error}}return this.__cache.events=Array.from(h)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"ownEvents",{get:function(){var a=new Set(this.transitions.filter(function(a){return!(!a.target&&!a.actions.length&&a.internal)}).map(function(a){return a.eventType}));return Array.from(a)},enumerable:!0,configurable:!0});k.prototype.resolveTarget=function(a){var b=this;return a===void 0?void 0:a.map(function(a){if(!f.isString(a))return a;var c=a[0]===b.delimiter;if(c&&!b.parent)return b.getStateNodeByPath(a.slice(1));c=c?b.key+a:a;if(b.parent)try{a=b.parent.getStateNodeByPath(c);return a}catch(a){throw new Error("Invalid transition definition for state node '"+b.id+"':\n"+a.message)}else return b.getStateNodeByPath(c)})};k.prototype.formatTransition=function(b){var c=this,d=f.normalizeTarget(b.target),e="internal"in b?b.internal:d?d.some(function(a){return f.isString(a)&&a[0]===c.delimiter}):!0,g=this.machine.options.guards;d=this.resolveTarget(d);return a(a({},b),{actions:l.toActionObjects(f.toArray(b.actions)),cond:f.toGuard(b.cond,g),target:d,source:this,internal:e,eventType:b.event})};k.prototype.formatTransitions=function(){var a,c,g=this,h;if(!this.config.on)h=[];else if(Array.isArray(this.config.on))h=this.config.on;else{var i=this.config.on,j=t,k=i[j];k=k===void 0?[]:k;var n=b(i,[typeof j==="symbol"?j:j+""]);h=f.flatten(f.keys(n).map(function(a){var b=f.toTransitionConfigArray(a,n[a]);m.IS_PRODUCTION||y(g,a,b);return b}).concat(f.toTransitionConfigArray(t,k)))}i=this.config.onDone?f.toTransitionConfigArray(String(l.done(this.id)),this.config.onDone):[];j=f.flatten(this.invoke.map(function(a){var b=[];a.onDone&&b.push.apply(b,d(f.toTransitionConfigArray(String(l.doneInvoke(a.id)),a.onDone)));a.onError&&b.push.apply(b,d(f.toTransitionConfigArray(String(l.error(a.id)),a.onError)));return b}));k=this.after;i=f.flatten(d(i,j,h).map(function(a){return f.toArray(a).map(function(a){return g.formatTransition(a)})}));try{for(var j=e(k),h=j.next();!h.done;h=j.next()){k=h.value;i.push(k)}}catch(b){a={error:b}}finally{try{h&&!h.done&&(c=j["return"])&&c.call(j)}finally{if(a)throw a.error}}return i};return k}();X.StateNode=z}var ja=!1;function ka(){ja||(ja=!0,ia());return ha.exports}var Y={},la={exports:Y};function ma(){Object.defineProperty(Y,"__esModule",{value:!0});var a=ka();function b(b,c,d){d===void 0&&(d=b.context);d=typeof d==="function"?d():d;return new a.StateNode(b,c,d)}Y.Machine=b;function c(b,c){var d=typeof b.context==="function"?b.context():b.context;return new a.StateNode(b,c,d)}Y.createMachine=c}var na=!1;function oa(){na||(na=!0,ma());return la.exports}var pa={},qa={exports:pa};function ra(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)};Object.defineProperty(pa,"__esModule",{value:!0});var b={deferEvents:!1},c=function(){function c(c){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=a(a({},b),c)}c.prototype.initialize=function(a){this.initialized=!0;if(a){if(!this.options.deferEvents){this.schedule(a);return}this.process(a)}this.flushEvents()};c.prototype.schedule=function(a){if(!this.initialized||this.processingEvent){this.queue.push(a);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(a);this.flushEvents()};c.prototype.clear=function(){this.queue=[]};c.prototype.flushEvents=function(){var a=this.queue.shift();while(a)this.process(a),a=this.queue.shift()};c.prototype.process=function(a){this.processingEvent=!0;try{a()}catch(a){this.clear();throw a}finally{this.processingEvent=!1}};return c}();pa.Scheduler=c}var sa=!1;function ta(){sa||(sa=!0,ra());return qa.exports}var ua={},va={exports:ua};function wa(){Object.defineProperty(ua,"__esModule",{value:!0});var a=new Map(),b=0;ua.registry={bookId:function(){return"x:"+b++},register:function(b,c){a.set(b,c);return b},get:function(b){return a.get(b)},free:function(b){a["delete"](b)}}}var xa=!1;function ya(){xa||(xa=!0,wa());return va.exports}var za={},Aa={exports:za};function Ba(){Object.defineProperty(za,"__esModule",{value:!0});var a=p();function b(){var a=window;return a.__xstate__?a.__xstate__:void 0}function c(c){if(a.IS_PRODUCTION||typeof window==="undefined")return;var d=b();d&&d.register(c)}za.registerService=c}var Ca=!1;function Da(){Ca||(Ca=!0,Ba());return Aa.exports}var Z={},Ea={exports:Z};function Fa(){var b=this&&this.__assign||function(){b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return b.apply(this,arguments)},c=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},d=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},e=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(d(arguments[b]));return a};Object.defineProperty(Z,"__esModule",{value:!0});var f=E(),g=V(),h=O(),i=T(),j=p(),k=u(),l=ta(),m=ga(),n=J(),o=ya(),q=Da(),r={sync:!1,autoForward:!1},s=function(){var a=[];return function(b,c){b&&a.push(b);c=c(b||a[a.length-1]);b&&a.pop();return c}}(),t;(function(a){a[a.NotStarted=0]="NotStarted",a[a.Running=1]="Running",a[a.Stopped=2]="Stopped"})(t||(t={}));var v=function(){function d(a,c){var e=this;c===void 0&&(c=d.defaultOptions);this.machine=a;this.scheduler=new l.Scheduler();this.delayedEventsMap={};this.listeners=new Set();this.contextListeners=new Set();this.stopListeners=new Set();this.doneListeners=new Set();this.eventListeners=new Set();this.sendListeners=new Set();this.initialized=!1;this._status=t.NotStarted;this.children=new Map();this.forwardTo=new Set();this.init=this.start;this.send=function(a,b){if(k.isArray(a)){e.batch(a);return e.state}var c=k.toSCXMLEvent(k.toEventObject(a,b));if(e._status===t.Stopped){j.IS_PRODUCTION||k.warn(!1,'Event "'+c.name+'" was sent to stopped service "'+e.machine.id+'". This service has already reached its final state, and will not transition.\nEvent: '+JSON.stringify(c.data));return e.state}if(e._status===t.NotStarted&&e.options.deferEvents)j.IS_PRODUCTION||k.warn(!1,'Event "'+c.name+'" was sent to uninitialized service "'+e.machine.id+'" and is deferred. Make sure .start() is called for this service.\nEvent: '+JSON.stringify(c.data));else if(e._status!==t.Running)throw new Error('Event "'+c.name+'" was sent to uninitialized service "'+e.machine.id+'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: '+JSON.stringify(c.data));e.scheduler.schedule(function(){e.forward(c);var a=e.nextState(c);e.update(a,c)});return e._state};this.sendTo=function(a,c){var d=e.parent&&(c===f.SpecialTargets.Parent||e.parent.id===c),g=d?e.parent:m.isActor(c)?c:e.children.get(c)||o.registry.get(c);if(!g){if(!d)throw new Error("Unable to send event to child '"+c+"' from service '"+e.id+"'.");j.IS_PRODUCTION||k.warn(!1,"Service '"+e.id+"' has no parent: unable to send event "+a.type);return}"machine"in g?g.send(b(b({},a),{name:a.name===h.error?""+i.error(e.id):a.name,origin:e.sessionId})):g.send(a.data)};c=b(b({},d.defaultOptions),c);var g=c.clock,n=c.logger,p=c.parent,q=c.id;q=q!==void 0?q:a.id;this.id=q;this.logger=n;this.clock=g;this.parent=p;this.options=c;this.scheduler=new l.Scheduler({deferEvents:this.options.deferEvents});this.sessionId=o.registry.bookId()}Object.defineProperty(d.prototype,"initialState",{get:function(){var a=this;return this._initialState?this._initialState:s(this,function(){a._initialState=a.machine.initialState;return a._initialState})},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"state",{get:function(){j.IS_PRODUCTION||k.warn(this._status!==t.NotStarted,"Attempted to read state from uninitialized service '"+this.id+"'. Make sure the service is started first.");return this._state},enumerable:!0,configurable:!0});d.prototype.execute=function(a,b){var d,e;try{for(var f=c(a.actions),g=f.next();!g.done;g=f.next()){var h=g.value;this.exec(h,a,b)}}catch(a){d={error:a}}finally{try{g&&!g.done&&(e=f["return"])&&e.call(f)}finally{if(d)throw d.error}}};d.prototype.update=function(a,b){var d,e,f,g,h,j,l,m,o=this;a._sessionid=this.sessionId;this._state=a;this.options.execute&&this.execute(this.state);this.devTools&&this.devTools.send(b.data,a);if(a.event)try{for(var p=c(this.eventListeners),q=p.next();!q.done;q=p.next()){var r=q.value;r(a.event)}}catch(a){d={error:a}}finally{try{q&&!q.done&&(e=p["return"])&&e.call(p)}finally{if(d)throw d.error}}try{for(var q=c(this.listeners),p=q.next();!p.done;p=q.next()){var r=p.value;r(a,a.event)}}catch(a){f={error:a}}finally{try{p&&!p.done&&(g=q["return"])&&g.call(q)}finally{if(f)throw f.error}}try{for(var p=c(this.contextListeners),q=p.next();!q.done;q=p.next()){var s=q.value;s(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(a){h={error:a}}finally{try{q&&!q.done&&(j=p["return"])&&j.call(p)}finally{if(h)throw h.error}}s=n.isInFinalState(a.configuration||[],this.machine);if(this.state.configuration&&s){q=a.configuration.find(function(a){return a.type==="final"&&a.parent===o.machine});p=q&&q.data?k.mapContext(q.data,a.context,b):void 0;try{for(var s=c(this.doneListeners),q=s.next();!q.done;q=s.next()){var r=q.value;r(i.doneInvoke(this.id,p))}}catch(a){l={error:a}}finally{try{q&&!q.done&&(m=s["return"])&&m.call(s)}finally{if(l)throw l.error}}this.stop()}};d.prototype.onTransition=function(a){this.listeners.add(a);this._status===t.Running&&a(this.state,this.state.event);return this};d.prototype.subscribe=function(a,b,c){var d=this;if(!a)return{unsubscribe:function(){return void 0}};var e,f=c;typeof a==="function"?e=a:(e=a.next.bind(a),f=a.complete.bind(a));this.listeners.add(e);this._status===t.Running&&e(this.state);f&&this.onDone(f);return{unsubscribe:function(){e&&d.listeners["delete"](e),f&&d.doneListeners["delete"](f)}}};d.prototype.onEvent=function(a){this.eventListeners.add(a);return this};d.prototype.onSend=function(a){this.sendListeners.add(a);return this};d.prototype.onChange=function(a){this.contextListeners.add(a);return this};d.prototype.onStop=function(a){this.stopListeners.add(a);return this};d.prototype.onDone=function(a){this.doneListeners.add(a);return this};d.prototype.off=function(a){this.listeners["delete"](a);this.eventListeners["delete"](a);this.sendListeners["delete"](a);this.stopListeners["delete"](a);this.doneListeners["delete"](a);this.contextListeners["delete"](a);return this};d.prototype.start=function(a){var b=this;if(this._status===t.Running)return this;o.registry.register(this.sessionId,this);this.initialized=!0;this._status=t.Running;var c=a===void 0?this.initialState:s(this,function(){return g.isState(a)?b.machine.resolveState(a):b.machine.resolveState(g.State.from(a,b.machine.context))});this.options.devTools&&this.attachDev();this.scheduler.initialize(function(){b.update(c,i.initEvent)});return this};d.prototype.stop=function(){var a,b,d,e,f,g,h,i,j,l;try{for(var m=c(this.listeners),n=m.next();!n.done;n=m.next()){var p=n.value;this.listeners["delete"](p)}}catch(b){a={error:b}}finally{try{n&&!n.done&&(b=m["return"])&&b.call(m)}finally{if(a)throw a.error}}try{for(var n=c(this.stopListeners),m=n.next();!m.done;m=n.next()){var p=m.value;p();this.stopListeners["delete"](p)}}catch(a){d={error:a}}finally{try{m&&!m.done&&(e=n["return"])&&e.call(n)}finally{if(d)throw d.error}}try{for(var m=c(this.contextListeners),n=m.next();!n.done;n=m.next()){var p=n.value;this.contextListeners["delete"](p)}}catch(a){f={error:a}}finally{try{n&&!n.done&&(g=m["return"])&&g.call(m)}finally{if(f)throw f.error}}try{for(var n=c(this.doneListeners),m=n.next();!m.done;m=n.next()){var p=m.value;this.doneListeners["delete"](p)}}catch(a){h={error:a}}finally{try{m&&!m.done&&(i=n["return"])&&i.call(n)}finally{if(h)throw h.error}}this.children.forEach(function(a){k.isFunction(a.stop)&&a.stop()});try{for(var p=c(k.keys(this.delayedEventsMap)),m=p.next();!m.done;m=p.next()){n=m.value;this.clock.clearTimeout(this.delayedEventsMap[n])}}catch(a){j={error:a}}finally{try{m&&!m.done&&(l=p["return"])&&l.call(p)}finally{if(j)throw j.error}}this.scheduler.clear();this.initialized=!1;this._status=t.Stopped;o.registry.free(this.sessionId);return this};d.prototype.batch=function(a){var b=this;if(this._status===t.NotStarted&&this.options.deferEvents)j.IS_PRODUCTION||k.warn(!1,a.length+' event(s) were sent to uninitialized service "'+this.machine.id+'" and are deferred. Make sure .start() is called for this service.\nEvent: '+JSON.stringify(event));else if(this._status!==t.Running)throw new Error(a.length+' event(s) were sent to uninitialized service "'+this.machine.id+'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.');this.scheduler.schedule(function(){var d,f,h=b.state,i=!1,j=[],l=function(a){var c=k.toSCXMLEvent(a);b.forward(c);h=s(b,function(){return b.machine.transition(h,c)});j.push.apply(j,e(h.actions.map(function(a){return g.bindActionToState(a,h)})));i=i||!!h.changed};try{for(var m=c(a),n=m.next();!n.done;n=m.next()){var o=n.value;l(o)}}catch(a){d={error:a}}finally{try{n&&!n.done&&(f=m["return"])&&f.call(m)}finally{if(d)throw d.error}}h.changed=i;h.actions=j;b.update(h,k.toSCXMLEvent(a[a.length-1]))})};d.prototype.sender=function(a){return this.send.bind(this,a)};d.prototype.nextState=function(a){var b=this,c=k.toSCXMLEvent(a);if(c.name.indexOf(h.errorPlatform)===0&&!this.state.nextEvents.some(function(a){return a.indexOf(h.errorPlatform)===0}))throw c.data.data;a=s(this,function(){return b.machine.transition(b.state,c)});return a};d.prototype.forward=function(a){var b,d;try{for(var e=c(this.forwardTo),f=e.next();!f.done;f=e.next()){var g=f.value,h=this.children.get(g);if(!h)throw new Error("Unable to forward event '"+a+"' from interpreter '"+this.id+"' to nonexistant child '"+g+"'.");h.send(a)}}catch(a){b={error:a}}finally{try{f&&!f.done&&(d=e["return"])&&d.call(e)}finally{if(b)throw b.error}}};d.prototype.defer=function(a){var b=this;this.delayedEventsMap[a.id]=this.clock.setTimeout(function(){a.to?b.sendTo(a._event,a.to):b.send(a._event)},a.delay)};d.prototype.cancel=function(a){this.clock.clearTimeout(this.delayedEventsMap[a]),delete this.delayedEventsMap[a]};d.prototype.exec=function(a,b,c){var d=b.context;b=b._event;c=i.getActionFunction(a.type,c)||a.exec;c=k.isFunction(c)?c:c?c.exec:a.exec;if(c)try{return c(d,b.data,{action:a,state:this.state,_event:b})}catch(a){this.parent&&this.parent.send({type:"xstate.error",data:a});throw a}switch(a.type){case h.send:c=a;if(typeof c.delay==="number"){this.defer(c);return}else c.to?this.sendTo(c._event,c.to):this.send(c._event);break;case h.cancel:this.cancel(a.sendId);break;case h.start:c=a.activity;if(!this.state.activities[c.type])break;if(c.type===f.ActionTypes.Invoke){var e=this.machine.options.services?this.machine.options.services[c.src]:void 0,g=c.id,l=c.data;j.IS_PRODUCTION||k.warn(!("forward"in c),"`forward` property is deprecated (found in invocation of '"+c.src+"' in in machine '"+this.machine.id+"'). Please use `autoForward` instead.");var m="autoForward"in c?c.autoForward:!!c.forward;if(!e){j.IS_PRODUCTION||k.warn(!1,"No service found for invocation '"+c.src+"' in machine '"+this.machine.id+"'.");return}e=k.isFunction(e)?e(d,b.data):e;k.isPromiseLike(e)?this.state.children[g]=this.spawnPromise(Promise.resolve(e),g):k.isFunction(e)?this.state.children[g]=this.spawnCallback(e,g):k.isObservable(e)?this.state.children[g]=this.spawnObservable(e,g):k.isMachine(e)&&(this.state.children[g]=this.spawnMachine(l?e.withContext(k.mapContext(l,d,b)):e,{id:g,autoForward:m}))}else this.spawnActivity(c);break;case h.stop:this.stopChild(a.activity.id);break;case h.log:l=a.label;d=a.value;l?this.logger(l,d):this.logger(d);break;default:j.IS_PRODUCTION||k.warn(!1,"No implementation found for action type '"+a.type+"'");break}return void 0};d.prototype.stopChild=function(a){var b=this.children.get(a);if(!b)return;this.children["delete"](a);this.forwardTo["delete"](a);delete this.state.children[a];k.isFunction(b.stop)&&b.stop()};d.prototype.spawn=function(a,c,d){if(k.isPromiseLike(a))return this.spawnPromise(Promise.resolve(a),c);else if(k.isFunction(a))return this.spawnCallback(a,c);else if(m.isActor(a))return this.spawnActor(a);else if(k.isObservable(a))return this.spawnObservable(a,c);else if(k.isMachine(a))return this.spawnMachine(a,b(b({},d),{id:c}));else throw new Error('Unable to spawn entity "'+c+'" of type "'+typeof a+'".')};d.prototype.spawnMachine=function(a,c){var e=this;c===void 0&&(c={});var f=new d(a,b(b({},this.options),{parent:this,id:c.id||a.id}));a=b(b({},r),c);a.sync&&f.onTransition(function(a){e.send(h.update,{state:a,id:f.id})});f.onDone(function(a){e.send(k.toSCXMLEvent(a,{origin:f.id}))}).start();c=f;this.children.set(f.id,c);a.autoForward&&this.forwardTo.add(f.id);return c};d.prototype.spawnPromise=function(a,b){var c=this,d=!1;a.then(function(a){d||c.send(k.toSCXMLEvent(i.doneInvoke(b,a),{origin:b}))},function(a){if(!d){var e=i.error(b,a);try{c.send(k.toSCXMLEvent(e,{origin:b}))}catch(d){k.reportUnhandledExceptionOnInvocation(a,d,b),c.devTools&&c.devTools.send(e,c.state),c.machine.strict&&c.stop()}}});var e={id:b,send:function(){return void 0},subscribe:function(b,c,d){var e=!1;a.then(function(a){if(e)return;b&&b(a);if(e)return;d&&d()},function(a){if(e)return;c(a)});return{unsubscribe:function(){return e=!0}}},stop:function(){d=!0},toJSON:function(){return{id:b}}};this.children.set(b,e);return e};d.prototype.spawnCallback=function(a,b){var c=this,d=!1,e=new Set(),f=new Set(),g=function(a){f.forEach(function(b){return b(a)});if(d)return;c.send(a)},h;try{h=a(g,function(a){e.add(a)})}catch(a){this.send(i.error(b,a))}if(k.isPromiseLike(h))return this.spawnPromise(h,b);a={id:b,send:function(a){return e.forEach(function(b){return b(a)})},subscribe:function(a){f.add(a);return{unsubscribe:function(){f["delete"](a)}}},stop:function(){d=!0,k.isFunction(h)&&h()},toJSON:function(){return{id:b}}};this.children.set(b,a);return a};d.prototype.spawnObservable=function(a,b){var c=this,d=a.subscribe(function(a){c.send(k.toSCXMLEvent(a,{origin:b}))},function(a){c.send(k.toSCXMLEvent(i.error(b,a),{origin:b}))},function(){c.send(k.toSCXMLEvent(i.doneInvoke(b),{origin:b}))}),e={id:b,send:function(){return void 0},subscribe:function(b,c,d){return a.subscribe(b,c,d)},stop:function(){return d.unsubscribe()},toJSON:function(){return{id:b}}};this.children.set(b,e);return e};d.prototype.spawnActor=function(a){this.children.set(a.id,a);return a};d.prototype.spawnActivity=function(a){var b=this.machine.options&&this.machine.options.activities?this.machine.options.activities[a.type]:void 0;if(!b){j.IS_PRODUCTION||k.warn(!1,"No implementation found for activity '"+a.type+"'");return}b=b(this.state.context,a);this.spawnEffect(a.id,b)};d.prototype.spawnEffect=function(a,b){this.children.set(a,{id:a,send:function(){return void 0},subscribe:function(){return{unsubscribe:function(){return void 0}}},stop:b||void 0,toJSON:function(){return{id:a}}})};d.prototype.attachDev=function(){if(this.options.devTools&&typeof window!=="undefined"){if(window.__REDUX_DEVTOOLS_EXTENSION__){var a=typeof this.options.devTools==="object"?this.options.devTools:void 0;this.devTools=window.__REDUX_DEVTOOLS_EXTENSION__.connect(b(b({name:this.id,autoPause:!0,stateSanitizer:function(a){return{value:a.value,context:a.context,actions:a.actions}}},a),{features:b({jump:!1,skip:!1},a?a.features:void 0)}),this.machine);this.devTools.init(this.state)}q.registerService(this)}};d.prototype.toJSON=function(){return{id:this.id}};d.prototype[k.symbolObservable]=function(){return this};d.defaultOptions=function(b){return{execute:!0,deferEvents:!0,clock:{setTimeout:function(a,c){return b.setTimeout.call(null,a,c)},clearTimeout:function(a){return b.clearTimeout.call(null,a)}},logger:b.console.log.bind(console),devTools:!1}}(typeof window==="undefined"?a:window);d.interpret=z;return d}();Z.Interpreter=v;var w=function(a){a===void 0&&(a="null");return{id:a,send:function(){return void 0},subscribe:function(){return{unsubscribe:function(){}}},toJSON:function(){return{id:a}}}},x=function(a){return k.isString(a)?b(b({},r),{name:a}):b(b(b({},r),{name:k.uniqueId()}),a)};function y(a,b){var c=x(b);return s(void 0,function(b){j.IS_PRODUCTION||k.warn(!!b,'Attempted to spawn an Actor (ID: "'+(k.isMachine(a)?a.id:"undefined")+'") outside of a service. This will have no effect.');if(b)return b.spawn(a,c.name,c);else return w(c.name)})}Z.spawn=y;function z(a,b){a=new v(a,b);return a}Z.interpret=z}var Ga=!1;function Ha(){Ga||(Ga=!0,Fa());return Ea.exports}var Ia={},Ja={exports:Ia};function Ka(){var a=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},b=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e};Object.defineProperty(Ia,"__esModule",{value:!0});var c=V();function d(d,e,f){var g,h;d=c.State.from(d,d instanceof c.State?d.context:void 0);try{for(var e=a(e),i=e.next();!i.done;i=e.next()){var j=b(i.value,2),k=j[0];j=j[1];if(d.matches(k))return j(d)}}catch(a){g={error:a}}finally{try{i&&!i.done&&(h=e["return"])&&h.call(e)}finally{if(g)throw g.error}}return f(d)}Ia.matchState=d}var La=!1;function Ma(){La||(La=!0,Ka());return Ja.exports}var $={},Na={exports:$};function Oa(){function a(a){for(var b in a)$.hasOwnProperty(b)||($[b]=a[b])}Object.defineProperty($,"__esModule",{value:!0});var b=u();$.matchesState=b.matchesState;b=z();$.mapState=b.mapState;b=ka();$.StateNode=b.StateNode;b=V();$.State=b.State;b=oa();$.Machine=b.Machine;$.createMachine=b.createMachine;b=T();$.send=b.send;$.sendParent=b.sendParent;$.sendUpdate=b.sendUpdate;$.assign=b.assign;$.doneInvoke=b.doneInvoke;$.forwardTo=b.forwardTo;var c=Ha();$.interpret=c.interpret;$.Interpreter=c.Interpreter;$.spawn=c.spawn;c=Ma();$.matchState=c.matchState;c={raise:b.raise,send:b.send,sendParent:b.sendParent,sendUpdate:b.sendUpdate,log:b.log,cancel:b.cancel,start:b.start,stop:b.stop,assign:b.assign,after:b.after,done:b.done,respond:b.respond,forwardTo:b.forwardTo,escalate:b.escalate};$.actions=c;a(E())}var Pa=!1;function Qa(){Pa||(Pa=!0,Oa());return Na.exports}function b(a){switch(a){case void 0:return Qa();case"/lib/utils":return u()}}e.exports=b},null);
__d("xstate",["xstate-4.7.7"],function(a,b,c,d,e,f){e.exports=b("xstate-4.7.7")()},null);
__d("ZenonDeferrableStateMachine",["xstate"],function(a,b,c,d,e,f){"use strict";var g=b("xstate").interpret;a={interpret:function(a){var b=[],c=g(a.withConfig({actions:{defer:function(a,c){b.push(c)}}})).onTransition(function(a){if(a.value!==((a=a.history)==null?void 0:a.value)){a=b;b=[];while(a.length>0)c.send(a.shift())}}).start();return c}};e.exports=a},null);
__d("ZenonConnectionStateMachine",["ZenonConnectionInitState","ZenonConnectionPeerConnectionRestartingState","ZenonConnectionSdpNegotiatedState","ZenonConnectionSdpSetState","ZenonConnectionSharedActions","ZenonConnectionSMGuards","ZenonDebugLogger","ZenonDeferrableStateMachine","immutable","xstate"],function(a,b,c,d,e,f){"use strict";var g,h,i,j="ConnectionStateMachine";a=function(){function a(a,c){var d=this;c===void 0&&(c="init");c=babelHelpers["extends"]({},G,{context:babelHelpers["extends"]({activePeerConnection:"primary",currentVideoSubscriptions:null,dataMessageSubscriptions:b("immutable").Map({})},a),initial:c});a.peerConnectionManager.registerTrackListener(function(){var a=d.$1.state.context,b=a.currentVideoSubscriptions;a=a.getConnectionModel;if(b){var c=b.request;b=b.userToCnameMap;a=a();var e=a.getUserToTracksMap();a=a.getTracks();for(var b=b,f=Array.isArray(b),g=0,b=f?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=b.length)break;h=b[g++]}else{g=b.next();if(g.done)break;h=g.value}h=h;var i=h[0];h=h[1];i=e.get(i);if(i)for(var i=i,j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{k=i.next();if(k.done)break;l=k.value}l=l;l=a.get(l);if(l&&l.webrtcStream.active&&l.contentType==="video"&&l.webrtcStream.id!==h){d.processEvent(c);return}}}}});this.$1=b("ZenonDeferrableStateMachine").interpret(b("xstate").Machine(c,{guards:b("ZenonConnectionSMGuards")})).onTransition(function(c){if(!H.has(c.event.type)){var d;b("ZenonDebugLogger").getInstance().logStateMachineTransition(j,c.changed,c.value,(d=c.history)==null?void 0:d.value,c.event.type,c.actions,a.signalingClient.getSignalingModel().getSignalingID())}a.updateConnectionModel(function(a){c.changed&&a.updateConnectionState(c.value)})});b("ZenonDebugLogger").getInstance().startQPL(64243854,+a.signalingClient.getSignalingModel().getSignalingID())}var c=a.prototype;c.processEvent=function(a){if(!H.has(a.type)){var c=this.$1.state.context.signalingClient.getSignalingModel().getSignalingID();this.$2(this.getState(),a.type,c);b("ZenonDebugLogger").getInstance().logStateMachine(j,this.getState(),a.type,c)}this.$1.send(a)};c.getState=function(){var a=this.$1.state.toStrings();return a.length>0?this.$1.state.toStrings()[0]:"init"};c.$2=function(a,b,c){c=c==null?j:j+": "+c;c="["+c+"] [Current State: "+a+"] Processing event: "+b;this.$1.state.context.logEvent({checkpoint:""+c,connectionState:this.getState(),name:"infraAction"})};return a}();e.exports=a;d={actions:[(c=b("ZenonConnectionSharedActions")).onAddParticipants]};f={actions:[c.onLocalMediaStateUpdateProcessing]};e={actions:[c.onLocalMediaStateUpdateRetry]};a={actions:[c.onStopLocalTrack]};var k={actions:[c.onLocalMediaStateUpdateReady]},l={actions:[c.onEndConnection],target:"terminated"},m={actions:[c.onCapabilitiesReceived]},n={actions:[c.onParticipantUpdateReceivedEvent]},o={actions:[c.onRemoveParticipants]},p={actions:[c.onIceCandidateReady]},q={actions:[(g=b("xstate")).assign(c.onCreateDataMessageSubscription)]},r={actions:[g.assign(c.onRemoveDataMessageSubscription)]},s={actions:[c.onDataMessageReceived]},t={actions:[c.onRoomContextUpdateReceived]},u={actions:[c.onIceCandidateReceived]},v={actions:[c.onConnectionDestroyed],cond:(h=b("ZenonConnectionSMGuards")).activePeerConnectionGuard,target:"terminated"},w={actions:[c.onConnectionDropped],cond:h.activePeerConnectionGuard},x={actions:[b("ZenonConnectionSdpSetState").onConnectionEstablished]},y={actions:[c.onStateSyncUnsubscribe]},z={actions:[c.onStateSyncUpdate]},A={actions:[g.assign(c.onSubscriptionRequest)]},B={actions:[c.onSendGenericDataMessage]},C={actions:[c.onUserApprovalRequest]},D={actions:[c.onForceEncodingEnabled]},E={actions:[g.assign((i=b("ZenonConnectionSdpNegotiatedState")).onInitiatePeerConnectionRestarting)],target:"peerConnectionRestarting"},F={actions:["defer"]},G={initial:"init",states:{init:{on:{addLocalTracks:F,capabilitiesReceived:m,connectionDestroyed:v,connectionRoomUpdateReceived:t,createConnection:[{actions:[b("ZenonConnectionInitState").onCreateConnection],cond:h.outgoingConnectionGuard,target:"creatingSdp"},{actions:[b("ZenonConnectionInitState").onCreateConnection],cond:h.incomingConnectionGuard,target:"waitingForIncoming"}],createDataMessageSubscription:q,dataMessageReceived:s,endConnection:l,forceEncodingEnabled:D,iceCandidateReady:p,iceCandidateReceived:u,localMediaStateUpdateProcessing:f,localMediaStateUpdateReady:k,localMediaStateUpdateRetry:e,participantUpdateReceived:n,removeDataMessageSubscription:r,removeLocalTrack:F,removeParticipants:o,replaceLocalTrack:F,sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:a,subscriptionRequest:F,userApprovalRequest:C}},waitingForIncoming:{on:{addLocalTracks:F,capabilitiesReceived:m,connectionDestroyed:v,connectionRoomUpdateReceived:t,createDataMessageSubscription:q,dataMessageReceived:s,endConnection:l,forceEncodingEnabled:D,iceCandidateReady:p,iceCandidateReceived:u,localMediaStateUpdateProcessing:f,localMediaStateUpdateReady:k,localMediaStateUpdateRetry:e,offerReady:[{actions:[c.onOfferReady],target:"sdpSet"}],participantUpdateReceived:n,removeDataMessageSubscription:r,removeLocalTrack:F,removeParticipants:o,replaceLocalTrack:F,sdpReceived:[{actions:[c.onSdpReceived],cond:h.sdpOfferReceiveGuard,target:"creatingSdp"}],sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:a,subscriptionRequest:F,userApprovalRequest:C}},creatingSdp:{on:{addLocalTracks:F,answerReady:[{actions:[c.onAnswerReady],target:"sdpSet"}],capabilitiesReceived:m,connectionDestroyed:v,connectionRoomUpdateReceived:t,createDataMessageSubscription:q,dataMessageReceived:s,endConnection:l,forceEncodingEnabled:D,iceCandidateReady:p,iceCandidateReceived:u,localMediaStateUpdateProcessing:f,localMediaStateUpdateReady:k,localMediaStateUpdateRetry:e,offerReady:[{actions:[c.onOfferReady],target:"sdpSet"}],participantUpdateReceived:n,removeDataMessageSubscription:r,removeLocalTrack:F,removeParticipants:o,replaceLocalTrack:F,sdpReceived:F,sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:a,subscriptionRequest:F,userApprovalRequest:C}},sdpSet:{on:{addLocalTracks:F,capabilitiesReceived:m,connectionDestroyed:v,connectionDropped:w,connectionEstablished:[{actions:[b("ZenonConnectionSdpSetState").onConnectionEstablished],target:"sdpNegotiated"}],connectionRoomUpdateReceived:t,createDataMessageSubscription:q,dataMessageReceived:s,endConnection:l,forceEncodingEnabled:D,iceCandidateReady:p,iceCandidateReceived:u,initiatePeerConnectionRestarting:E,localMediaStateUpdateProcessing:f,localMediaStateUpdateReady:k,localMediaStateUpdateRetry:e,participantUpdateReceived:n,pendingApproval:[{target:"pendingApproval"}],removeDataMessageSubscription:r,removeLocalTrack:F,removeParticipants:o,replaceLocalTrack:F,sdpReceived:[{actions:[c.onSdpReceived],cond:h.sdpAnswerReceiveGuard},babelHelpers["extends"]({},F,{cond:h.sdpOfferReceiveGuard})],sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:a,subscriptionRequest:F,userApprovalRequest:C}},pendingApproval:{on:{addLocalTracks:F,capabilitiesReceived:F,connectionDestroyed:v,connectionRoomUpdateReceived:F,createDataMessageSubscription:F,dataMessageReceived:F,endConnection:l,forceEncodingEnabled:F,iceCandidateReady:F,iceCandidateReceived:F,initiatePeerConnectionRestarting:E,localMediaStateUpdateProcessing:F,localMediaStateUpdateReady:F,localMediaStateUpdateRetry:F,participantUpdateReceived:F,removeDataMessageSubscription:F,removeLocalTrack:F,replaceLocalTrack:F,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:F,subscriptionRequest:F}},sdpNegotiated:{on:{addLocalTracks:[{actions:[i.onAddScreenShareLocalTrack],cond:h.addScreenShareTrackWithReplaceGuard},{actions:[i.onAddLocalTracks],target:"clientInitiatedRenegotiation"}],addParticipants:d,capabilitiesReceived:m,connectionDestroyed:v,connectionDropped:w,connectionEstablished:x,connectionRoomUpdateReceived:t,createDataMessageSubscription:q,dataMessageReceived:s,endConnection:l,forceEncodingEnabled:D,iceCandidateReady:p,iceCandidateReceived:u,initiatePeerConnectionRestarting:E,localMediaStateUpdateProcessing:f,localMediaStateUpdateReady:k,localMediaStateUpdateRetry:e,participantUpdateReceived:n,removeDataMessageSubscription:r,removeLocalTrack:[{actions:[i.onRemoveScreenShareLocalTrack],cond:h.removeScreenShareTrackWithReplaceGuard},{actions:[i.onRemoveLocalTrack],target:"clientInitiatedRenegotiation"}],removeParticipants:o,replaceLocalTrack:{actions:[i.onReplaceLocalTrack]},sdpReceived:{actions:[c.onSdpReceived],cond:h.sdpOfferReceiveGuard,target:"sdpRenegotiating"},sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:a,subscriptionRequest:A,userApprovalRequest:C}},sdpRenegotiating:{on:{addLocalTracks:F,addParticipants:d,answerReady:{actions:[c.onAnswerReady],target:"sdpNegotiated"},capabilitiesReceived:m,connectionDestroyed:v,connectionDropped:w,connectionEstablished:x,connectionRoomUpdateReceived:t,createDataMessageSubscription:q,dataMessageReceived:s,endConnection:l,forceEncodingEnabled:F,iceCandidateReady:p,iceCandidateReceived:u,initiatePeerConnectionRestarting:F,localMediaStateUpdateProcessing:f,localMediaStateUpdateReady:k,localMediaStateUpdateRetry:e,participantUpdateReceived:n,removeDataMessageSubscription:r,removeLocalTrack:F,removeParticipants:o,replaceLocalTrack:F,sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:a,subscriptionRequest:F,userApprovalRequest:C}},clientInitiatedRenegotiation:{on:{addLocalTracks:F,capabilitiesReceived:m,connectionDestroyed:v,connectionDropped:w,connectionEstablished:[{actions:[b("ZenonConnectionSdpSetState").onConnectionEstablished],target:"sdpNegotiated"}],connectionRoomUpdateReceived:t,createDataMessageSubscription:q,dataMessageReceived:s,endConnection:l,forceEncodingEnabled:D,iceCandidateReady:p,iceCandidateReceived:u,initiatePeerConnectionRestarting:F,localMediaStateUpdateProcessing:F,localMediaStateUpdateReady:F,localMediaStateUpdateRetry:F,offerReady:{actions:[c.onOfferReady]},participantUpdateReceived:n,removeDataMessageSubscription:r,removeLocalTrack:F,removeParticipants:o,replaceLocalTrack:F,sdpReceived:[{actions:[c.onSdpReceived],cond:h.sdpAnswerReceiveGuard},F],sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:F,subscriptionRequest:F,userApprovalRequest:C}},peerConnectionRestarting:{on:{addLocalTracks:F,addParticipants:d,capabilitiesReceived:m,connectionDestroyed:babelHelpers["extends"]({},v,{cond:h.secondaryPeerConnectionGuard}),connectionDropped:w,connectionEstablished:{actions:[g.assign(b("ZenonConnectionPeerConnectionRestartingState").onSecondaryConnectionEstablished)],cond:h.secondaryPeerConnectionGuard,target:"sdpNegotiated"},connectionRoomUpdateReceived:t,createDataMessageSubscription:q,dataMessageReceived:babelHelpers["extends"]({},s,{cond:h.secondaryPeerConnectionGuard}),endConnection:l,forceEncodingEnabled:F,iceCandidateReady:babelHelpers["extends"]({},p,{cond:h.secondaryPeerConnectionGuard}),iceCandidateReceived:u,localMediaStateUpdateProcessing:f,localMediaStateUpdateReady:babelHelpers["extends"]({},k,{cond:h.secondaryPeerConnectionGuard}),localMediaStateUpdateRetry:e,offerReady:{actions:[c.onOfferReady],cond:h.secondaryPeerConnectionGuard},participantUpdateReceived:n,removeDataMessageSubscription:r,removeLocalTrack:F,removeParticipants:o,replaceLocalTrack:F,sdpReceived:[{actions:[b("ZenonConnectionPeerConnectionRestartingState").onAnswerSdpReceived],cond:h.sdpAnswerReceiveGuard},F],sendGenericDataMessage:B,stateSyncUnsubscribe:y,stateSyncUpdate:z,stopLocalTrack:a,subscriptionRequest:F,userApprovalRequest:C}},terminated:{}}},H=new Set(["dataMessageReceived"])},null);
__d("ZenonConnectionStateModel",["CurrentUser","MessengerCowatchConfig","UserAgent","ZenonCallFeatures","ZenonNetworkQualityMonitor","ZenonParticipantState","ZenonRTWebBrowserFeatureSupport","ZenonScreenSharingAvailabilityType","gkx"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e,f,g){e===void 0&&(e={groupThreadID:null,peerID:null,serverInfoData:null}),f===void 0&&(f=new(b("ZenonCallFeatures"))({canReplaceLocalStreams:!b("UserAgent").isBrowser("Firefox"),cowatchEnabled:b("MessengerCowatchConfig").hasZenonCowatchCapability(),cowatchGroupEnabled:b("MessengerCowatchConfig").hasZenonGroupCowatchCapability(),networkStatus:b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Good,screenSharingAvailability:b("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()?b("ZenonScreenSharingAvailabilityType").Available:b("ZenonScreenSharingAvailabilityType").Unknown,supportMultipleStreams:b("gkx")("1667037")})),g===void 0&&(g="init"),this.selfUserID=b("CurrentUser").getID(),this.collisionContext=e,this.capabilities=f,this.connectionDirection=d,this.connectionState=g,this.$4=function(){return new Map()},this.$5=function(){return[]},this.$6=function(){return[]},this.$7=function(){return a.getStateSyncStore().getInputStates()},this.$8=function(){return a.getStateSyncStore().getOutputStates()},this.$9=new Map(),this.$1=c,this.$1.set(this.selfUserID,b("ZenonParticipantState").ZenonParticipantState.CONNECTED),this.$2=new Set(),this.$3=new Map(this.$1)}var c=a.prototype;c.getConsolidatedParticipantStates=function(){return this.$3};c.updateParticipantState=function(a,b){this.$1.set(a,b),this.$2.has(a)||(this.$3=this.$3.set(a,b))};c.updateConnectionState=function(a){this.connectionState=a};c.updateCapabilities=function(a){this.capabilities=this.capabilities.set("canAddParticipants",a.addParticipantEnabled),this.capabilities=this.capabilities.set("cowatchEnabled",a.cowatchEnabled),this.capabilities=this.capabilities.set("cowatchGroupEnabled",a.cowatchGroupEnabled)};c.updateNetworkStatus=function(a){this.capabilities=this.capabilities.set("networkStatus",a)};c.updateConsolidatedParticipantStates=function(){var a=new Map(this.$1);this.$2.forEach(function(c){a.set(c,b("ZenonParticipantState").ZenonParticipantState.CONNECTED)});this.$3=a};c.getTracks=function(){return this.$4()};c.registerTrackFetcher=function(a){this.$4=a};c.getRtpSenders_I_KNOW_WHAT_I_AM_DOING=function(){return this.$5()};c.registerRtpSendersFetcher=function(a){this.$5=a};c.getRtpReceivers_I_KNOW_WHAT_I_AM_DOING=function(){return this.$6()};c.registerRtpReceiversFetcher=function(a){this.$6=a};c.getStateSyncInputs=function(){return this.$7()};c.getStateSyncOutputs=function(){return this.$8()};c.getUserToTracksMap=function(){return this.$9};c.addLocalTrackToTrackMap=function(a){var b;b=(b=this.$9.get(this.selfUserID))!=null?b:new Set();b.add(a);this.$9.set(this.selfUserID,b)};c.removeLocalTrackFromTrackMap=function(a){var b;b=(b=this.$9.get(this.selfUserID))!=null?b:new Set();b["delete"](a);this.$9.set(this.selfUserID,b)};c.updateTrackMapFromMediaStates=function(a){var b=this;this.$2=new Set();a.forEach(function(a){var c=a.userID;if(c!=null){var d;d=(d=b.$9.get(c))!=null?d:new Set();d.add(a.trackID);b.$9.set(c,d);b.$2.add(c)}});this.updateConsolidatedParticipantStates()};return a}();e.exports=a},null);
__d("ZenonConnectionStatePeerConnectionDelegate",[],function(a,b,c,d,e,f){"use strict";var g={connectionDestroyed:function(a,b,c){a.processEvent({payload:{error:c,peerConnectionRole:b},type:"connectionDestroyed"})},connectionDropped:function(a,b){a.processEvent({payload:{peerConnectionRole:b},type:"connectionDropped"})},connectionEstablished:function(a,b){a.processEvent({payload:{peerConnectionRole:b},type:"connectionEstablished"})},dataChannelMesageReceived:function(a,b,c,d){a.processEvent({payload:{data:d,dataChannelLabel:c,peerConnectionRole:b},type:"dataMessageReceived"})},sendIceCandidate:function(a,b,c){a.processEvent({payload:{candidate:c,peerConnectionRole:b},type:"iceCandidateReady"})},sendLocalMediaStateUpdate:function(a,b,c){a.processEvent({payload:{mediaStates:c,peerConnectionRole:b},type:"localMediaStateUpdateReady"})},sendSdpReady:function(a,b,c,d,e){var f={tracks:[],version:c.version};d.forEach(function(a){a={enabled:a.enabled,trackID:a.trackId,type:a.contentType,userID:e};f.tracks.push(a)});d={mediaStates:f,peerConnectionRole:b,sdp:c};c.type==="offer"?a.processEvent({payload:d,type:"offerReady"}):a.processEvent({payload:d,type:"answerReady"})},setPeerConnectionEventHandlers:function(a,b,c,d){a.setPeerConnectionEventHandlers({onConnectionDestroyed:function(a){return g.connectionDestroyed(b,c,a)},onConnectionDropped:function(){return g.connectionDropped(b,c)},onConnectionEstablished:function(){return g.connectionEstablished(b,c)},onDataChannelMessageReceived:function(a,d){return g.dataChannelMesageReceived(b,c,a,d)},onIceCandidateReady:function(a){return g.sendIceCandidate(b,c,a)},onLocalMediaStateUpdate:function(a){return g.sendLocalMediaStateUpdate(b,c,a)},onLocalSdpSet:function(e){return g.sendSdpReady(b,c,e,a.getLocalTracksForMWS(),d().selfUserID)}})}};a=g;e.exports=a},null);
__d("ZenonConnectionStateSignalingDelegate",[],function(a,b,c,d,e,f){"use strict";var g={onCapabilitiesReceived:function(a,b,c){a.processEvent({payload:{capabilities:b,escalationConferenceName:c},type:"capabilitiesReceived"})},onDismissReceived:function(a,b){b={dismissReason:b,dismissReasonSetByRemote:!0,shouldInformPeer:!1};a.processEvent({payload:b,type:"endConnection"})},onGenericDataMessageReceived:function(a,b,c){c={data:c,dataChannelLabel:b};a.processEvent({payload:c,type:"dataMessageReceived"})},onIceCandidateReceived:function(a,b){a.processEvent({payload:b,type:"iceCandidateReceived"})},onMediaUpdateRetryRequested:function(a){a.processEvent({type:"localMediaStateUpdateRetry"})},onParticipantUpdateReceived:function(a,b){a.processEvent({payload:{participantStates:b},type:"participantUpdateReceived"})},onPendingApprovalReceived:function(a){a.processEvent({type:"pendingApproval"})},onRenegotiationRequested:function(a){a.processEvent({type:"initiatePeerConnectionRestarting"})},onRoomContextUpdateReceived:function(a,b){a.processEvent({payload:{context:b},type:"connectionRoomUpdateReceived"})},onSdpReceived:function(a,b,c,d){a.processEvent({payload:{mediaStates:c,renegotiationOffer:d,sdp:b},type:"sdpReceived"})},setSignalingEventHandlers:function(a,b){a.setSignalingEventHandlers({onCapabilitiesReceived:function(a,c){return g.onCapabilitiesReceived(b,a,c)},onDismissReceived:function(a,c){return g.onDismissReceived(b,c)},onGenericDataMessageReceived:function(a,c){return g.onGenericDataMessageReceived(b,a,c)},onIceCandidateReceived:function(a){return g.onIceCandidateReceived(b,a)},onMediaUpdateRetryRequested:function(){return g.onMediaUpdateRetryRequested(b)},onParticipantUpdateReceived:function(a){return g.onParticipantUpdateReceived(b,a)},onPendingApprovalReceived:function(){return g.onPendingApprovalReceived(b)},onRenegotiationRequested:function(){return g.onRenegotiationRequested(b)},onRoomContextUpdateReceived:function(a){return g.onRoomContextUpdateReceived(b,a)},onSdpReceived:function(a,c,d){return g.onSdpReceived(b,a,c,d)}})}};a=g;e.exports=a},null);
__d("ZenonConnectionStateManager",["ZenonCallsModelEmitter","ZenonCallsModelTypes","ZenonConnectionStateMachine","ZenonConnectionStateModel","ZenonConnectionStatePeerConnectionDelegate","ZenonConnectionStateSignalingDelegate","ZenonParticipantState","ZenonPeerConnectionManager","ZenonPlatformExperiments"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e,f,g){var h=this;g===void 0&&(g=!1);this.$8=function(){return h.$2};this.$6=function(a){a(h.$2),h.$7(),h.$10()};this.$1=a;var i=c.getSignalingModel();i.setNotifyCallback(function(){h.$6(function(a){a.collisionContext.serverInfoData=i.getRemoteSignalingID()})});this.$2=new(b("ZenonConnectionStateModel"))(i,new Map(),d,{groupThreadID:null,peerID:null,serverInfoData:c.getSignalingModel().getRemoteSignalingID()});a=new(b("ZenonPeerConnectionManager"))(e,g,function(a){return f.log(a)});a.registerTrackListener(function(){h.$7()});a.registerNetworkListener(function(a){h.$2.updateNetworkStatus(a),h.$7()});d=new(b("ZenonPeerConnectionManager"))(e,g,function(a){return f.log(a)});this.$3=new(b("ZenonConnectionStateMachine"))({getConnectionModel:this.$8,logEvent:function(a){return f.log(a)},peerConnectionManager:a,secondaryPeerConnectionManager:d,signalingClient:c,updateConnectionModel:this.$6});b("ZenonConnectionStateSignalingDelegate").setSignalingEventHandlers(c,this.$3);b("ZenonConnectionStatePeerConnectionDelegate").setPeerConnectionEventHandlers(a,this.$3,"primary",this.$8);b("ZenonConnectionStatePeerConnectionDelegate").setPeerConnectionEventHandlers(d,this.$3,"secondary",this.$8);this.$4=f;c.setLoggingEventHandler(function(a){return f.log(a)});this.$5=0}var c=a.prototype;c.start=function(a){var c=a.mwRingRequest!=null?"incoming":"outgoing",d=a.dataChannels,e=a.initialSyncStates,f=a.localMedia,g=a.mwRingRequest;a=a.usersToRing;d={dataChannels:d,direction:c,initialSyncStates:b("ZenonPlatformExperiments").shouldUseStateSync()&&e?e:void 0,mwRingRequest:g,tracks:f,usersToRing:a};this.$3.processEvent({payload:d,type:"createConnection"})};c.muteTrack=function(a){this.$9(a,!1)};c.unmuteTrack=function(a){this.$9(a,!0)};c.$9=function(a,b){b={enabled:b,trackID:a};this.$3.processEvent({payload:b,type:"localMediaStateUpdateProcessing"})};c.stopLocalTrack=function(a){a={trackID:a};this.$3.processEvent({payload:a,type:"stopLocalTrack"})};c.end=function(a,b){a={dismissReason:a,dismissReasonSetByRemote:!1,dismissSubreason:b,shouldInformPeer:!0};this.$3.processEvent({payload:a,type:"endConnection"})};c.addParticipants=function(a){a={usersToRing:a};this.$3.processEvent({payload:a,type:"addParticipants"})};c.removeParticipants=function(a){a={usersToRemove:a};this.$3.processEvent({payload:a,type:"removeParticipants"})};c.addLocalTrack=function(a){this.$3.processEvent({payload:{tracks:[a]},type:"addLocalTracks"})};c.replaceLocalTrack=function(a,b){this.$3.processEvent({payload:{replacementTrack:b,trackIDToReplace:a},type:"replaceLocalTrack"})};c.removeLocalTrack=function(a){this.$3.processEvent({payload:{trackID:a},type:"removeLocalTrack"})};c.createDataMessageSubscription=function(a,b){this.$3.processEvent({payload:{dataChannelLabel:a,messageHandler:b},type:"createDataMessageSubscription"})};c.removeDataMessageSubscription=function(a,b){this.$3.processEvent({payload:{dataChannelLabel:a,messageHandler:b},type:"removeDataMessageSubscription"})};c.sendGenericDataMessage=function(a,b,c,d){b={data:b,recipientIDs:c,serviceRecipients:d,topic:a};this.$3.processEvent({payload:b,type:"sendGenericDataMessage"})};c.updateStateSyncTopic=function(a,b){b={inputData:b,topic:a};this.$3.processEvent({payload:b,type:"stateSyncUpdate"})};c.unsubscribeFromStateSyncTopic=function(a){a={topic:a};this.$3.processEvent({payload:a,type:"stateSyncUnsubscribe"})};c.subscribeToRemoteVideo=function(a,b){b={includeDominantSpeaker:b,subscriptions:a};this.$3.processEvent({payload:b,type:"subscriptionRequest"})};c.approveParticipants=function(a){this.$3.processEvent({payload:{approvalStatus:1,targetUsers:a},type:"userApprovalRequest"})};c.denyParticipants=function(a){this.$3.processEvent({payload:{approvalStatus:0,targetUsers:a},type:"userApprovalRequest"})};c.forceEncodingEnabled=function(a){this.$3.processEvent({payload:{enabled:a},type:"forceEncodingEnabled"})};c.getConnectionState=function(){return this.$2.connectionState};c.getClientCallID=function(){return this.$1};c.getServerCallID=function(){return this.$2.collisionContext.serverInfoData};c.$7=function(){b("ZenonCallsModelEmitter").CallsModelEmitterInstance.emitCallsModel(this.$1,this.$2)};c.$10=function(){if(b("ZenonCallsModelEmitter").CONNECTION_STATE_TO_CALL_STATE_MAP[this.$2.connectionState]!==b("ZenonCallsModelTypes").ZenonCallState.Connected)return;var a=this.$2.getConsolidatedParticipantStates();if(a){a=Array.from(a.values());a=a.filter(function(a){return a===b("ZenonParticipantState").ZenonParticipantState.CONNECTED});a=a.length;a>this.$5&&(this.$4.log({connectedParticipantsCount:a,name:"setMaxConnectedParticipants"}),this.$5=a)}};return a}();e.exports=a},null);
__d("ZenonVideoDurationTracker",["performanceNow"],function(a,b,c,d,e,f){"use strict";var g;function h(a){a.startedAt==null&&(a.startedAt=(g||(g=b("performanceNow")))())}function i(a){a.startedAt!=null&&(a.duration=k(a),a.startedAt=null)}function j(a,b){b=b.filter(function(a){return a.enabled&&a.webrtcTrack.readyState!=="ended"});b.length>0?h(a):i(a)}function k(a){var c=a.startedAt;return c!=null?a.duration+(g||(g=b("performanceNow")))()-c:a.duration}a=function(){function a(){this.$1={localScreenShareDuration:{duration:0,startedAt:null},localVideoDuration:{duration:0,startedAt:null},remoteVideoDuration:{duration:0,startedAt:null}}}var b=a.prototype;b.getLocalVideoDuration=function(){return k(this.$1.localVideoDuration)};b.getLocalScreenShareDuration=function(){return k(this.$1.localScreenShareDuration)};b.getRemoteVideoDuration=function(){return k(this.$1.remoteVideoDuration)};b.update=function(a){var b=this.$1.localVideoDuration,c=Array.from(a.values()).filter(function(a){var b=a.contentType==="video"||a.contentType==="screen";return b&&!a.remote});j(b,c);b=this.$1.localScreenShareDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="screen";return b&&!a.remote});j(b,c);b=this.$1.remoteVideoDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="video"||a.contentType==="screen";return b&&a.remote});j(b,c)};return a}();e.exports=a},null);
__d("ZenonMediaChannelManager",["regeneratorRuntime","FBLogger","ScotchRTWebUserActionLogger","ZenonDebugLogger","ZenonImmutableMediaTrack","ZenonMediaStatsManager","ZenonMediaUtils","ZenonRTCVideoResolutionHelper","ZenonScreenShare","ZenonSimulcastManager","ZenonVideoDurationTracker","err","gkx","promiseDone","qex"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c){var d=this;this.$11=!1;this.$1=a;this.$2=new Map();this.$7=new Map();this.$8=new Map();this.$5=[];this.$4=new(b("ZenonVideoDurationTracker"))();this.$3=new(b("ZenonMediaStatsManager"))(this.$1,this.$2,c,this.$4);this.$3.listen();this.$1.addEventListener("track",function(a){var c;if((c=b("qex")._("1688994"))!=null?c:!1){var e=(c=d.$1.getMWTrackId(a==null?void 0:(c=a.transceiver)==null?void 0:c.mid))!=null?c:a.track.id;a.track.addEventListener("mute",function(){b("ZenonDebugLogger").getInstance().logConsole("mute track event for: "+e),d.muteTrack(e)});a.track.addEventListener("unmute",function(){b("ZenonDebugLogger").getInstance().logConsole("unmute track event for: "+e),d.unmuteTrack(e)});a.track.addEventListener("ended",function(){b("ZenonDebugLogger").getInstance().logConsole("ended track event for: "+e),d.muteTrack(e)})}d.addRemoteTrackFromEvent(a);d.$12();d.$13()});this.$1.addEventListener("signalingstatechange",function(){d.$13(),d.$14()});this.$1.addEventListener("removestream",function(){d.$12()});this.$9=!0;this.$10=new Map()}var c=a.prototype;c.cleanUp=function(){this.$3.stopPolling()};c.getTracks=function(){return this.$2};c.$12=function(){b("ZenonRTCVideoResolutionHelper").maybeLimitEncodingResolutionByParticipantCount(this.$1.getSenders(),this.$1.getReceivers(),this.$1.supportsSimulcast())};c.updateTrackInfo=function(a){var c=this.$2.get(a.trackID);if(c==null){b("FBLogger")("rtc_www").warn("Received track info update before track was available");this.$10.set(a.trackID,a);return}c=this.$15(c,a);this.$2.set(a.trackID,c);this.$14()};c.$15=function(a,c){var d;if(!b("gkx")("1667037"))return a;var e=a.webrtcStream;c.type==="screen"&&(e=b("ZenonMediaUtils").createStreamWithTrack(a.webrtcTrack),a.webrtcStream.removeTrack(a.webrtcTrack));return new(b("ZenonImmutableMediaTrack"))({contentHint:a.contentHint,contentType:(d=c.type)!=null?d:a.contentType,enabled:c.enabled,label:a.label,remote:a.remote,trackId:c.trackID,webrtcStream:e,webrtcTrack:a.webrtcTrack})};c.getLocalTracksForMWS=function(){var a=this,b=new Map();this.$2.forEach(function(c,d){if(!c.remote){var e,f=(e=a.$8.get(d))!=null?e:d;e=c.update("trackId",function(){return f});b.set(f,e)}});return b};c.addTrack=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:a.contentType==="video"&&a.remote===!1&&(this.$6=a);if(!(b("ZenonScreenShare").isScreenSharingTrack([a])&&this.$6!=null)){c.next=8;break}this.$9=this.$6.enabled&&this.$6.webrtcTrack.enabled;c.next=5;return b("regeneratorRuntime").awrap(this.$16(this.$6,a));case 5:this.unmuteTrack(a.trackId);c.next=9;break;case 8:this.$17(a);case 9:b("ZenonScreenShare").isScreenSharingTrack([a])&&b("ZenonRTCVideoResolutionHelper").handleStartScreenSharing(this.$1.getSenders(),this.$1.getReceivers(),this.$1.supportsSimulcast()),this.$14();case 11:case"end":return c.stop()}},null,this)};c.removeTrack=function(a){var c,d,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c=this.$2.get(a);if(!(c==null)){h.next=3;break}return h.abrupt("return");case 3:if(!(b("ZenonScreenShare").isScreenSharingTrack([c])&&this.$6!=null)){h.next=9;break}h.next=6;return b("regeneratorRuntime").awrap(this.$16(c,this.$6));case 6:this.$9?this.unmuteTrack((d=(e=this.$6)==null?void 0:e.trackId)!=null?d:""):this.muteTrack((f=(g=this.$6)==null?void 0:g.trackId)!=null?f:"");h.next=10;break;case 9:this.$18(c);case 10:c.webrtcTrack.stop(),b("ZenonScreenShare").isScreenSharingTrack([c])&&b("ZenonRTCVideoResolutionHelper").handleStopScreenSharing(this.$1.getSenders(),this.$1.getReceivers(),this.$1.supportsSimulcast()),this.$14();case 13:case"end":return h.stop()}},null,this)};c.replaceTrack=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=this.$2.get(a);if(!(e==null)){f.next=3;break}return f.abrupt("return");case 3:((d=this.$6)==null?void 0:d.trackId)===a&&(this.$6=c);f.next=6;return b("regeneratorRuntime").awrap(this.$16(e,c));case 6:this.$14(),e.webrtcTrack.stop();case 8:case"end":return f.stop()}},null,this)};c.addRemoteTrackFromEvent=function(a){var c=a.transceiver;c=this.$1.getMWTrackId(c.mid);a=b("ZenonMediaUtils").convertToZenonImmutableMediaTrack(a.track,{isRemote:!0,isUserMuted:!1,stream:a.streams?a.streams[0]:null},c);c=this.$10.get(a.trackId);c!=null&&(a=this.$15(a,c),this.$10["delete"](a.trackId));c=this.$7.get(a.trackId);c!=null&&(a.contentType!=="audio"&&(a.webrtcTrack.enabled=c.enabled,a=a.set("enabled",c.enabled)),a=a.set("userMuted",c.userMuted),this.$7["delete"](a.trackId));this.$2=this.$2.set(a.trackId,a);this.$14()};c.createDataChannel=function(a,b){this.$1.createDataChannel(a,b)};c.muteTrack=function(a){var b=this.$2.get(a),c=b===this.$6;if(b==null){this.$7.set(a,{enabled:!1,userMuted:!0});return}a=b;b.userMuted||(a=a.set("userMuted",!0));var d=Boolean((b==null?void 0:b.remote)&&b.contentType==="audio");!d&&b.enabled&&b.webrtcTrack.enabled&&(a.webrtcTrack.enabled=!1,a=a.set("enabled",!1));c&&(this.$6=a);b!==a&&(this.$2=this.$2.set(a.trackId,a),this.$14())};c.unmuteTrack=function(a){var b=this.$2.get(a),c=b===this.$6;if(b==null){this.$7.set(a,{enabled:!0,userMuted:!1});return}a=b;b.userMuted&&(a=a.set("userMuted",!1));var d=Boolean((b==null?void 0:b.remote)&&b.contentType==="audio");!d&&!b.enabled&&!b.webrtcTrack.enabled&&(a.webrtcTrack.enabled=!0,a=a.set("enabled",!0));c&&(this.$6=a);b!==a&&(this.$2=this.$2.set(a.trackId,a),this.$14())};c.forceEncodingEnabled=function(a){if(a===this.$11)return;this.$11=a;this.$13()};c.getSdpFormat=function(){return this.$1.getSdpFormat()};c.setSimulcastSingleLayerParams=function(){if(this.$1.supportsSimulcast()&&!this.$1.getSimulcastInitialized()){var a=this.$1.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(a.length!==0){a=a[0];var c=b("ZenonSimulcastManager").getSimulcastSingleLayerParameters(a.getParameters());a.setParameters(c);this.$1.setSimulcastInitialized(!0)}}};c.stopLocalTracks=function(){this.$2.forEach(function(a){a.remote===!1&&(b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"stopping track: "+a.label,codebase_version:"Zenon"}),a.webrtcTrack.stop())});if(this.$6!=null&&!this.$2.has(this.$6.trackId)){var a;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"stopping local video track: "+this.$6.label,codebase_version:"Zenon"});(a=this.$6)==null?void 0:a.webrtcTrack.stop()}this.$14()};c.stopLocalTrack=function(a){a=this.$2.get(a);if(a==null)return;if(a.remote)return;a.webrtcTrack.stop()};c.registerNetworkListener=function(a){this.$3.registerNetworkListener(a)};c.registerTrackListener=function(a){this.$5.push(a)};c.setTrackListenersFromManager=function(a){this.$5=a.$5};c.timeSeries=function(){return this.$3.timeSeries()};c.$17=function(a){this.$1.addTrack(a.webrtcTrack,a.webrtcStream),this.$2=this.$2.set(a.trackId,a)};c.$18=function(a){this.$1.removeTrack(a.webrtcTrack),this.$2["delete"](a.trackId),a.webrtcTrack.stop()};c.$16=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=this.$1.getSenders().find(function(b){return b.track===a.webrtcTrack});if(!(d===void 0)){f.next=3;break}throw new(b("err"))("track to be replaced is not found");case 3:f.next=5;return b("regeneratorRuntime").awrap(d.replaceTrack(c.webrtcTrack));case 5:e=this.$8.get(a.trackId),e!=null?this.$8["delete"](a.trackId):e=a.trackId,this.$8.set(c.trackId,e),this.$2["delete"](a.trackId),this.$2.set(c.trackId,c);case 10:case"end":return f.stop()}},null,this)};c.$14=function(){this.$4.update(this.$2),this.$5.forEach(function(a){a()})};c.$19=function(){return this.$11||this.$1.getRemoteStreams().length>0};c.$13=function(){if(!b("gkx")("1723730"))return;var a=this.$19();this.$1.getSenders().forEach(function(c){var d=c.getParameters(),e=!1;d.encodings.forEach(function(b){!e&&b.active!==a&&(e=!0),b.active=a});e&&b("promiseDone")(c.setParameters(d),null,function(a){b("FBLogger")("rtc_www").catching(a).mustfix("Error while trying to toggle encoding")})})};return a}();e.exports=a},null);
__d("ZenonMediaStatsManager",["regeneratorRuntime","FBLogger","ZenonCumulativeMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsReportPoller","ZenonNetworkQualityMonitor","ZenonTSLogDataHelper","qex"],function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID,h=b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID,i=b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID,j=1e4,k={tet:1e3,tpsd:1e3};a=function(){function a(a,c,d,e,f){f===void 0&&(f=5e3),this.$8=null,this.__iceconnectionstate="disconnected",this.$1=a,this.$2=c,this.$3=new Map(),this.$5=d,this.$6=b("ZenonTSLogDataHelper").emptyTSLogDataHolder(),this.__videoDurationTracker=e,this.$7=f,this.$4=function(){},this.$9=new(b("ZenonNetworkQualityMonitor").ZenonNetworkQualityMonitor)()}var c=a.prototype;c.listen=function(){var a=this;this.$1.addEventListener("iceconnectionstatechange",function(c){c=c.target;a.__iceconnectionstate=c.iceConnectionState;switch(a.__iceconnectionstate){case"connected":a.pollRecurring();break;case"failed":case"disconnected":a.$10()&&a.updateNetworkStatus(b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Poor);break}})};c.pollOnce=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.prev=0;a.next=3;return b("regeneratorRuntime").awrap(b("ZenonMediaStatsReportPoller").updateStatsFromConnection(Array.from(this.$2.values()),this.$3,this.$1,this.$6,this.$7));case 3:this.$5(this.$11());a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),b("FBLogger")("rtc_www").warn("Error polling media metrics: ",a.t0);case 9:this.__iceconnectionstate==="failed"||this.__iceconnectionstate==="disconnected"?this.updateNetworkStatus(b("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Poor):this.updateNetworkStatus(this.$9.determineQuality(this.$3));case 10:case"end":return a.stop()}},null,this,[[0,6]])};c.pollRecurring=function(){var a=this;if(this.$8!=null)return;this.$8=window.setInterval(function(){return a.pollOnce()},this.$7);this.pollOnce()};c.stopPolling=function(){this.$8!=null&&(window.clearInterval(this.$8),this.$8=null)};c.timeSeries=function(){var a=b("ZenonTSLogDataHelper").serialize(this.$6);return a.streams.length===0?null:JSON.stringify(a)};c.registerNetworkListener=function(a){this.$4=a};c.updateNetworkStatus=function(a){this.$4(a)};c.$10=function(){var a;return(a=b("qex")._("1763245"))!=null?a:!1};c.$11=function(){var a=this,b={CoreAudioMetrics:{},DebugAudioMetrics:{NetworkReceive:{}},extraInfo:{},receiver:{},sender:{},video:{}},c={},d=this.$3.get(g);d!=null&&(this.$12(d,b.sender),this.$13(d,b.CoreAudioMetrics));d=this.$3.get(i);d!=null&&(this.$14(b.video,d),this.$15(b.video,d,c));d=this.$3.get(h);d!=null&&this.$15(b.video,d,c);this.$3.forEach(function(d,e){e=a.$2.get(e);if(e==null)return;var f=d.localIceCandidateStats,g=d.remoteIceCandidateStats;!b.extraInfo.localIceCandidate&&f&&(b.extraInfo.localIceCandidate=f);!b.extraInfo.remoteIceCandidate&&g&&(b.extraInfo.remoteIceCandidate=g);if(e.remote===!1){e.enabled===!0&&e.contentType==="audio"&&e.webrtcTrack.readyState==="live"&&(b.CoreAudioMetrics.audio_device=e.label);return}e.contentType==="audio"?a.$16(d,b.receiver,e,c):e.contentType==="video"&&a.$17(b.video,d,c)});this.$18(b,c);return b};c.$18=function(a,b){var c={},d=a.receiver,e=d.jbd;d=d.jbec;if(e!=null&&d!=null&&d>0){e=Math.round(e/d);c.neteq={meanWait:e}}d=b.maxSpeechExpandRate!=null?Math.round(b.maxSpeechExpandRate*j):null;e=b.minSpeechExpandRate!=null?Math.round(b.minSpeechExpandRate*j):null;b=b.countSpeechExpandRate!=null&&b.countSpeechExpandRate>0&&b.sumSpeechExpandRate!=null?Math.round(b.sumSpeechExpandRate*j/b.countSpeechExpandRate):null;(d!=null||b!=null||e!=null)&&(c.speech_expand_rate={M:d,avg:b,m:e});a.DebugAudioMetrics.NetworkReceive={jb_nm:c}};c.$12=function(a,c){var d=a.cumulativeStat,e=d.bytesSent;d=d.packetsSent;var f=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],g=a.deltaStat.googRtt;f=new Map([["bytes",e],["plost",f],["psent",d]]);f.forEach(function(a,b){a!=null&&b!=="codec"&&b!=="ice"&&b!=="ice_g0"&&(c[b]=a.getCurrentValue())});if(e){d=e.getElapsedTime();d>0&&(c.ube_avg=Math.round(e.getDeltaValue()*8/d*1e3))}if(g){f=g.getTotal();e=g.getCount();if(e>0){c.avgrtt=Math.round(f/e);c.maxrtt=Math.max((d=c.maxrtt)!=null?d:Number.MIN_SAFE_INTEGER,g.getMax());c.minrtt=Math.min((f=c.minrtt)!=null?f:Number.MAX_SAFE_INTEGER,g.getMin())}}a.codec!=null&&a.codec!==""&&(c.codec={www:a.codec});return c};c.$16=function(a,c,d,e){a.codec!=null&&a.codec!==""&&(c.codec==null&&(c.codec={}),c.codec[d.hashCode().toString()]=a.codec);d=a.cumulativeStat;var f=d.bytesReceived,g=d.fecPacketsDiscarded,h=d.fecPacketsReceived,i=d.googDecodingCNG,j=d.googDecodingCTN,k=d.googDecodingNormal,m=d.googDecodingPLC,n=d.googDecodingPLCCNG,o=d.insertedSamplesForDeceleration,p=d.jitterBufferDelay,q=d.jitterBufferEmittedCount,r=d.packetsReceived,s=d.removedSamplesForAcceleration,t=d.totalAudioEnergy,u=d.totalSamplesDuration;d=d.totalSamplesReceived;var v=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],w=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL],x=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT];a=a.deltaStat;var y=a.googRtt,z=a.googSpeechExpandRate;a=a.jitter;if(f){var A=f.getElapsedTime();if(A>0){var B=l(c.dbe_total_bytes,f.getDeltaValue());c.dbe_total_bytes=B;A=l(c.dbe_total_time,A);c.dbe_total_time=A;c.dbe_avg=Math.round(B*8/A*1e3)}}if(y){e.sumrtt=((B=e.sumrtt)!=null?B:0)+y.getTotal();e.countrtt=((A=e.countrtt)!=null?A:0)+y.getCount();e.sumrtt!=null&&e.countrtt>0&&(c.avgrtt=Math.round(e.sumrtt/e.countrtt));c.maxrtt=Math.max((B=c.maxrtt)!=null?B:Number.MIN_SAFE_INTEGER,y.getMax());c.minrtt=Math.min((A=c.minrtt)!=null?A:Number.MAX_SAFE_INTEGER,y.getMin())}if(z){e.sumSpeechExpandRate=((B=e.sumSpeechExpandRate)!=null?B:0)+z.getTotal();e.countSpeechExpandRate=((A=e.countSpeechExpandRate)!=null?A:0)+z.getCount();e.maxSpeechExpandRate=Math.max((y=e.maxSpeechExpandRate)!=null?y:Number.MIN_SAFE_INTEGER,z.getMax());e.minSpeechExpandRate=Math.min((B=e.minSpeechExpandRate)!=null?B:Number.MAX_SAFE_INTEGER,z.getMin())}p&&(c.jbd=l(c.jbd,1e3*p.getCurrentValue()));t&&(c.taue=l(c.taue,1e5*t.getCurrentValue()),c.taut=l(c.taut,t.getElapsedTime()));w&&x&&(c.rx_sum_lvl=l(c.rx_sum_lvl,w.getCurrentValue()),c.tautc=l(c.tautc,x.getCurrentValue()));u&&(c.sp_dur=l(c.sp_dur,1e3*u.getCurrentValue()));if(d){A=d.getCurrentValue();if(A>0&&j!=null){if(s!=null){y=Math.round(s.getCurrentValue()*j.getCurrentValue()/A);c.dec_ar=l(c.dec_ar,y)}if(o){B=Math.round(o.getCurrentValue()*j.getCurrentValue()/A);c.dec_per=l(c.dec_per,B)}}}z=new Map([["dec_plc",m],["dec_plc_cng",n],["dec_cng",i],["dec_normal",k],["neteq_calls",j],["decel_cnt",o],["bytes",f],["plost",v],["precv",r],["fecpd",g],["fecpr",h],["jbec",q],["sp_dur",u],["sp_r",d]]);z.forEach(function(a,b){a!=null&&b!=="codec"&&b!=="ice"&&b!=="ice_g0"&&(c[b]=l(c[b],a.getCurrentValue()))});if(a&&r&&c.precv!=null&&c.precv>0){p=c.precv;t=a.getTotal()*r.getCurrentValue();e.weightedJitterSum=((w=e.weightedJitterSum)!=null?w:0)+t;c.jitter=Math.round(1e3*e.weightedJitterSum/p)}return c};c.$15=function(a,c,d){a.ld=Math.round(this.__videoDurationTracker.getLocalVideoDuration());var e=a.sender||{};c.codec!=null&&c.codec!==""&&(e.ename=c.codec);if(c.histResScale){e.histResScale==null&&(e.histResScale=new Array(5).fill(0));var f=e.histResScale;f.forEach(function(a,b){f[b]+=c.histResScale[b]})}var g=c.cumulativeStat,h=g.bytesSent,i=g.captureFrameCount,j=g.firCount,m=g.framesEncoded,n=g.framesSent,o=g.keyFramesEncoded,p=g.nackCount,q=g.packetsSent,r=g.pliCount,s=g.simulcast_layer_changes,t=g.totalEncodeTime,u=g.totalPacketSendDelay,v=g.videoConvertedQpSum,w=g.videoEncodeFps,x=g.videoSumCapturePixel;g=g.videoSumPixel;var y=c.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],z=c.deltaStat,A=z.frameHeight,B=z.frameWidth,C=z.height;z=z.width;h=new Map([["enc_bytes",h],["eqps",v],["plost",y],["psent",q],["pli",r],["fcsn",n],["fir",j],["tet",t],["tpsd",u],["fcap",i],["frames",m],["kframes",o],["nack",p],["sim_l_chg",s],["efrate",w],["ah",A],["aw",B],["ch",C],["cw",z]]);h.forEach(function(a,c){if(a!=null&&c!=="ename"&&c!=="histResScale"&&c!=="ehist"&&c!=="ss")if(a instanceof b("ZenonCumulativeMediaStat")){var d;d=(d=k[c])!=null?d:1;e[c]=l(e[c],a.getCurrentValue()*d)}else{e[c]=Math.round((d=a.getLastAddedValue())!=null?d:0)}});if(e.enc_bytes!=null&&a.ld!=null&&a.ld>0){v=e.enc_bytes;y=a.ld;a.bwe={avg_enc_bitrate:Math.round(v*8/y*1e3)}}a.ld!=null&&a.ld>0&&e.frames!=null&&e.frames>0&&(e.efrate=Math.round(e.frames*1e3/a.ld));if(x&&e.fcap!=null&&e.fcap>0){q=e.fcap;d.videoSumCapturePixel=l((r=d.videoSumCapturePixel)!=null?r:void 0,x.getCurrentValue());e.eipxl=Math.round(d.videoSumCapturePixel/q)}if(g&&e.frames!=null&&e.frames>0){n=e.frames;d.videoSumPixel=l((j=d.videoSumPixel)!=null?j:void 0,g.getCurrentValue());e.eopxl=Math.round(d.videoSumPixel/n)}c.codecHistory!=null&&(e.ehist=Object.fromEntries(c.codecHistory.map(function(a){var b=a.codec;a=a.updateTime;return[Math.round(a).toString(),b]})));a.sender=e};c.$17=function(a,c,d){a.rd=Math.round(this.__videoDurationTracker.getRemoteVideoDuration());var e=a.receiver,f=e===void 0?{}:e;c.codec!=null&&c.codec!==""&&c.lastUpdate>((e=d.lastCodecUpdate)!=null?e:Number.MIN_SAFE_INTEGER)&&(f.dname=c.codec,d.lastCodecUpdate=c.lastUpdate);e=c.cumulativeStat;var g=e.bytesReceived,h=e.firCount,i=e.framesDecoded,j=e.framesReceived,k=e.jitterBufferDelay,m=e.jitterBufferEmittedCount,n=e.jitterBufferFramesSentToDecoder,o=e.keyFramesDecoded,p=e.packetsReceived,q=e.pliCount,r=e.totalDecodeTime,s=e.tracktimestamp,t=e.videoConvertedQpSum,u=e.videoDecodedBytes,v=e.videoDecodeTime,w=e.videoFreezeCount,x=e.videoFreezeDuration,y=e.videoPauseCount,z=e.videoPauseDuration;e=e.videoSumPixel;var A=c.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],B=c.deltaStat,C=B.avSync,D=B.avSyncAbs,E=B.e2eLatency,F=B.frameHeight;B=B.frameWidth;if(c.maxTotalDecodeTime!=null){f.dec_time=Math.round(Math.max(c.maxTotalDecodeTime,(c=f.dec_time)!=null?c:0))}if(i){c=l(f.frd,i.getCurrentValue());if(E&&c>0){var G;E=E.getAverage()*i.getCurrentValue();f.e2el=(G=f.e2el)!=null?G:0;f.frd=(G=f.frd)!=null?G:0;f.e2el=Math.round((f.e2el*f.frd+E)/c)}if(e!=null&&c>0){E=((G=d.aggVideoSumPixel)!=null?G:0)+e.getCurrentValue();f.dpxl=Math.round(E/c);d.aggVideoSumPixel=E}if(C!=null&&D!=null&&c>0){e=((G=d.weigtedAvSync)!=null?G:0)+C.getAverage()*i.getCurrentValue();G=((E=d.weigtedAvSyncAbs)!=null?E:0)+D.getAverage()*i.getCurrentValue();f.av=Math.round(e/c);f.avabs=Math.round(G/c);d.weigtedAvSync=e;d.weigtedAvSyncAbs=G}f.frd=c;f.dec_frame=c}if(B&&F&&s.getCurrentTime()>((C=d.lastFrameUpdate)!=null?C:Number.MIN_SAFE_INTEGER)){f.rh=(E=F.getLastAddedValue())!=null?E:0;f.rw=(D=B.getLastAddedValue())!=null?D:0;d.lastFrameUpdate=s.getCurrentTime()}r&&(f.tdt=l(f.tdt,1e3*r.getCurrentValue()));k&&(f.jbd=l(f.jbd,1e3*k.getCurrentValue()));i=new Map([["recv",g],["qps",t],["plost",A],["precv",p],["pli",q],["pact",y],["padur",z],["jbec",m],["jtasb",j],["jtfrm",n],["jtkey",o],["fir",h],["frcnt",w],["frdur",x],["dec_time_all_streams",v],["dec_bytes",u]]);i.forEach(function(a,b){a!=null&&b!=="dname"&&(f[b]=l(f[b],a.getCurrentValue()))});f.jbd!=null&&f.jbec!=null&&f.jbec>0&&(f.recjbl=Math.round(f.jbd/f.jbec));a.receiver=f};c.$14=function(a,b){var c,d=((c=a.sender)==null?void 0:c.ss)||{};d.dur=Math.round(this.__videoDurationTracker.getLocalScreenShareDuration());c=b.cumulativeStat;var e=c.captureFrameCount,f=c.framesEncoded,g=c.videoBytesSent,h=c.videoConvertedQpSum,i=c.videoSumCapturePixel;c=c.videoSumPixel;b=b.deltaStat.availableOutgoingBitrate;e=new Map([["eiframes",e],["eqps",h],["frames",f]]);e.forEach(function(a,b){a!=null&&(d[b]=a.getCurrentValue())});if(i!=null&&d.eiframes!=null&&d.eiframes>0){h=d.eiframes;d.eipxl=Math.round(i.getCurrentValue()/h)}if(c!=null&&d.frames!=null&&d.frames>0){f=d.frames;d.eopxl=Math.round(c.getCurrentValue()/f)}b&&(d.avbw=Math.round(b.getAverage()));if(g&&d.dur!=null&&d.dur>0){e=d.dur;d.avbr=Math.round(g.getCurrentValue()*8/e)}a.sender=(i=a.sender)!=null?i:{};a.sender.ss=d};c.$13=function(a,b){var c=a.cumulativeStat,d=c.audioDevRecStalls,e=c.audioDevStallDuration;c=c.audioDevTotalStalls;a=a.deltaStat.audioDevIsStalled;c=new Map([["astall",c],["sdur",e],["rstall",d]]);c.forEach(function(a,c){a!=null&&c!=="audio_device"&&(b[c]=Math.round(a.getCurrentValue()))});if(a){b.isstall=(e=a.getLastAddedValue())!=null?e:0}};return a}();e.exports=a;function l(a,b){return a===void 0?Math.round(b):Math.round(a+b)}},null);
__d("ZenonAudioLevelDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f.computeAudioLevels=a;var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL,h=b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT,i=9.5/Math.log(32767);function a(a,c){a.filter(function(a){return a.webrtcTrack.enabled===!0&&a.webrtcTrack.readyState==="live"&&a.contentType==="audio"}).forEach(function(a){a=c.get(a.trackId);if(a==null||a.cumulativeStat.totalAudioEnergy==null||a.cumulativeStat.totalSamplesDuration==null)return;var d=a.cumulativeStat,e=d.totalAudioEnergy;d=d.totalSamplesDuration;e=e.getDeltaFromLastUpdate();d=d.getDeltaFromLastUpdate()*1e3;if(d===0)return;e=20+i*Math.log(e*1e3/d);e=Math.max(1,Math.min(e,20));a.cumulativeStat[g]==null?a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(e):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+e);a.cumulativeStat[h]==null?a.cumulativeStat[h]=new(b("ZenonCumulativeMediaStat"))(1):a.cumulativeStat[h].update(a.cumulativeStat[h].getCurrentValue()+1)})}},null);
__d("ZenonAudioStallStatsDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],function(a,b,c,d,e,f){"use strict";f.updateStatsWithDerivedMetric=a;var g=5e3;c=b("ZenonMediaStatsConfig").DERIVED_METRICS;var h=c.AUDIO_DEV_IS_STALLED,i=c.AUDIO_DEV_REC_STALLS,j=c.AUDIO_DEV_STALL_DURATION,k=c.AUDIO_DEV_TOTAL_STALLS;function l(a){a=a.cumulativeStat;var b=a.bytesSent,c=a["media-sourcetimestamp"];a=a[j];return b!=null&&c!=null?b.getCurrentTimeSinceLastUpdate()>g?a.getCurrentTimeSinceLastUpdate():b.getCurrentValue()===0||b.getDeltaFromLastUpdate()===0?c.getDeltaFromLastUpdate():0:0}function m(a){a.deltaStat[h]==null&&(a.deltaStat[h]=new(b("ZenonDeltaMediaStat"))()),a.cumulativeStat[i]==null&&(a.cumulativeStat[i]=new(b("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[k]==null&&(a.cumulativeStat[k]=new(b("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[j]==null&&(a.cumulativeStat[j]=new(b("ZenonCumulativeMediaStat"))(0))}function n(a){var b=l(a),c=b===0?0:1;m(a);var d=!p(a)&&c?1:0;a.cumulativeStat[i].update(a.cumulativeStat[i].getCurrentValue()+d);a.cumulativeStat[k].update(a.cumulativeStat[k].getCurrentValue()+d);a.cumulativeStat[j].update(a.cumulativeStat[j].getCurrentValue()+b);a.deltaStat[h].add(c)}function o(a,b){b=b?0:1;var c=!p(a)&&b?1:0;a.cumulativeStat[i].update(a.cumulativeStat[i].getCurrentValue()+c);a.cumulativeStat[k].update(a.cumulativeStat[k].getCurrentValue()+c);a.deltaStat[h].add(b);c=b?a.cumulativeStat[j].getCurrentTimeSinceLastUpdate():0;a.cumulativeStat[j].update(a.cumulativeStat[j].getCurrentValue()+c)}function p(a){return a.deltaStat[h]!=null&&a.deltaStat[h].getLastAddedValue()===1}function a(a,c){var d=0;a.filter(function(a){return a.contentType==="audio"&&!a.remote&&a.webrtcTrack.readyState==="live"}).forEach(function(a){d++;a=c.get(a.trackId);a!=null&&n(a)});a=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID);a!=null&&(m(a),d===0?o(a,!1):o(a,!0))}},null);
__d("ZenonAvSyncDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f.findAssociatedAudioTrackId=i;f.isMutedDuringInterval=j;f.updateTrackerWithAvSync=a;var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT,h=b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB;function i(a){a=a.webrtcStream.getAudioTracks();return a!=null&&a.length>0?a[0].id:null}function j(a){var c;if(a.cumulativeStat.totalAudioEnergy!=null&&a.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate()<=b("ZenonMediaStatsConfig").VOICE_ENERGY_THRESHOLD){a.isMuted=!0;return!0}c=(c=a.isMuted)!=null?c:!1;a.isMuted=!1;return c}function a(a,c){a.filter(function(a){return a.contentType==="video"&&a.remote}).forEach(function(a){var d=i(a);if(d!=null){d=c.get(d);var e=c.get(a.trackId);if(d!=null&&d.cumulativeStat.estimatedPlayoutTimestamp!=null&&e!=null&&e.cumulativeStat.estimatedPlayoutTimestamp!=null){var f,l,m;a=e.cumulativeStat.estimatedPlayoutTimestamp;var n=d.cumulativeStat.estimatedPlayoutTimestamp;f=(f=e.lastEstimatedPlayoutTimestamp)!=null?f:0;l=(l=d.lastEstimatedPlayoutTimestamp)!=null?l:0;e.lastEstimatedPlayoutTimestamp=a.getCurrentValue();d.lastEstimatedPlayoutTimestamp=n.getCurrentValue();var o=e.cumulativeStat.packetsReceived?e.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()>0:!1,p=d.cumulativeStat.packetsReceived?d.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()>0:!1;if(((m=e.lastEstimatedPlayoutTimestamp)!=null?m:0)<=f||((m=d.lastEstimatedPlayoutTimestamp)!=null?m:0)<=l||j(d)||!o||!p){k(e,g,0);k(e,h,0);return}k(e,g,1);f=n.getCurrentValue()-a.getCurrentValue();m=Math.abs(f);if(m>b("ZenonMediaStatsConfig").AV_SYNC_CUTOFF){k(e,h,1);return}k(e,h,0);l=[{key:b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC,value:f},{key:b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS,value:m}];l.forEach(function(a){e.deltaStat[a.key]==null&&(e.deltaStat[a.key]=new(b("ZenonDeltaMediaStat"))()),e.deltaStat[a.key].add(a.value)})}}})}function k(a,c,d){a.cumulativeStat[c]==null&&(a.cumulativeStat[c]=new(b("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[c].update(a.cumulativeStat[c].getCurrentValue()+d)}},null);
__d("ZenonE2ELatencyDeriver",["ZenonDeltaMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f.updateTrackerWithE2ELatency=a;var g=-22089888e5;function a(a,c){a.filter(function(a){return a.remote}).forEach(function(a){a=c.get(a.trackId);var d=b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY;if(a!=null&&a.cumulativeStat.estimatedPlayoutTimestamp!=null&&a.cumulativeStat.estimatedPlayoutTimestamp.getDeltaFromLastUpdate()>0){var e=Date.now()-g-a.cumulativeStat.estimatedPlayoutTimestamp.getCurrentValue();a.deltaStat[d]==null&&(a.deltaStat[d]=new(b("ZenonDeltaMediaStat"))());a.deltaStat[d].add(e)}})}},null);
__d("ZenonMediaElementTracker",["FBLogger","React"],function(a,b,c,d,e,f){"use strict";f.track=i;f.untrack=j;f.updateStats=a;f.useMediaElementTracker=c;var g=b("React"),h=new Map();function i(a,c){h.has(a)&&b("FBLogger")("rtc_www").warn("ZenonMediaElementTracker already has a stream associated with the given element"),h.set(a,c)}function j(a){h["delete"](a)||b("FBLogger")("rtc_www").warn("ZenonMediaElementTracker did not have a stream associated with the given element")}function a(a){for(var c=h,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];for(var f=f.getTracks(),i=Array.isArray(f),j=0,f=i?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=f.length)break;k=f[j++]}else{j=f.next();if(j.done)break;k=j.value}k=k;var l=a.get(k.id);if(l==null){b("FBLogger")("rtc_www").warn("Failed to find stream ID in media stats. Is ZenonMediaElementTracker leaking?");continue}if(k.kind==="video"&&g instanceof HTMLVideoElement){if(g.videoWidth===0||g.videoHeight===0)continue;var m=g.getBoundingClientRect();l.renderedWidth=m.width;l.renderedHeight=m.height;var n=m.width/g.videoWidth,o=m.height/g.videoHeight,p=getComputedStyle(g);p=p.objectFit;var q=1,r=1;switch(p){case"cover":q=Math.max(n,o);r=m.width*m.height/(q*q*g.videoWidth*g.videoHeight);break;case"contain":q=Math.min(n,o);break;default:b("FBLogger")("rtc_www").warn("Unknown object-fit type %s",p)}l.scaleRatio=q*q;l.croppingRatio=r}else k.kind==="audio"&&g instanceof HTMLAudioElement}}}function c(a,b){g.useEffect(function(){var c=a.current;if(!b||!c)return;i(c,b);return function(){j(c)}},[a,b])}},null);
__d("ZenonOutboundStatsWriter",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],function(a,b,c,d,e,f){"use strict";f.updateOutboundStats=a;var g=Object.freeze({audio:b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID,screen:b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID,video:b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID});function h(a,c,d){if(d==null)return;a.cumulativeStat[c]==null?a.cumulativeStat[c]=new(b("ZenonCumulativeMediaStat"))(d.getCurrentValue()):a.cumulativeStat[c].update(a.cumulativeStat[c].getCurrentValue()+d.getDeltaFromLastUpdate())}function i(a,c,d){if(d==null)return;a.deltaStat[c]==null&&(a.deltaStat[c]=new(b("ZenonDeltaMediaStat"))());d=d.getLastAddedValue();d!=null&&a.deltaStat[c].add(d)}function a(a,c){a.filter(function(a){return a.remote===!1&&a.webrtcTrack.readyState==="live"}).forEach(function(a){var d=c.get(a.trackId);if(d!=null){a=g[a.contentType];a=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,a);var e=d.cumulativeStat,f=d.deltaStat,j=d.histResScale;d.percentStat;d.simulcastStats;d=babelHelpers.objectWithoutPropertiesLoose(d,["cumulativeStat","deltaStat","histResScale","percentStat","simulcastStats"]);Object.assign(a,d);a.histResScale=[].concat(j);for(var k in e)h(a,k,e[k]);for(var l in f)i(a,l,f[l])}})}},null);
__d("ZenonPacketsLostDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f.updatePacketsLost=a;var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED;function a(a,c){a.filter(function(a){return a.webrtcTrack.enabled===!0&&a.webrtcTrack.readyState==="live"}).forEach(function(a){var d=c.get(a.trackId);if(d==null||d.cumulativeStat.packetsLost==null)return;var e=d.cumulativeStat.packetsLost;a.remote?a=d.cumulativeStat.packetsReceived:a=d.cumulativeStat.packetsSent;if(d.cumulativeStat[g]==null)d.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(e.getCurrentValue());else{a=a!=null&&a.isReset()?e.getCurrentValue():e.getDeltaFromLastUpdate();d.cumulativeStat[g].updateNonStrictCumulative(d.cumulativeStat[g].getCurrentValue()+a)}})}},null);
__d("ZenonVideoQualityDeriver",["ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f._convertToH264QP=l;f.computeVideoQuality=a;var g=1280*720;c=160*96;var h=Math.log2(g/c);d=51;var i=16,j=d-i,k=j+Math.floor(h*6);function l(a){var b=Math.max(1,Math.min(63,a));a=[1,5,12,28,42,53,64];var c=a.findIndex(function(a){return a>b});return c==null?0:Math.min(51,Math.floor(12+6*c+6*(b-a[c-1])/(a[c]-a[c-1])))}function a(a){var c=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM],d=a.cumulativeStat.framesEncoded,e=a.deltaStat,f=e.frameHeight;e=e.frameWidth;if(c==null||d==null||f==null||e==null)return;d=d.getDeltaFromLastUpdate();c=c.getDeltaFromLastUpdate();e=e.getLastAddedValue();f=f.getLastAddedValue();if(d===0||f==null||e==null||e<=0||f<=0)return;c=c/d;if(c<=0)return;((d=a.codec)==null?void 0:d.indexOf("264"))===-1?a=l(c):a=c;d=Math.max(0,Math.min(j,a-i));c=e*f;a=Math.max(0,Math.min(h,Math.log2(g/c)));return Math.max(0,k-d-a*6)/k*100}},null);
__d("ZenonPerStreamAggregator",["ZenonAvSyncDeriver","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonPercentMediaStat","ZenonRenderedView","ZenonVideoQualityDeriver"],function(a,b,c,d,e,f){"use strict";f.aggregatePerStream=a;var g=b("ZenonRenderedView").GRID,h=Object.freeze({audio:b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID,screen:b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID,video:b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID});function a(a,b){s(a,b),r(a,b),q(a,b)}function i(a,c,d,e,f,g){if(d==null)return;a.percentStat[c]==null&&(a.percentStat[c]=new(b("ZenonPercentMediaStat"))());a.percentStat[c].add(d,e,f,g)}function j(a,b){return a<b?a:b}function k(a,c){var d=c.get(a.trackId),e=0;if(d==null)return e;if(a.contentType==="audio")d.cumulativeStat.totalAudioEnergy!=null&&(e=d.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate());else{d=b("ZenonAvSyncDeriver").findAssociatedAudioTrackId(a);if(d!=null){a=c.get(d);a!=null&&a.cumulativeStat.totalAudioEnergy!=null&&(e=a.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate(),b("ZenonAvSyncDeriver").isMutedDuringInterval(a)&&(e=0))}}return e}function l(a,c){var d,e=b("ZenonMediaStatsConfig").DERIVED_METRICS.RENDERED_VIEW;c=c.get(a.trackId);if(c==null)return g;c.deltaStat[e]==null&&(c.deltaStat[e]=new(b("ZenonDeltaMediaStat"))());a=(a=c.renderedView)!=null?a:g;d=(d=b("ZenonRenderedView").cast(c.deltaStat[e].getLastAddedValue()))!=null?d:a;c.deltaStat[e].add(a);c=j(a,d);return c}function m(a,b,c,d){if(a.cumulativeStat[c]&&a.cumulativeStat[c].getDeltaFromLastUpdate()!==0&&a.cumulativeStat[b]!=null){b=a.cumulativeStat[b].getDeltaFromLastUpdate()/a.cumulativeStat[c].getDeltaFromLastUpdate();return b*((a=d)!=null?a:1)}return null}function n(a){var c=null,d=b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED;a.cumulativeStat.packetsReceived!=null&&a.cumulativeStat[d]!=null&&a.cumulativeStat[d].getDeltaFromLastUpdate()+a.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()!==0&&(c=a.cumulativeStat[d].getDeltaFromLastUpdate()/(a.cumulativeStat[d].getDeltaFromLastUpdate()+a.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()));return c}function o(a,b,c){if(a.cumulativeStat[b]&&a.cumulativeStat[b].getTimeSinceLastUpdate()!==0){a=a.cumulativeStat[b].getDeltaFromLastUpdate()/a.cumulativeStat[b].getTimeSinceLastUpdate();return a*((b=c)!=null?b:1)}return null}function p(a,b,c){if(a.deltaStat[b]){a=a.deltaStat[b].getLastAddedValue();return a!=null?a*((b=c)!=null?b:1):null}return null}function q(a,c){var d=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID),e=0,f=0,g=0,h=0,j=0,k=0;a.filter(function(a){return a.webrtcTrack.readyState==="live"&&a.webrtcTrack.muted===!1}).forEach(function(a){var b=c.get(a.trackId);if(b!=null)if(a.remote===!1)b.cumulativeStat.totalEncodeTime!=null&&b.cumulativeStat.totalEncodeTime.getTimeSinceLastUpdate()>0&&(h+=b.cumulativeStat.totalEncodeTime.getDeltaFromLastUpdate(),j+=b.cumulativeStat.totalEncodeTime.getTimeSinceLastUpdate(),k++);else{var d=o(b,"bytesReceived",8e3);if(d==null)return;a.contentType==="audio"?f+=d:g+=d;b.cumulativeStat.totalDecodeTime!=null&&b.cumulativeStat.totalDecodeTime.getTimeSinceLastUpdate()>0&&(h+=b.cumulativeStat.totalDecodeTime.getDeltaFromLastUpdate(),j+=b.cumulativeStat.totalDecodeTime.getTimeSinceLastUpdate(),k++)}});if(k>0){a=j/k;a=h*1e3/a;i(d,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_CPU_USAGE,a,b("ZenonMediaStatsConfig").GLOBAL_STATS_RENDERED_VIEW,b("ZenonMediaStatsConfig").GLOBAL_STATS_CONTENT_TYPE,e)}if(f+g>0){i(d,(a=b("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.GLOBAL_AUDIO_BITRATE,f,a.GLOBAL_STATS_RENDERED_VIEW,a.GLOBAL_STATS_CONTENT_TYPE,e);i(d,a.PER_STREAM_AGG_METRICS.GLOBAL_VIDEO_BITRATE,g,a.GLOBAL_STATS_RENDERED_VIEW,a.GLOBAL_STATS_CONTENT_TYPE,e)}}function r(a,c){a.filter(function(a){return a.remote===!1&&a.webrtcTrack.readyState==="live"}).forEach(function(a){var d=c.get(a.trackId);if(d!=null){var e,f=h[a.contentType];f=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,f);i(f,(e=b("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.ROUND_TRIP_TIME,p(d,"googRtt",1),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);var g=b("ZenonVideoQualityDeriver").computeVideoQuality(d);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_QUALITY,g,e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_ENCODED_FRAME_RATE,o(d,"framesEncoded",1e3),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_QP,m(d,e.DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM,"framesEncoded",1),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0)}})}function s(a,c){var d=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").PINNED_AUDIO_STATS_TRACKID),e=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").PINNED_VIDEO_STATS_TRACKID);a.filter(function(a){return a.webrtcTrack.readyState==="live"&&a.remote===!0}).forEach(function(a){var f=c.get(a.trackId);if(f!=null){var g=k(a,c),h=l(a,c);if(a.contentType==="audio"){var j=h===b("ZenonRenderedView").PINNED?d:f;i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_RATE,m(f,"googDecodingPLC","googDecodingCTN"),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_CNG_RATE,m(f,"googDecodingPLCCNG","googDecodingCTN"),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_NETEQ_WAIT_TIME,m(f,"jitterBufferDelay","jitterBufferEmittedCount",1e3),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PACKET_LOSS_RATE,n(f),h,a.contentType,g)}else if(a.contentType==="video"){j=h===b("ZenonRenderedView").PINNED?e:f;i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_NETEQ_WAIT_TIME,m(f,"jitterBufferDelay","jitterBufferEmittedCount",1e3),h,a.contentType,g);if(f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT]!=null&&f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT].getDeltaFromLastUpdate()>0){var q=0;f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB]==null||f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB].getDeltaFromLastUpdate()===0?i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_ABS,p(f,b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS,1),h,a.contentType,g):q=1;i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_OOB,q,h,a.contentType,g)}i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FRAME_RATE,o(f,"framesDecoded",1e3),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_COUNT_PER_MIN,o(f,b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT,6e4),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_DURATION_PER_MIN,o(f,b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION,6e4),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_PACKET_LOSS_RATE,n(f),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_RENDER_SCALE_RATIO,f.scaleRatio,h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_CROPPING_RATIO,f.croppingRatio,h,a.contentType,g)}}})}},null);
__d("ZenonVideoCaptureMetricDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT,h=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL,i={VIDEO_CAPTURE_FRAME_COUNT_STAT_KEY:g,VIDEO_SUM_CAPTURE_PIXEL_STAT_KEY:h,addDebugLog:function(a,c,d,e){var f="video_debugFPS",g="video_debugtracktimestamp",h="video_debuglastUpdate";a.deltaStat[f]!=null?a.deltaStat[f].add(c):(a.deltaStat[f]=new(b("ZenonDeltaMediaStat"))(),a.deltaStat[f].add(c));a.deltaStat[g]!=null?a.deltaStat[g].add(d):(a.deltaStat[g]=new(b("ZenonDeltaMediaStat"))(),a.deltaStat[g].add(d));a.deltaStat[h]!=null?a.deltaStat[h].add(e):(a.deltaStat[h]=new(b("ZenonDeltaMediaStat"))(),a.deltaStat[h].add(e))},calculateVideoCaptureFrameCount:function(a){var b=a.cumulativeStat.tracktimestamp,c=a.deltaStat.framesPerSecond;if(c!=null&&b!=null&&b.getCurrentValue()>a.lastUpdate&&b.getDeltaFromLastUpdate()!==b.getCurrentValue()){c=c.getLastAddedValue();var d=b.getDeltaFromLastUpdate();if(typeof c==="number"){d=Math.round(c*d/1e3);d>1e3&&i.addDebugLog(a,c,b.getCurrentValue(),a.lastUpdate);return d}}return 0},calculateVideoSumCapturePixel:function(a,b){var c=a.cumulativeStat,d=c.captureFrameCount;c=c.tracktimestamp;var e=a.deltaStat,f=e.height;e=e.width;if(d!=null&&e!=null&&f!=null&&c!=null&&c.getCurrentValue()>a.lastUpdate){c=b?d.getCurrentValue():d.getDeltaFromLastUpdate();b=(a=e.getLastAddedValue())!=null?a:0;e=(d=f.getLastAddedValue())!=null?d:0;a=c*b*e;return a}return 0},updateStatsWithDerivedMetric:function(a,c){var d=["video","screen"];a.filter(function(a){return d.includes(a.contentType)&&a.remote===!1}).forEach(function(a){a=c.get(a.trackId);if(a!=null){if(a.cumulativeStat[g]!=null){var d=a.cumulativeStat.framesEncoded;if(d!=null)if(d.getDeltaFromLastUpdate()<0)a.cumulativeStat[g].update(0);else{d=i.calculateVideoCaptureFrameCount(a);a.cumulativeStat[g].getCurrentValue()===0&&(d+=d);a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+d)}}else a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(0);if(a.cumulativeStat[h]!=null){d=a.cumulativeStat.captureFrameCount;d=d.getDeltaFromLastUpdate()<0;var e=i.calculateVideoSumCapturePixel(a,d);d?a.cumulativeStat[h].update(e):a.cumulativeStat[h].update(a.cumulativeStat[h].getCurrentValue()+e)}else{d=i.calculateVideoSumCapturePixel(a,!0);a.cumulativeStat[h]=new(b("ZenonCumulativeMediaStat"))(d)}}})}};a=i;e.exports=a},null);
__d("ZenonVideoConvertedQpDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig","ZenonVideoQpConversion"],function(a,b,c,d,e,f){"use strict";var g=["video","screen"],h={calculateVideoConvertedQP:function(a){var c=a.cumulativeStat,d=c.framesDecoded,e=c.framesEncoded,f=c.qpSum;c=c.tracktimestamp;var g=a.codec;e=e!=null?e:d;if(f!=null&&e!=null&&g!=null&&c!=null&&c.getCurrentValue()>a.lastUpdate){d=f.getDeltaFromLastUpdate();c=e.getDeltaFromLastUpdate();(c<=0||d<=0)&&(d=f.getCurrentValue(),c=e.getCurrentValue());a=g.includes("264");f=b("ZenonVideoQpConversion").convertQp(c,d,a);return f*c}return 0},updateStatsWithDerivedMetric:function(a,c){a.filter(function(a){return g.includes(a.contentType)&&a.webrtcTrack.readyState==="live"&&a.webrtcTrack.muted===!1}).forEach(function(a){a=c.get(a.trackId);if(a!=null){var d=a.cumulativeStat.qpSum;if(d!=null){d=d.getDeltaFromLastUpdate()<0;var e=h.calculateVideoConvertedQP(a),f=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM;a.cumulativeStat[f]!=null?d?a.cumulativeStat[f].update(e):a.cumulativeStat[f].update(a.cumulativeStat[f].getCurrentValue()+e):a.cumulativeStat[f]=new(b("ZenonCumulativeMediaStat"))(e)}}})}};a=h;e.exports=a},null);
__d("ZenonVideoDecodeTimeDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f.findMaxDecodeTime=a;f.updateTrackerWithDecodeTime=c;var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME;function a(a,b,c){var d=a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).reduce(function(a,d){d=b.get(d.trackId);if(d!=null&&d.cumulativeStat.framesDecoded!=null&&d.cumulativeStat.framesDecoded.getDeltaFromLastUpdate()>0){var e=d.cumulativeStat.framesDecoded.getTimeSinceLastUpdate();d.cumulativeStat.framesDecoded.getStatCount()===2&&(e+=h(d.cumulativeStat.framesDecoded,c));return Math.max(e,a)}return a},0);b.forEach(function(a){if(a.cumulativeStat.framesDecoded!=null){a.maxTotalDecodeTime=((a=a.maxTotalDecodeTime)!=null?a:0)+d}})}function c(a,c,d){a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=c.get(a.trackId);if(a!=null&&a.cumulativeStat.framesDecoded!=null&&a.cumulativeStat.framesDecoded.getDeltaFromLastUpdate()>0){var e=a.cumulativeStat.framesDecoded.getTimeSinceLastUpdate();a.cumulativeStat.framesDecoded.getStatCount()===2&&(e+=h(a.cumulativeStat.framesDecoded,d));a.cumulativeStat[g]==null?a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(e):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+e)}})}function h(a,b){return a.getDeltaFromLastUpdate()>0?Math.round(b*a.getFirstValue()/a.getDeltaFromLastUpdate()):0}},null);
__d("ZenonVideoDecodedBytesDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f.updateTrackerWithDecodedBytes=a;var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODED_BYTES;function a(a,c){a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=c.get(a.trackId);if(a!=null){var d=a.cumulativeStat,e=d.bytesReceived;d=d.framesDecoded;if(e&&d){var f=d.getElapsedTime()===0&&d.getCurrentValue()>0;if(f||d.getDeltaFromLastUpdate()>0){d=e.getDeltaFromLastUpdate();f&&(d=e.getCurrentValue());a.cumulativeStat[g]==null?a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(d):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+d)}}}})}},null);
__d("ZenonVideoFreezeCountDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";var g=10,h={calculateVideoFreeze:function(a){a=a.cumulativeStat;var b=a.framesDecoded,c=a.totalInterFrameDelay;a=a.totalSquaredInterFrameDelay;if(b!=null&&c!=null&&a!=null&&b.getDeltaFromLastUpdate()>0){var d=b.getDeltaFromLastUpdate(),e=b.getAverageOverTime()*1e3;c=c.getDeltaFromLastUpdate();a=a.getDeltaFromLastUpdate();e=1/e;var f=e*g/100;e=Math.max(3*e,e+.15);var h=(f*f*d+e*e*(d-1)/d)/d;a=(a-c*c/d)/d;c=a>h?1:0;h=0;if(c)if(d>1){a=a-f*f;h=Math.sqrt(a*d*d/(d-1))*1e3}else h=b.getTimeSinceLastUpdate()/2>e*1e3?b.getTimeSinceLastUpdate()/2:0;return{count:c,duration:h}}return{count:0,duration:0}},updateStatsWithDerivedMetric:function(a,c){var d=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT,e=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION;a.filter(function(a){return a.contentType==="video"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=c.get(a.trackId);if(a!=null){var f=h.calculateVideoFreeze(a);a.cumulativeStat[d]!=null?a.cumulativeStat[d].update(a.cumulativeStat[d].getCurrentValue()+f.count):a.cumulativeStat[d]=new(b("ZenonCumulativeMediaStat"))(f.count);a.cumulativeStat[e]!=null?a.cumulativeStat[e].update(a.cumulativeStat[e].getCurrentValue()+f.duration):a.cumulativeStat[e]=new(b("ZenonCumulativeMediaStat"))(f.duration)}})}};a=h;e.exports=a},null);
__d("ZenonVideoPauseDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";f.updateVideoPause=a;var g=5e3;function a(a,b){a.filter(function(a){return a.contentType==="video"&&a.remote}).forEach(function(a){a=b.get(a.trackId);a!=null&&h(a)})}function h(a){var c=a.cumulativeStat,d=c.framesDecoded;c=c.packetsReceived;if(c!=null){var e;e=(e=a.isVideoPaused)!=null?e:!1;if(!e)c.getDeltaFromLastUpdate()===0&&c.getTimeSinceLastUpdate()>1e3&&(a.isVideoPaused=!0,a.lastVideoPacketTime=c.getPreviousTime());else if(d!=null&&d.getDeltaFromLastUpdate()>0){a.isVideoPaused=!1;d=(c.getCurrentTime()+c.getPreviousTime())/2-((e=a.lastVideoPacketTime)!=null?e:c.getPreviousTime());a.lastVideoPacketTime=void 0;d>=g&&(a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT]!=null?a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT].update(a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT].getCurrentValue()+1):a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT]=new(b("ZenonCumulativeMediaStat"))(1),a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION]!=null?a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION].update(a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION].getCurrentValue()+d):a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION]=new(b("ZenonCumulativeMediaStat"))(d))}}}},null);
__d("ZenonVideoSumPixelDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL,h=["video","screen"],i={calculateVideoSumPixel:function(a,b,c){var d=a.cumulativeStat,e=d.framesDecoded,f=d.framesEncoded;d=d.tracktimestamp;var g=a.deltaStat,h=g.frameHeight;g=g.frameWidth;c=c?e:f;if(c!=null&&g!=null&&h!=null&&d!=null&&d.getCurrentValue()>a.lastUpdate){e=b?c.getCurrentValue():c.getDeltaFromLastUpdate();d=(f=g.getLastAddedValue())!=null?f:0;b=(a=h.getLastAddedValue())!=null?a:0;c=e*d*b;return c}return 0},updateStatsWithDerivedMetric:function(a,c){a.filter(function(a){return h.includes(a.contentType)}).forEach(function(a){var d=a.remote;a=c.get(a.trackId);if(a!=null)if(a.cumulativeStat[g]!=null){var e=a.cumulativeStat,f=e.framesDecoded;e=e.framesEncoded;f=d?f:e;if(f!=null){e=f.getDeltaFromLastUpdate()<0;f=i.calculateVideoSumPixel(a,e,d);e?a.cumulativeStat[g].update(f):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+f)}}else{e=i.calculateVideoSumPixel(a,!0,d);a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(e)}})}};a=i;e.exports=a},null);
__d("ZenonMediaStatsReportPoller",["regeneratorRuntime","Promise","UserAgent","ZenonAudioLevelDeriver","ZenonAudioStallStatsDeriver","ZenonAvSyncDeriver","ZenonE2ELatencyDeriver","ZenonMediaElementTracker","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonOutboundStatsWriter","ZenonPacketsLostDeriver","ZenonPerStreamAggregator","ZenonSpeakerTracker","ZenonTSLogDataHelper","ZenonVideoCaptureMetricDeriver","ZenonVideoConvertedQpDeriver","ZenonVideoDecodedBytesDeriver","ZenonVideoDecodeTimeDeriver","ZenonVideoFreezeCountDeriver","ZenonVideoPauseDeriver","ZenonVideoScaleHistogram","ZenonVideoSumPixelDeriver","gkx","immutable"],function(a,b,c,d,e,f){"use strict";f.updateStatsFromConnection=a;function g(a,b){return b.toArray().find(function(b){return b.trackIDs.contains(a.trackId)})}function h(a,c,d,e,f,h,i){var j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:j=d.getSenders().map(function(d){var h,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:j=(h=d.track)==null?void 0:h.id;if(!(j!=null)){n.next=11;break}k=a.find(function(a){return a.trackId===j});if(!(k!=null&&k.webrtcTrack.readyState!=="ended")){n.next=11;break}n.next=6;return b("regeneratorRuntime").awrap(d.getStats());case 6:l=n.sent,m=b("ZenonMediaStatsParser").makeStatsReportMap(l),b("gkx")("965758")&&b("ZenonTSLogDataHelper").addData(e,k.enabled,b("ZenonMediaStatsParser").filterMediaReports(m),b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,k.contentType,g(k,f)),b("ZenonMediaStatsParser").updateTrackStatsWithReport(k,c,m),i.push(k);case 11:case"end":return n.stop()}},null,this)});l.next=3;return b("regeneratorRuntime").awrap(b("Promise").all(j));case 3:k=d.getReceivers().map(function(d){var i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:j=(i=d.track)==null?void 0:i.id;if(!(j!=null)){n.next=11;break}k=a.find(function(a){return a.trackId===j});if(!(k!=null&&k.webrtcTrack.readyState!=="ended")){n.next=11;break}n.next=6;return b("regeneratorRuntime").awrap(d.getStats());case 6:l=n.sent,m=b("ZenonMediaStatsParser").makeStatsReportMap(l),b("gkx")("965758")&&b("ZenonTSLogDataHelper").addData(e,k.enabled,b("ZenonMediaStatsParser").filterMediaReports(m),b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,k.contentType,g(k,f)),b("ZenonMediaStatsParser").updateTrackStatsWithReport(k,c,m),h.push(k);case 11:case"end":return n.stop()}},null,this)});l.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(k));case 6:case"end":return l.stop()}},null,this)}function i(a,c,d,e,f){var h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:h=function(){return new(b("Promise"))(function(a){d.getStats(a)})};j.next=3;return b("regeneratorRuntime").awrap(h());case 3:i=j.sent,a.forEach(function(a){if(a.webrtcTrack.readyState!=="ended"){var d=b("ZenonMediaStatsParser").makeStatsReportMap(i);b("gkx")("965758")&&b("ZenonTSLogDataHelper").addData(e,a.enabled,b("ZenonMediaStatsParser").filterLegacyMediaReports(a,d),b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,a.contentType,g(a,f));b("ZenonMediaStatsParser").updateTrackStatsWithChromiumLegacyReport(a,c,d)}});case 5:case"end":return j.stop()}},null,this)}function j(a,b){a.forEach(function(a){a=b.get(a.trackId);a!=null&&a.cumulativeStat.tracktimestamp!=null&&(a.lastUpdate=a.cumulativeStat.tracktimestamp.getCurrentValue())})}function a(a,c,d,e,f,g){var k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:g===void 0&&(g=b("immutable").Map());k=[];l=[];o.next=5;return b("regeneratorRuntime").awrap(h(a,c,d,e,g,k,l));case 5:if(!(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera"))){o.next=8;break}o.next=8;return b("regeneratorRuntime").awrap(i(a,c,d,e,g));case 8:if(!b("gkx")("965758")){o.next=15;break}o.next=11;return b("regeneratorRuntime").awrap(d.getStats());case 11:m=o.sent,n=b("ZenonMediaStatsParser").makeStatsReportMap(m),b("ZenonTSLogDataHelper").addCandidatePairStats(e,n),b("ZenonTSLogDataHelper").addNonMediaStates(e);case 15:b("ZenonTSLogDataHelper").advance(e),b("ZenonMediaElementTracker").updateStats(c),b("ZenonSpeakerTracker").updateStats(a,c),b("ZenonPacketsLostDeriver").updatePacketsLost(a,c),b("ZenonVideoFreezeCountDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoPauseDeriver").updateVideoPause(a,c),b("ZenonVideoCaptureMetricDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoSumPixelDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoConvertedQpDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoDecodedBytesDeriver").updateTrackerWithDecodedBytes(a,c),b("ZenonVideoDecodeTimeDeriver").findMaxDecodeTime(a,c,f),b("ZenonVideoDecodeTimeDeriver").updateTrackerWithDecodeTime(a,c,f),b("ZenonVideoScaleHistogram").updateTrackerWithScaleHistogram(a,c),b("ZenonE2ELatencyDeriver").updateTrackerWithE2ELatency(a,c),b("ZenonAudioLevelDeriver").computeAudioLevels(a,c),b("ZenonAudioStallStatsDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonAvSyncDeriver").updateTrackerWithAvSync(a,c),b("ZenonOutboundStatsWriter").updateOutboundStats(l,c),b("ZenonPerStreamAggregator").aggregatePerStream([].concat(k,l),c),j(a,c);case 35:case"end":return o.stop()}},null,this)}},null);
__d("ZenonLayout",["$InternalEnum"],function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Grid","DominantSpeaker"]);c=a;e.exports=c},null);
__d("ZenonSpeakerTracker",["React","ZenonCallsHooks","ZenonLayout","ZenonRenderedView"],function(a,b,c,d,e,f){"use strict";f.updateLayout=k;f.updateStats=a;f.useUpdateSpeakerTracker=c;var g=b("React"),h=null,i=[],j=[];function k(a,b,c){h=a,i=b,j=c}function a(a,c){for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;if(!f.remote)continue;var g=c.get(f.trackId);if(!g)continue;g.isDominantSpeaker=i.indexOf(f.trackId)!==-1;if(h!=null)switch(h){case b("ZenonLayout").Grid:g.renderedView=b("ZenonRenderedView").GRID;break;case b("ZenonLayout").DominantSpeaker:f=j.indexOf(f.trackId)!==-1;g.renderedView=f?b("ZenonRenderedView").PINNED:b("ZenonRenderedView").THUMBNAIL;break}}}function c(a,c,d){var e,f=(e=b("ZenonCallsHooks").useLiveMediaTrack((e=c)!=null?e:"","video"))==null?void 0:e.trackId,h=(c=b("ZenonCallsHooks").useLiveMediaTrack((e=c)!=null?e:"","audio"))==null?void 0:c.trackId,i=(c=b("ZenonCallsHooks").useLiveMediaTrack((e=d)!=null?e:"","video"))==null?void 0:c.trackId,j=(c=b("ZenonCallsHooks").useLiveMediaTrack((e=d)!=null?e:"","audio"))==null?void 0:c.trackId;g.useEffect(function(){k(a,[f,h],[i,j])},[i,j,a,f,h])}},null);
__d("LsRtcTslogFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1743886");c=b("FalcoLoggerInternal").create("ls_rtc_tslog",a);e.exports=c},null);
__d("ZenonChildCallSummaryLogProcessor",["ChannelClientID","DateConsts","LsRtcTslogFalcoEvent","ScotchRTWebUserActionLogger","ZenonCallSummary","ZenonCallSummaryStore","ZenonDismissReason","gkx"],function(a,b,c,d,e,f){"use strict";var g=10*b("DateConsts").MS_PER_SEC;a=function(){function a(a,c){this.$3=null;this.$2=a.protocol;this.$2==="mw"&&(a.peerID="MW_PEER_ID");var d=b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.retrieveCallSummary(a.peerID,a.callID);d?(this.$1=d,this.$1.unsetEndCallFields(),this.$1.setDeviceID(b("ChannelClientID").getID())):this.$1=new(b("ZenonCallSummary"))(a);a.conferenceName!=null&&this.$1.setConferenceName(a.conferenceName);a.serverInfoData!=null?(this.$1.setServerInfoData(a.serverInfoData),this.$1.setJoinWithSID(!0)):this.$1.setJoinWithSID(!1);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);c&&c({localCallID:this.$1.localCallID})}var c=a.prototype;c.processEvent=function(a){var c=this;switch(a.name){case"callJoinRequest":this.$1.onCallJoinRequest(a.hasOfferInRingRequest);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"callConnected":this.$1.onCallConnected(a.mediaMode);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"callEscalated":this.$1.onCallEscalated(a.mediaMode);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"peerConnectionStateChanged":this.$1.setPCIsConnected(a.connected);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"callEnded":this.$3!=null&&window.clearTimeout(this.$3);this.$1.onCallEnded(a.endCallReason,a.isRemoteEnded,!1,a.endCallSubreason);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);b("gkx")("1369511")&&this.$1.uploadLog();b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[ZP] ZenonLoggingEvent_callEnded: "+JSON.stringify({dismissReason:a.endCallReason,endCallReason:b("ZenonDismissReason").dismissToEndCallReason(a.endCallReason),endCallSubreason:a.endCallSubreason})});break;case"inviteSent":this.$1.onInviteSent();this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"inviteResponseReceived":this.$1.onInviteResponseReceived();this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"inviteResponseProcessed":this.$1.onInviteResponseProcessed();this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"mediaConnected":this.$1.onMediaConnected();this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"setMediaStats":this.$1.setMediaStats(a.mediaStats);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"setMaxConnectedParticipants":this.$1.setMaxConnectedParticipants(a.connectedParticipantsCount);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"setHasAnswerInJoinResponse":this.$1.setHasAnswerInJoinResponse(a.hasAnswerInJoinResponse);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"setRemoteSignalingID":this.$1.setServerInfoData(a.remoteSignalingID);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"startHeartbeat":var d=function d(){a.isCallOngoing()&&(c.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance),c.$3=window.setTimeout(d,g))};d();break;case"callRated":this.$1.setRating(a.rating);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"callFeedbackSubmitted":this.$1.setFeedback(a.feedback);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"callSurveyChoiceSubmitted":this.$1.setSurveyChoice(a.surveyChoice);this.$1.save(b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance);break;case"logTSData":b("LsRtcTslogFalcoEvent").log(function(){return babelHelpers["extends"]({},c.$1.getLoggingArgs(),{time_series:a.time_series})});break;case"peerConnectionCreated":this.$1.setSdpFormat(a.sdpFormat);break}};return a}();e.exports=a},null);
__d("ZenonMWMessageLogger",["ZenonMWMessageTypes"],function(a,b,c,d,e,f){"use strict";f.logSentMessage=a;function a(a,c){a=a.jsonPayload;var d=a.body;a=a.header;switch(a.type){case b("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:d.joinRequest&&c({name:"inviteSent"});break}}},null);
__d("ZenonMWSendMessageMutation",["regeneratorRuntime","Promise","RelayFBEnvironment","RelayModern","ZenonMWSendMessageMutation.graphql"],function(a,b,c,d,e,f){"use strict";f.sendMessage=a;var g;function h(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:return c.abrupt("return",new(b("Promise"))(function(c,d){b("RelayModern").commitMutation(b("RelayFBEnvironment"),{mutation:g!==void 0?g:g=b("ZenonMWSendMessageMutation.graphql"),onCompleted:function(a){return c(a)},onError:function(a){return d(a)},variables:{input:{message:a}}})}));case 1:case"end":return c.stop()}},null,this)}function i(a){a=a.rtc_web_send_multiway_signaling_message;var b=null,c=null;a!=null&&(a.header!=null&&(b=JSON.parse(a.header)),a.body!=null&&(c=JSON.parse(a.body)));return{body:c,header:b}}function a(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(h(a));case 2:c=d.sent;return d.abrupt("return",i(c));case 4:case"end":return d.stop()}},null,this)}},null);
__d("ZenonMWMessageSender",["regeneratorRuntime","ZenonDebugLogger","ZenonMWMessageLogger","ZenonMWMessageTranslator","ZenonMWSendMessageMutation","ZenonMWTranslatorUtils","unrecoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.handleResponse=function(a){var c=a.header||null;a=a.body||null;var d=b("ZenonDebugLogger").getInstance();if(c!=null&&a!=null){c=b("ZenonMWTranslatorUtils").createMWMessage(c,a);d.logMWMessage("RECEIVED [GraphQL]",c);d.logReceivingMultiwayMessage(c);a=b("ZenonMWMessageTranslator").toSignalingMessage(c);if(this.$1!=null)this.$1(a),d.logProcessingMultiwayMessage(c);else throw b("unrecoverableViolation")("Should never have null message receiver","rtc_www")}};c.asyncSendMessage=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=b("ZenonDebugLogger").getInstance();c.logSendingMultiwayMessage(a);c.logMWMessage("SENDING",a);this.$2&&b("ZenonMWMessageLogger").logSentMessage(a,this.$2);e.prev=4;e.next=7;return b("regeneratorRuntime").awrap(b("ZenonMWSendMessageMutation").sendMessage(JSON.stringify(a)));case 7:d=e.sent;c.logSentMultiwayMessage(a);this.handleResponse(d);e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](4),c.logSendMultiwayMessageFailed(a);case 15:case"end":return e.stop()}},null,this,[[4,12]])};c.sendMessage=function(a){a=b("ZenonMWMessageTranslator").toMWMessage(a);a!=null&&this.asyncSendMessage(a)};c.setMessageReceiver=function(a){this.$1=a};c.setLoggingEventHandler=function(a){this.$2=a};return a}();e.exports=a},null);
__d("ZenonXControllerMWMessageSender",["regeneratorRuntime","Promise","AsyncRequest","XGroupCallSendRequestController","ZenonDebugLogger","ZenonMWMessageLogger","ZenonMWMessageTranslator","ZenonMWTranslatorUtils","err","unrecoverableViolation"],function(a,b,c,d,e,f){"use strict";var g=6e3;a=function(){function a(){}var c=a.prototype;c.handleResponse=function(a){a=a.payload;var c=a.header||null;a=a.body||null;var d=b("ZenonDebugLogger").getInstance();if(c!=null&&a!=null){c=b("ZenonMWTranslatorUtils").createMWMessage(c,a);d.logMultiwayResponseStartProcessing(c);d.logMWMessage("RECEIVED [XController]",c);d.logReceivingMultiwayMessage(c);a=b("ZenonMWMessageTranslator").toSignalingMessage(c);if(this.$1!=null)this.$1(a),d.logProcessingMultiwayMessage(c);else throw b("unrecoverableViolation")("Should never have null message receiver","rtc_www")}};c.asyncSendMessage=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=b("ZenonDebugLogger").getInstance();c.logMWMessage("SENDING [XController]",a);this.$2&&b("ZenonMWMessageLogger").logSentMessage(a,this.$2);e.prev=3;e.next=6;return b("regeneratorRuntime").awrap(this.$3(a));case 6:d=e.sent;this.handleResponse(d);e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),c.logSendMultiwayMessageFailed(a);case 13:case"end":return e.stop()}},null,this,[[3,10]])};c.$3=function(a){return new(b("Promise"))(function(c,d){var e=b("XGroupCallSendRequestController").getURIBuilder().getURI();b("ZenonDebugLogger").getInstance().logSendingMultiwayMessage(a);e=new(b("AsyncRequest"))(e).setMethod("POST").setData({request:JSON.stringify(a)}).setAllowCrossPageTransition(!0).setHandler(function(d){b("ZenonDebugLogger").getInstance().logSentMultiwayMessage(a),c(d)}).setErrorHandler(function(c){b("ZenonDebugLogger").getInstance().logSendMultiwayMessageFailedFromErrorHandler(a);c=c.getErrorDescription();c=new(b("err"))(c!=null?c.toString():"AsyncRequest error");d(c)}).setTimeoutHandler(g,function(){d("Timeout")});e.send()})};c.sendMessage=function(a){a=b("ZenonMWMessageTranslator").toMWMessage(a);a!=null&&this.asyncSendMessage(a)};c.setMessageReceiver=function(a){this.$1=a};c.setLoggingEventHandler=function(a){this.$2=a};return a}();e.exports=a},null);
__d("ZenonHybridMWMessageSender",["ZenonMWMessageSender","ZenonMWMessageTranslator","ZenonMWMessageTypes","ZenonXControllerMWMessageSender"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new(b("ZenonXControllerMWMessageSender"))(),this.$2=new(b("ZenonMWMessageSender"))()}var c=a.prototype;c.sendMessage=function(a){a=b("ZenonMWMessageTranslator").toMWMessage(a);a!=null&&(a.jsonPayload.header.type===b("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN?this.$1.asyncSendMessage(a):this.$2.asyncSendMessage(a))};c.setMessageReceiver=function(a){this.$1.setMessageReceiver(a),this.$2.setMessageReceiver(a)};c.setLoggingEventHandler=function(a){this.$1.setLoggingEventHandler(a),this.$2.setLoggingEventHandler(a)};return a}();e.exports=a},null);
__d("RpWebInfraActionsLoggerEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744334");c=b("FalcoLoggerInternal").create("rp_web_infra_actions_logger_event",a);e.exports=c},null);
__d("ZenonInfraActionManager",["ZenonCallInfoManager"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonInfraActionManager1="init",c.$ZenonInfraActionManager2="init",c.$ZenonInfraActionManager3="init",b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInfraActionData=function(a){var b,c=this.getParsedCallInfo(),d=c.callID,e=c.deviceID;c=c.peerID;var f=this.getCallInfo();f=f.serverInfoData;this.$ZenonInfraActionManager1=(b=a.connectionState)!=null?b:this.$ZenonInfraActionManager1;this.$ZenonInfraActionManager3=(b=a.peerConnectionState)!=null?b:this.$ZenonInfraActionManager3;this.$ZenonInfraActionManager2=(b=a.signalingState)!=null?b:this.$ZenonInfraActionManager2;return{call_id:d,checkpoint:a.checkpoint,connection:this.$ZenonInfraActionManager1,device_id:e,peer_connection:this.$ZenonInfraActionManager3,peer_id:c,server_info_data:f,signaling:this.$ZenonInfraActionManager2}};return b}(b("ZenonCallInfoManager"));e.exports=a},null);
__d("ZenonInfraActionLogProcessor",["RpWebInfraActionsLoggerEventFalcoEvent","ZenonInfraActionManager","ZenonSDESKeyDetector","unrecoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a){a.protocol!=="p2p"&&(a.peerID="MW_PEER_ID"),this.$1=new(b("ZenonInfraActionManager"))(a)}var c=a.prototype;c.log=function(a){var c=this;if(b("ZenonSDESKeyDetector")(a))throw b("unrecoverableViolation")("ZenonInfraActionLogProcessor event contains SDES crypto key! This log entry must be removed!","rtc_www");b("RpWebInfraActionsLoggerEventFalcoEvent").log(function(){return c.$1.getInfraActionData(a)})};c.processEvent=function(a){a.name==="infraAction"&&this.log(a)};return a}();e.exports=a},null);
__d("ZenonMultiwayReliabilityLogProcessor",["ChannelClientID","CurrentUser","RtcInfraReliabilityFalcoEvent"],function(a,b,c,d,e,f){"use strict";var g={version:"1",web_app_id:b("CurrentUser").getAppID(),web_device_id:b("ChannelClientID").getID()};a=function(){function a(a){a.protocol!=="p2p"&&(a.peerID="MW_PEER_ID"),this.$1=a.conferenceName,this.$3=a.signalingID,this.$2=a.serverInfoData}var c=a.prototype;c.processEvent=function(a){var c=this;switch(a.name){case"mediaConnected":b("RtcInfraReliabilityFalcoEvent").log(function(){return c.$4("RELAY_CONNECTED")});break;case"setRemoteSdpAnswer":b("RtcInfraReliabilityFalcoEvent").log(function(){return c.$4("SET_REMOTE_DESCRIPTION")});break}};c.$4=function(a){a=babelHelpers["extends"]({client_session_id:this.$3,conference_name:this.$1,event_name:a,server_info_data:this.$2,tc:Date.now().toString()},g);return a};return a}();e.exports=a},null);
__d("ZenonSignalingInitState",["setInterval"],function(a,b,c,d,e,f){"use strict";f.onReceiveInvite=a;f.onSendInvite=c;f.startPingTimer=d;var g=3e4;function a(a,b){if(b.type==="receiveInviteRequest"){a.onInviteReceived(b.payload,b.configuration);return{inviteMessageID:b.messageID}}return{}}function c(a,b){b.type==="sendInviteRequest"&&a.sendSignalingEvent(b.payload)}function d(a){if(!a.pingTimer){var c={eventName:"pingRequest"},d=b("setInterval")(function(){a.sendSignalingEvent(c)},g);return{pingTimer:d}}return{}}},null);
__d("ZenonSignalingInviteReceivedState",["FBLogger"],function(a,b,c,d,e,f){"use strict";f.onSendInviteResponse=a;function a(a,c){c.type==="sendInviteResponse"&&(a.inviteMessageID!=null?c.payload.status!=="OK"&&(c.payload.ackMessageId=a.inviteMessageID,a.sendSignalingEvent(c.payload)):b("FBLogger")("rtc_www").mustfix("onSendInviteResponse handler invoked without populated inviteMessageID in signaling state machine context."))}},null);
__d("ZenonSignalingNegotiationCompleteState",["ZenonMWMessageTypes"],function(a,b,c,d,e,f){"use strict";f.onReceiveAnswer=a;f.onReceiveMediaUpdateResponse=c;f.onSendMediaUpdateRequest=d;f._resetRetryCount=k;var g=6,h=null,i=1;function a(a,b){if(b.type==="receiveRemoteSdpRequest"){b=b.payload;var c=b.mediaStates;b=b.sdp;a.onSdpReceived(b,c);return{lastRemoteSdpVersion:b.version}}return{}}function c(a,c){if(c.type==="receiveMediaUpdateResponse"){var d=a.mediaUpdateRequestToSend,e=g<i,f=c.payload.responseSubCode===b("ZenonMWMessageTypes").ZenonMWResponseSubCode.REJECTING_CMU_WHEN_SMU_PENDING&&!e;if(d){k();return j(a,d)}else{f?(i++,c.payload.retryAfter!=null?h=window.setTimeout(function(){a.onMediaUpdateRetryRequested(),h=null},c.payload.retryAfter):a.onMediaUpdateRetryRequested()):e||k();return{isMediaUpdateResponsePending:!1}}}return{}}function d(a,b){if(b.type==="sendMediaUpdateRequest"){h!==null&&(window.clearTimeout(h),h=null,k());if(a.isMediaUpdateResponsePending===!0)return{mediaUpdateRequestToSend:b.payload};else return j(a,b.payload)}return{}}function j(a,b){a.sendSignalingEvent(b);return{isMediaUpdateResponsePending:!0,mediaUpdateRequestToSend:null}}function k(){i=1}},null);
__d("ZenonSignalingOfferSdpSentState",[],function(a,b,c,d,e,f){"use strict";f.onInviteResponseReceived=a;function a(a){a.logEvent({name:"inviteResponseReceived"})}},null);
__d("ZenonSignalingSMEvents",[],function(a,b,c,d,e,f){"use strict";f.getSendEvent=a;f.getReceiveEvent=b;function a(a){switch(a.eventName){case"addParticipantsRequest":return{payload:a,type:"sendAddParticipantsRequest"};case"addParticipantsResponse":return{payload:a,type:"sendAddParticipantsResponse"};case"answerIntentRequest":return{payload:a,type:"sendAnswerIntentRequest"};case"usersApprovalRequest":return{payload:a,type:"sendUsersApprovalRequest"};case"capabilitiesRequest":return{payload:a,type:"sendCapabilitiesRequest"};case"clientEventRequest":return{payload:a,type:"sendClientEventRequest"};case"clientInfoRequest":return{payload:a,type:"sendClientInfoRequest"};case"dismissResponse":return{payload:a,type:"sendDismissResponse"};case"iceCandidateRequest":return{payload:a,type:"sendIceCandidateRequest"};case"iceCandidateResponse":return{payload:a,type:"sendIceCandidateResponse"};case"initiateRenegotiationRequest":return null;case"initiateRenegotiationResponse":return{payload:a,type:"sendInitiateRenegotiationResponse"};case"inviteRequest":return{payload:a,type:"sendInviteRequest"};case"inviteResponse":return{payload:a,type:"sendInviteResponse"};case"localSdpRequest":return{payload:a,type:"sendLocalSdpRequest"};case"localSdpResponse":return{payload:a,type:"sendLocalSdpResponse"};case"mediaUpdateRequest":return{payload:a,type:"sendMediaUpdateRequest"};case"mediaUpdateResponse":return{payload:a,type:"sendMediaUpdateResponse"};case"overlayConfigServerUpdateRequest":return{payload:a,type:"sendOverlayConfigServerUpdateRequest"};case"participantUpdateRequest":return{payload:a,type:"sendParticipantUpdateRequest"};case"participantUpdateResponse":return{payload:a,type:"sendParticipantUpdateResponse"};case"pingResponse":return null;case"pingRequest":return{payload:a,type:"sendPingRequest"};case"remoteSdpRequest":return null;case"remoteSdpResponse":return{payload:a,type:"sendRemoteSdpResponse"};case"subscriptionRequest":return{payload:a,type:"sendSubscriptionRequest"};case"removeParticipantsRequest":return{payload:a,type:"sendRemoveParticipantsRequest"};case"stateSyncNotifyRequest":return null;case"stateSyncNotifyResponse":return{payload:a,type:"sendStateSyncNotifyResponse"};case"stateSyncUnsubscribeRequest":return{payload:a,type:"sendStateSyncUnsubscribeRequest"};case"stateSyncUnsubscribeResponse":return null;case"stateSyncUpdateRequest":return{payload:a,type:"sendStateSyncUpdateRequest"};case"stateSyncUpdateResponse":return null;case"terminateRequest":return{payload:a,type:"sendTerminateRequest"};case"hangupResponse":return null;case"roomContextUpdateRequest":return null;case"genericDataMessageRequest":return{payload:a,type:"sendGenericDataMessageRequest"};case"pendingApprovalRequest":return null;default:a;return null}}function b(a,b,c){switch(a.eventName){case"addParticipantsRequest":return{payload:a,type:"receiveAddParticipantsRequest"};case"addParticipantsResponse":return{payload:a,type:"receiveAddParticipantsResponse"};case"pendingApprovalRequest":return{configuration:c,messageID:b,payload:a,type:"receivePendingApprovalRequest"};case"answerIntentRequest":return null;case"clientEventRequest":return null;case"capabilitiesRequest":return{configuration:c,messageID:b,payload:a,type:"receiveCapabilitiesRequest"};case"clientInfoRequest":return{configuration:c,messageID:b,payload:a,type:"receiveClientInfoRequest"};case"dismissResponse":return{configuration:c,messageID:b,payload:a,type:"receiveDismissResponse"};case"iceCandidateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveIceCandidateRequest"};case"iceCandidateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveIceCandidateResponse"};case"initiateRenegotiationRequest":return{configuration:c,messageID:b,payload:a,type:"receiveInitiateRenegotiationRequest"};case"initiateRenegotiationResponse":return null;case"inviteRequest":return{configuration:c,messageID:b,payload:a,type:"receiveInviteRequest"};case"inviteResponse":return{configuration:c,messageID:b,payload:a,type:"receiveInviteResponse"};case"localSdpRequest":return null;case"localSdpResponse":return{configuration:c,messageID:b,payload:a,type:"receiveLocalSdpResponse"};case"mediaUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveMediaUpdateRequest"};case"mediaUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveMediaUpdateResponse"};case"overlayConfigServerUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveOverlayConfigServerUpdateRequest"};case"participantUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveParticipantUpdateRequest"};case"participantUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveParticipantUpdateResponse"};case"pingResponse":return{configuration:c,messageID:b,payload:a,type:"receivePingResponse"};case"pingRequest":return null;case"remoteSdpRequest":return{configuration:c,messageID:b,payload:a,type:"receiveRemoteSdpRequest"};case"remoteSdpResponse":return{configuration:c,messageID:b,payload:a,type:"receiveRemoteSdpResponse"};case"stateSyncNotifyRequest":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncNotifyRequest"};case"stateSyncNotifyResponse":return null;case"stateSyncUnsubscribeRequest":return null;case"stateSyncUnsubscribeResponse":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncUnsubscribeResponse"};case"stateSyncUpdateRequest":return null;case"stateSyncUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncUpdateResponse"};case"subscriptionRequest":return null;case"removeParticipantsRequest":return null;case"usersApprovalRequest":return null;case"terminateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveTerminateRequest"};case"hangupResponse":return{configuration:c,messageID:b,payload:a,type:"receiveHangupResponse"};case"roomContextUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveRoomContextUpdateRequest"};case"genericDataMessageRequest":return{configuration:c,messageID:b,payload:a,type:"receiveGenericDataMessageRequest"};default:a;return null}}},null);
__d("ZenonSignalingSharedActions",["ZenonSignalingTypes"],function(a,b,c,d,e,f){"use strict";f.genericEventSender=a;f.onReceiveCapabilitiesRequest=c;f.onReceiveClientInfoRequest=d;f.onReceiveGenericDataMessageRequest=e;f.onReceiveIceCandidateRequest=g;f.onReceiveInitiateRenegotiationRequest=h;f.onReceiveLocalSdpResponse=i;f.onReceiveParticipantUpdateRequest=j;f.onReceivePendingApprovalRequest=k;f.onReceiveRemoteSdpRequest=l;f.onReceiveRoomContextUpdateRequest=m;f.onReceiveStateSyncNotifyRequest=n;f.onReceiveTerminateRequest=o;f.onSendTerminateRequest=p;f.onSendUsersApprovalRequest=q;f.shouldRejectRequest=r;function a(a,b){a.sendSignalingEvent(b.payload)}function c(a,b){if(b.type==="receiveCapabilitiesRequest"){a.onCapabilitiesReceived(b.payload.capabilities,(a=b.payload.escalationConferenceName)!=null?a:null)}}function d(a,b){b.type==="receiveClientInfoRequest"&&a.onClientInfoReceived(b.payload.userCapabilities)}function e(a,b){b.type==="receiveGenericDataMessageRequest"&&a.onGenericDataMessageReceived(b.payload.topic,b.payload.data)}function g(a,b){if(b.type==="receiveIceCandidateRequest"){var c={ackMessageId:b.messageID,eventName:"iceCandidateResponse"};a.sendSignalingEvent(c);var d=a.onIceCandidateReceived;b.payload.iceCandidates.forEach(function(a){return d(a)})}}function h(a,c){var d;if(c.type!=="receiveInitiateRenegotiationRequest")return{};var e=r(a.lastRemoteSdpVersion,c.payload.fromVersion);d={ackMessageId:c.messageID,acknowledgedVersion:e?(d=a.lastRemoteSdpVersion)!=null?d:0:c.payload.version,eventName:"initiateRenegotiationResponse",status:e?b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus.REJECTED_FROM_VERSION_DOES_NOT_MATCH:b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus.OK};a.sendSignalingEvent(d);if(e)return{};a.signalingModel.getMediaModeManager().onSfuEscalated();a.onRenegotiationRequested();return s((d=a.lastRemoteSdpVersion)!=null?d:null,c.payload.version)}function i(a,b){if(b.type!=="receiveLocalSdpResponse")return;a.logEvent({hasAnswerInJoinResponse:b.payload.hasAnswerInJoinResponse,name:"setHasAnswerInJoinResponse"})}function j(a,b){if(b.type==="receiveParticipantUpdateRequest"){var c={ackMessageId:b.messageID,eventName:"participantUpdateResponse",requestVersionId:b.payload.versionId};a.sendSignalingEvent(c);a.onParticipantUpdateReceived(b.payload.participantStates)}}function k(a){a.onPendingApprovalReceived(),a.logEvent({name:"pendingApproval"})}function l(a,c){var d;if(c.type!=="receiveRemoteSdpRequest")return{};var e=r(a.lastRemoteSdpVersion,c.payload.fromVersion);if(((d=c.payload)==null?void 0:d.source)!=="joinResponse"){d={ackMessageId:c.messageID,acknowledgedVersion:e?a.lastRemoteSdpVersion:c.payload.sdp.version,eventName:"remoteSdpResponse",negotiateType:c.payload.negotiateType,status:e?b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus.REJECTED_FROM_VERSION_DOES_NOT_MATCH:b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus.OK,type:c.payload.sdp.type};a.sendSignalingEvent(d)}if(e)return{};a.onSdpReceived(c.payload.sdp,c.payload.mediaStates,c.payload.renegotiationOffer);return s((d=a.lastRemoteSdpVersion)!=null?d:null,c.payload.sdp.version)}function m(a,b){b.type==="receiveRoomContextUpdateRequest"&&a.onRoomContextUpdateReceived(b.payload.context)}function n(a,b){if(b.type!=="receiveStateSyncNotifyRequest")return;var c=a.signalingModel,d=b.payload,e=d.data,f=d.responseRequired,g=d.topic;d=d.version;c.getStateSyncStore().updateOutputState(g,{data:e,version:d});c.notify();if(f){e={ackMessageId:b.messageID,eventName:"stateSyncNotifyResponse",topic:g,version:d};a.sendSignalingEvent(e)}}function o(a,b){if(b.type==="receiveTerminateRequest"){if(b.payload.shouldInformPeer){var c={ackMessageId:b.messageID,eventName:"dismissResponse"};a.sendSignalingEvent(c)}a.onDismissReceived(a.signalingModel.getSignalingID(),b.payload.reason);b.payload.fromJoinResponse===!0&&a.logEvent({name:"inviteResponseReceived"})}}function p(a,b){b.type==="sendTerminateRequest"&&b.payload.shouldInformPeer&&a.sendSignalingEvent(b.payload)}function q(a,b){if(b.type!=="sendUsersApprovalRequest")return;a.sendSignalingEvent(b.payload)}function r(a,b){return a!=null&&b!=null&&a!==b}function s(a,b){return a==null||b>a?{lastRemoteSdpVersion:b}:{}}},null);
__d("ZenonSignalingSMGuards",["ZenonDebugLogger","ZenonSignalingSharedActions"],function(a,b,c,d,e,f){"use strict";f.sdpOfferReceiveNotRejectedGuard=a;f.sdpOfferReceiveRejectedGuard=c;f.sdpAnswerReceiveGuard=d;f.sdpAnswerSendGuard=e;f.sdpJoinResponseReceiveGuard=g;f.sdpOfferReceiveGuard=h;f.sdpOfferSendGuard=i;function a(a,c){a=c.type==="receiveRemoteSdpRequest"&&c.payload.sdp.type==="offer"&&b("ZenonSignalingSharedActions").shouldRejectRequest(a.lastRemoteSdpVersion,c.payload.fromVersion)===!1;b("ZenonDebugLogger").getInstance().logGuardsResults("sdpOfferReceiveNotRejectedGuard",a);return a}function c(a,c){a=c.type==="receiveRemoteSdpRequest"&&c.payload.sdp.type==="offer"&&b("ZenonSignalingSharedActions").shouldRejectRequest(a.lastRemoteSdpVersion,c.payload.fromVersion);b("ZenonDebugLogger").getInstance().logGuardsResults("sdpOfferReceiveRejectedGuard",a);return a}function d(a,c){a=c.type==="receiveRemoteSdpRequest"&&c.payload.sdp.type==="answer";b("ZenonDebugLogger").getInstance().logGuardsResults("sdpAnswerReceiveGuard",a);return a}function e(a,c){a=c.type==="sendLocalSdpRequest"&&c.payload.sdp.type==="answer";b("ZenonDebugLogger").getInstance().logGuardsResults("sdpAnswerSendGuard",a);return a}function g(a,c){a=c.type==="receiveLocalSdpResponse"&&c.payload.source==="joinResponse";b("ZenonDebugLogger").getInstance().logGuardsResults("sdpJoinResponseReceiveGuard",a);return a}function h(a,c){a=c.type==="receiveRemoteSdpRequest"&&c.payload.sdp.type==="offer";b("ZenonDebugLogger").getInstance().logGuardsResults("sdpOfferReceiveGuard",a);return a}function i(a,c){a=c.type==="sendLocalSdpRequest"&&c.payload.sdp.type==="offer";b("ZenonDebugLogger").getInstance().logGuardsResults("sdpOfferSendGuard",a);return a}},null);
__d("ZenonSignalingTerminatedState",["clearInterval"],function(a,b,c,d,e,f){"use strict";f.stopPingTimer=a;function a(a){if(a.pingTimer){b("clearInterval")(a.pingTimer);delete a.pingTimer;return a}return{}}},null);
__d("ZenonSignalingStateMachine",["ZenonDebugLogger","ZenonDeferrableStateMachine","ZenonSignalingInitState","ZenonSignalingInviteReceivedState","ZenonSignalingNegotiationCompleteState","ZenonSignalingOfferSdpSentState","ZenonSignalingSharedActions","ZenonSignalingSMEvents","ZenonSignalingSMGuards","ZenonSignalingTerminatedState","gkx","xstate"],function(a,b,c,d,e,f){"use strict";var g,h,i="SignalingStateMachine";a=function(){function a(a,c){var d=this;c===void 0&&(c="init");c=babelHelpers["extends"]({},B,{context:babelHelpers["extends"]({},a),initial:c});this.$1=b("ZenonDeferrableStateMachine").interpret(b("xstate").Machine(c,{guards:b("ZenonSignalingSMGuards")}));this.$1.onTransition(function(a){var c;b("ZenonDebugLogger").getInstance().logStateMachineTransition(i,a.changed,a.value,(c=a.history)==null?void 0:c.value,a.event.type,a.actions,d.$2().signalingModel.getSignalingID())});b("ZenonDebugLogger").getInstance().startQPL(64245348,+a.signalingModel.getSignalingID())}var c=a.prototype;c.processSendEvent=function(a){a=b("ZenonSignalingSMEvents").getSendEvent(a);a!=null&&this.$3(a)};c.processReceiveEvent=function(a,c,d){a=b("ZenonSignalingSMEvents").getReceiveEvent(a,c,d);a!=null&&this.$3(a)};c.$3=function(a){var c=this.$2().signalingModel.getSignalingID();this.$4(i,this.getState(),a.type,c);b("ZenonDebugLogger").getInstance().logStateMachine(i,this.getState(),a.type,c);this.$1.send(a)};c.$2=function(){return this.$1.state.context};c.getState=function(){var a=this.$1.state.toStrings();return a.length>0?this.$1.state.toStrings()[0]:"init"};c.$4=function(a,b,c,d){a=d==null?a:a+": "+d;d="["+a+"] [Current State: "+b+"] Processing event: "+c;this.$1.state.context.logEvent({checkpoint:""+d,name:"infraAction",signalingState:this.getState()})};return a}();e.exports=a;d={actions:[(c=b("ZenonSignalingSharedActions")).genericEventSender]};f={actions:[c.onReceiveTerminateRequest],target:"terminated"};e={actions:[c.genericEventSender]};a={actions:[c.genericEventSender]};var j={actions:[c.genericEventSender]},k={actions:[c.onReceiveCapabilitiesRequest]},l={actions:[c.onReceiveClientInfoRequest]},m={actions:[c.onReceiveGenericDataMessageRequest]},n={actions:[c.onReceiveIceCandidateRequest]},o={actions:[c.genericEventSender]},p={actions:[c.genericEventSender]},q={actions:[c.genericEventSender]},r={actions:[c.genericEventSender]},s={actions:[c.onSendTerminateRequest],target:"terminated"},t={actions:[c.genericEventSender]},u={actions:[c.onReceiveParticipantUpdateRequest]},v={actions:[c.onReceiveRoomContextUpdateRequest]},w={actions:[c.onReceiveStateSyncNotifyRequest]},x={actions:[c.genericEventSender]},y={actions:[c.genericEventSender]},z={actions:[c.onSendUsersApprovalRequest]},A={actions:["defer"]},B={initial:"init",states:{init:{on:{sendInviteRequest:{actions:[(g=b("xstate")).assign((h=b("ZenonSignalingInitState")).startPingTimer),h.onSendInvite],target:"inviteSent"},receiveInviteRequest:{target:"inviteReceived",actions:[g.assign(h.startPingTimer),g.assign(h.onReceiveInvite)]},receiveGenericDataMessageRequest:A,receiveIceCandidateRequest:A,sendGenericDataMessageRequest:A,receiveRoomContextUpdateRequest:v,receiveTerminateRequest:f,sendClientInfoRequest:d,sendRemoveParticipantsRequest:t,sendUsersApprovalRequest:z,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:A,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:r,sendTerminateRequest:s}},inviteSent:{on:{sendLocalSdpRequest:{actions:[c.genericEventSender],cond:(h=b("ZenonSignalingSMGuards")).sdpOfferSendGuard,target:"offerSdpSent"},sendIceCandidateRequest:A,receiveGenericDataMessageRequest:A,sendGenericDataMessageRequest:A,receiveIceCandidateRequest:n,receiveParticipantUpdateRequest:u,receiveRoomContextUpdateRequest:v,receiveTerminateRequest:f,sendCapabilitiesRequest:q,sendClientInfoRequest:d,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:A,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:r,sendTerminateRequest:s,sendUsersApprovalRequest:z}},offerSdpSent:{on:{receiveLocalSdpResponse:{actions:[g.assign(c.onReceiveLocalSdpResponse)],cond:h.sdpJoinResponseReceiveGuard,target:"offerSdpAcknowledged"},receivePendingApprovalRequest:A,receiveRemoteSdpRequest:A,receiveInitiateRenegotiationRequest:A,sendGenericDataMessageRequest:A,sendIceCandidateRequest:A,sendMediaUpdateRequest:A,receiveGenericDataMessageRequest:A,receiveCapabilitiesRequest:k,receiveClientInfoRequest:l,receiveIceCandidateRequest:n,receiveParticipantUpdateRequest:u,receiveRoomContextUpdateRequest:v,receiveTerminateRequest:f,sendAddParticipantsRequest:p,sendAnswerIntentRequest:e,sendUsersApprovalRequest:z,sendClientInfoRequest:d,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:A,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:r,sendTerminateRequest:s}},offerSdpAcknowledged:{on:{receivePendingApprovalRequest:{actions:[c.onReceivePendingApprovalRequest]},receiveRemoteSdpRequest:{actions:[b("ZenonSignalingOfferSdpSentState").onInviteResponseReceived,g.assign(c.onReceiveRemoteSdpRequest)],cond:h.sdpAnswerReceiveGuard,target:"negotiationComplete"},receiveInitiateRenegotiationRequest:{actions:[g.assign(c.onReceiveInitiateRenegotiationRequest)],target:"negotiationComplete"},sendGenericDataMessageRequest:A,sendMediaUpdateRequest:A,receiveGenericDataMessageRequest:A,sendIceCandidateRequest:j,receiveCapabilitiesRequest:k,receiveClientInfoRequest:l,receiveIceCandidateRequest:n,receiveParticipantUpdateRequest:u,receiveRoomContextUpdateRequest:v,receiveTerminateRequest:f,sendAddParticipantsRequest:p,sendAnswerIntentRequest:e,sendUsersApprovalRequest:z,sendClientInfoRequest:d,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:y,sendStateSyncUpdateRequest:x,sendSubscriptionRequest:r,sendTerminateRequest:s}},inviteReceived:{on:{sendInviteResponse:{actions:[b("ZenonSignalingInviteReceivedState").onSendInviteResponse],target:"inviteAcknowledged"},receiveCapabilitiesRequest:A,receiveClientInfoRequest:A,receiveGenericDataMessageRequest:A,receiveIceCandidateRequest:A,receiveParticipantUpdateRequest:A,receiveRemoteSdpRequest:A,sendGenericDataMessageRequest:A,receiveTerminateRequest:A,receiveRoomContextUpdateRequest:v,sendAnswerIntentRequest:e,sendIceCandidateRequest:j,sendUsersApprovalRequest:z,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:y,sendStateSyncUpdateRequest:x,sendSubscriptionRequest:r,sendTerminateRequest:s}},inviteAcknowledged:{on:{sendLocalSdpRequest:[{actions:[c.genericEventSender],cond:h.sdpOfferSendGuard,target:"offerSdpSent"},{actions:[c.genericEventSender],cond:h.sdpAnswerSendGuard,target:"negotiationComplete"}],receiveRemoteSdpRequest:{actions:[g.assign(c.onReceiveRemoteSdpRequest)],cond:h.sdpOfferReceiveGuard,target:"offerSdpReceived"},sendGenericDataMessageRequest:A,receiveGenericDataMessageRequest:A,receiveCapabilitiesRequest:k,receiveClientInfoRequest:l,receiveIceCandidateRequest:n,receiveParticipantUpdateRequest:u,receiveRoomContextUpdateRequest:v,receiveTerminateRequest:f,sendAnswerIntentRequest:e,sendClientInfoRequest:d,sendIceCandidateRequest:j,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:y,sendStateSyncUpdateRequest:x,sendSubscriptionRequest:r,sendTerminateRequest:s,sendUsersApprovalRequest:z}},offerSdpReceived:{on:{sendLocalSdpRequest:{actions:[c.genericEventSender],cond:h.sdpAnswerSendGuard,target:"negotiationComplete"},receiveRemoteSdpRequest:A,sendGenericDataMessageRequest:A,receiveGenericDataMessageRequest:A,receiveCapabilitiesRequest:k,receiveClientInfoRequest:l,receiveIceCandidateRequest:n,receiveParticipantUpdateRequest:u,receiveRoomContextUpdateRequest:v,receiveTerminateRequest:f,sendAnswerIntentRequest:e,sendCapabilitiesRequest:q,sendUsersApprovalRequest:z,sendClientInfoRequest:d,sendIceCandidateRequest:j,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:y,sendStateSyncUpdateRequest:x,sendSubscriptionRequest:r,sendTerminateRequest:s}},negotiationComplete:{on:{receiveInitiateRenegotiationRequest:{actions:[g.assign(c.onReceiveInitiateRenegotiationRequest)]},receiveLocalSdpResponse:{actions:[g.assign(c.onReceiveLocalSdpResponse)],cond:h.sdpJoinResponseReceiveGuard},receiveMediaUpdateResponse:{actions:[g.assign(b("ZenonSignalingNegotiationCompleteState").onReceiveMediaUpdateResponse)]},receivePendingApprovalRequest:{actions:[c.onReceivePendingApprovalRequest]},receiveRemoteSdpRequest:b("gkx")("1774104")?[{actions:[b("xstate").assign(b("ZenonSignalingSharedActions").onReceiveRemoteSdpRequest)],cond:b("ZenonSignalingSMGuards").sdpOfferReceiveNotRejectedGuard,target:"renegotiating"},{actions:[b("xstate").assign(b("ZenonSignalingSharedActions").onReceiveRemoteSdpRequest)],cond:b("ZenonSignalingSMGuards").sdpOfferReceiveRejectedGuard},{actions:[b("xstate").assign(b("ZenonSignalingNegotiationCompleteState").onReceiveAnswer)],cond:b("ZenonSignalingSMGuards").sdpAnswerReceiveGuard}]:[{actions:[b("xstate").assign(b("ZenonSignalingSharedActions").onReceiveRemoteSdpRequest)],cond:b("ZenonSignalingSMGuards").sdpOfferReceiveGuard,target:"renegotiating"},{actions:[b("xstate").assign(b("ZenonSignalingNegotiationCompleteState").onReceiveAnswer)],cond:b("ZenonSignalingSMGuards").sdpAnswerReceiveGuard}],sendLocalSdpRequest:[{actions:[b("ZenonSignalingSharedActions").genericEventSender],cond:b("ZenonSignalingSMGuards").sdpOfferSendGuard,target:"renegotiating"},{actions:[b("ZenonSignalingSharedActions").genericEventSender],cond:b("ZenonSignalingSMGuards").sdpAnswerSendGuard}],sendMediaUpdateRequest:{actions:[b("xstate").assign(b("ZenonSignalingNegotiationCompleteState").onSendMediaUpdateRequest)]},sendPingRequest:{actions:[b("ZenonSignalingSharedActions").genericEventSender]},receiveCapabilitiesRequest:k,receiveClientInfoRequest:l,receiveGenericDataMessageRequest:m,receiveIceCandidateRequest:n,receiveParticipantUpdateRequest:u,receiveRoomContextUpdateRequest:v,receiveTerminateRequest:f,sendAddParticipantsRequest:p,sendGenericDataMessageRequest:a,sendIceCandidateRequest:j,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:y,sendStateSyncUpdateRequest:x,sendSubscriptionRequest:r,sendTerminateRequest:s,sendUsersApprovalRequest:z,sendClientEventRequest:o}},renegotiating:{on:{sendLocalSdpRequest:[{actions:[b("ZenonSignalingSharedActions").genericEventSender],cond:b("ZenonSignalingSMGuards").sdpOfferSendGuard},{actions:[b("ZenonSignalingSharedActions").genericEventSender],cond:b("ZenonSignalingSMGuards").sdpAnswerSendGuard,target:"negotiationComplete"}],receiveRemoteSdpRequest:[{actions:["defer"],cond:b("ZenonSignalingSMGuards").sdpOfferReceiveGuard},{actions:[b("xstate").assign(b("ZenonSignalingSharedActions").onReceiveRemoteSdpRequest)],cond:b("ZenonSignalingSMGuards").sdpAnswerReceiveGuard,target:"negotiationComplete"}],receiveLocalSdpResponse:A,sendMediaUpdateRequest:A,receiveMediaUpdateResponse:A,receiveCapabilitiesRequest:k,receiveClientInfoRequest:l,receiveGenericDataMessageRequest:m,receiveIceCandidateRequest:n,receiveParticipantUpdateRequest:u,receiveRoomContextUpdateRequest:v,sendUsersApprovalRequest:z,receiveTerminateRequest:f,sendAddParticipantsRequest:p,sendIceCandidateRequest:j,sendRemoveParticipantsRequest:t,receiveStateSyncNotifyRequest:w,sendStateSyncUnsubscribeRequest:y,sendStateSyncUpdateRequest:x,sendSubscriptionRequest:r,sendTerminateRequest:s,sendGenericDataMessageRequest:a,sendClientEventRequest:o}},terminated:{entry:[b("xstate").assign(b("ZenonSignalingTerminatedState").stopPingTimer)]}}}},null);
__d("ZenonSignalingClient",["ZenonSignalingStateMachine","recoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e){var f=this;this.$5=null;this.$6=function(){};this.$1=a;var g=this.$7();this.$2=new(b("ZenonSignalingStateMachine"))(babelHelpers["extends"]({logEvent:function(a){return f.$6(a)},onInviteReceived:function(a,b){e(a,b,f)},sendSignalingEvent:function(a){return d.sendEvent(a)}},g,{signalingModel:a}));c.setReceiver(function(a,b,c){return f.$2.processReceiveEvent(a,b,c)});this.$3=c;this.$4=d}var c=a.prototype;c.getSignalingModel=function(){return this.$1};c.sendInvite=function(a,b){b={eventName:"inviteRequest",inviterID:"0",isRemoteOfferer:!1,otherParticipants:a,requestingVideo:!1,roomInfo:{name:"mock"}};this.$2.processSendEvent(b)};c.sendSdp=function(a,b){b={eventName:"localSdpRequest",mediaStates:b,sdp:a};this.$2.processSendEvent(b)};c.sendIceCandidate=function(a){a={eventName:"iceCandidateRequest",iceCandidates:[a]};this.$2.processSendEvent(a)};c.sendClientEvent=function(a){a={clientEventType:a,eventName:"clientEventRequest"};this.$2.processSendEvent(a)};c.sendDismiss=function(a){this.$6({name:"dismissSent"});a={eventName:"terminateRequest",fromJoinResponse:!1,reason:a,shouldInformPeer:!0};this.$2.processSendEvent(a)};c.sendGenericDataMessage=function(a,b,c,d){b={data:b,eventName:"genericDataMessageRequest",recipientIDs:c,serviceRecipients:d,topic:a};this.$2.processSendEvent(b)};c.sendMediaUpdate=function(a){a={eventName:"mediaUpdateRequest",mediaStates:a};this.$2.processSendEvent(a)};c.sendAddParticipantsMessage=function(a){a={eventName:"addParticipantsRequest",participants:a};this.$2.processSendEvent(a)};c.sendRemoveParticipantsRequest=function(a){a={eventName:"removeParticipantsRequest",participants:a};this.$2.processSendEvent(a)};c.sendUsersApprovalRequest=function(a,b){a={approvalStatus:a,eventName:"usersApprovalRequest",targetUsers:b};this.$2.processSendEvent(a)};c.sendClientInfo=function(a,b){var c=this,d;b&&(d=new Map(),b.forEach(function(a,b){d.set(b,c.getSignalingModel().getStateSyncStore().updateInputState(b,a))}));b={eventName:"clientInfoRequest",initialSyncStates:d,userCapabilities:a};this.$2.processSendEvent(b)};c.sendStateSyncUnsubscribe=function(a){var b=this.getSignalingModel(),c=b.getStateSyncStore().unsubscribe(a);a={eventName:"stateSyncUnsubscribeRequest",topic:a,version:c.version};this.$2.processSendEvent(a);b.notify()};c.sendStateSyncUpdate=function(a,b){var c=this.getSignalingModel();b=c.getStateSyncStore().updateInputState(a,b);a={data:b.data!=null?b.data:void 0,eventName:"stateSyncUpdateRequest",topic:a,version:b.version};this.$2.processSendEvent(a);c.notify()};c.sendSubscriptionRequest=function(a){a={eventName:"subscriptionRequest",subscriptions:a};this.$2.processSendEvent(a)};c.receiveMessage=function(a){var b=a.getHeader();b=b.remoteSignalingID;b!=null&&this.$1.getRemoteSignalingID()!==b&&(this.$1.updateRemoteSignalingID(b),this.$6({name:"setRemoteSignalingID",remoteSignalingID:b}),this.$1.notify());this.$3.receiveMessage(a)};c.isTerminated=function(){return this.$2.getState()==="terminated"};c.sendAnswerIntent=function(){var a={eventName:"answerIntentRequest"};this.$2.processSendEvent(a)};c.respondToInvite=function(a){a={ackMessageId:"",eventName:"inviteResponse",status:a};this.$2.processSendEvent(a)};c.setSignalingEventHandlers=function(a){if(this.$5!=null){b("recoverableViolation")("setSignalingEventHandlers should only be called once, to avoid accidentally losing handlers.","rtc_www");return}this.$5=a};c.setLoggingEventHandler=function(a){this.$6=a,this.$3.setLoggingEventHandler(a)};c.$7=function(){return{onCapabilitiesReceived:this.$8("onCapabilitiesReceived"),onClientInfoReceived:this.$8("onClientInfoReceived"),onDismissReceived:this.$8("onDismissReceived"),onGenericDataMessageReceived:this.$8("onGenericDataMessageReceived"),onIceCandidateReceived:this.$8("onIceCandidateReceived"),onInviteAcknowledgeSent:this.$8("onInviteAcknowledgeSent"),onMediaUpdateRetryRequested:this.$8("onMediaUpdateRetryRequested"),onParticipantUpdateReceived:this.$8("onParticipantUpdateReceived"),onPendingApprovalReceived:this.$8("onPendingApprovalReceived"),onRenegotiationRequested:this.$8("onRenegotiationRequested"),onRoomContextUpdateReceived:this.$8("onRoomContextUpdateReceived"),onSdpReceived:this.$8("onSdpReceived")}};c.$8=function(a){var b=this;return function(){if(b.$5&&b.$5[a]){var c;(c=b.$5)[a].apply(c,arguments)}}};return a}();e.exports=a},null);
__d("ZenonMWEventAggregator",["ZenonSignalingMessage","ZenonSignalingTypes","gkx","randomInt"],function(a,b,c,d,e,f){"use strict";var g=250;a=function(){function a(a,b){this.$3={},this.$4={},this.$5=0,this.$6=!1,this.$7=null,this.$8=null,this.$1=a,this.$2=b}var c=a.prototype;c.sendEvent=function(a){var c=[];switch(a.eventName){case"clientInfoRequest":this.$3.clientInfoRequest=a;c=this.$9();break;case"inviteRequest":this.$3.inviteRequest=a;c=this.$9();break;case"localSdpRequest":a.sdp.type==="offer"?this.$6?c=[a]:(this.$3.localSdpRequest=a,this.$6=!0,c=this.$9()):a.sdp.type==="answer"&&(this.$6?(this.$4.localSdpRequest=a,c=this.$10()):(this.$3.localSdpRequest=a,this.$6=!0,c=this.$9()));break;case"remoteSdpResponse":a.type==="offer"?a.status===b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus.OK?(this.$4.remoteSdpResponse=a,c=this.$10()):(this.$4={},c=[a]):c=[a];break;case"iceCandidateRequest":case"pingRequest":this.$1.getMediaModeManager().getMediaMode()==="p2p"&&(c=[a]);break;case"subscriptionRequest":!b("gkx")("1414812")?c=[a]:c=this.$11(a);break;case"usersApprovalRequest":case"iceCandidateResponse":case"addParticipantsRequest":case"dismissResponse":case"genericDataMessageRequest":case"initiateRenegotiationResponse":case"inviteResponse":case"mediaUpdateRequest":case"participantUpdateResponse":case"removeParticipantsRequest":case"stateSyncNotifyResponse":case"stateSyncUnsubscribeRequest":case"stateSyncUpdateRequest":case"terminateRequest":case"clientEventRequest":c=[a];break}this.$12(c,a)};c.$13=function(a){return{messageID:(a=a)!=null?a:String(b("randomInt")(0,4294967294)+1),protocol:this.$1.getProtocol(),remoteInfo:this.$1.getRemoteInfo(),remoteSignalingID:this.$1.getRemoteSignalingID(),retryCount:0,roomInfo:this.$1.getRoomInfo(),sequenceNumber:this.$5++,signalingID:this.$1.getSignalingID(),userInfo:this.$1.getUserInfo()}};c.$9=function(){var a=this.$3,b=a.clientInfoRequest,c=a.inviteRequest;a=a.localSdpRequest;if(b!=null&&a!=null){this.$3={};return c!=null?[c,b,a]:[b,a]}return[]};c.$10=function(){var a=this.$4,b=a.localSdpRequest;a=a.remoteSdpResponse;if(a&&b){this.$4={};return[a,b]}return[]};c.$11=function(a){var b=this,c=[];this.$7!=null?this.$8=a:(c=[a],this.$7=window.setTimeout(function(){b.$8!=null&&(b.$12([b.$8],b.$8),b.$8=null),window.clearTimeout(b.$7),b.$7=null},g));return c};c.$12=function(a,c){if(a.length>0){c=(c=c.ackMessageId)!=null?c:(c=a.find(function(a){return a.ackMessageId}))==null?void 0:c.ackMessageId;c=this.$13(c);c=new(b("ZenonSignalingMessage"))(c,a);this.$2.sendMessage(c)}};return a}();e.exports=a},null);
__d("ZenonMWMessageSenderFactory",["ZenonMWMessageSender"],function(a,b,c,d,e,f){"use strict";f.createMWMessageSender=a;function a(){return new(b("ZenonMWMessageSender"))()}},null);
__d("ZenonP2PEventAggregator",["ZenonSignalingMessage","randomInt"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$3={},this.$1=a,this.$2=b}var c=a.prototype;c.sendEvent=function(a){var c;c=(c=a.ackMessageId)!=null?c:null;c=this.$4(c);var d=[];switch(a.eventName){case"answerIntentRequest":this.$5();break;case"inviteResponse":this.$3.inviteResponse=a;d=this.$6();break;case"remoteSdpResponse":this.$3.remoteSdpResponse=a;d=this.$6();break;case"terminateRequest":this.$5();d.push(a);break}if(d.length>0){a=new(b("ZenonSignalingMessage"))(c,d);this.$2.sendMessage(a)}};c.setRemoteSignalingID=function(a){};c.$5=function(){var a=this.$4(null);a.remoteInfo={userID:a.userInfo.userID};var c={eventName:"answerIntentRequest"};a=new(b("ZenonSignalingMessage"))(a,[c]);this.$2.sendMessage(a)};c.$4=function(a){return{messageID:(a=a)!=null?a:String(b("randomInt")(0,4294967294)+1),protocol:this.$1.getProtocol(),remoteInfo:this.$1.getRemoteInfo(),retryCount:0,roomInfo:this.$1.getRoomInfo(),signalingID:this.$1.getSignalingID(),userInfo:this.$1.getUserInfo()}};c.$6=function(){var a=this.$3,b=a.inviteResponse;a=a.remoteSdpResponse;if(b!=null&&a!=null){this.$3={};return[b,a]}return[]};return a}();e.exports=a},null);
__d("ZenonP2PSendMessageMutation",["regeneratorRuntime","Promise","RelayFBEnvironment","RelayModern","ZenonP2PSendMessageMutation.graphql"],function(a,b,c,d,e,f){"use strict";f.sendMessage=a;var g;function h(a,c,d){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new(b("Promise"))(function(e,f){b("RelayModern").commitMutation(b("RelayFBEnvironment"),{mutation:g!==void 0?g:g=b("ZenonP2PSendMessageMutation.graphql"),onCompleted:function(a){return e(a)},onError:function(a){return f(a)},variables:{input:{message:a,msg_id:d,recipient_id:c}}})}));case 1:case"end":return e.stop()}},null,this)}function a(a,c,d){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(h(a,c,d));case 2:f=g.sent;return g.abrupt("return",(e=f.rtc_web_send_p2p_signaling_message)!=null?e:!1);case 4:case"end":return g.stop()}},null,this)}},null);
__d("ZenonP2PMessageSender",["ZenonP2PMessageTranslator","ZenonP2PSendMessageMutation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.sendMessage=function(a){var c=b("ZenonP2PMessageTranslator").toP2PMessage(a);if(c!=null){a=a.getHeader();var d=a.remoteInfo.userID;a=a.messageID;b("ZenonP2PSendMessageMutation").sendMessage(JSON.stringify(c),d,a)}};c.setMessageReceiver=function(a){};c.setLoggingEventHandler=function(a){};return a}();e.exports=a},null);
__d("ZenonTransaction",["clearInterval","recoverableViolation","requireCond","setInterval","cr:1577681","cr:1577682","cr:1577683","$InternalEnum"],function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["WaitingSendOrReceiveMessageState","RequestProcessingState","ResponseProcessingState","Terminated"]),h=3*1e3,i=60*1e3;a=function(){function a(a,b,c,d){this.$8=0,this.$2=a,this.$3=b,this.$1=g.WaitingSendOrReceiveMessageState,this.$9=c,this.$10=d}var c=a.prototype;c.$11=function(){var a=this;if(this.$1!==g.RequestProcessingState){b("recoverableViolation")("Should never startRetryTimer in non-REQUEST_PROCESSING state: "+this.$1,"rtc_www");return}this.$12();this.$6=b("setInterval")(function(){a.$13()},h)};c.$14=function(){var a=this;if(this.$1!==g.RequestProcessingState){b("recoverableViolation")("Should never startTerminateTimer in non-REQUEST_PROCESSING state: "+this.$1,"rtc_www");return}this.$15();this.$7=b("setInterval")(function(){a.$16(),b("cr:1577681")&&a.$17(b("cr:1577681").FAIL)},i)};c.$13=function(){if(this.$1===g.Terminated){b("recoverableViolation")("Should never call onRetryTimer with transaction terminated.","rtc_www");return}if(this.$1!==g.RequestProcessingState){b("recoverableViolation")("Should never call onRetryTimer in non-REQUEST_PROCESSING state: "+this.$1+" for messageId: "+this.$2,"rtc_www");return}if(this.$4===null||this.$4===void 0){b("recoverableViolation")("Request should not be null or undefined when calling onRetryTimer","rtc_www");return}this.$8++;this.$4.setRetryCount(this.$8);this.$4!==null&&this.$4!==void 0&&this.$9(this.$4);this.$11()};c.$12=function(){b("clearInterval")(this.$6)};c.$15=function(){b("clearInterval")(this.$7)};c.$16=function(){this.$12(),this.$15(),this.$1=g.Terminated};c.$18=function(a){return isNaN(+a)?0:+a};c.$19=function(){b("cr:1577682")&&b("cr:1577683")&&b("cr:1577682").markerStart(b("cr:1577683").ZENON_TRANSACTION,this.$18(this.$2))};c.$17=function(a){b("cr:1577682")&&b("cr:1577683")&&b("cr:1577682").markerEnd(b("cr:1577683").ZENON_TRANSACTION,a,this.$18(this.$2))};c.$20=function(a,c){if(b("cr:1577682")&&b("cr:1577683")&&a){var d,e=this.$3.getSignalingID();d=(d=this.$3.getRemoteSignalingID())!=null?d:"";var f=this.$3.getUserInfo().userID,g=this.$3.getRoomInfo().name,h=this.$3.getProtocol();b("cr:1577682").markerPoint(b("cr:1577683").ZENON_TRANSACTION,a,{data:{"int":{retryCount:c},string:{protocol:h,remoteSignalingID:d,roomName:g,signalingID:e,userID:f}},instanceKey:this.$18(this.$2)})}};c.sendMessage=function(a){var c,d=a.getHeader().retryCount;switch(this.$1){case g.WaitingSendOrReceiveMessageState:this.$19();this.$4=a;this.$1=g.RequestProcessingState;this.$9(this.$4);this.$11();this.$14();break;case g.RequestProcessingState:b("recoverableViolation")("Zenon should not generate an outgoing request more than once.","rtc_www");break;case g.ResponseProcessingState:this.$20((c=a.getEvents()[0])==null?void 0:c.eventName,d);if(this.$5===null||this.$5===void 0){this.$5=a;this.$9(this.$5);return}b("recoverableViolation")("Zenon should not generate a response to an incoming request more than once.","rtc_www");break;case g.Terminated:b("cr:1577681")&&this.$17(b("cr:1577681").SUCCESS);break}};c.receiveMessage=function(a){var c,d=a.getHeader().retryCount;switch(this.$1){case g.WaitingSendOrReceiveMessageState:this.$19();this.$4=a;this.$1=g.ResponseProcessingState;this.$10(a);break;case g.RequestProcessingState:this.$20((c=a.getEvents()[0])==null?void 0:c.eventName,d);this.$16();this.$10(a);break;case g.ResponseProcessingState:this.$20((c=a.getEvents()[0])==null?void 0:c.eventName,d);this.$5!==null&&this.$5!==void 0&&(this.$9(this.$5),this.$20("send_back_same_response",d));break;case g.Terminated:b("cr:1577681")&&this.$17(b("cr:1577681").SUCCESS);break}};return a}();e.exports=a},null);
__d("ZenonTransactionManager",["ZenonTransaction"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$4=function(){},this.$3=new Map(),this.$1=a,this.$2=b}var c=a.prototype;c.$5=function(a){var c=this;if(this.$3.has(a))return this.$3.get(a);this.$3.set(a,new(b("ZenonTransaction"))(a,this.$2,function(a){c.$1.sendMessage(a)},function(a){var b=a.getHeader(),d=b.messageID,e=b.protocol;b=a.getEvents();b.forEach(function(a){return c.$4(a,d,e)})}));return this.$3.get(a)};c.sendMessage=function(a){var b=a.getHeader();b=b.messageID;b=this.$5(b);b!==void 0&&b!==null&&b.sendMessage(a)};c.receiveMessage=function(a){var b=a.getHeader();b=b.messageID;b=this.$5(b);b!==void 0&&b!==null&&b.receiveMessage(a)};c.setReceiver=function(a){this.$4=a};c.setLoggingEventHandler=function(a){this.$1.setLoggingEventHandler(a)};return a}();e.exports=a},null);
__d("ZenonProtocolConfiguration",["ZenonMWEventAggregator","ZenonMWMessageSenderFactory","ZenonP2PEventAggregator","ZenonP2PMessageSender","ZenonTransactionManager"],function(a,b,c,d,e,f){"use strict";f.getConfiguration=a;function a(a,c){c===void 0&&(c=null);var d,e,f;if(a.getProtocol()==="p2p")d=new(b("ZenonP2PMessageSender"))(),e=new(b("ZenonTransactionManager"))(d,a),f=new(b("ZenonP2PEventAggregator"))(a,e);else{d=(c=c)!=null?c:b("ZenonMWMessageSenderFactory").createMWMessageSender();e=new(b("ZenonTransactionManager"))(d,a);f=new(b("ZenonMWEventAggregator"))(a,e)}return{eventAggregator:f,messageSender:d,transactionManager:e}}},null);
__d("ZenonMediaModeManager",["$InternalEnum"],function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["MwCaller","MwCallee","MwppCaller","MwppCallee"]);a=function(){function a(){this.$1="sfu"}var b=a.prototype;b.onJoin=function(a,b,c,d){a=this.$2(a,b,c,d);switch(a){case g.MwppCaller:case g.MwppCallee:this.$3("p2p");return;case g.MwCaller:case g.MwCallee:this.$3("sfu");return}};b.onSfuEscalated=function(){this.$3("sfu")};b.getMediaMode=function(){return this.$1};b.$3=function(a){this.$1=a};b.$2=function(a,b,c,d){return a?b&&c===1?g.MwppCaller:g.MwCaller:b&&d?g.MwppCallee:g.MwCallee};return a}();e.exports=a},null);
__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],function(a,b,c,d,e,f){var g=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),h=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:g.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:g.CT_BOOLEAN_FALSE}),i=[g.CT_STOP,0,g.CT_BOOLEAN_TRUE,g.CT_BYTE,g.CT_DOUBLE,0,g.CT_I16,0,g.CT_I32,0,g.CT_I64,g.CT_BINARY,g.CT_STRUCT,g.CT_MAP,g.CT_SET,g.CT_LIST,0,0,0,g.CT_FLOAT],j=Math.pow(2,7)-1,k=-1*Math.pow(2,7),l=Math.pow(2,15)-1,m=-1*Math.pow(2,15),n=Math.pow(2,31)-1,o=-1*Math.pow(2,31),p=Math.pow(2,32)-1,q=(a=b("jsbi")).BigInt("9223372036854775807"),r=a.BigInt("-9223372036854775808"),s=a.BigInt("18446744073709551615"),t=a.BigInt(63),u=a.BigInt(1),v=a.BigInt(0),w=a.BigInt(7),x=a.BigInt(70),y=a.BigInt(127),z=a.BigInt(128),A=Math.pow(2,4);c=function(){function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var c=a.prototype;c.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};c.readStructEnd=function(){this.$3=this.$2.pop()};c.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};c.writeStructEnd=function(){this.$3=this.$2.pop();return 0};c.writeFieldBegin=function(a){if(a.ftype===b("ThriftTypes").BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,h.NONE)};c.writeListBegin=function(a){return this.$8(a)};c.writeSetBegin=function(a){return this.$8(a)};c.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};c.$7=function(a,b){var c=0;b=b===h.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=A-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};c.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=A-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};c.readFieldBegin=function(){var a=this.$1.readByte(),c=a&15;if(c===b("ThriftTypes").STOP)return{ftype:b("ThriftTypes").STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(c);(c===g.CT_BOOLEAN_TRUE||c===g.CT_BOOLEAN_FALSE)&&(this.$5=c===g.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};c.readListBegin=function(){return this.$11()};c.readSetBegin=function(){return this.$11()};c.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};c.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};c.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};c.readFieldEnd=function(){};c.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};c.writeByte=function(a){if(a<k||a>j)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};c.readFloat=function(){return this.$1.readFloatBE()};c.writeFloat=function(a){return this.$1.writeFloatBE(a)};c.readDouble=function(){return this.$1.readDoubleBE()};c.writeDouble=function(a){return this.$1.writeDoubleBE(a)};c.writeString=function(a){return this.writeBinary(b("StringToUtf8").StringToUtf8(a))};c.skip=function(a){switch(a){case b("ThriftTypes").STOP:return;case b("ThriftTypes").BOOL:this.readBool();break;case b("ThriftTypes").BYTE:this.readByte();break;case b("ThriftTypes").DOUBLE:this.readDouble();break;case b("ThriftTypes").I16:this.readI16();break;case b("ThriftTypes").I32:this.readI32();break;case b("ThriftTypes").I64:this.readI64();break;case b("ThriftTypes").STRING:this.readString();break;case b("ThriftTypes").STRUCT:this.readStructBegin();var c;while(!0){c=this.readFieldBegin();if(c.ftype===b("ThriftTypes").STOP)break;this.skip(c.ftype)}this.readStructEnd();break;case b("ThriftTypes").MAP:c=this.readMapBegin();if(c.size>0&&c.ktype!=null&&c.vtype!=null){var d=c.ktype,e=c.vtype;for(var f=0;f<c.size;f++)this.skip(d),this.skip(e)}break;case b("ThriftTypes").SET:case b("ThriftTypes").LIST:f=this.$11();for(var d=0;d<f.size;d++)this.skip(f.etype);break;case b("ThriftTypes").FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};c.toByteArray=function(){return this.$1.toByteArray()};c.writeFieldStop=function(){return this.$1.writeByte(b("ThriftTypes").STOP)};c.writeI16=function(a){if(a<m||a>l)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};c.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<m||a>l)throw new Error("read invalid i16: "+a);return a};c.writeI32=function(a){if(a<o||a>n)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};c.readI32=function(){return this.zigzagToI32(this.readVarint32())};c.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};c.readI64=function(){return this.zigzagToI64(this.readVarint64())};c.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===g.CT_BOOLEAN_TRUE;return a};c.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?h.CT_BOOLEAN_TRUE:h.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?g.CT_BOOLEAN_TRUE:g.CT_BOOLEAN_FALSE);return b};c.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};c.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};c.i32ToZigzag=function(a){if(a<o||a>n)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};c.zigzagToI32=function(a){if(a<0||a>p)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};c.i64ToZigzag=function(a){if(b("jsbi").greaterThan(a,q)||b("jsbi").lessThan(a,r))throw new Error("i64 out of range: "+a.toString());return b("jsbi").bitwiseXor(b("jsbi").signedRightShift(a,t),b("jsbi").leftShift(a,u))};c.zigzagToI64=function(a){if(b("jsbi").lessThan(a,0)||b("jsbi").greaterThan(a,s))throw new Error("invalid uint64: "+a.toString());return b("jsbi").equal(b("jsbi").bitwiseAnd(a,u),u)?b("jsbi").bitwiseNot(b("jsbi").signedRightShift(a,u)):b("jsbi").signedRightShift(a,u)};c.writeVarint32=function(a){if(a<0||a>p)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};c.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};c.writeVarint64=function(a){if(b("jsbi").lessThan(a,v)||b("jsbi").greaterThan(a,s))throw new Error("invalid uint64: "+a.toString());a=a;var c=0;while(!0)if(b("jsbi").equal(b("jsbi").signedRightShift(a,w),v)){this.$1.writeByte(b("jsbi").toNumber(a));c++;break}else{var d,e=(d=b("jsbi")).toNumber(d.bitwiseOr(d.bitwiseAnd(a,y),z));this.$1.writeByte(e);c++;a=d.signedRightShift(a,w)}return c};c.readVarint64=function(){var a=v,c=v,d;while(!0){var e;d=(e=b("jsbi")).BigInt(this.$1.readByte());a=e.bitwiseOr(a,e.leftShift(e.bitwiseAnd(d,y),c));c=e.add(c,w);if(b("jsbi").equal(b("jsbi").bitwiseAnd(d,z),v)){if(b("jsbi").equal(c,x)&&b("jsbi").notEqual(d,u))throw new Error("result exceeded 64 bit limit");break}if(b("jsbi").greaterThan(c,t))throw new Error("result exceeded 64 bit limit")}return a};c.readString=function(){return b("Utf8ToString").Utf8ToString(this.readBinary())};c.getLastFieldId=function(){return this.$3};c.getLastField=function(){return this.$2};c.getBooleanFieldInfo=function(){return this.$4};c.getBooleanValue=function(){return this.$5};c.$9=function(a){return i[a]};c.$10=function(a){switch(a){case g.CT_STOP:return b("ThriftTypes").STOP;case g.CT_BOOLEAN_FALSE:case g.CT_BOOLEAN_TRUE:return b("ThriftTypes").BOOL;case g.CT_BYTE:return b("ThriftTypes").BYTE;case g.CT_I16:return b("ThriftTypes").I16;case g.CT_I32:return b("ThriftTypes").I32;case g.CT_I64:return b("ThriftTypes").I64;case g.CT_DOUBLE:return b("ThriftTypes").DOUBLE;case g.CT_FLOAT:return b("ThriftTypes").FLOAT;case g.CT_BINARY:return b("ThriftTypes").STRING;case g.CT_LIST:return b("ThriftTypes").LIST;case g.CT_SET:return b("ThriftTypes").SET;case g.CT_MAP:return b("ThriftTypes").MAP;case g.CT_STRUCT:return b("ThriftTypes").STRUCT;default:throw new Error("don't know what type")}};return a}();e.exports=c},null);
__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],function(a,b,c,d,e,f){"use strict";f.deserialize=g;f.deserializeNoThrow=a;f.serialize=h;f.serializeNoThrow=c;function g(a,c){a=new(b("TReadBuffer"))(a);a=new(b("TCompactProtocolPolyfill"))(a);return c(a)}function a(a,b,c){try{return g(a,b)}catch(a){c!=null&&c(a)}return null}function h(a,c,d){d===void 0&&(d=!1);if(d){d=new(b("TNoOpWriteBuffer"))();var e=new(b("TCompactProtocolPolyfill"))(d);c(a,e);e=new(b("TWriteBuffer"))(d.currentSize())}else e=new(b("TWriteBuffer"))();d=new(b("TCompactProtocolPolyfill"))(e);c(a,d);return d.toByteArray()}function c(a,b,c,d){c===void 0&&(c=!1);try{return h(a,b,c)}catch(a){d!=null&&d(a)}return null}},null);
__d("CoplayState",["ThriftTypes","jsbi"],function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,STATUS_CHANGE:1});var g=new Set(Object.values(a));c=Object.freeze({STARTED:1,ENDED:2});var h=new Set(Object.values(c));d=Object.freeze({PENDING:1,RUNNING:2,CONCLUDED:3,ABANDONED:4});var i=new Set(Object.values(d));f=function(){return{matchId:"0"}};var j=function(){return{matchState:l()}},k=function(){return{}},l=function(){return{matchId:"0",appId:"0",participants:[],creatorId:"0"}},m=function(){return{}},n=function(){return{userId:"0"}},o=function(a,c){c.writeStructBegin("CoplayConferenceInputState"),c.writeFieldBegin({fname:"matchId",ftype:b("ThriftTypes").I64,fid:1}),a.matchId!=null?c.writeI64(b("jsbi").BigInt(a.matchId)):c.writeI64(b("jsbi").BigInt("0")),a.event!=null&&(c.writeFieldBegin({fname:"event",ftype:b("ThriftTypes").I32,fid:2}),c.writeI32(a.event)),c.writeFieldStop(),c.writeStructEnd()},p=function(a,c){c.writeStructBegin("CoplayConferenceOutputState"),c.writeFieldBegin({fname:"matchState",ftype:b("ThriftTypes").STRUCT,fid:1}),a.matchState!=null?r(a.matchState,c):r(l(),c),c.writeFieldStop(),c.writeStructEnd()},q=function(a,c){c.writeStructBegin("CoplayMatchInputState"),a.matchId!=null&&(c.writeFieldBegin({fname:"matchId",ftype:b("ThriftTypes").I64,fid:1}),c.writeI64(b("jsbi").BigInt(a.matchId))),a.event!=null&&(c.writeFieldBegin({fname:"event",ftype:b("ThriftTypes").I32,fid:2}),c.writeI32(a.event)),a.isEligible!=null&&(c.writeFieldBegin({fname:"isEligible",ftype:b("ThriftTypes").BOOL,fid:3}),c.writeBool(a.isEligible)),c.writeFieldStop(),c.writeStructEnd()},r=function(a,c){c.writeStructBegin("CoplayMatchState");c.writeFieldBegin({fname:"matchId",ftype:b("ThriftTypes").I64,fid:1});a.matchId!=null?c.writeI64(b("jsbi").BigInt(a.matchId)):c.writeI64(b("jsbi").BigInt("0"));c.writeFieldBegin({fname:"appId",ftype:b("ThriftTypes").I64,fid:2});a.appId!=null?c.writeI64(b("jsbi").BigInt(a.appId)):c.writeI64(b("jsbi").BigInt("0"));a.matchStatus!=null&&(c.writeFieldBegin({fname:"matchStatus",ftype:b("ThriftTypes").I32,fid:3}),c.writeI32(a.matchStatus));c.writeFieldBegin({fname:"participants",ftype:b("ThriftTypes").LIST,fid:4});if(a.participants!=null){c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.participants.length});for(var d=a.participants,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;t(g,c)}}else{g=[];c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:g.length});for(var f=0;f<g.length;f++){e=g[f];t(e,c)}}c.writeFieldBegin({fname:"creatorId",ftype:b("ThriftTypes").I64,fid:5});a.creatorId!=null?c.writeI64(b("jsbi").BigInt(a.creatorId)):c.writeI64(b("jsbi").BigInt("0"));c.writeFieldStop();c.writeStructEnd()},s=function(a,c){c.writeStructBegin("CoplayOutputState");a.matchState!=null&&(c.writeFieldBegin({fname:"matchState",ftype:b("ThriftTypes").STRUCT,fid:1}),r(a.matchState,c));if(a.eligibleParticipants!=null){a=a.eligibleParticipants;c.writeFieldBegin({fname:"eligibleParticipants",ftype:b("ThriftTypes").LIST,fid:2});c.writeListBegin({etype:b("ThriftTypes").STRING,size:a.length});for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;c.writeString(f)}}c.writeFieldStop();c.writeStructEnd()},t=function(a,c){c.writeStructBegin("CoplayParticipantInfo"),c.writeFieldBegin({fname:"userId",ftype:b("ThriftTypes").I64,fid:1}),a.userId!=null?c.writeI64(b("jsbi").BigInt(a.userId)):c.writeI64(b("jsbi").BigInt("0")),c.writeFieldStop(),c.writeStructEnd()},u=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.matchId=a.readI64().toString():a.skip(e);break;case 2:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.event=d)}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.matchId==null&&(c.matchId="0");return c},v=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.matchState=x(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.matchState==null&&(c.matchState=l());return c},w=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.matchId=a.readI64().toString():a.skip(e);break;case 2:if(e===b("ThriftTypes").I32){d=a.readI32();h.has(d)&&(c.event=d)}else a.skip(e);break;case 3:e===b("ThriftTypes").BOOL?c.isEligible=a.readBool():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},x=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.matchId=a.readI64().toString():a.skip(e);break;case 2:e===b("ThriftTypes").I64?c.appId=a.readI64().toString():a.skip(e);break;case 3:if(e===b("ThriftTypes").I32){d=a.readI32();i.has(d)&&(c.matchStatus=d)}else a.skip(e);break;case 4:if(e===b("ThriftTypes").LIST){c.participants=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=z(a);c.participants.push(g)}}else a.skip(e);break;case 5:e===b("ThriftTypes").I64?c.creatorId=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.matchId==null&&(c.matchId="0");c.appId==null&&(c.appId="0");c.participants==null&&(c.participants=[]);c.creatorId==null&&(c.creatorId="0");return c},y=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.matchState=x(a):a.skip(e);break;case 2:if(e===b("ThriftTypes").LIST){c.eligibleParticipants=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=a.readString();c.eligibleParticipants.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},z=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.userId=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.userId==null&&(c.userId="0");return c};e.exports={CoplayConferenceInputEvents:a,CoplayConferenceInputState$DefaultConstructor:f,CoplayConferenceOutputState$DefaultConstructor:j,CoplayMatchEvents:c,CoplayMatchInputState$DefaultConstructor:k,CoplayMatchState$DefaultConstructor:l,CoplayMatchStatuss:d,CoplayOutputState$DefaultConstructor:m,CoplayParticipantInfo$DefaultConstructor:n,deserializeCoplayConferenceInputState:u,deserializeCoplayConferenceOutputState:v,deserializeCoplayMatchInputState:w,deserializeCoplayMatchState:x,deserializeCoplayOutputState:y,deserializeCoplayParticipantInfo:z,serializeCoplayConferenceInputState:o,serializeCoplayConferenceOutputState:p,serializeCoplayMatchInputState:q,serializeCoplayMatchState:r,serializeCoplayOutputState:s,serializeCoplayParticipantInfo:t}},null);
__d("MediaSyncState",["ThriftTypes","jsbi"],function(a,b,c,d,e,f){"use strict";a=Object.freeze({PLAY:1,PAUSE:2,STOP:3});var g=new Set(Object.values(a));c=Object.freeze({PLAY:1,PAUSE:2,STOP:3,RESUME:4,SEEK_FORWARD:5,SEEK_BACKWARD:6,AUTOPLAY:7});var h=new Set(Object.values(c));d=Object.freeze({UNKNOWN:0,IMAGE:1,VIDEO:2,IGTV:3,CAROUSEL:4});var i=new Set(Object.values(d));f=Object.freeze({UNKNOWN:0,INSTAGRAM:1,FACEBOOK_VIDEO:2});var j=new Set(Object.values(f)),k=function(){return{media_position_ms:"0",action_time_ms:"0"}},l=function(){return{user_id:"",username:"",avatar_url:""}},m=function(){return{locale:"",localized_language:"",captions_url:""}},n=function(){return{}},o=function(){return{content_id:"",video:x(),is_live_streaming:!1,is_reportable:!1,available_caption_locales:[],is_non_interactable:!1}},p=function(){return{content_id:"",cover_image_url:""}},q=function(){return{content_id:"",owner:r(),thumbnail_url:""}},r=function(){return{user_id:"",username:"",avatar_url:""}},s=function(){return{latest_input:t(),latest_actor_id:"",latest_new_content_start_time_ms:"0"}},t=function(){return{action_metadata:k(),content_id:""}},u=function(){return{action_metadata:k(),actor:l(),content:n(),content_id:""}},v=function(){return{content_id:"",title:"",message:""}},w=function(){return{url:"",height:0,width:0}},x=function(){return{duration_ms:"0",aspect_ratio:0}},y=function(a,c){c.writeStructBegin("ActionMetadata"),c.writeFieldBegin({fname:"media_position_ms",ftype:b("ThriftTypes").I64,fid:1}),a.media_position_ms!=null?c.writeI64(b("jsbi").BigInt(a.media_position_ms)):c.writeI64(b("jsbi").BigInt("0")),c.writeFieldBegin({fname:"action_time_ms",ftype:b("ThriftTypes").I64,fid:2}),a.action_time_ms!=null?c.writeI64(b("jsbi").BigInt(a.action_time_ms)):c.writeI64(b("jsbi").BigInt("0")),a.autoplay_action_id!=null&&(c.writeFieldBegin({fname:"autoplay_action_id",ftype:b("ThriftTypes").STRING,fid:3}),c.writeString(a.autoplay_action_id)),a.tab_source!=null&&(c.writeFieldBegin({fname:"tab_source",ftype:b("ThriftTypes").STRING,fid:4}),c.writeString(a.tab_source)),c.writeFieldStop(),c.writeStructEnd()},z=function(a,c){c.writeStructBegin("Actor"),c.writeFieldBegin({fname:"user_id",ftype:b("ThriftTypes").STRING,fid:1}),a.user_id!=null?c.writeString(a.user_id):c.writeString(""),c.writeFieldBegin({fname:"username",ftype:b("ThriftTypes").STRING,fid:2}),a.username!=null?c.writeString(a.username):c.writeString(""),c.writeFieldBegin({fname:"avatar_url",ftype:b("ThriftTypes").STRING,fid:3}),a.avatar_url!=null?c.writeString(a.avatar_url):c.writeString(""),c.writeFieldStop(),c.writeStructEnd()},A=function(a,c){c.writeStructBegin("CaptionLocales"),c.writeFieldBegin({fname:"locale",ftype:b("ThriftTypes").STRING,fid:1}),a.locale!=null?c.writeString(a.locale):c.writeString(""),c.writeFieldBegin({fname:"localized_language",ftype:b("ThriftTypes").STRING,fid:2}),a.localized_language!=null?c.writeString(a.localized_language):c.writeString(""),a.localized_country!=null&&(c.writeFieldBegin({fname:"localized_country",ftype:b("ThriftTypes").STRING,fid:3}),c.writeString(a.localized_country)),a.localized_creation_method!=null&&(c.writeFieldBegin({fname:"localized_creation_method",ftype:b("ThriftTypes").STRING,fid:4}),c.writeString(a.localized_creation_method)),c.writeFieldBegin({fname:"captions_url",ftype:b("ThriftTypes").STRING,fid:5}),a.captions_url!=null?c.writeString(a.captions_url):c.writeString(""),c.writeFieldStop(),c.writeStructEnd()},B=function(a,c){c.writeStructBegin("Content"),a.placeholder!=null&&(c.writeFieldBegin({fname:"placeholder",ftype:b("ThriftTypes").STRUCT,fid:1}),J(a.placeholder,c)),a.fallback!=null&&(c.writeFieldBegin({fname:"fallback",ftype:b("ThriftTypes").STRUCT,fid:2}),D(a.fallback,c)),a.ig_content!=null&&(c.writeFieldBegin({fname:"ig_content",ftype:b("ThriftTypes").STRUCT,fid:3}),E(a.ig_content,c)),a.fb_video!=null&&(c.writeFieldBegin({fname:"fb_video",ftype:b("ThriftTypes").STRUCT,fid:4}),C(a.fb_video,c)),c.writeFieldStop(),c.writeStructEnd()},C=function(a,c){c.writeStructBegin("FacebookVideo");c.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:1});a.content_id!=null?c.writeString(a.content_id):c.writeString("");c.writeFieldBegin({fname:"video",ftype:b("ThriftTypes").STRUCT,fid:2});a.video!=null?L(a.video,c):L(x(),c);a.thumbnail!=null&&(c.writeFieldBegin({fname:"thumbnail",ftype:b("ThriftTypes").STRUCT,fid:3}),K(a.thumbnail,c));a.title!=null&&(c.writeFieldBegin({fname:"title",ftype:b("ThriftTypes").STRING,fid:4}),c.writeString(a.title));a.subtitle!=null&&(c.writeFieldBegin({fname:"subtitle",ftype:b("ThriftTypes").STRING,fid:5}),c.writeString(a.subtitle));c.writeFieldBegin({fname:"is_live_streaming",ftype:b("ThriftTypes").BOOL,fid:6});a.is_live_streaming!=null?c.writeBool(a.is_live_streaming):c.writeBool(!1);c.writeFieldBegin({fname:"is_reportable",ftype:b("ThriftTypes").BOOL,fid:7});a.is_reportable!=null?c.writeBool(a.is_reportable):c.writeBool(!1);c.writeFieldBegin({fname:"available_caption_locales",ftype:b("ThriftTypes").LIST,fid:8});if(a.available_caption_locales!=null){c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.available_caption_locales.length});for(var d=a.available_caption_locales,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;A(g,c)}}else{g=[];c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:g.length});for(var f=0;f<g.length;f++){e=g[f];A(e,c)}}c.writeFieldBegin({fname:"is_non_interactable",ftype:b("ThriftTypes").BOOL,fid:9});a.is_non_interactable!=null?c.writeBool(a.is_non_interactable):c.writeBool(!1);a.content_rating!=null&&(c.writeFieldBegin({fname:"content_rating",ftype:b("ThriftTypes").STRING,fid:10}),c.writeString(a.content_rating));c.writeFieldStop();c.writeStructEnd()},D=function(a,c){c.writeStructBegin("Fallback"),c.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:1}),a.content_id!=null?c.writeString(a.content_id):c.writeString(""),c.writeFieldBegin({fname:"cover_image_url",ftype:b("ThriftTypes").STRING,fid:2}),a.cover_image_url!=null?c.writeString(a.cover_image_url):c.writeString(""),a.message!=null&&(c.writeFieldBegin({fname:"message",ftype:b("ThriftTypes").STRING,fid:3}),c.writeString(a.message)),a.video!=null&&(c.writeFieldBegin({fname:"video",ftype:b("ThriftTypes").STRUCT,fid:4}),L(a.video,c)),a.attribution_image_url!=null&&(c.writeFieldBegin({fname:"attribution_image_url",ftype:b("ThriftTypes").STRING,fid:5}),c.writeString(a.attribution_image_url)),a.attribution!=null&&(c.writeFieldBegin({fname:"attribution",ftype:b("ThriftTypes").STRING,fid:6}),c.writeString(a.attribution)),c.writeFieldStop(),c.writeStructEnd()},E=function a(c,d){d.writeStructBegin("InstagramContent");d.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:1});c.content_id!=null?d.writeString(c.content_id):d.writeString("");d.writeFieldBegin({fname:"owner",ftype:b("ThriftTypes").STRUCT,fid:2});c.owner!=null?F(c.owner,d):F(r(),d);c.media_type!=null&&(d.writeFieldBegin({fname:"media_type",ftype:b("ThriftTypes").I32,fid:3}),d.writeI32(c.media_type));d.writeFieldBegin({fname:"thumbnail_url",ftype:b("ThriftTypes").STRING,fid:4});c.thumbnail_url!=null?d.writeString(c.thumbnail_url):d.writeString("");if(c.images!=null){var e=c.images;d.writeFieldBegin({fname:"images",ftype:b("ThriftTypes").LIST,fid:5});d.writeListBegin({etype:b("ThriftTypes").STRUCT,size:e.length});for(var e=e,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;K(h,d)}}c.video!=null&&(d.writeFieldBegin({fname:"video",ftype:b("ThriftTypes").STRUCT,fid:6}),L(c.video,d));if(c.carousel!=null){h=c.carousel;d.writeFieldBegin({fname:"carousel",ftype:b("ThriftTypes").LIST,fid:7});d.writeListBegin({etype:b("ThriftTypes").STRUCT,size:h.length});for(var g=h,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;c=g[e++]}else{e=g.next();if(e.done)break;c=e.value}h=c;a(h,d)}}d.writeFieldStop();d.writeStructEnd()},F=function(a,c){c.writeStructBegin("InstagramContentOwner"),c.writeFieldBegin({fname:"user_id",ftype:b("ThriftTypes").STRING,fid:1}),a.user_id!=null?c.writeString(a.user_id):c.writeString(""),c.writeFieldBegin({fname:"username",ftype:b("ThriftTypes").STRING,fid:2}),a.username!=null?c.writeString(a.username):c.writeString(""),c.writeFieldBegin({fname:"avatar_url",ftype:b("ThriftTypes").STRING,fid:3}),a.avatar_url!=null?c.writeString(a.avatar_url):c.writeString(""),c.writeFieldStop(),c.writeStructEnd()},G=function(a,c){c.writeStructBegin("MediaSyncConferenceOutputState"),c.writeFieldBegin({fname:"latest_input",ftype:b("ThriftTypes").STRUCT,fid:1}),a.latest_input!=null?H(a.latest_input,c):H(t(),c),c.writeFieldBegin({fname:"latest_actor_id",ftype:b("ThriftTypes").STRING,fid:2}),a.latest_actor_id!=null?c.writeString(a.latest_actor_id):c.writeString(""),c.writeFieldBegin({fname:"latest_new_content_start_time_ms",ftype:b("ThriftTypes").I64,fid:3}),a.latest_new_content_start_time_ms!=null?c.writeI64(b("jsbi").BigInt(a.latest_new_content_start_time_ms)):c.writeI64(b("jsbi").BigInt("0")),c.writeFieldStop(),c.writeStructEnd()},H=function(a,c){c.writeStructBegin("MediaSyncInputState"),a.action!=null&&(c.writeFieldBegin({fname:"action",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.action)),c.writeFieldBegin({fname:"action_metadata",ftype:b("ThriftTypes").STRUCT,fid:2}),a.action_metadata!=null?y(a.action_metadata,c):y(k(),c),c.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:3}),a.content_id!=null?c.writeString(a.content_id):c.writeString(""),a.content_source!=null&&(c.writeFieldBegin({fname:"content_source",ftype:b("ThriftTypes").I32,fid:4}),c.writeI32(a.content_source)),a.admin_message_type!=null&&(c.writeFieldBegin({fname:"admin_message_type",ftype:b("ThriftTypes").I32,fid:5}),c.writeI32(a.admin_message_type)),c.writeFieldStop(),c.writeStructEnd()},I=function(a,c){c.writeStructBegin("MediaSyncOutputState"),a.action!=null&&(c.writeFieldBegin({fname:"action",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.action)),c.writeFieldBegin({fname:"action_metadata",ftype:b("ThriftTypes").STRUCT,fid:2}),a.action_metadata!=null?y(a.action_metadata,c):y(k(),c),c.writeFieldBegin({fname:"actor",ftype:b("ThriftTypes").STRUCT,fid:3}),a.actor!=null?z(a.actor,c):z(l(),c),c.writeFieldBegin({fname:"content",ftype:b("ThriftTypes").STRUCT,fid:4}),a.content!=null?B(a.content,c):B(n(),c),a.content_source!=null&&(c.writeFieldBegin({fname:"content_source",ftype:b("ThriftTypes").I32,fid:5}),c.writeI32(a.content_source)),c.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:6}),a.content_id!=null?c.writeString(a.content_id):c.writeString(""),a.admin_message!=null&&(c.writeFieldBegin({fname:"admin_message",ftype:b("ThriftTypes").STRING,fid:7}),c.writeString(a.admin_message)),c.writeFieldStop(),c.writeStructEnd()},J=function(a,c){c.writeStructBegin("Placeholder"),c.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:1}),a.content_id!=null?c.writeString(a.content_id):c.writeString(""),c.writeFieldBegin({fname:"title",ftype:b("ThriftTypes").STRING,fid:2}),a.title!=null?c.writeString(a.title):c.writeString(""),c.writeFieldBegin({fname:"message",ftype:b("ThriftTypes").STRING,fid:3}),a.message!=null?c.writeString(a.message):c.writeString(""),c.writeFieldStop(),c.writeStructEnd()},K=function(a,c){c.writeStructBegin("SizedUrl"),c.writeFieldBegin({fname:"url",ftype:b("ThriftTypes").STRING,fid:1}),a.url!=null?c.writeString(a.url):c.writeString(""),c.writeFieldBegin({fname:"height",ftype:b("ThriftTypes").I32,fid:2}),a.height!=null?c.writeI32(a.height):c.writeI32(0),c.writeFieldBegin({fname:"width",ftype:b("ThriftTypes").I32,fid:3}),a.width!=null?c.writeI32(a.width):c.writeI32(0),a.type!=null&&(c.writeFieldBegin({fname:"type",ftype:b("ThriftTypes").STRING,fid:4}),c.writeString(a.type)),c.writeFieldStop(),c.writeStructEnd()},L=function(a,c){c.writeStructBegin("Video"),a.dash_manifest!=null&&(c.writeFieldBegin({fname:"dash_manifest",ftype:b("ThriftTypes").STRING,fid:2}),c.writeString(a.dash_manifest)),c.writeFieldBegin({fname:"duration_ms",ftype:b("ThriftTypes").I64,fid:3}),a.duration_ms!=null?c.writeI64(b("jsbi").BigInt(a.duration_ms)):c.writeI64(b("jsbi").BigInt("0")),c.writeFieldBegin({fname:"aspect_ratio",ftype:b("ThriftTypes").FLOAT,fid:4}),a.aspect_ratio!=null?c.writeFloat(a.aspect_ratio):c.writeFloat(0),a.url!=null&&(c.writeFieldBegin({fname:"url",ftype:b("ThriftTypes").STRUCT,fid:5}),K(a.url,c)),c.writeFieldStop(),c.writeStructEnd()},M=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.media_position_ms=a.readI64().toString():a.skip(e);break;case 2:e===b("ThriftTypes").I64?c.action_time_ms=a.readI64().toString():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.autoplay_action_id=a.readString():a.skip(e);break;case 4:e===b("ThriftTypes").STRING?c.tab_source=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.media_position_ms==null&&(c.media_position_ms="0");c.action_time_ms==null&&(c.action_time_ms="0");return c},N=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.user_id=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.username=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.avatar_url=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.user_id==null&&(c.user_id="");c.username==null&&(c.username="");c.avatar_url==null&&(c.avatar_url="");return c},O=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.locale=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.localized_language=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.localized_country=a.readString():a.skip(e);break;case 4:e===b("ThriftTypes").STRING?c.localized_creation_method=a.readString():a.skip(e);break;case 5:e===b("ThriftTypes").STRING?c.captions_url=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.locale==null&&(c.locale="");c.localized_language==null&&(c.localized_language="");c.captions_url==null&&(c.captions_url="");return c},P=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.placeholder=X(a):a.skip(e);break;case 2:e===b("ThriftTypes").STRUCT?c.fallback=R(a):a.skip(e);break;case 3:e===b("ThriftTypes").STRUCT?c.ig_content=S(a):a.skip(e);break;case 4:e===b("ThriftTypes").STRUCT?c.fb_video=Q(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},Q=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.content_id=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").STRUCT?c.video=Z(a):a.skip(e);break;case 3:e===b("ThriftTypes").STRUCT?c.thumbnail=Y(a):a.skip(e);break;case 4:e===b("ThriftTypes").STRING?c.title=a.readString():a.skip(e);break;case 5:e===b("ThriftTypes").STRING?c.subtitle=a.readString():a.skip(e);break;case 6:e===b("ThriftTypes").BOOL?c.is_live_streaming=a.readBool():a.skip(e);break;case 7:e===b("ThriftTypes").BOOL?c.is_reportable=a.readBool():a.skip(e);break;case 8:if(e===b("ThriftTypes").LIST){c.available_caption_locales=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=O(a);c.available_caption_locales.push(g)}}else a.skip(e);break;case 9:e===b("ThriftTypes").BOOL?c.is_non_interactable=a.readBool():a.skip(e);break;case 10:e===b("ThriftTypes").STRING?c.content_rating=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.content_id==null&&(c.content_id="");c.video==null&&(c.video=x());c.is_live_streaming==null&&(c.is_live_streaming=!1);c.is_reportable==null&&(c.is_reportable=!1);c.available_caption_locales==null&&(c.available_caption_locales=[]);c.is_non_interactable==null&&(c.is_non_interactable=!1);return c},R=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.content_id=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.cover_image_url=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.message=a.readString():a.skip(e);break;case 4:e===b("ThriftTypes").STRUCT?c.video=Z(a):a.skip(e);break;case 5:e===b("ThriftTypes").STRING?c.attribution_image_url=a.readString():a.skip(e);break;case 6:e===b("ThriftTypes").STRING?c.attribution=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.content_id==null&&(c.content_id="");c.cover_image_url==null&&(c.cover_image_url="");return c},S=function a(c){var d={};c.readStructBegin();while(!0){var e=c.readFieldBegin(),f=e.ftype;e=e.fid;if(f===b("ThriftTypes").STOP)break;switch(e){case 1:f===b("ThriftTypes").STRING?d.content_id=c.readString():c.skip(f);break;case 2:f===b("ThriftTypes").STRUCT?d.owner=T(c):c.skip(f);break;case 3:if(f===b("ThriftTypes").I32){e=c.readI32();i.has(e)&&(d.media_type=e)}else c.skip(f);break;case 4:f===b("ThriftTypes").STRING?d.thumbnail_url=c.readString():c.skip(f);break;case 5:if(f===b("ThriftTypes").LIST){d.images=[];e=c.readListBegin();for(var g=0;g<e.size;++g){var h=Y(c);d.images.push(h)}}else c.skip(f);break;case 6:f===b("ThriftTypes").STRUCT?d.video=Z(c):c.skip(f);break;case 7:if(f===b("ThriftTypes").LIST){d.carousel=[];h=c.readListBegin();for(var g=0;g<h.size;++g){e=a(c);d.carousel.push(e)}}else c.skip(f);break;default:c.skip(f)}c.readFieldEnd()}c.readStructEnd();d.content_id==null&&(d.content_id="");d.owner==null&&(d.owner=r());d.thumbnail_url==null&&(d.thumbnail_url="");return d},T=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.user_id=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.username=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.avatar_url=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.user_id==null&&(c.user_id="");c.username==null&&(c.username="");c.avatar_url==null&&(c.avatar_url="");return c},U=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.latest_input=V(a):a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.latest_actor_id=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").I64?c.latest_new_content_start_time_ms=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.latest_input==null&&(c.latest_input=t());c.latest_actor_id==null&&(c.latest_actor_id="");c.latest_new_content_start_time_ms==null&&(c.latest_new_content_start_time_ms="0");return c},V=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.action=d)}else a.skip(e);break;case 2:e===b("ThriftTypes").STRUCT?c.action_metadata=M(a):a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.content_id=a.readString():a.skip(e);break;case 4:if(e===b("ThriftTypes").I32){d=a.readI32();j.has(d)&&(c.content_source=d)}else a.skip(e);break;case 5:if(e===b("ThriftTypes").I32){d=a.readI32();h.has(d)&&(c.admin_message_type=d)}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.action_metadata==null&&(c.action_metadata=k());c.content_id==null&&(c.content_id="");return c},W=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.action=d)}else a.skip(e);break;case 2:e===b("ThriftTypes").STRUCT?c.action_metadata=M(a):a.skip(e);break;case 3:e===b("ThriftTypes").STRUCT?c.actor=N(a):a.skip(e);break;case 4:e===b("ThriftTypes").STRUCT?c.content=P(a):a.skip(e);break;case 5:if(e===b("ThriftTypes").I32){d=a.readI32();j.has(d)&&(c.content_source=d)}else a.skip(e);break;case 6:e===b("ThriftTypes").STRING?c.content_id=a.readString():a.skip(e);break;case 7:e===b("ThriftTypes").STRING?c.admin_message=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.action_metadata==null&&(c.action_metadata=k());c.actor==null&&(c.actor=l());c.content==null&&(c.content=n());c.content_id==null&&(c.content_id="");return c},X=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.content_id=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.title=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.message=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.content_id==null&&(c.content_id="");c.title==null&&(c.title="");c.message==null&&(c.message="");return c},Y=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.url=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").I32?c.height=a.readI32():a.skip(e);break;case 3:e===b("ThriftTypes").I32?c.width=a.readI32():a.skip(e);break;case 4:e===b("ThriftTypes").STRING?c.type=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.url==null&&(c.url="");c.height==null&&(c.height=0);c.width==null&&(c.width=0);return c},Z=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 2:e===b("ThriftTypes").STRING?c.dash_manifest=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").I64?c.duration_ms=a.readI64().toString():a.skip(e);break;case 4:e===b("ThriftTypes").FLOAT?c.aspect_ratio=a.readFloat():a.skip(e);break;case 5:e===b("ThriftTypes").STRUCT?c.url=Y(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.duration_ms==null&&(c.duration_ms="0");c.aspect_ratio==null&&(c.aspect_ratio=0);return c};e.exports={ActionMetadata$DefaultConstructor:k,Actions:a,Actor$DefaultConstructor:l,AdminMessageTypes:c,CaptionLocales$DefaultConstructor:m,Content$DefaultConstructor:n,FacebookVideo$DefaultConstructor:o,Fallback$DefaultConstructor:p,InstagramContent$DefaultConstructor:q,InstagramContentOwner$DefaultConstructor:r,InstagramMediaTypes:d,MediaSyncConferenceOutputState$DefaultConstructor:s,MediaSyncInputState$DefaultConstructor:t,MediaSyncOutputState$DefaultConstructor:u,Placeholder$DefaultConstructor:v,SizedUrl$DefaultConstructor:w,Sources:f,Video$DefaultConstructor:x,deserializeActionMetadata:M,deserializeActor:N,deserializeCaptionLocales:O,deserializeContent:P,deserializeFacebookVideo:Q,deserializeFallback:R,deserializeInstagramContent:S,deserializeInstagramContentOwner:T,deserializeMediaSyncConferenceOutputState:U,deserializeMediaSyncInputState:V,deserializeMediaSyncOutputState:W,deserializePlaceholder:X,deserializeSizedUrl:Y,deserializeVideo:Z,serializeActionMetadata:y,serializeActor:z,serializeCaptionLocales:A,serializeContent:B,serializeFacebookVideo:C,serializeFallback:D,serializeInstagramContent:E,serializeInstagramContentOwner:F,serializeMediaSyncConferenceOutputState:G,serializeMediaSyncInputState:H,serializeMediaSyncOutputState:I,serializePlaceholder:J,serializeSizedUrl:K,serializeVideo:L}},null);
__d("MediaSyncAutoplayState",["MediaSyncState","ThriftTypes","jsbi"],function(a,b,c,d,e,f){f.AutoplayInput$DefaultConstructor=a;f.AutoplayOutput$DefaultConstructor=c;f.ConferenceInputState$DefaultConstructor=d;f.ParticipantInputState$DefaultConstructor=e;f.ParticipantOutputState$DefaultConstructor=k;f.serializeAutoplayInput=l;f.serializeAutoplayOutput=m;f.serializeConferenceInputState=n;f.serializeParticipantInputState=o;f.serializeParticipantOutputState=p;f.deserializeAutoplayInput=q;f.deserializeAutoplayOutput=r;f.deserializeConferenceInputState=s;f.deserializeParticipantInputState=t;f.deserializeParticipantOutputState=u;a=b("MediaSyncState").Sources;var g=b("MediaSyncState").deserializeContent,h=b("MediaSyncState").serializeContent,i=new Set(Object.values(a));c=Object.freeze({COUNTDOWN:1,CANCELED:2});f.DisplayStates=c;var j=new Set(Object.values(c));function a(){return{action_id:"",content_id:"",preview_duration_ms:"7000"}}function c(){return{action_id:"",content_id:"",content:b("MediaSyncState").Content$DefaultConstructor(),preview_duration_ms:"0"}}function d(){return{}}function e(){return{cancel_action_id:""}}function k(){return{}}function l(a,c){c.writeStructBegin("AutoplayInput"),c.writeFieldBegin({fname:"action_id",ftype:b("ThriftTypes").STRING,fid:1}),a.action_id!=null?c.writeString(a.action_id):c.writeString(""),a.content_source!=null&&(c.writeFieldBegin({fname:"content_source",ftype:b("ThriftTypes").I32,fid:2}),c.writeI32(a.content_source)),c.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:3}),a.content_id!=null?c.writeString(a.content_id):c.writeString(""),c.writeFieldBegin({fname:"preview_duration_ms",ftype:b("ThriftTypes").I64,fid:4}),a.preview_duration_ms!=null?c.writeI64(b("jsbi").BigInt(a.preview_duration_ms)):c.writeI64(b("jsbi").BigInt("7000")),c.writeFieldStop(),c.writeStructEnd()}function m(a,c){c.writeStructBegin("AutoplayOutput"),c.writeFieldBegin({fname:"action_id",ftype:b("ThriftTypes").STRING,fid:1}),a.action_id!=null?c.writeString(a.action_id):c.writeString(""),a.content_source!=null&&(c.writeFieldBegin({fname:"content_source",ftype:b("ThriftTypes").I32,fid:2}),c.writeI32(a.content_source)),c.writeFieldBegin({fname:"content_id",ftype:b("ThriftTypes").STRING,fid:3}),a.content_id!=null?c.writeString(a.content_id):c.writeString(""),c.writeFieldBegin({fname:"content",ftype:b("ThriftTypes").STRUCT,fid:4}),a.content!=null?h(a.content,c):h(b("MediaSyncState").Content$DefaultConstructor(),c),a.display_state!=null&&(c.writeFieldBegin({fname:"display_state",ftype:b("ThriftTypes").I32,fid:5}),c.writeI32(a.display_state)),c.writeFieldBegin({fname:"preview_duration_ms",ftype:b("ThriftTypes").I64,fid:6}),a.preview_duration_ms!=null?c.writeI64(b("jsbi").BigInt(a.preview_duration_ms)):c.writeI64(b("jsbi").BigInt("0")),c.writeFieldStop(),c.writeStructEnd()}function n(a,c){c.writeStructBegin("ConferenceInputState"),a.autoplay!=null&&(c.writeFieldBegin({fname:"autoplay",ftype:b("ThriftTypes").STRUCT,fid:1}),l(a.autoplay,c)),c.writeFieldStop(),c.writeStructEnd()}function o(a,c){c.writeStructBegin("ParticipantInputState"),c.writeFieldBegin({fname:"cancel_action_id",ftype:b("ThriftTypes").STRING,fid:1}),a.cancel_action_id!=null?c.writeString(a.cancel_action_id):c.writeString(""),c.writeFieldStop(),c.writeStructEnd()}function p(a,c){c.writeStructBegin("ParticipantOutputState"),a.autoplay!=null&&(c.writeFieldBegin({fname:"autoplay",ftype:b("ThriftTypes").STRUCT,fid:1}),m(a.autoplay,c)),c.writeFieldStop(),c.writeStructEnd()}function q(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.action_id=a.readString():a.skip(e);break;case 2:if(e===b("ThriftTypes").I32){d=a.readI32();i.has(d)&&(c.content_source=d)}else a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.content_id=a.readString():a.skip(e);break;case 4:e===b("ThriftTypes").I64?c.preview_duration_ms=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.action_id==null&&(c.action_id="");c.content_id==null&&(c.content_id="");c.preview_duration_ms==null&&(c.preview_duration_ms="7000");return c}function r(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.action_id=a.readString():a.skip(e);break;case 2:if(e===b("ThriftTypes").I32){d=a.readI32();i.has(d)&&(c.content_source=d)}else a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.content_id=a.readString():a.skip(e);break;case 4:e===b("ThriftTypes").STRUCT?c.content=g(a):a.skip(e);break;case 5:if(e===b("ThriftTypes").I32){d=a.readI32();j.has(d)&&(c.display_state=d)}else a.skip(e);break;case 6:e===b("ThriftTypes").I64?c.preview_duration_ms=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.action_id==null&&(c.action_id="");c.content_id==null&&(c.content_id="");c.content==null&&(c.content=b("MediaSyncState").Content$DefaultConstructor());c.preview_duration_ms==null&&(c.preview_duration_ms="0");return c}function s(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.autoplay=q(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c}function t(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.cancel_action_id=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.cancel_action_id==null&&(c.cancel_action_id="");return c}function u(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.autoplay=r(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c}},null);
__d("MeetingAssistantState",["ThriftTypes"],function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNAVAILABLE:0,NOT_RECORDING:1,RECORDING:2});var g=new Set(Object.values(a));c=function(){return{}};d=function(){return{}};f=function(){return{}};var h=function(a,c){c.writeStructBegin("ConferenceOutputState"),a.transcription_status!=null&&(c.writeFieldBegin({fname:"transcription_status",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.transcription_status)),c.writeFieldStop(),c.writeStructEnd()},i=function(a,b){b.writeStructBegin("ParticipantInputState"),b.writeFieldStop(),b.writeStructEnd()},j=function(a,c){c.writeStructBegin("ParticipantOutputState"),a.transcription_status!=null&&(c.writeFieldBegin({fname:"transcription_status",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.transcription_status)),c.writeFieldStop(),c.writeStructEnd()},k=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.transcription_status=d)}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},l=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},m=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.transcription_status=d)}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c};e.exports={ConferenceOutputState$DefaultConstructor:c,ParticipantInputState$DefaultConstructor:d,ParticipantOutputState$DefaultConstructor:f,TranscriptionStatuss:a,deserializeConferenceOutputState:k,deserializeParticipantInputState:l,deserializeParticipantOutputState:m,serializeConferenceOutputState:h,serializeParticipantInputState:i,serializeParticipantOutputState:j}},null);
__d("ModeratorControlsState",["ThriftTypes"],function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,SOFT_MUTE:1});var g=new Set(Object.values(a)),h=function(){return{moderator_uids:[],allows_screen_share:!1,soft_mute_feature_enabled:!1,participant_capabilities:new Map()}};c=function(){return{action_uuid:"",action_issued_by:""}};d=function(){return{}};f=function(){return{participant:l(),conference:h()}};var i=function(){return{issue_action_target_uids:new Set()}},j=function(){return{is_moderator:!1,action_capabilities_as_moderator:new Set(),action_capabilities_as_participant:new Set()}},k=function(){return{action_capabilities:new Set(),action_uuids_executed:new Set()}},l=function(){return{is_moderator:!1,screenshare_enabled:!1,action_capabilities_as_moderator:new Set(),action_capabilities_as_participant:new Set()}},m=function(a,c){c.writeStructBegin("ConferenceOutputState");c.writeFieldBegin({fname:"moderator_uids",ftype:b("ThriftTypes").LIST,fid:1});if(a.moderator_uids!=null){c.writeListBegin({etype:b("ThriftTypes").STRING,size:a.moderator_uids.length});for(var d=a.moderator_uids,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.writeString(g)}}else{g=[];c.writeListBegin({etype:b("ThriftTypes").STRING,size:g.length});for(var f=0;f<g.length;f++){e=g[f];c.writeString(e)}}c.writeFieldBegin({fname:"allows_screen_share",ftype:b("ThriftTypes").BOOL,fid:2});a.allows_screen_share!=null?c.writeBool(a.allows_screen_share):c.writeBool(!1);a.allows_screen_share_changed_by!=null&&(c.writeFieldBegin({fname:"allows_screen_share_changed_by",ftype:b("ThriftTypes").STRING,fid:3}),c.writeString(a.allows_screen_share_changed_by));c.writeFieldBegin({fname:"soft_mute_feature_enabled",ftype:b("ThriftTypes").BOOL,fid:4});a.soft_mute_feature_enabled!=null?c.writeBool(a.soft_mute_feature_enabled):c.writeBool(!1);c.writeFieldBegin({fname:"participant_capabilities",ftype:b("ThriftTypes").MAP,fid:5});if(a.participant_capabilities!=null){c.writeMapBegin({ktype:b("ThriftTypes").STRING,vtype:b("ThriftTypes").STRUCT,size:a.participant_capabilities.size});for(var d=a.participant_capabilities.entries(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}a=g;g=a[0];a=a[1];c.writeString(g);r(a,c)}}else{g=new Map();c.writeMapBegin({ktype:b("ThriftTypes").STRING,vtype:b("ThriftTypes").STRUCT,size:g.size});for(var a=g.entries(),f=Array.isArray(a),e=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=a.length)break;d=a[e++]}else{e=a.next();if(e.done)break;d=e.value}g=d;d=g[0];g=g[1];c.writeString(d);r(g,c)}}c.writeFieldStop();c.writeStructEnd()},n=function(a,c){c.writeStructBegin("ModeratorActionInfo"),c.writeFieldBegin({fname:"action_uuid",ftype:b("ThriftTypes").STRING,fid:1}),a.action_uuid!=null?c.writeString(a.action_uuid):c.writeString(""),a.action_type!=null&&(c.writeFieldBegin({fname:"action_type",ftype:b("ThriftTypes").I32,fid:2}),c.writeI32(a.action_type)),c.writeFieldBegin({fname:"action_issued_by",ftype:b("ThriftTypes").STRING,fid:3}),a.action_issued_by!=null?c.writeString(a.action_issued_by):c.writeString(""),c.writeFieldStop(),c.writeStructEnd()},o=function(a,c){c.writeStructBegin("ModeratorControlsInputState"),a.participant!=null&&(c.writeFieldBegin({fname:"participant",ftype:b("ThriftTypes").STRUCT,fid:1}),s(a.participant,c)),a.moderator!=null&&(c.writeFieldBegin({fname:"moderator",ftype:b("ThriftTypes").STRUCT,fid:2}),q(a.moderator,c)),c.writeFieldStop(),c.writeStructEnd()},p=function(a,c){c.writeStructBegin("ModeratorControlsOutputState"),c.writeFieldBegin({fname:"participant",ftype:b("ThriftTypes").STRUCT,fid:1}),a.participant!=null?t(a.participant,c):t(l(),c),c.writeFieldBegin({fname:"conference",ftype:b("ThriftTypes").STRUCT,fid:2}),a.conference!=null?m(a.conference,c):m(h(),c),c.writeFieldStop(),c.writeStructEnd()},q=function(a,c){c.writeStructBegin("ModeratorInputState");a.allows_screen_share!=null&&(c.writeFieldBegin({fname:"allows_screen_share",ftype:b("ThriftTypes").BOOL,fid:1}),c.writeBool(a.allows_screen_share));a.issue_action!=null&&(c.writeFieldBegin({fname:"issue_action",ftype:b("ThriftTypes").I32,fid:2}),c.writeI32(a.issue_action));c.writeFieldBegin({fname:"issue_action_target_uids",ftype:b("ThriftTypes").SET,fid:3});if(a.issue_action_target_uids!=null){c.writeSetBegin({etype:b("ThriftTypes").STRING,size:a.issue_action_target_uids.size});for(var a=a.issue_action_target_uids,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;c.writeString(f)}}else{f=new Set();c.writeSetBegin({etype:b("ThriftTypes").STRING,size:f.size});for(var e=f,d=Array.isArray(e),a=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(a>=e.length)break;f=e[a++]}else{a=e.next();if(a.done)break;f=a.value}f=f;c.writeString(f)}}c.writeFieldStop();c.writeStructEnd()},r=function(a,c){c.writeStructBegin("ParticipantCapabilityInfo");c.writeFieldBegin({fname:"is_moderator",ftype:b("ThriftTypes").BOOL,fid:1});a.is_moderator!=null?c.writeBool(a.is_moderator):c.writeBool(!1);c.writeFieldBegin({fname:"action_capabilities_as_moderator",ftype:b("ThriftTypes").SET,fid:2});if(a.action_capabilities_as_moderator!=null){c.writeSetBegin({etype:b("ThriftTypes").I32,size:a.action_capabilities_as_moderator.size});for(var d=a.action_capabilities_as_moderator,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.writeI32(g)}}else{g=new Set();c.writeSetBegin({etype:b("ThriftTypes").I32,size:g.size});for(var f=g,e=Array.isArray(f),d=0,f=e?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=f.length)break;g=f[d++]}else{d=f.next();if(d.done)break;g=d.value}g=g;c.writeI32(g)}}c.writeFieldBegin({fname:"action_capabilities_as_participant",ftype:b("ThriftTypes").SET,fid:3});if(a.action_capabilities_as_participant!=null){c.writeSetBegin({etype:b("ThriftTypes").I32,size:a.action_capabilities_as_participant.size});for(var g=a.action_capabilities_as_participant,d=Array.isArray(g),e=0,g=d?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(e>=g.length)break;f=g[e++]}else{e=g.next();if(e.done)break;f=e.value}a=f;c.writeI32(a)}}else{f=new Set();c.writeSetBegin({etype:b("ThriftTypes").I32,size:f.size});for(var a=f,e=Array.isArray(a),d=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=a.length)break;g=a[d++]}else{d=a.next();if(d.done)break;g=d.value}f=g;c.writeI32(f)}}c.writeFieldStop();c.writeStructEnd()},s=function(a,c){c.writeStructBegin("ParticipantInputState");c.writeFieldBegin({fname:"action_capabilities",ftype:b("ThriftTypes").SET,fid:1});if(a.action_capabilities!=null){c.writeSetBegin({etype:b("ThriftTypes").I32,size:a.action_capabilities.size});for(var d=a.action_capabilities,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.writeI32(g)}}else{g=new Set();c.writeSetBegin({etype:b("ThriftTypes").I32,size:g.size});for(var f=g,e=Array.isArray(f),d=0,f=e?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=f.length)break;g=f[d++]}else{d=f.next();if(d.done)break;g=d.value}g=g;c.writeI32(g)}}c.writeFieldBegin({fname:"action_uuids_executed",ftype:b("ThriftTypes").SET,fid:2});if(a.action_uuids_executed!=null){c.writeSetBegin({etype:b("ThriftTypes").STRING,size:a.action_uuids_executed.size});for(var g=a.action_uuids_executed,d=Array.isArray(g),e=0,g=d?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(e>=g.length)break;f=g[e++]}else{e=g.next();if(e.done)break;f=e.value}a=f;c.writeString(a)}}else{f=new Set();c.writeSetBegin({etype:b("ThriftTypes").STRING,size:f.size});for(var a=f,e=Array.isArray(a),d=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=a.length)break;g=a[d++]}else{d=a.next();if(d.done)break;g=d.value}f=g;c.writeString(f)}}c.writeFieldStop();c.writeStructEnd()},t=function(a,c){c.writeStructBegin("ParticipantOutputState");c.writeFieldBegin({fname:"is_moderator",ftype:b("ThriftTypes").BOOL,fid:1});a.is_moderator!=null?c.writeBool(a.is_moderator):c.writeBool(!1);c.writeFieldBegin({fname:"screenshare_enabled",ftype:b("ThriftTypes").BOOL,fid:2});a.screenshare_enabled!=null?c.writeBool(a.screenshare_enabled):c.writeBool(!1);a.screenshare_enabled_changed_by!=null&&(c.writeFieldBegin({fname:"screenshare_enabled_changed_by",ftype:b("ThriftTypes").STRING,fid:3}),c.writeString(a.screenshare_enabled_changed_by));c.writeFieldBegin({fname:"action_capabilities_as_moderator",ftype:b("ThriftTypes").SET,fid:4});if(a.action_capabilities_as_moderator!=null){c.writeSetBegin({etype:b("ThriftTypes").I32,size:a.action_capabilities_as_moderator.size});for(var d=a.action_capabilities_as_moderator,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.writeI32(g)}}else{g=new Set();c.writeSetBegin({etype:b("ThriftTypes").I32,size:g.size});for(var f=g,e=Array.isArray(f),d=0,f=e?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=f.length)break;g=f[d++]}else{d=f.next();if(d.done)break;g=d.value}g=g;c.writeI32(g)}}c.writeFieldBegin({fname:"action_capabilities_as_participant",ftype:b("ThriftTypes").SET,fid:5});if(a.action_capabilities_as_participant!=null){c.writeSetBegin({etype:b("ThriftTypes").I32,size:a.action_capabilities_as_participant.size});for(var g=a.action_capabilities_as_participant,d=Array.isArray(g),e=0,g=d?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(e>=g.length)break;f=g[e++]}else{e=g.next();if(e.done)break;f=e.value}f=f;c.writeI32(f)}}else{f=new Set();c.writeSetBegin({etype:b("ThriftTypes").I32,size:f.size});for(var e=f,d=Array.isArray(e),g=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(g>=e.length)break;f=e[g++]}else{g=e.next();if(g.done)break;f=g.value}f=f;c.writeI32(f)}}if(a.actions_issued!=null){f=a.actions_issued;c.writeFieldBegin({fname:"actions_issued",ftype:b("ThriftTypes").MAP,fid:6});c.writeMapBegin({ktype:b("ThriftTypes").I32,vtype:b("ThriftTypes").STRUCT,size:f.size});for(var g=f.entries(),d=Array.isArray(g),e=0,g=d?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(e>=g.length)break;a=g[e++]}else{e=g.next();if(e.done)break;a=e.value}f=a;a=f[0];f=f[1];c.writeI32(a);n(f,c)}}c.writeFieldStop();c.writeStructEnd()},u=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").LIST){c.moderator_uids=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=a.readString();c.moderator_uids.push(g)}}else a.skip(e);break;case 2:e===b("ThriftTypes").BOOL?c.allows_screen_share=a.readBool():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.allows_screen_share_changed_by=a.readString():a.skip(e);break;case 4:e===b("ThriftTypes").BOOL?c.soft_mute_feature_enabled=a.readBool():a.skip(e);break;case 5:if(e===b("ThriftTypes").MAP){c.participant_capabilities=new Map();g=a.readMapBegin();for(var f=0;f<g.size;++f){d=a.readString();var h=z(a);c.participant_capabilities.set(d,h)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.moderator_uids==null&&(c.moderator_uids=[]);c.allows_screen_share==null&&(c.allows_screen_share=!1);c.soft_mute_feature_enabled==null&&(c.soft_mute_feature_enabled=!1);c.participant_capabilities==null&&(c.participant_capabilities=new Map());return c},v=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.action_uuid=a.readString():a.skip(e);break;case 2:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.action_type=d)}else a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.action_issued_by=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.action_uuid==null&&(c.action_uuid="");c.action_issued_by==null&&(c.action_issued_by="");return c},w=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.participant=A(a):a.skip(e);break;case 2:e===b("ThriftTypes").STRUCT?c.moderator=y(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},x=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRUCT?c.participant=B(a):a.skip(e);break;case 2:e===b("ThriftTypes").STRUCT?c.conference=u(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.participant==null&&(c.participant=l());c.conference==null&&(c.conference=h());return c},y=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").BOOL?c.allows_screen_share=a.readBool():a.skip(e);break;case 2:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.issue_action=d)}else a.skip(e);break;case 3:if(e===b("ThriftTypes").SET){c.issue_action_target_uids=new Set();d=a.readSetBegin();for(var f=0;f<d.size;++f){var h=a.readString();c.issue_action_target_uids.add(h)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.issue_action_target_uids==null&&(c.issue_action_target_uids=new Set());return c},z=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").BOOL?c.is_moderator=a.readBool():a.skip(e);break;case 2:if(e===b("ThriftTypes").SET){c.action_capabilities_as_moderator=new Set();d=a.readSetBegin();for(var f=0;f<d.size;++f){var h=a.readI32();g.has(h)&&c.action_capabilities_as_moderator.add(h)}}else a.skip(e);break;case 3:if(e===b("ThriftTypes").SET){c.action_capabilities_as_participant=new Set();h=a.readSetBegin();for(var f=0;f<h.size;++f){d=a.readI32();g.has(d)&&c.action_capabilities_as_participant.add(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.is_moderator==null&&(c.is_moderator=!1);c.action_capabilities_as_moderator==null&&(c.action_capabilities_as_moderator=new Set());c.action_capabilities_as_participant==null&&(c.action_capabilities_as_participant=new Set());return c},A=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").SET){c.action_capabilities=new Set();d=a.readSetBegin();for(var f=0;f<d.size;++f){var h=a.readI32();g.has(h)&&c.action_capabilities.add(h)}}else a.skip(e);break;case 2:if(e===b("ThriftTypes").SET){c.action_uuids_executed=new Set();h=a.readSetBegin();for(var f=0;f<h.size;++f){d=a.readString();c.action_uuids_executed.add(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.action_capabilities==null&&(c.action_capabilities=new Set());c.action_uuids_executed==null&&(c.action_uuids_executed=new Set());return c},B=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").BOOL?c.is_moderator=a.readBool():a.skip(e);break;case 2:e===b("ThriftTypes").BOOL?c.screenshare_enabled=a.readBool():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.screenshare_enabled_changed_by=a.readString():a.skip(e);break;case 4:if(e===b("ThriftTypes").SET){c.action_capabilities_as_moderator=new Set();d=a.readSetBegin();for(var f=0;f<d.size;++f){var h=a.readI32();g.has(h)&&c.action_capabilities_as_moderator.add(h)}}else a.skip(e);break;case 5:if(e===b("ThriftTypes").SET){c.action_capabilities_as_participant=new Set();h=a.readSetBegin();for(var f=0;f<h.size;++f){d=a.readI32();g.has(d)&&c.action_capabilities_as_participant.add(d)}}else a.skip(e);break;case 6:if(e===b("ThriftTypes").MAP){c.actions_issued=new Map();d=a.readMapBegin();for(var f=0;f<d.size;++f){h=a.readI32();var i=v(a);g.has(h)&&c.actions_issued.set(h,i)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.is_moderator==null&&(c.is_moderator=!1);c.screenshare_enabled==null&&(c.screenshare_enabled=!1);c.action_capabilities_as_moderator==null&&(c.action_capabilities_as_moderator=new Set());c.action_capabilities_as_participant==null&&(c.action_capabilities_as_participant=new Set());return c};e.exports={ConferenceOutputState$DefaultConstructor:h,ModeratorActionInfo$DefaultConstructor:c,ModeratorActionTypes:a,ModeratorControlsInputState$DefaultConstructor:d,ModeratorControlsOutputState$DefaultConstructor:f,ModeratorInputState$DefaultConstructor:i,ParticipantCapabilityInfo$DefaultConstructor:j,ParticipantInputState$DefaultConstructor:k,ParticipantOutputState$DefaultConstructor:l,deserializeConferenceOutputState:u,deserializeModeratorActionInfo:v,deserializeModeratorControlsInputState:w,deserializeModeratorControlsOutputState:x,deserializeModeratorInputState:y,deserializeParticipantCapabilityInfo:z,deserializeParticipantInputState:A,deserializeParticipantOutputState:B,serializeConferenceOutputState:m,serializeModeratorActionInfo:n,serializeModeratorControlsInputState:o,serializeModeratorControlsOutputState:p,serializeModeratorInputState:q,serializeParticipantCapabilityInfo:r,serializeParticipantInputState:s,serializeParticipantOutputState:t}},null);
__d("RaisedHandsQueueState",["ThriftTypes","jsbi"],function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,JOIN:1,LEAVE:2});var g=new Set(Object.values(a));c=Object.freeze({UNKNOWN:0,HIDDEN:1,VISIBLE:2});var h=new Set(Object.values(c));d=function(){return{queue:[]}};f=function(){return{}};var i=function(){return{queue:[]}},j=function(){return{uid:"",state_info_history:[]}},k=function(){return{start_time:"0",is_new_state:!1}},l=function(a,c){c.writeStructBegin("RaisedHandsQueueConferenceOutputState");c.writeFieldBegin({fname:"queue",ftype:b("ThriftTypes").LIST,fid:1});if(a.queue!=null){c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.queue.length});for(var a=a.queue,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;o(f,c)}}else{f=[];c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:f.length});for(var e=0;e<f.length;e++){d=f[e];o(d,c)}}c.writeFieldStop();c.writeStructEnd()},m=function(a,c){c.writeStructBegin("RaisedHandsQueueParticipantInputState"),a.request_type!=null&&(c.writeFieldBegin({fname:"request_type",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.request_type)),c.writeFieldStop(),c.writeStructEnd()},n=function(a,c){c.writeStructBegin("RaisedHandsQueueParticipantOutputState");c.writeFieldBegin({fname:"queue",ftype:b("ThriftTypes").LIST,fid:1});if(a.queue!=null){c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.queue.length});for(var a=a.queue,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;o(f,c)}}else{f=[];c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:f.length});for(var e=0;e<f.length;e++){d=f[e];o(d,c)}}c.writeFieldStop();c.writeStructEnd()},o=function(a,c){c.writeStructBegin("RaisedHandsQueuer");c.writeFieldBegin({fname:"uid",ftype:b("ThriftTypes").STRING,fid:1});a.uid!=null?c.writeString(a.uid):c.writeString("");c.writeFieldBegin({fname:"state_info_history",ftype:b("ThriftTypes").LIST,fid:3});if(a.state_info_history!=null){c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.state_info_history.length});for(var a=a.state_info_history,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;p(f,c)}}else{f=[];c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:f.length});for(var e=0;e<f.length;e++){d=f[e];p(d,c)}}c.writeFieldStop();c.writeStructEnd()},p=function(a,c){c.writeStructBegin("RaisedHandsQueuerStateInfo"),a.state!=null&&(c.writeFieldBegin({fname:"state",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.state)),c.writeFieldBegin({fname:"start_time",ftype:b("ThriftTypes").I64,fid:2}),a.start_time!=null?c.writeI64(b("jsbi").BigInt(a.start_time)):c.writeI64(b("jsbi").BigInt("0")),c.writeFieldBegin({fname:"is_new_state",ftype:b("ThriftTypes").BOOL,fid:3}),a.is_new_state!=null?c.writeBool(a.is_new_state):c.writeBool(!1),c.writeFieldStop(),c.writeStructEnd()},q=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").LIST){c.queue=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=t(a);c.queue.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.queue==null&&(c.queue=[]);return c},r=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.request_type=d)}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},s=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").LIST){c.queue=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=t(a);c.queue.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.queue==null&&(c.queue=[]);return c},t=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.uid=a.readString():a.skip(e);break;case 3:if(e===b("ThriftTypes").LIST){c.state_info_history=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=u(a);c.state_info_history.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.uid==null&&(c.uid="");c.state_info_history==null&&(c.state_info_history=[]);return c},u=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();h.has(d)&&(c.state=d)}else a.skip(e);break;case 2:e===b("ThriftTypes").I64?c.start_time=a.readI64().toString():a.skip(e);break;case 3:e===b("ThriftTypes").BOOL?c.is_new_state=a.readBool():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.start_time==null&&(c.start_time="0");c.is_new_state==null&&(c.is_new_state=!1);return c};e.exports={RaisedHandsQueueConferenceOutputState$DefaultConstructor:d,RaisedHandsQueueParticipantInputState$DefaultConstructor:f,RaisedHandsQueueParticipantOutputState$DefaultConstructor:i,RaisedHandsQueueParticipantRequestTypes:a,RaisedHandsQueuer$DefaultConstructor:j,RaisedHandsQueuerStateInfo$DefaultConstructor:k,RaisedHandsQueuerStates:c,deserializeRaisedHandsQueueConferenceOutputState:q,deserializeRaisedHandsQueueParticipantInputState:r,deserializeRaisedHandsQueueParticipantOutputState:s,deserializeRaisedHandsQueuer:t,deserializeRaisedHandsQueuerStateInfo:u,serializeRaisedHandsQueueConferenceOutputState:l,serializeRaisedHandsQueueParticipantInputState:m,serializeRaisedHandsQueueParticipantOutputState:n,serializeRaisedHandsQueuer:o,serializeRaisedHandsQueuerStateInfo:p}},null);
__d("ScreenshareFloorControlState",["ThriftTypes"],function(a,b,c,d,e,f){"use strict";a=Object.freeze({NONE:0,REQUEST_FLOOR:1,RELEASE_FLOOR:2});var g=new Set(Object.values(a));c=function(){return{fbid:""}};d=function(){return{}};f=function(){return{floorParticipants:[]}};var h=function(a,c){c.writeStructBegin("FloorParticipant"),c.writeFieldBegin({fname:"fbid",ftype:b("ThriftTypes").STRING,fid:1}),a.fbid!=null?c.writeString(a.fbid):c.writeString(""),c.writeFieldStop(),c.writeStructEnd()},i=function(a,c){c.writeStructBegin("ScreenshareFloorControlInputState"),a.floorControlAction!=null&&(c.writeFieldBegin({fname:"floorControlAction",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.floorControlAction)),c.writeFieldStop(),c.writeStructEnd()},j=function(a,c){c.writeStructBegin("ScreenshareFloorControlOutputState");c.writeFieldBegin({fname:"floorParticipants",ftype:b("ThriftTypes").LIST,fid:1});if(a.floorParticipants!=null){c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.floorParticipants.length});for(var a=a.floorParticipants,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;h(f,c)}}else{f=[];c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:f.length});for(var e=0;e<f.length;e++){d=f[e];h(d,c)}}c.writeFieldStop();c.writeStructEnd()},k=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.fbid=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.fbid==null&&(c.fbid="");return c},l=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.floorControlAction=d)}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},m=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").LIST){c.floorParticipants=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=k(a);c.floorParticipants.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.floorParticipants==null&&(c.floorParticipants=[]);return c};e.exports={FloorControlActions:a,FloorParticipant$DefaultConstructor:c,ScreenshareFloorControlInputState$DefaultConstructor:d,ScreenshareFloorControlOutputState$DefaultConstructor:f,deserializeFloorParticipant:k,deserializeScreenshareFloorControlInputState:l,deserializeScreenshareFloorControlOutputState:m,serializeFloorParticipant:h,serializeScreenshareFloorControlInputState:i,serializeScreenshareFloorControlOutputState:j}},null);
__d("SimpleState",["ThriftTypes"],function(a,b,c,d,e,f){"use strict";a=function(){return{number:0}};c=function(){return{max:0}};d=function(a,c){c.writeStructBegin("SimpleInputState"),c.writeFieldBegin({fname:"number",ftype:b("ThriftTypes").I32,fid:1}),a.number!=null?c.writeI32(a.number):c.writeI32(0),c.writeFieldStop(),c.writeStructEnd()};f=function(a,c){c.writeStructBegin("SimpleOutputState"),c.writeFieldBegin({fname:"max",ftype:b("ThriftTypes").I32,fid:1}),a.max!=null?c.writeI32(a.max):c.writeI32(0),c.writeFieldStop(),c.writeStructEnd()};var g=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I32?c.number=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.number==null&&(c.number=0);return c},h=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I32?c.max=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.max==null&&(c.max=0);return c};e.exports={SimpleInputState$DefaultConstructor:a,SimpleOutputState$DefaultConstructor:c,deserializeSimpleInputState:g,deserializeSimpleOutputState:h,serializeSimpleInputState:d,serializeSimpleOutputState:f}},null);
__d("WorkroomsState",["ThriftTypes"],function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,JOIN_CONVERSATION:1,CREATE_CONVERSATION:2,LEAVE_CONVERSATION:3});var g=new Set(Object.values(a));c=function(){return{participant_ids:[]}};d=function(){return{active_conversations:new Map()}};f=function(){return{}};var h=function(){return{active_conversations:new Map()}},i=function(a,c){c.writeStructBegin("ActiveConversation");c.writeFieldBegin({fname:"participant_ids",ftype:b("ThriftTypes").LIST,fid:1});if(a.participant_ids!=null){c.writeListBegin({etype:b("ThriftTypes").STRING,size:a.participant_ids.length});for(var a=a.participant_ids,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;c.writeString(f)}}else{f=[];c.writeListBegin({etype:b("ThriftTypes").STRING,size:f.length});for(var e=0;e<f.length;e++){d=f[e];c.writeString(d)}}c.writeFieldStop();c.writeStructEnd()},j=function(a,c){c.writeStructBegin("WorkroomConferenceOutputState");c.writeFieldBegin({fname:"active_conversations",ftype:b("ThriftTypes").MAP,fid:1});if(a.active_conversations!=null){c.writeMapBegin({ktype:b("ThriftTypes").STRING,vtype:b("ThriftTypes").STRUCT,size:a.active_conversations.size});for(var a=a.active_conversations.entries(),d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];c.writeString(g);i(f,c)}}else{g=new Map();c.writeMapBegin({ktype:b("ThriftTypes").STRING,vtype:b("ThriftTypes").STRUCT,size:g.size});for(var f=g.entries(),e=Array.isArray(f),d=0,f=e?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=f.length)break;a=f[d++]}else{d=f.next();if(d.done)break;a=d.value}g=a;a=g[0];g=g[1];c.writeString(a);i(g,c)}}c.writeFieldStop();c.writeStructEnd()},k=function(a,c){c.writeStructBegin("WorkroomInputState");a.type!=null&&(c.writeFieldBegin({fname:"type",ftype:b("ThriftTypes").I32,fid:1}),c.writeI32(a.type));a.conversation_id!=null&&(c.writeFieldBegin({fname:"conversation_id",ftype:b("ThriftTypes").STRING,fid:2}),c.writeString(a.conversation_id));if(a.participant_ids!=null){a=a.participant_ids;c.writeFieldBegin({fname:"participant_ids",ftype:b("ThriftTypes").LIST,fid:3});c.writeListBegin({etype:b("ThriftTypes").STRING,size:a.length});for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;c.writeString(f)}}c.writeFieldStop();c.writeStructEnd()},l=function(a,c){c.writeStructBegin("WorkroomOutputState");c.writeFieldBegin({fname:"active_conversations",ftype:b("ThriftTypes").MAP,fid:1});if(a.active_conversations!=null){c.writeMapBegin({ktype:b("ThriftTypes").STRING,vtype:b("ThriftTypes").STRUCT,size:a.active_conversations.size});for(var a=a.active_conversations.entries(),d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];c.writeString(g);i(f,c)}}else{g=new Map();c.writeMapBegin({ktype:b("ThriftTypes").STRING,vtype:b("ThriftTypes").STRUCT,size:g.size});for(var f=g.entries(),e=Array.isArray(f),d=0,f=e?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=f.length)break;a=f[d++]}else{d=f.next();if(d.done)break;a=d.value}g=a;a=g[0];g=g[1];c.writeString(a);i(g,c)}}c.writeFieldStop();c.writeStructEnd()},m=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").LIST){c.participant_ids=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var g=a.readString();c.participant_ids.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.participant_ids==null&&(c.participant_ids=[]);return c},n=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").MAP){c.active_conversations=new Map();d=a.readMapBegin();for(var f=0;f<d.size;++f){var g=a.readString(),h=m(a);c.active_conversations.set(g,h)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.active_conversations==null&&(c.active_conversations=new Map());return c},o=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").I32){d=a.readI32();g.has(d)&&(c.type=d)}else a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.conversation_id=a.readString():a.skip(e);break;case 3:if(e===b("ThriftTypes").LIST){c.participant_ids=[];d=a.readListBegin();for(var f=0;f<d.size;++f){var h=a.readString();c.participant_ids.push(h)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},p=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:if(e===b("ThriftTypes").MAP){c.active_conversations=new Map();d=a.readMapBegin();for(var f=0;f<d.size;++f){var g=a.readString(),h=m(a);c.active_conversations.set(g,h)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.active_conversations==null&&(c.active_conversations=new Map());return c};e.exports={ActionTypes:a,ActiveConversation$DefaultConstructor:c,WorkroomConferenceOutputState$DefaultConstructor:d,WorkroomInputState$DefaultConstructor:f,WorkroomOutputState$DefaultConstructor:h,deserializeActiveConversation:m,deserializeWorkroomConferenceOutputState:n,deserializeWorkroomInputState:o,deserializeWorkroomOutputState:p,serializeActiveConversation:i,serializeWorkroomConferenceOutputState:j,serializeWorkroomInputState:k,serializeWorkroomOutputState:l}},null);
__d("ZenonStateSyncSerializer",["CompactSerializerPolyfill","CoplayState","LiveStreamState","MediaSyncAutoplayState","MediaSyncState","MeetingAssistantState","ModeratorControlsState","RaisedHandsQueueState","ScreenshareFloorControlState","SimpleState","WorkroomsState"],function(a,b,c,d,e,f){"use strict";f.deserializeOutputState=a;f.serializeInputState=c;function a(a,c){var d=null;switch(a){case"raised_hands_queue":d=b("RaisedHandsQueueState").deserializeRaisedHandsQueueParticipantOutputState;break;case"simple_internal":case"simple_external":d=b("SimpleState").deserializeSimpleOutputState;break;case"live_stream":d=b("LiveStreamState").deserializeLiveStreamClientOutputState;break;case"moderator_controls":d=b("ModeratorControlsState").deserializeModeratorControlsOutputState;break;case"media_sync":d=b("MediaSyncState").deserializeMediaSyncOutputState;break;case"media_sync_autoplay":d=b("MediaSyncAutoplayState").deserializeParticipantOutputState;break;case"coplay":d=b("CoplayState").deserializeCoplayOutputState;break;case"workroom":d=b("WorkroomsState").deserializeWorkroomOutputState;break;case"screenshare_floor_control":d=b("ScreenshareFloorControlState").deserializeScreenshareFloorControlOutputState;break;case"meeting_assistant":d=b("MeetingAssistantState").deserializeParticipantOutputState;break;default:break}return c!=null&&d!=null?b("CompactSerializerPolyfill").deserialize(new Uint8Array(atob(c).split("").map(function(a){return a.charCodeAt(0)})),d):null}function c(a,c){var d=null;switch(a){case"raised_hands_queue":d=b("RaisedHandsQueueState").serializeRaisedHandsQueueParticipantInputState;break;case"simple_internal":case"simple_external":d=b("SimpleState").serializeSimpleInputState;break;case"live_stream":d=b("LiveStreamState").serializeLiveStreamClientInputState;break;case"moderator_controls":d=b("ModeratorControlsState").serializeModeratorControlsInputState;break;case"media_sync":d=b("MediaSyncState").serializeMediaSyncInputState;break;case"media_sync_autoplay":d=b("MediaSyncAutoplayState").serializeParticipantInputState;break;case"coplay":d=b("CoplayState").serializeCoplayMatchInputState;break;case"workroom":d=b("WorkroomsState").serializeWorkroomInputState;break;case"screenshare_floor_control":d=b("ScreenshareFloorControlState").serializeScreenshareFloorControlInputState;break;case"meeting_assistant":d=b("MeetingAssistantState").serializeParticipantInputState;break;default:break}return c!=null&&d!=null?btoa(String.fromCharCode.apply(null,b("CompactSerializerPolyfill").serialize(c,d))):null}},null);
__d("ZenonStateSyncStore",["ZenonStateSyncSerializer"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map(),this.$2=new Map(),this.$3=new Set()}var c=a.prototype;c.getInputStates=function(){return this.$1};c.getOutputStates=function(){return this.$2};c.updateInputState=function(a,c){var d;this.$3.add(a);d=((d=(d=this.$1.get(a))==null?void 0:d.version)!=null?d:0)+1;this.$1.set(a,{data:c,version:d});a=b("ZenonStateSyncSerializer").serializeInputState(a,c);return a!==null?{data:a,version:d}:{version:d}};c.updateOutputState=function(a,c){var d;if(!this.$3.has(a))return;d=(d=(d=this.$2.get(a))==null?void 0:d.version)!=null?d:-1;if(c.version<=d)return;d=b("ZenonStateSyncSerializer").deserializeOutputState(a,c.data);this.$2.set(a,{data:d,version:c.version})};c.unsubscribe=function(a){var b;this.$3["delete"](a);b=((b=(b=this.$1.get(a))==null?void 0:b.version)!=null?b:0)+1;this.$1.set(a,{data:null,version:b});return{version:b}};return a}();e.exports=a},null);
__d("ZenonSignalingModel",["ZenonMediaModeManager","ZenonStateSyncStore"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e,f,g){this.$7=new(b("ZenonStateSyncStore"))(),this.$9=new(b("ZenonMediaModeManager"))(),this.$1=a,this.$2=c,this.$3=d,this.$4=e,this.$5=f,this.$6=g}var c=a.prototype;c.getSignalingID=function(){return this.$1};c.updateRemoteSignalingID=function(a){this.$2=a};c.getRemoteSignalingID=function(){return this.$2};c.getUserInfo=function(){return this.$3};c.getRemoteInfo=function(){return this.$4};c.getRoomInfo=function(){return this.$5};c.getProtocol=function(){return this.$6};c.getMediaModeManager=function(){return this.$9};c.getStateSyncStore=function(){return this.$7};c.setNotifyCallback=function(a){this.$8=a};c.notify=function(){this.$8&&this.$8()};return a}();e.exports=a},null);
__d("ZenonSignalingClientManager",["CurrentUser","ZenonProtocolConfiguration","ZenonSignalingModel","immutable","randomInt"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d){d===void 0&&(d=null),this.$6=null,this.$1=b("immutable").Map(),this.$2={userID:b("CurrentUser").getID()},this.$3=c,this.$4=new Set(),this.$5=a,this.$6=d}var c=a.prototype;c.getSignalingClient=function(a){return this.$1.get(a)};c.getSignalingClientWithRemoteSignalingID=function(a){var b=this.$1.find(function(b){return b.getSignalingModel().getRemoteSignalingID()===a});return b};c.createSignalingClient=function(a,c,d,e,f){a=(a=a)!=null?a:String(b("randomInt")(0,4294967294)+1);d=new(b("ZenonSignalingModel"))(a,d,this.$2,c,f,e);c=b("ZenonProtocolConfiguration").getConfiguration(d,this.$6);f=c.eventAggregator;e=c.messageSender;c=c.transactionManager;var g=new this.$5(d,c,f,this.$3);e.setMessageReceiver(function(a){return g.receiveMessage(a)});this.$1=this.$1.set(a,g);return g};c.receiveMessage=function(a){var b=a.getHeader(),c=this.$7(a);if(c==null)return;else a.setSignalingID(c);var d=this.getSignalingClient(c);if(d!=null)d.receiveMessage(a);else{d=this.createSignalingClient(c,b.remoteInfo,b.remoteSignalingID,b.protocol,b.roomInfo);d.getSignalingModel().updateRemoteSignalingID(b.remoteSignalingID);d.receiveMessage(a)}};c.$7=function(a){var c=a.getHeader(),d=c.signalingID;if(d!=null)return d;if(!this.$8(c.messageID))return null;c=c.remoteSignalingID;if(a.getEvents().some(function(a){return a.eventName==="terminateRequest"})&&c!=null){a=this.getSignalingClientWithRemoteSignalingID(c);a&&(d=a.getSignalingModel().getSignalingID())}if(d==null){c=b("randomInt")(0,4294967294)+1;d=String(c)}return d};c.$8=function(a){if(this.$4.has(a))return!1;this.$4.add(a);return!0};return a}();e.exports=a},null);
__d("ZenonTransportEventEmitter",["EventEmitter"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.emitJoinReady=function(a){this.emit("transportPlatformEvent",{messageType:"joinReady",mwRingRequest:a})};c.emitParentWindowConnectionTimeout=function(){this.emit("transportPlatformEvent",{messageType:"parentWindowConnectionTimeout",mwRingRequest:null})};return b}(b("EventEmitter"));c=new a();d=c;e.exports=d},null);
__d("ZenonCallsManager",["invariant","regeneratorRuntime","Promise","FBLogger","PlatformType","ScotchRTWebUserActionLogger","ZenonCallLogger","ZenonChildCallSummaryLogProcessor","ZenonConnectionStateManager","ZenonDismissReason","ZenonHybridMWMessageSender","ZenonInfraActionLogProcessor","ZenonMultiwayReliabilityLogProcessor","ZenonMWMessageTranslator","ZenonPlatformExperiments","ZenonRTCPeerConnectionConfig","ZenonSignalingChildTransport","ZenonSignalingClient","ZenonSignalingClientManager","ZenonSimulcastExperiments","ZenonTransportEventEmitter","ZenonTurnDiscovery","gkx","immutable","promiseDone","requireCond","unrecoverableViolation","cr:1606520","cr:1557768","cr:1625711","cr:1578322"],function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var c=this;this.$4=new Map();this.$5=null;this.$6="";this.$7=b("ZenonPlatformExperiments").isMwpp()?"mw++":"mw";this.$1=b("immutable").Map();this.$2=a;a=b("gkx")("1747845");var d=null;a&&(d=new(b("ZenonHybridMWMessageSender"))());this.$3=new(b("ZenonSignalingClientManager"))(b("ZenonSignalingClient"),function(a,b,d){return c.onInviteReceived(a,b,d)},d);this.$8=this.$9()}var c=a.prototype;c.$9=function(){var a,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:if(!(this.$7==="mw")){d.next=2;break}return d.abrupt("return");case 2:a=Date.now();d.prev=3;d.next=6;return b("regeneratorRuntime").awrap(b("ZenonTurnDiscovery").requestTurnCreds("ZenonPlatform","MW_PEER_ID"));case 6:c=d.sent;b("ZenonRTCPeerConnectionConfig").setTurnCredentials(c);b("ScotchRTWebUserActionLogger").logCheckpoint({callType:"mw",checkpoint:"[ZP] successfully acquired TURN credentials. Took "+(Date.now()-a)+" ms."});d.next=14;break;case 11:d.prev=11,d.t0=d["catch"](3),b("ScotchRTWebUserActionLogger").logError({callType:"mw",checkpoint:"[ZP] failed to get TURN credentials. Took "+(Date.now()-a)+" ms. Error message: "+d.t0,errorDomain:"ZenonCallsManager_fetchTurnCredentials"});case 14:case"end":return d.stop()}},null,this,[[3,11]])};c.$10=function(a){this.$6=a};c.getLogProcessors=function(){var a=[b("ZenonChildCallSummaryLogProcessor"),b("ZenonInfraActionLogProcessor"),b("ZenonMultiwayReliabilityLogProcessor")];b("cr:1557768")&&a.push(b("cr:1557768"));b("cr:1578322")&&a.push(b("cr:1578322"));b("cr:1606520")&&a.push(b("cr:1606520"));b("cr:1625711")&&a.push(b("cr:1625711"));return a};c.onInviteReceived=function(a,c,d){c=this.$2.getConfigManager().getZenonMultiCallSupportConfig().getMaxConnectedCalls();var e=this.$1.filter(function(a){return a.getConnectionState()!=="terminated"}),f=e.filter(function(b){return b.getServerCallID()===((b=a.roomInfo.context)==null?void 0:b.serverInfoData)});if(f.size>0){d.respondToInvite("OK");return}f=e.some(function(a){return a.getServerCallID()==null});e.size>=c?(e.size>c&&b("FBLogger")("rtc_www").warn("We have more than supported number of calls occurring"),d.respondToInvite("IN_ANOTHER_CALL"),f||d.sendDismiss(b("ZenonDismissReason").ZenonDismissReason.InAnotherCall)):d.respondToInvite("NOT_SUPPORTED")};c.join=function(a){var c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return b("regeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:a.peerID!=null||g(0,18600);d={userID:a.peerID};e=a.callTrigger,f=a.clientCallID,h=a.localMedia,i=a.mwRingRequest,j=a.peerID,k=a.serverCallID,l=a.usersToRing;m={name:a.roomID};i!=null&&(i.jsonPayload.header.clientSessionId=(n=k)!=null?n:"");if(!(this.$1.get(f)!=null)){z.next=7;break}throw b("unrecoverableViolation")("Call with id "+f+" already exists. Use a new clientCallID/clientSessionID if rejoining.","rtc_www");case 7:o=null;k!=null&&(o=this.$3.getSignalingClient(k));o==null&&(o=this.$3.createSignalingClient(k,d,a.serverInfoData,this.$7,m));p=o.getSignalingModel();q=p.getSignalingID();r=i==null;s=(i==null?void 0:(c=i.jsonPayload.body.ringRequest)==null?void 0:c.offer)!=null;p.getMediaModeManager().onJoin(r,this.$7==="mw++",l.length,s);t=this.$4.get(f);t==null&&(v=h.find(function(a){return a.contentType==="video"})!=null,t=new(b("ZenonCallLogger"))({callID:(u=k)!=null?u:f,callTrigger:e,conferenceName:a.roomID,isCaller:r,isVideo:v,peerID:j,protocol:this.$7,serverInfoData:a.serverInfoData,signalingID:q},this.getLogProcessors()),this.$4.set(f,t));this.$10(q);w=b("ZenonSimulcastExperiments").shouldUseSimulcast(this.$7==="mw"||this.$7==="mw++");o!=null||g(0,23327);if(!(p.getMediaModeManager().getMediaMode()==="p2p")){z.next=23;break}z.next=23;return b("regeneratorRuntime").awrap(this.$8);case 23:x=new(b("ZenonConnectionStateManager"))(f,o,r?"outgoing":"incoming",this.$2.getConfigManager(),t,w),t.log({hasOfferInRingRequest:s,isCaller:r,name:"callJoinRequest"}),this.$1=this.$1.set(f,x),x.start(a),b("ScotchRTWebUserActionLogger").logCheckpoint({callID:k,callType:"mw",checkpoint:"[ZP] ZenonCallsManager_join called, starting connectionStateManager",conferenceName:a.roomID,isCaller:r}),i&&(y=b("ZenonMWMessageTranslator").toSignalingMessage(i),this.$3.receiveMessage(y));case 29:case"end":return z.stop()}},null,this)};c.addLocalTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.addLocalTrack(b)};c.removeLocalTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.removeLocalTrack(b)};c.muteTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.muteTrack(b)};c.unmuteTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.unmuteTrack(b)};c.stopLocalVideo=function(a,b){(a=this.$1.get(a))==null?void 0:a.stopLocalTrack(b)};c.initializeV2Infrastructure=function(a,c){var d,e={userID:c.peerID},f={name:c.roomID};d=this.$3.createSignalingClient((d=c.callID)==null?void 0:d.toString(),e,c.serverInfoData,this.$7,f);e=d.getSignalingModel().getSignalingID();f=new(b("ZenonCallLogger"))({callID:(d=(f=c.callID)==null?void 0:f.toString())!=null?d:a,callTrigger:c.callTrigger,conferenceName:c.roomID,isCaller:!1,isVideo:c.initializeVideo,peerID:c.peerID,protocol:this.$7,serverInfoData:c.serverInfoData,signalingID:e},this.getLogProcessors());this.$4.set(a,f)};c.initializeSignaling=function(a,c,d){var e=this,f=this.$2.getSignalingListener();f.subscribe(function(a){return e.$3.receiveMessage(a)},function(a){});f=this.$2.getConfigManager().getZenonStartCallImmediatelyConfig().isEnabled();if(f)b("ZenonTransportEventEmitter").emitJoinReady();else if(c!=null){f=this.$2.getConfigManager().getZenonPlatformSupportConfig().getParentWindowConnectionTimeoutMs();this.$5=new(b("ZenonSignalingChildTransport"))(c,a,f,d)}this.$5&&b("promiseDone")(this.$5.connect(),function(a){a.state==="join_ready"?b("ZenonTransportEventEmitter").emitJoinReady(a.mwRingRequest):b("ZenonTransportEventEmitter").emitParentWindowConnectionTimeout()})};c.endCall=function(a,c,d){c=b("ZenonDismissReason").endCallToDismissReason(c);var e=this.$1.get(a);if(e)e.end(c,d);else{e=this.$4.get(a);e!=null?e.log({endCallReason:c,endCallSubreason:d,isRemoteEnded:!1,name:"callEnded"}):b("FBLogger")("rtc_www").warn("ZenonCallLogger missing for endCall")}};c.ringParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.addParticipants(b)};c.removeParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.removeParticipants(b)};c.replaceLocalTrack=function(a,c,d,e){e===void 0;e=this.$1.get(a);e!=null&&e.replaceLocalTrack(c,d);return b("Promise").resolve()};c.notifyScreenShareStart=function(a){};c.notifyScreenShareEnd=function(a){};c.forceEncodingEnabled=function(a,b){(a=this.$1.get(a))==null?void 0:a.forceEncodingEnabled(b)};c.acceptVideoEscalation=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:g(0,11323);case 1:case"end":return a.stop()}},null,this)};c.declineVideoEscalation=function(){g(0,11323)};c.cancelVideoEscalation=function(){g(0,11323)};c.startVideoEscalation=function(){g(0,11323)};c.submitRating=function(a,b,c,d){c===void 0&&(c=null);d===void 0&&(d=null);a=this.$4.get(a);a&&(b!=null&&a.log({name:"callRated",rating:b}),c!=null&&a.log({feedback:c,name:"callFeedbackSubmitted"}),d!=null&&a.log({name:"callSurveyChoiceSubmitted",surveyChoice:d}))};c.setRatingImpression=function(a,b){};c.getCalls=function(){return this.$1};c.setCalls=function(a){this.$1=a};c.createDataMessageSubscription=function(a,b,c){a=this.$1.get(a);a!=null&&a.createDataMessageSubscription(b,c)};c.removeDataMessageSubscription=function(a,b,c){a=this.$1.get(a);a!=null&&a.removeDataMessageSubscription(b,c)};c.sendGenericDataMessage=function(a,b,c,d,e){a=this.$1.get(a);a!=null&&a.sendGenericDataMessage(b,c,d,e)};c.logWithLogIdentifiers=function(a,b){a=this.$4.get(a);a!=null&&b(a.getLogIdentifiers())};c.subscribeToRemoteVideo=function(a,b,c){a=this.$1.get(a);a!=null&&a.subscribeToRemoteVideo(b,c)};c.updateStateSyncTopic=function(a,b,c){a=this.$1.get(a);a!=null&&a.updateStateSyncTopic(b,c)};c.unsubscribeFromStateSyncTopic=function(a,b){a=this.$1.get(a);a!=null&&a.unsubscribeFromStateSyncTopic(b)};c.approveParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.approveParticipants(b.toArray())};c.denyParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.denyParticipants(b.toArray())};c.getPlatformType=function(){return b("PlatformType").Zenon};c.getCallProtocolType=function(){return"multiway"};return a}();e.exports=a},null);
__d("ZenonPeerConnectionDataActions",[],function(a,b,c,d,e,f){"use strict";a=function(a,b){if(b.type==="createDataChannel"){b=b.payload;var c=b.dataChannelLabel;b=b.onDataChannelMessage;a.mediaChannelManager.createDataChannel(c,b)}};f.onCreateDataChannel=a;b=function(a,b){if(b.type==="dataChannelMessageReceived"){b=b.payload;var c=b.data;b=b.dataChannelLabel;a.onDataChannelMessageReceived(b,c)}};f.onDataChannelMessageReceived=b},null);
__d("ZenonPeerConnectionIceActions",["ScotchRTWebUserActionLogger"],function(a,b,c,d,e,f){"use strict";var g={onIceConnected:function(a){a.onConnectionEstablished(),a.logEvent({name:"mediaConnected"})},onIceConnectionStateChanged:function(a,c){if(c.type==="iceConnectionStateChange"){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"iceConnectionStateChange: "+c.payload.iceConnectionState,codebase_version:"Zenon"});var d=c.payload.iceConnectionState==="connected"||c.payload.iceConnectionState==="completed",e=c.payload.iceConnectionState==="disconnected"||c.payload.iceConnectionState==="failed";a.logEvent({connected:d,name:"peerConnectionStateChanged",newState:c.payload.iceConnectionState});d?g.onIceConnected(a):e&&a.onConnectionDropped();return c.payload}return{}}};a=g;e.exports=a},null);
__d("AggregateError",[],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(c,d){var e;d=(d=d)!=null?d:g(c);e=a.call(this,d)||this;e.name="AggregateError";e.errors=c;e.message=d;Error.captureStackTrace&&Error.captureStackTrace(babelHelpers.assertThisInitialized(e),b);return e}return b}(babelHelpers.wrapNativeSuper(Error));e.exports=a;function g(a){if(a.length===0)return"No errors";return a.length===1?a[0].message:a.map(function(a){return"- "+a.message}).join("\n")}},null);
__d("ZenonPeerConnectionMediaActions",["regeneratorRuntime","Promise","AggregateError","ScotchRTWebUserActionLogger","err","gkx"],function(a,b,c,d,e,f){"use strict";a=function(a,b){b.type==="applyRemoteIceCandidate"&&a.sdpManager.setRemoteIceCandidate(b.payload)};f.applyRemoteIceCandidate=a;c=function(a,c){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Failed to add local tracks: "+c.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onAddLocalTracks"})};f.onAddLocalTracksError=c;d=function(a,c){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Successfully added local tracks",codebase_version:"Zenon"});return c.data};f.onAddedLocalTracks=d;e=function(a,c){var d,e,f;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:if(!(c.type!=="addLocalTracks")){h.next=2;break}return h.abrupt("return",{});case 2:d=c.payload.tracks;e=[];h.next=6;return b("regeneratorRuntime").awrap(b("Promise").allSettled(d.map(function(c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(a.mediaChannelManager.addTrack(c));case 2:g(a,c.trackId,b("gkx")("1643601")?c.enabled:!0);case 3:case"end":return d.stop()}},null,this)})));case 6:f=h.sent;f.forEach(function(a){a.status==="rejected"&&e.push(new(b("err"))(a.reason))});if(!(e.length>0)){h.next=10;break}throw new(b("AggregateError"))(e);case 10:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"add local tracks",codebase_version:"Zenon"});return h.abrupt("return",{localMediaStateVersion:a.localMediaStateVersion+d.length});case 12:case"end":return h.stop()}},null,this)};f.onAddingLocalTracks=e;a=function(a,b){if(b.type!=="forceEncodingEnabled")return;a.mediaChannelManager.forceEncodingEnabled(b.payload.enabled)};f.onForceEncodingEnabled=a;c=function(a,b){b.type==="iceCandidateReady"&&a.onIceCandidateReady(b.payload)};f.onIceCandidateReady=c;d=function(a,c){if(c.type!=="localMediaStateUpdateRetry")return{};b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"local media state update retry",codebase_version:"Zenon"});return h(a)};f.onLocalMediaStateUpdateRetry=d;e=function(a,c){if(c.type==="muteLocalTrack"){a=g(a,c.payload.trackId,!1);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"mute local track",codebase_version:"Zenon"});return a}return{}};f.onMuteLocalTrack=e;a=function(a,c){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Failed to remove local track: "+c.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onRemoveLocalTracks"})};f.onRemoveLocalTrackError=a;c=function(a,c){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Successfully removed local track",codebase_version:"Zenon"});return c.data};f.onRemovedLocalTrack=c;d=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!(c.type!=="removeLocalTrack")){f.next=2;break}return f.abrupt("return",{});case 2:d=c.payload.trackId;f.next=5;return b("regeneratorRuntime").awrap(a.mediaChannelManager.removeTrack(d));case 5:e=g(a,d,!1);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"remove local track with id "+d,codebase_version:"Zenon"});return f.abrupt("return",e);case 8:case"end":return f.stop()}},null,this)};f.onRemovingLocalTrack=d;e=function(a,c){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Failed to replace local tracks: "+c.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onReplaceLocalTrack"})};f.onReplaceLocalTrackError=e;a=function(a,c){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!(c.type!=="replaceLocalTrack")){g.next=2;break}return g.abrupt("return");case 2:d=c.payload,e=d.replacementTrack,f=d.trackIdToReplace;g.next=5;return b("regeneratorRuntime").awrap(a.mediaChannelManager.replaceTrack(f,e));case 5:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"replace local track with id "+f+" by track "+e.trackId,codebase_version:"Zenon"});case 6:case"end":return g.stop()}},null,this)};f.onReplacingLocalTrack=a;c=function(a,b){return b.type!=="setLocalMediaStateVersion"?{}:{localMediaStateVersion:b.payload.version}};f.onSetLocalMediaStateVersion=c;d=function(a,b){if(b.type!=="stopLocalTrack")return;b=b.payload.trackId;a.mediaChannelManager.stopLocalTrack(b)};f.onStopLocalTrack=d;e=function(a,c){if(c.type==="unmuteLocalTrack"){a=g(a,c.payload.trackId,!0);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"unmute local track",codebase_version:"Zenon"});return a}return{}};f.onUnmuteLocalTrack=e;function g(a,b,c){var d=a.mediaChannelManager;c?d.unmuteTrack(b):d.muteTrack(b);return h(a)}function h(a){var b=a.mediaChannelManager,c=[];b=b.getLocalTracksForMWS();b.forEach(function(a){a={enabled:a.enabled,trackID:a.trackId,type:a.contentType};c.push(a)});b=a.localMediaStateVersion+1;var d={tracks:c,version:b};a.onLocalMediaStateUpdate(d);return{localMediaStateVersion:b}}},null);
__d("ZenonPeerConnectionSMGuards",["ZenonDebugLogger"],function(a,b,c,d,e,f){"use strict";f.applyRemoteOfferSdpGuard=a;f.iceConnectedEventGuard=c;f.iceConnectedGuard=d;f.iceDisconnectedEventGuard=e;f.iceNotConnectedGuard=g;function a(a,c){a=c.type==="applyRemoteSdp"&&c.payload.sdp.type==="offer";b("ZenonDebugLogger").getInstance().logGuardsResults("applyRemoteOfferSdpGuard",a);return a}function c(a,c){a=c.type==="iceConnectionStateChange"&&(c.payload.iceConnectionState==="connected"||c.payload.iceConnectionState==="completed");b("ZenonDebugLogger").getInstance().logGuardsResults("iceConnectedEventGuard",a);return a}function d(a){a=a.iceConnectionState==="connected"||a.iceConnectionState==="completed";b("ZenonDebugLogger").getInstance().logGuardsResults("iceConnectedGuard",a);return a}function e(a,c){a=c.type==="iceConnectionStateChange"&&c.payload.iceConnectionState==="disconnected";b("ZenonDebugLogger").getInstance().logGuardsResults("iceDisconnectedEventGuard",a);return a}function g(a){a=a.iceConnectionState!=="connected"&&a.iceConnectionState!=="completed";b("ZenonDebugLogger").getInstance().logGuardsResults("iceNotConnectedGuard",a);return a}},null);
/**
 * Released under the MIT license. Copyright (c) 2013 Eirik Albrigtsen.
 *
 * @nolint
 * @preserve-header
 * @preserve-whitespace
 */
__d("sdp-transform-grammar",[],(function $module_sdp_transform_grammar(global,require,requireDynamic,requireLazy,module,exports){

var grammar = module.exports = {
  v: [{
    name: 'version',
    reg: /^(\d*)$/
  }],
  o: [{ //o=- 20518 0 IN IP4 203.0.113.1
    // NB: sessionId will be a String in most cases because it is huge
    name: 'origin',
    reg: /^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,
    names: ['username', 'sessionId', 'sessionVersion', 'netType', 'ipVer', 'address'],
    format: '%s %s %d %s IP%d %s'
  }],
  // default parsing of these only (though some of these feel outdated)
  s: [{ name: 'name' }],
  i: [{ name: 'description' }],
  u: [{ name: 'uri' }],
  e: [{ name: 'email' }],
  p: [{ name: 'phone' }],
  z: [{ name: 'timezones' }], // TODO: this one can actually be parsed properly..
  r: [{ name: 'repeats' }],   // TODO: this one can also be parsed properly
  //k: [{}], // outdated thing ignored
  t: [{ //t=0 0
    name: 'timing',
    reg: /^(\d*) (\d*)/,
    names: ['start', 'stop'],
    format: '%d %d'
  }],
  c: [{ //c=IN IP4 10.47.197.26
    name: 'connection',
    reg: /^IN IP(\d) (\S*)/,
    names: ['version', 'ip'],
    format: 'IN IP%d %s'
  }],
  b: [{ //b=AS:4000
    push: 'bandwidth',
    reg: /^(TIAS|AS|CT|RR|RS):(\d*)/,
    names: ['type', 'limit'],
    format: '%s:%s'
  }],
  m: [{ //m=video 51744 RTP/AVP 126 97 98 34 31
    // NB: special - pushes to session
    // TODO: rtp/fmtp should be filtered by the payloads found here?
    reg: /^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,
    names: ['type', 'port', 'protocol', 'payloads'],
    format: '%s %d %s %s'
  }],
  a: [
    { //a=rtpmap:110 opus/48000/2
      push: 'rtp',
      reg: /^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,
      names: ['payload', 'codec', 'rate', 'encoding'],
      format: function (o) {
        return (o.encoding) ?
          'rtpmap:%d %s/%s/%s':
          o.rate ?
          'rtpmap:%d %s/%s':
          'rtpmap:%d %s';
      }
    },
    { //a=fmtp:108 profile-level-id=24;object=23;bitrate=64000
      //a=fmtp:111 minptime=10; useinbandfec=1
      push: 'fmtp',
      reg: /^fmtp:(\d*) ([\S| ]*)/,
      names: ['payload', 'config'],
      format: 'fmtp:%d %s'
    },
    { //a=control:streamid=0
      name: 'control',
      reg: /^control:(.*)/,
      format: 'control:%s'
    },
    { //a=rtcp:65179 IN IP4 193.84.77.194
      name: 'rtcp',
      reg: /^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,
      names: ['port', 'netType', 'ipVer', 'address'],
      format: function (o) {
        return (o.address != null) ?
          'rtcp:%d %s IP%d %s':
          'rtcp:%d';
      }
    },
    { //a=rtcp-fb:98 trr-int 100
      push: 'rtcpFbTrrInt',
      reg: /^rtcp-fb:(\*|\d*) trr-int (\d*)/,
      names: ['payload', 'value'],
      format: 'rtcp-fb:%d trr-int %d'
    },
    { //a=rtcp-fb:98 nack rpsi
      push: 'rtcpFb',
      reg: /^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,
      names: ['payload', 'type', 'subtype'],
      format: function (o) {
        return (o.subtype != null) ?
          'rtcp-fb:%s %s %s':
          'rtcp-fb:%s %s';
      }
    },
    { //a=extmap:2 urn:ietf:params:rtp-hdrext:toffset
      //a=extmap:1/recvonly URI-gps-string
      push: 'ext',
      reg: /^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,
      names: ['value', 'direction', 'uri', 'config'],
      format: function (o) {
        return 'extmap:%d' + (o.direction ? '/%s' : '%v') + ' %s' + (o.config ? ' %s' : '');
      }
    },
    { //a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32
      push: 'crypto',
      reg: /^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,
      names: ['id', 'suite', 'config', 'sessionConfig'],
      format: function (o) {
        return (o.sessionConfig != null) ?
          'crypto:%d %s %s %s':
          'crypto:%d %s %s';
      }
    },
    { //a=setup:actpass
      name: 'setup',
      reg: /^setup:(\w*)/,
      format: 'setup:%s'
    },
    { //a=mid:1
      name: 'mid',
      reg: /^mid:([^\s]*)/,
      format: 'mid:%s'
    },
    { //a=msid:0c8b064d-d807-43b4-b434-f92a889d8587 98178685-d409-46e0-8e16-7ef0db0db64a
      name: 'msid',
      reg: /^msid:(.*)/,
      format: 'msid:%s'
    },
    { //a=ptime:20
      name: 'ptime',
      reg: /^ptime:(\d*)/,
      format: 'ptime:%d'
    },
    { //a=maxptime:60
      name: 'maxptime',
      reg: /^maxptime:(\d*)/,
      format: 'maxptime:%d'
    },
    { //a=sendrecv
      name: 'direction',
      reg: /^(sendrecv|recvonly|sendonly|inactive)/
    },
    { //a=ice-lite
      name: 'icelite',
      reg: /^(ice-lite)/
    },
    { //a=ice-ufrag:F7gI
      name: 'iceUfrag',
      reg: /^ice-ufrag:(\S*)/,
      format: 'ice-ufrag:%s'
    },
    { //a=ice-pwd:x9cml/YzichV2+XlhiMu8g
      name: 'icePwd',
      reg: /^ice-pwd:(\S*)/,
      format: 'ice-pwd:%s'
    },
    { //a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33
      name: 'fingerprint',
      reg: /^fingerprint:(\S*) (\S*)/,
      names: ['type', 'hash'],
      format: 'fingerprint:%s %s'
    },
    { //a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host
      //a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10
      //a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10
      //a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10
      //a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10
      push:'candidates',
      reg: /^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,
      names: ['foundation', 'component', 'transport', 'priority', 'ip', 'port', 'type', 'raddr', 'rport', 'tcptype', 'generation', 'network-id', 'network-cost'],
      format: function (o) {
        var str = 'candidate:%s %d %s %d %s %d typ %s';

        str += (o.raddr != null) ? ' raddr %s rport %d' : '%v%v';

        // NB: candidate has three optional chunks, so %void middles one if it's missing
        str += (o.tcptype != null) ? ' tcptype %s' : '%v';

        if (o.generation != null) {
          str += ' generation %d';
        }

        str += (o['network-id'] != null) ? ' network-id %d' : '%v';
        str += (o['network-cost'] != null) ? ' network-cost %d' : '%v';
        return str;
      }
    },
    { //a=end-of-candidates (keep after the candidates line for readability)
      name: 'endOfCandidates',
      reg: /^(end-of-candidates)/
    },
    { //a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401 ...
      name: 'remoteCandidates',
      reg: /^remote-candidates:(.*)/,
      format: 'remote-candidates:%s'
    },
    { //a=ice-options:trickle fb-force-5245
      name: 'iceOptions',
      reg: /^ice-options:(.*)/,
      format: 'ice-options:%s'
    },
    { //a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1
      push: 'ssrcs',
      reg: /^ssrc:(\d*) ([\w_]*)(?::(.*))?/,
      names: ['id', 'attribute', 'value'],
      format: function (o) {
        var str = 'ssrc:%d';
        if (o.attribute != null) {
          str += ' %s';
          if (o.value != null) {
            str += ':%s';
          }
        }
        return str;
      }
    },
    { //a=ssrc-group:FEC 1 2
      //a=ssrc-group:FEC-FR 3004364195 1080772241
      push: 'ssrcGroups',
      // token-char = %x21 / %x23-27 / %x2A-2B / %x2D-2E / %x30-39 / %x41-5A / %x5E-7E
      reg: /^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,
      names: ['semantics', 'ssrcs'],
      format: 'ssrc-group:%s %s'
    },
    { //a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV
      name: 'msidSemantic',
      reg: /^msid-semantic:\s?(\w*) (\S*)/,
      names: ['semantic', 'token'],
      format: 'msid-semantic: %s %s' // space after ':' is not accidental
    },
    { //a=group:BUNDLE audio video
      push: 'groups',
      reg: /^group:(\w*) (.*)/,
      names: ['type', 'mids'],
      format: 'group:%s %s'
    },
    { //a=rtcp-mux
      name: 'rtcpMux',
      reg: /^(rtcp-mux)/
    },
    { //a=rtcp-rsize
      name: 'rtcpRsize',
      reg: /^(rtcp-rsize)/
    },
    { //a=sctpmap:5000 webrtc-datachannel 1024
      name: 'sctpmap',
      reg: /^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,
      names: ['sctpmapNumber', 'app', 'maxMessageSize'],
      format: function (o) {
        return (o.maxMessageSize != null) ?
          'sctpmap:%s %s %s' :
          'sctpmap:%s %s';
      }
    },
    { //a=x-google-flag:conference
      name: 'xGoogleFlag',
      reg: /^x-google-flag:([^\s]*)/,
      format: 'x-google-flag:%s'
    },
    { //a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0
      push: 'rids',
      reg: /^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,
      names: ['id', 'direction', 'params'],
      format: function (o) {
        return (o.params) ? 'rid:%s %s %s' : 'rid:%s %s';
      }
    },
    { //a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]
      //a=imageattr:* send [x=800,y=640] recv *
      //a=imageattr:100 recv [x=320,y=240]
      push: 'imageattrs',
      reg: new RegExp(
        //a=imageattr:97
        '^imageattr:(\\d+|\\*)' +
        //send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]
        '[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)' +
        //recv [x=330,y=250]
        '(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?'
      ),
      names: ['pt', 'dir1', 'attrs1', 'dir2', 'attrs2'],
      format: function (o) {
        return 'imageattr:%s %s %s' + (o.dir2 ? ' %s %s' : '');
      }
    },
    { //a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8
      //a=simulcast:recv 1;4,5 send 6;7
      name: 'simulcast',
      reg: new RegExp(
        //a=simulcast:
        '^simulcast:' +
        //send 1,2,3;~4,~5
        '(send|recv) ([a-zA-Z0-9\\-_~;,]+)' +
        //space + recv 6;~7,~8
        '(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?' +
        //end
        '$'
      ),
      names: ['dir1', 'list1', 'dir2', 'list2'],
      format: function (o) {
        return 'simulcast:%s %s' + (o.dir2 ? ' %s %s' : '');
      }
    },
    { //Old simulcast draft 03 (implemented by Firefox)
      //  https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03
      //a=simulcast: recv pt=97;98 send pt=97
      //a=simulcast: send rid=5;6;7 paused=6,7
      name: 'simulcast_03',
      reg: /^simulcast:[\s\t]+([\S+\s\t]+)$/,
      names: ['value'],
      format: 'simulcast: %s'
    },
    {
      //a=framerate:25
      //a=framerate:29.97
      name: 'framerate',
      reg: /^framerate:(\d+(?:$|\.\d+))/,
      format: 'framerate:%s'
    },
    { // any a= that we don't understand is kepts verbatim on media.invalid
      push: 'invalid',
      names: ['value']
    }
  ]
};

// set sensible defaults to avoid polluting the grammar with boring details
Object.keys(grammar).forEach(function (key) {
  var objs = grammar[key];
  objs.forEach(function (obj) {
    if (!obj.reg) {
      obj.reg = /(.*)/;
    }
    if (!obj.format) {
      obj.format = '%s';
    }
  });
});

/*  */}),null);
/**
 * Released under the MIT license. Copyright (c) 2013 Eirik Albrigtsen.
 *
 * @nolint
 * @preserve-header
 * @preserve-whitespace
 */
__d("sdp-transform-parser",["sdp-transform-grammar"],(function $module_sdp_transform_parser(global,require,requireDynamic,requireLazy,module,exports){

var toIntIfInt = function (v) {
  return String(Number(v)) === v ? Number(v) : v;
};

var attachProperties = function (match, location, names, rawName) {
  if (rawName && !names) {
    location[rawName] = toIntIfInt(match[1]);
  }
  else {
    for (var i = 0; i < names.length; i += 1) {
      if (match[i+1] != null) {
        location[names[i]] = toIntIfInt(match[i+1]);
      }
    }
  }
};

var parseReg = function (obj, location, content) {
  var needsBlank = obj.name && obj.names;
  if (obj.push && !location[obj.push]) {
    location[obj.push] = [];
  }
  else if (needsBlank && !location[obj.name]) {
    location[obj.name] = {};
  }
  var keyLocation = obj.push ?
    {} :  // blank object that will be pushed
    needsBlank ? location[obj.name] : location; // otherwise, named location or root

  attachProperties(content.match(obj.reg), keyLocation, obj.names, obj.name);

  if (obj.push) {
    location[obj.push].push(keyLocation);
  }
};

var grammar = require('sdp-transform-grammar');
var validLine = RegExp.prototype.test.bind(/^([a-z])=(.*)/);

exports.parse = function (sdp) {
  var session = {}
    , media = []
    , location = session; // points at where properties go under (one of the above)

  // parse lines we understand
  sdp.split(/(\r\n|\r|\n)/).filter(validLine).forEach(function (l) {
    var type = l[0];
    var content = l.slice(2);
    if (type === 'm') {
      media.push({rtp: [], fmtp: []});
      location = media[media.length-1]; // point at latest media line
    }

    for (var j = 0; j < (grammar[type] || []).length; j += 1) {
      var obj = grammar[type][j];
      if (obj.reg.test(content)) {
        return parseReg(obj, location, content);
      }
    }
  });

  session.media = media; // link it up
  return session;
};

var paramReducer = function (acc, expr) {
  var s = expr.split(/=(.+)/, 2);
  if (s.length === 2) {
    acc[s[0]] = toIntIfInt(s[1]);
  }
  return acc;
};

exports.parseParams = function (str) {
  return str.split(/\;\s?/).reduce(paramReducer, {});
};

// For backward compatibility - alias will be removed in 3.0.0
exports.parseFmtpConfig = exports.parseParams;

exports.parsePayloads = function (str) {
  return str.split(' ').map(Number);
};

exports.parseRemoteCandidates = function (str) {
  var candidates = [];
  var parts = str.split(' ').map(toIntIfInt);
  for (var i = 0; i < parts.length; i += 3) {
    candidates.push({
      component: parts[i],
      ip: parts[i + 1],
      port: parts[i + 2]
    });
  }
  return candidates;
};

exports.parseImageAttributes = function (str) {
  return str.split(' ').map(function (item) {
    return item.substring(1, item.length-1).split(',').reduce(paramReducer, {});
  });
};

exports.parseSimulcastStreamList = function (str) {
  return str.split(';').map(function (stream) {
    return stream.split(',').map(function (format) {
      var scid, paused = false;

      if (format[0] !== '~') {
        scid = toIntIfInt(format);
      } else {
        scid = toIntIfInt(format.substring(1, format.length));
        paused = true;
      }

      return {
        scid: scid,
        paused: paused
      };
    });
  });
};

/*  */}),null);
/**
 * Released under the MIT license. Copyright (c) 2013 Eirik Albrigtsen.
 *
 * @nolint
 * @preserve-header
 * @preserve-whitespace
 */
__d("sdp-transform-writer",["sdp-transform-grammar"],(function $module_sdp_transform_writer(global,require,requireDynamic,requireLazy,module,exports){

var grammar = require('sdp-transform-grammar');

// customized util.format - discards excess arguments and can void middle ones
var formatRegExp = /%[sdv%]/g;
var format = function (formatStr) {
  var i = 1;
  var args = arguments;
  var len = args.length;
  return formatStr.replace(formatRegExp, function (x) {
    if (i >= len) {
      return x; // missing argument
    }
    var arg = args[i];
    i += 1;
    switch (x) {
    case '%%':
      return '%';
    case '%s':
      return String(arg);
    case '%d':
      return Number(arg);
    case '%v':
      return '';
    }
  });
  // NB: we discard excess arguments - they are typically undefined from makeLine
};

var makeLine = function (type, obj, location) {
  var str = obj.format instanceof Function ?
    (obj.format(obj.push ? location : location[obj.name])) :
    obj.format;

  var args = [type + '=' + str];
  if (obj.names) {
    for (var i = 0; i < obj.names.length; i += 1) {
      var n = obj.names[i];
      if (obj.name) {
        args.push(location[obj.name][n]);
      }
      else { // for mLine and push attributes
        args.push(location[obj.names[i]]);
      }
    }
  }
  else {
    args.push(location[obj.name]);
  }
  return format.apply(null, args);
};

// RFC specified order
// TODO: extend this with all the rest
var defaultOuterOrder = [
  'v', 'o', 's', 'i',
  'u', 'e', 'p', 'c',
  'b', 't', 'r', 'z', 'a'
];
var defaultInnerOrder = ['i', 'c', 'b', 'a'];


module.exports = function (session, opts) {
  opts = opts || {};
  // ensure certain properties exist
  if (session.version == null) {
    session.version = 0; // 'v=0' must be there (only defined version atm)
  }
  if (session.name == null) {
    session.name = ' '; // 's= ' must be there if no meaningful name set
  }
  session.media.forEach(function (mLine) {
    if (mLine.payloads == null) {
      mLine.payloads = '';
    }
  });

  var outerOrder = opts.outerOrder || defaultOuterOrder;
  var innerOrder = opts.innerOrder || defaultInnerOrder;
  var sdp = [];

  // loop through outerOrder for matching properties on session
  outerOrder.forEach(function (type) {
    grammar[type].forEach(function (obj) {
      if (obj.name in session && session[obj.name] != null) {
        sdp.push(makeLine(type, obj, session));
      }
      else if (obj.push in session && session[obj.push] != null) {
        session[obj.push].forEach(function (el) {
          sdp.push(makeLine(type, obj, el));
        });
      }
    });
  });

  // then for each media line, follow the innerOrder
  session.media.forEach(function (mLine) {
    sdp.push(makeLine('m', grammar.m[0], mLine));

    innerOrder.forEach(function (type) {
      grammar[type].forEach(function (obj) {
        if (obj.name in mLine && mLine[obj.name] != null) {
          sdp.push(makeLine(type, obj, mLine));
        }
        else if (obj.push in mLine && mLine[obj.push] != null) {
          mLine[obj.push].forEach(function (el) {
            sdp.push(makeLine(type, obj, el));
          });
        }
      });
    });
  });

  return sdp.join('\r\n') + '\r\n';
};

/*  */}),null);
/**
 * Released under the MIT license. Copyright (c) 2013 Eirik Albrigtsen.
 *
 * @nolint
 * @preserve-header
 * @preserve-whitespace
 */
__d("sdp-transform",["sdp-transform-parser","sdp-transform-writer"],(function $module_sdp_transform(global,require,requireDynamic,requireLazy,module,exports){

var parser = require('sdp-transform-parser');
var writer = require('sdp-transform-writer');

exports.write = writer;
exports.parse = parser.parse;
exports.parseFmtpConfig = parser.parseFmtpConfig;
exports.parseParams = parser.parseParams;
exports.parsePayloads = parser.parsePayloads;
exports.parseRemoteCandidates = parser.parseRemoteCandidates;
exports.parseImageAttributes = parser.parseImageAttributes;
exports.parseSimulcastStreamList = parser.parseSimulcastStreamList;

/*  */}),null);
/**
 * Copyright @ 2015 Atlassian Pty Ltd
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Modified by Facebook.
 *
 * @nolint
 * @preserve-header
 * @preserve-whitespace
 * @format
 */__d("ZenonSDPInteropTransform",["sdp-transform"],(function $module_ZenonSDPInteropTransform(global,require,requireDynamic,requireLazy,module,exports){

'use strict';



exports.write=function(session,opts,options){
if(
typeof session!=='undefined'&&
typeof session.media!=='undefined'&&
Array.isArray(session.media))
{
session.media.forEach(function(mLine){







var groupedSsrcs=[];
var ungroupedSsrcs=Object.keys(mLine.sources||{});


if(
typeof mLine.ssrcGroups!=='undefined'&&
Array.isArray(mLine.ssrcGroups))
{
mLine.ssrcGroups.forEach(function(ssrcGroup){
if(
typeof ssrcGroup.ssrcs!=='undefined'&&
Array.isArray(ssrcGroup.ssrcs))
{
groupedSsrcs=groupedSsrcs.concat(ssrcGroup.ssrcs);
ungroupedSsrcs=ungroupedSsrcs.filter(
function(ssrc){return ssrcGroup.ssrcs.indexOf(ssrc)===-1;});

ssrcGroup.ssrcs=ssrcGroup.ssrcs.join(' ');
}
});
}


if(
typeof mLine.sources!=='undefined'&&
Object.keys(mLine.sources).length!==0)
{
mLine.ssrcs=[];
groupedSsrcs.concat(ungroupedSsrcs).forEach(function(ssrc){
var source=mLine.sources[ssrc];
Object.keys(source).forEach(function(attribute){
mLine.ssrcs.push({
attribute:attribute,
id:ssrc,
value:source[attribute]});

});
});
if(options&&options.iceOptions){
mLine.iceOptions=options.iceOptions;
}
delete mLine.sources;
}
});
}


if(
typeof session!=='undefined'&&
typeof session.groups!=='undefined'&&
Array.isArray(session.groups))
{
session.groups.forEach(function(g){
if(typeof g.mids!=='undefined'&&Array.isArray(g.mids)){
g.mids=g.mids.join(' ');
}
});
}

return require("sdp-transform").write(session,opts);
};

exports.parse=function(sdp){
var session=require("sdp-transform").parse(sdp);

if(
typeof session!=='undefined'&&
typeof session.media!=='undefined'&&
Array.isArray(session.media))
{
session.media.forEach(function(mLine){

if(typeof mLine.ssrcs!=='undefined'&&Array.isArray(mLine.ssrcs)){
mLine.sources={};
mLine.ssrcs.forEach(function(ssrc){
if(!mLine.sources[ssrc.id])mLine.sources[ssrc.id]={};
mLine.sources[ssrc.id][ssrc.attribute]=ssrc.value;
});

delete mLine.ssrcs;
}


if(
typeof mLine.ssrcGroups!=='undefined'&&
Array.isArray(mLine.ssrcGroups))
{
mLine.ssrcGroups.forEach(function(ssrcGroup){
if(typeof ssrcGroup.ssrcs==='string'){
ssrcGroup.ssrcs=ssrcGroup.ssrcs.split(' ');
}
});
}
});
}

if(
typeof session!=='undefined'&&
typeof session.groups!=='undefined'&&
Array.isArray(session.groups))
{
session.groups.forEach(function(g){
if(typeof g.mids==='string'){
g.mids=g.mids.split(' ');
}
});
}

return session;
};}),null);
__d("ZenonSDP",["ZenonSDPInteropTransform","ZenonSignalingTypes"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c){this.$1={};var d=a.sdp;d!=null&&(this.$1=b("ZenonSDPInteropTransform").parse(d));this.$2=a.type;this.$2==="answer"&&c===b("ZenonSignalingTypes").ZenonSdpFormat.PLAN_B&&(this.$3("audio","sendrecv"),this.$3("video","sendrecv"))}var c=a.prototype;c.$4=function(a,b,c){a=a.split(";");var d=a.findIndex(function(a){return a.startsWith(b+"=")});c=b+"="+c;d>=0?a[d]=c:a.push(c);return""+a.join(";")};c.getMedia=function(){var a=this.$1.media;return a};c.addFmtpConfig=function(a,b,c){var d=this,e=this.$1.media;e!=null&&e.forEach(function(e){e.rtp.filter(function(b){return b.codec===a}).forEach(function(a){var f=e.fmtp.find(function(b){return b.payload===a.payload});f==null?e.fmtp.push({config:b+"="+c,payload:a.payload}):f.config=d.$4(f.config,b,c)})})};c.maybeAddPtimeForOpusOnly=function(a){var b=this.$1.media;if(b==null)return;b.forEach(function(b){if(b.type!=="audio")return;var c=b.rtp.filter(function(a){return a.codec!=="opus"}).length>=1;if(c)return;c=b.rtp.find(function(a){return a.codec==="opus"});if(c==null)return;if(b.ptime!=null)return;b.ptime=a})};c.addAudioNACK=function(){var a=this.$1.media;a!=null&&a.forEach(function(a){if(a.type!=="audio")return;a.rtcpFb==null&&(a.rtcpFb=[]);a.rtp.forEach(function(b){var c;if(!((c=a.rtcpFb)==null?void 0:c.some(function(a){return a.payload===b.payload&&a.type==="nack"}))){(c=a.rtcpFb)==null?void 0:c.push({payload:b.payload,type:"nack"})}})})};c.removeCodec=function(a){var b=this.$1.media;b!=null&&b.forEach(function(b){var c=b.rtp.filter(function(b){return b.codec===a}).map(function(a){a=a.payload;return a}),d=b.fmtp.filter(function(a){a=a.config.match(/apt=(\d*)/);return a!=null?c.includes(Number(a[1])):!1}).map(function(a){a=a.payload;return a}),e=c.concat(d);if(e.length<1)return;b.rtp=b.rtp.filter(function(a){return!e.includes(a.payload)});b.fmtp=b.fmtp.filter(function(a){return!e.includes(a.payload)});b.rtcpFb!=null&&(b.rtcpFb=b.rtcpFb.filter(function(a){return!e.includes(a.payload)}));b.rtcpFbTrrInt!=null&&(b.rtcpFbTrrInt=b.rtcpFbTrrInt.filter(function(a){return!e.includes(a.payload)}));d=new RegExp("("+e.join("|")+") ?","g");b.payloads=b.payloads.replace(d,"").trim()})};c.preferCodec=function(a,b){var c=b.preferredCodec,d=b.preferredCodecRate;b=this.$1.media;b!=null&&b.forEach(function(b){if(b.type===a){var e=b.rtp.find(function(a){return a.codec===c&&a.rate===d});e!=null&&(b.payloads=b.payloads.replace(e.payload+" ",""),b.payloads=e.payload+" "+b.payloads)}})};c.preferH264Codec=function(a){var b=this.$1.media;b!=null&&b.forEach(function(b){if(b.type==="video"){var c=[];b.rtp.forEach(function(a){a.codec==="H264"&&c.push(a.payload)});var d=a.levelAsymmetryAllowed?"1":"0",e=a.packetizationMode?"1":"0",f=new RegExp("level-asymmetry-allowed="+d+";packetization-mode="+e+";profile-level-id="+a.profileLevelId);d=b.fmtp.find(function(a){return a.config.match(f)&&c.includes(a.payload)});d!=null&&(b.payloads=b.payloads.replace(d.payload+" ",""),b.payloads=d.payload+" "+b.payloads)}})};c.$3=function(a,b){var c=this.$1.media;c!=null&&c.forEach(function(c){c.type===a&&(c.direction=b)})};c.setVersion=function(a){this.$1.origin.sessionVersion=a};c.toDesc=function(){return{sdp:b("ZenonSDPInteropTransform").write(this.$1,{},{iceOptions:"trickle fb-force-5245"}),type:this.$2}};return a}();e.exports=a},null);
__d("ZenonPeerConnectionSdpActions",["regeneratorRuntime","Promise","ScotchRTWebUserActionLogger","ZenonSDP"],function(a,b,c,d,e,f){"use strict";function g(a,b){b&&b.tracks.forEach(function(b){var c=b.enabled,d=b.trackID;if(d==="data"||d==="stream_label")return;a.updateTrackInfo(b);c?a.unmuteTrack(d):a.muteTrack(d)})}a=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(c.type==="applyLocalSdp")){e.next=6;break}d=a.localMediaStateVersion+1;e.next=4;return b("regeneratorRuntime").awrap(a.sdpManager.createAndSetLocalSdp(d,"offer"));case 4:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"apply local SDP",codebase_version:"Zenon"});return e.abrupt("return",{localMediaStateVersion:d});case 6:return e.abrupt("return",b("Promise").resolve({}));case 7:case"end":return e.stop()}},null,this)};f.applyLocalSdp=a;c=function(a,c){var d,e,f,h,i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:d=a.mediaChannelManager,e=a.sdpManager;if(!(c.type==="applyRemoteSdp")){n.next=18;break}f=c.payload.sdp,h=f.sdp,i=f.type;if(!(i==="answer")){n.next=8;break}a.logEvent({name:"setRemoteSdpAnswer"});n.next=7;return b("regeneratorRuntime").awrap(e.setRemoteSdp(new(b("ZenonSDP"))({sdp:h,type:i},d.getSdpFormat())));case 7:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"apply remote answer",codebase_version:"Zenon"});case 8:g(d,c.payload.mediaStates);j=c.payload.renegotiationOffer;if(!(j!=null)){n.next=18;break}k=j.sdp,l=j.type;n.next=14;return b("regeneratorRuntime").awrap(e.setRemoteSdp(new(b("ZenonSDP"))({sdp:k,type:l},d.getSdpFormat())));case 14:m=a.localMediaStateVersion+1;n.next=17;return b("regeneratorRuntime").awrap(a.sdpManager.createAndSetLocalSdp(m,"answer"));case 17:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Apply renegotiation offer and set local answer",codebase_version:"Zenon"});case 18:case"end":return n.stop()}},null,this)};f.applyRemoteAnswer=c;d=function(a,c){var d,e,f,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d=a.mediaChannelManager,e=a.sdpManager;if(!(c.type==="applyRemoteSdp")){k.next=13;break}f=c.payload.sdp,h=f.sdp,i=f.type;if(!(i==="offer")){k.next=13;break}a.logEvent({name:"setRemoteSdpOffer"});k.next=7;return b("regeneratorRuntime").awrap(e.setRemoteSdp(new(b("ZenonSDP"))({sdp:h,type:i},d.getSdpFormat())));case 7:g(d,c.payload.mediaStates);j=a.localMediaStateVersion+1;k.next=11;return b("regeneratorRuntime").awrap(a.sdpManager.createAndSetLocalSdp(j,"answer"));case 11:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"apply remote offer and set local answer",codebase_version:"Zenon"});return k.abrupt("return",{localMediaStateVersion:j});case 13:return k.abrupt("return",{});case 14:case"end":return k.stop()}},null,this)};f.applyRemoteOfferAndSetLocalAnswer=d;e=function(a){a.logEvent({name:"inviteResponseProcessed"})};f.logInviteResponseProcessed=e;a=function(a){a.logEvent({name:"negotiationComplete"})};f.logNegotiationCompleted=a;c=function(a,b){var c=a.sdpManager.getLocalSdp();b=b.data;if(c!==null&&b.localMediaStateVersion!=null){c=c.toDesc();var d=c.sdp;c=c.type;a.onLocalSdpSet({sdp:d,type:c,version:b.localMediaStateVersion})}return b};f.onLocalSdpSet=c},null);
__d("ZenonPeerConnectionTerminatingState",["Promise","FBLogger","ScotchRTWebUserActionLogger","ZenonMediaError"],function(a,b,c,d,e,f){"use strict";a=function(a,c){var d;(c.type!=="endCall"||c.payload.stopLocalTracks)&&(b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"stopping local tracks",codebase_version:"Zenon"}),a.mediaChannelManager.stopLocalTracks());switch(c.type){case"endCall":a.onConnectionDestroyed((d=c.payload.error)!=null?d:null);break;case"applyLocalSdp":a.onConnectionDestroyed(b("ZenonMediaError").ZenonMediaError.SetLocalSdpFailed);break;case"applyRemoteSdp":a.onConnectionDestroyed(b("ZenonMediaError").ZenonMediaError.SetRemoteSdpFailed);break;default:b("FBLogger")("rtc_www").warn("Event "+c.type+" logged as unknown error. Please add a more specific error for this event type.");a.onConnectionDestroyed(b("ZenonMediaError").ZenonMediaError.UnknownError);break}a.sdpManager.closePeerConnection();a.mediaChannelManager.cleanUp();return b("Promise").resolve(b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"cleaning up peer connection",codebase_version:"Zenon"}))};f.cleanUp=a;c=function(a,b){};f.done=c},null);
__d("ZenonPeerConnectionStateMachine",["ZenonDebugLogger","ZenonDeferrableStateMachine","ZenonPeerConnectionDataActions","ZenonPeerConnectionIceActions","ZenonPeerConnectionMediaActions","ZenonPeerConnectionSdpActions","ZenonPeerConnectionSMGuards","ZenonPeerConnectionTerminatingState","xstate"],function(a,b,c,d,e,f){"use strict";var g,h,i="PeerConnectionStateMachine";a=function(){function a(a,c){var d=this;c===void 0&&(c="init");a=babelHelpers["extends"]({},k,{context:babelHelpers["extends"]({},a,{iceConnectionState:"new",localMediaStateVersion:1}),initial:c});this.$1=b("ZenonDeferrableStateMachine").interpret(b("xstate").Machine(a,{guards:b("ZenonPeerConnectionSMGuards")}));this.$2=Date.now();b("ZenonDebugLogger").getInstance().startQPL(64239068,this.$2);this.$1.onTransition(function(a){if(!l.has(a.event.type)){var c;b("ZenonDebugLogger").getInstance().logStateMachineTransition(i,a.changed,a.value,(c=a.history)==null?void 0:c.value,a.event.type,a.actions,d.$2.toString())}a.value==="terminated"&&b("ZenonDebugLogger").getInstance().endQPL(64239068,d.$2)})}var c=a.prototype;c.processEvent=function(a){l.has(a.type)||(this.$3(this.getState(),a.type,this.$2.toString()),b("ZenonDebugLogger").getInstance().logStateMachine(i,this.getState(),a.type,this.$2.toString())),this.$1.send(a)};c.getState=function(){var a=this.$1.state.toStrings();return a.length>0?this.$1.state.toStrings()[0]:"init"};c.getContext=function(){return this.$1.state.context};c.getLocalMediaStateVersion=function(){return this.$1.state.context.localMediaStateVersion};c.$3=function(a,b,c){c=c==null?i:i+": "+c;c="["+c+"] [Current State: "+a+"] Processing event: "+b;this.$1.state.context.logEvent({checkpoint:""+c,name:"infraAction",peerConnectionState:this.getState()})};return a}();e.exports=a;f={actions:[(c=b("xstate")).assign((d=b("ZenonPeerConnectionIceActions")).onIceConnectionStateChanged)]};e={actions:[b("ZenonPeerConnectionDataActions").onDataChannelMessageReceived]};var j={actions:[(a=b("ZenonPeerConnectionMediaActions")).onForceEncodingEnabled]},k={initial:"init",states:{init:{on:{addLocalTracks:{target:"addingLocalTracks"},applyLocalSdp:{target:"applyingLocalSdp"},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{cond:(g=b("ZenonPeerConnectionSMGuards")).applyRemoteOfferSdpGuard,target:"renegotiating"},createDataChannel:{actions:[b("ZenonPeerConnectionDataActions").onCreateDataChannel]},dataChannelMessageReceived:e,forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},iceConnectionStateChange:f,localMediaStateUpdateRetry:{actions:[c.assign(a.onLocalMediaStateUpdateRetry)]},muteLocalTrack:{actions:[c.assign(a.onMuteLocalTrack)]},removeLocalTrack:{target:"removingLocalTrack"},replaceLocalTrack:{target:"replacingLocalTrack"},setLocalMediaStateVersion:{actions:[c.assign(a.onSetLocalMediaStateVersion)]},stopLocalTrack:{actions:[a.onStopLocalTrack]},unmuteLocalTrack:{actions:[c.assign(a.onUnmuteLocalTrack)]}}},applyingLocalSdp:{invoke:{id:"applyLocalSdpInvoke",onDone:{actions:[c.assign((h=b("ZenonPeerConnectionSdpActions")).onLocalSdpSet)],target:"hasLocalSdp"},onError:{target:"terminating"},src:h.applyLocalSdp},on:{addLocalTracks:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},createDataChannel:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},dataChannelMessageReceived:e,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},iceConnectionStateChange:f,localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},hasLocalSdp:{entry:[function(a){return a.mediaChannelManager.setSimulcastSingleLayerParams()}],on:{addLocalTracks:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{target:"applyingRemoteSdp"},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:e,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:[a.onIceCandidateReady]},iceConnectionStateChange:f,localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},applyingRemoteSdp:{invoke:[{id:"applyRemoteSdpInvoke",onDone:[{actions:[h.logInviteResponseProcessed],cond:g.iceNotConnectedGuard,target:"negotiated"},{actions:[h.logInviteResponseProcessed,d.onIceConnected],cond:g.iceConnectedGuard,target:"connected"}],onError:{target:"terminating"},src:h.applyRemoteAnswer}],on:{addLocalTracks:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:e,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:[a.onIceCandidateReady]},iceConnectionStateChange:f,localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},negotiated:{entry:[h.logNegotiationCompleted],on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:[a.applyRemoteIceCandidate]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:e,endCall:{target:"terminating"},forceEncodingEnabled:j,iceCandidateReady:{actions:[a.onIceCandidateReady]},iceConnectionStateChange:[{actions:[c.assign(d.onIceConnectionStateChanged)],cond:g.iceConnectedEventGuard,target:"connected"},{actions:[c.assign(d.onIceConnectionStateChanged)]}],localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},connected:{on:{addLocalTracks:{target:"addingLocalTracks"},applyLocalSdp:{target:"applyingLocalSdp"},applyRemoteIceCandidate:{actions:[a.applyRemoteIceCandidate]},applyRemoteSdp:{cond:g.applyRemoteOfferSdpGuard,target:"renegotiating"},createDataChannel:{actions:[b("ZenonPeerConnectionDataActions").onCreateDataChannel]},dataChannelMessageReceived:e,endCall:{target:"terminating"},forceEncodingEnabled:j,iceCandidateReady:{actions:[a.onIceCandidateReady]},iceConnectionStateChange:[{actions:[c.assign(d.onIceConnectionStateChanged)],cond:g.iceDisconnectedEventGuard,target:"negotiated"},{actions:[c.assign(d.onIceConnectionStateChanged)]}],localMediaStateUpdateRetry:{actions:[c.assign(a.onLocalMediaStateUpdateRetry)]},muteLocalTrack:{actions:[c.assign(a.onMuteLocalTrack)]},removeLocalTrack:{target:"removingLocalTrack"},replaceLocalTrack:{target:"replacingLocalTrack"},stopLocalTrack:{actions:[a.onStopLocalTrack]},unmuteLocalTrack:{actions:[c.assign(a.onUnmuteLocalTrack)]}}},addingLocalTracks:{invoke:{id:"addLocalTracksInvoke",onDone:{actions:[c.assign(a.onAddedLocalTracks)],target:"connected"},onError:{actions:[a.onAddLocalTracksError],target:"connected"},src:a.onAddingLocalTracks},on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:e,iceConnectionStateChange:f,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},removingLocalTrack:{invoke:{id:"removeLocalTrackInvoke",onDone:{actions:[c.assign(a.onRemovedLocalTrack)],target:"connected"},onError:{actions:[a.onRemoveLocalTrackError],target:"connected"},src:a.onRemovingLocalTrack},on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:e,iceConnectionStateChange:f,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},replacingLocalTrack:{invoke:{id:"replaceLocalTrackInvoke",onDone:{target:"connected"},onError:{actions:[a.onReplaceLocalTrackError],target:"connected"},src:a.onReplacingLocalTrack},on:{applyLocalSdp:{actions:["defer"]},addLocalTracks:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:e,iceConnectionStateChange:f,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},renegotiating:{invoke:{id:"renegotiatingInvoke",onDone:[{actions:[c.assign(h.onLocalSdpSet)],cond:g.iceNotConnectedGuard,target:"negotiated"},{actions:[c.assign(h.onLocalSdpSet)],cond:g.iceConnectedGuard,target:"connected"}],onError:{target:"terminating"},src:h.applyRemoteOfferAndSetLocalAnswer},on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:e,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceConnectionStateChange:{actions:["defer"]},localMediaStateUpdateRetry:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},terminating:{exit:[b("ZenonPeerConnectionTerminatingState").done],invoke:[{onDone:{target:"terminated"},src:b("ZenonPeerConnectionTerminatingState").cleanUp}]},terminated:{}}},l=new Set(["dataChannelMessageReceived"])},null);
__d("ZenonEventListenerCache",[],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.add=function(a,b){var c=this.getByType(a);c.push(b);this.$1.set(a,c)};b["delete"]=function(a,b){var c=this.getByType(a);c=c.filter(function(a){return a!==b});c.length<1?this.$1["delete"](a):this.$1.set(a,c)};b.getByType=function(a){return(a=this.$1.get(a))!=null?a:[]};b.getCachedEventTypes=function(){return Array.from(this.$1.keys())};b.getAll=function(){return this.$1};return a}();e.exports=a},null);
__d("ZenonSimulcastSdpUtils",["Random","UserAgent","recoverableViolation"],function(a,b,c,d,e,f){"use strict";f.addSimulcastToPlanBOffer=a;var g="\r\n";function h(a){a=a.filter(function(a){return a.startsWith("a=ssrc:")}).map(function(a){return a.split(" ")[0].split(":")[1]});return new Set(a)}function i(a,b){var c=new RegExp("^a=ssrc:\\d+ "+b+":");b=a.filter(function(a){return c.test(a)})[0];return b.split(" ")[1].split(":")[1]}function j(a){a=a.filter(function(a){return a.startsWith("a=ssrc-group:FID")}).map(function(a){return a.split(" ")[2]});return new Set(a)}function k(a){var b=new RegExp("^a=ssrc:\\d+ msid:");a=a.filter(function(a){return b.test(a)})[0];a=a.split(" ");return a.length>2?a[2]:null}function l(a,c){var d=[];for(var e=0;e<a;e++){var f=0;while(f===0||c.has(f.toString()))f=b("Random").uint32();c.add(f.toString());d.push(f.toString())}return d}function a(a,c){if(!b("UserAgent").isBrowser("Chrome >= 86")){b("recoverableViolation")("Attempted to add plan-b simulcast in unsupported browser","rtc_www");return a}if(c<=1||c>3){b("recoverableViolation")("Unsupported number of layers passed: "+c,"rtc_www");return a}var d=a.trim().split(g),e=h(d),f=d.findIndex(function(a){return/^m=video/.test(a)});if(f===-1)return a;a=f+1;while(a<d.length){if(d[a].startsWith("m="))break;a++}a=d.splice(f,a-f);var m=h(a),n=j(a);m=new Set(Array.from(m).filter(function(a){return!n.has(a)}));if(m.size!==1||n.size>1)return[].concat(d.slice(0,f),a,d.slice(f)).join(g);var o=n.size===1;m=Array.from(m)[0];var p="";o&&(p=Array.from(n)[0]);var q=i(a,"cname"),r=i(a,"msid"),s=k(a);s!=null&&(r+=" "+s);var t=i(a,"mslabel"),u=i(a,"label");s=[m].concat(l(c-1,e));m=[];o&&(s.forEach(function(a){return e.add(a)}),m=[p].concat(l(c-1,e)));var v=[];v.push("a=ssrc-group:SIM "+s.join(" "));for(var p=0;p<m.length;p++)v.push("a=ssrc-group:FID "+s[p]+" "+m[p]);c=[];if(o)for(var p=0;p<s.length;p++)c.push(s[p]),c.push(m[p]);else c=s;c.forEach(function(a){v.push("a=ssrc:"+a+" cname:"+q),v.push("a=ssrc:"+a+" msid:"+r),v.push("a=ssrc:"+a+" mslabel:"+t),v.push("a=ssrc:"+a+" label:"+u)});a=a.filter(function(a){return!a.startsWith("a=ssrc")});a=[].concat(a,v);return[].concat(d.slice(0,f),a,d.slice(f)).join(g)+g}},null);
__d("ZenonRTCPeerConnectionWrapper",["regeneratorRuntime","Promise","FBLogger","ScotchRTWebUserActionLogger","UserAgent","ZenonBrowsers","ZenonEventListenerCache","ZenonRTCPeerConnectionHelper","ZenonSDP","ZenonSignalingTypes","ZenonSimulcastSdpUtils","qex","recoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e){c===void 0&&(c={}),d===void 0&&(d={}),e===void 0&&(e=!1),this.$4=new(b("ZenonEventListenerCache"))(),this.$7=!1,this.$8=!1,this.count=0,this.$2=c,this.$3=d,this.$1=b("ZenonRTCPeerConnectionHelper").createPeerConnection(a,c,d),this.$5=new Map(),this.$6=e,this.getSdpFormat()===b("ZenonSignalingTypes").ZenonSdpFormat.PLAN_B&&e&&(this.$7=!0),this.midToMWTrackId=new Map()}var c=a.prototype;c.createOffer=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:a===void 0&&(a={});e.next=3;return b("regeneratorRuntime").awrap(this.$9(a));case 3:c=e.sent;this.$7&&(c.sdp!=null&&(c.sdp=b("ZenonSimulcastSdpUtils").addSimulcastToPlanBOffer(c.sdp,(d=b("qex")._("1574288"))!=null?d:1)),this.$7=!1);return e.abrupt("return",new(b("ZenonSDP"))(c,this.getSdpFormat()));case 6:case"end":return e.stop()}},null,this)};c.setLocalDescription=function(a){var c=this;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:if(!this.$10()){d.next=12;break}d.prev=1;d.next=4;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,d){c.$1.setLocalDescription(a.toDesc(),b,d)}));case 4:d.next=10;break;case 6:d.prev=6;d.t0=d["catch"](1);b("FBLogger")("rtc_www").catching(d.t0).mustfix("Error processing legacy API setLocalDescription in ZenonRTCPeerConnectionWrapper.");throw d.t0;case 10:d.next=21;break;case 12:d.prev=12;d.next=15;return b("regeneratorRuntime").awrap(this.$1.setLocalDescription(a.toDesc()));case 15:d.next=21;break;case 17:d.prev=17;d.t1=d["catch"](12);b("FBLogger")("rtc_www").catching(d.t1).mustfix("Error processing modern API setLocalDescription in ZenonRTCPeerConnectionWrapper.");throw d.t1;case 21:case"end":return d.stop()}},null,this,[[1,6],[12,17]])};c.createAnswer=function(){var a=this,c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$10()){e.next=7;break}d=function(){return new(b("Promise"))(function(b,c){return a.$1.createAnswer(b,c)})};e.next=4;return b("regeneratorRuntime").awrap(d());case 4:c=e.sent;e.next=10;break;case 7:e.next=9;return b("regeneratorRuntime").awrap(this.$1.createAnswer());case 9:c=e.sent;case 10:return e.abrupt("return",new(b("ZenonSDP"))(c,this.getSdpFormat()));case 11:case"end":return e.stop()}},null,this)};c.setRemoteDescription=function(a){var c=this;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:this.$11(a.getMedia());if(!this.$10()){d.next=13;break}d.prev=2;d.next=5;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,d){c.$1.setRemoteDescription(a.toDesc(),b,d)}));case 5:d.next=11;break;case 7:d.prev=7;d.t0=d["catch"](2);b("FBLogger")("rtc_www").catching(d.t0).mustfix("Error processing legacy API setRemoteDescription in ZenonRTCPeerConnectionWrapper.");throw d.t0;case 11:d.next=22;break;case 13:d.prev=13;d.next=16;return b("regeneratorRuntime").awrap(this.$1.setRemoteDescription(a.toDesc()));case 16:d.next=22;break;case 18:d.prev=18;d.t1=d["catch"](13);b("FBLogger")("rtc_www").catching(d.t1).mustfix("Error processing modern API setRemoteDescription in ZenonRTCPeerConnectionWrapper.");throw d.t1;case 22:case"end":return d.stop()}},null,this,[[2,7],[13,18]])};c.setRemoteIceCandidate=function(a){return this.$1.addIceCandidate(a)};c.close=function(){b("ZenonRTCPeerConnectionHelper").closePeerConnection(this.$1)};c.addEventListener=function(a,b){this.$4.add(a,b),this.$1.addEventListener(a,b)};c.createDataChannel=function(a,c){if(!this.$5.has(a)&&!b("ZenonBrowsers").isFirefox()){var d=this.$1.createDataChannel(a);d?(d.onmessage=function(a){return c(a.data)},this.$5.set(a,d)):b("recoverableViolation")("Unable to create requested data channel: "+a,"rtc_www")}};c.getAllEventListeners=function(){return this.$4.getAll()};c.getEventListenersForType=function(a){return(a=this.$4.getByType(a))!=null?a:[]};c.removeEventListener=function(a,b){this.$4["delete"](a,b),this.$1.removeEventListener(a,b)};c.removeAllEventListeners=function(){var a=this,b=this.$4.getCachedEventTypes();b.forEach(function(b){var c=a.$4.getByType(b);c.forEach(function(c){a.$1.removeEventListener(b),a.$4["delete"](b,c)})})};c.addTrack=function(a,b){return b==null?this.$1.addTrack(a):this.$1.addTrack(a,b)};c.getReceivers=function(){return this.$1.getReceivers()};c.getSenders=function(){return this.$1.getSenders()};c.getRemoteStreams=function(){return this.$1.getRemoteStreams()};c.getStats=function(a){return this.$1.getStats(a)};c.removeTrack=function(a){var c=!1;for(var d=this.$1.getSenders(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;g.track===a&&(this.$1.removeTrack(g),c=!0)}c||b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ZenonRTCPeerConnectionWrapper.removeTrack: Could not find sender for track "+a.id,codebase_version:"Zenon"})};c.supportsSimulcast=function(){return this.$6};c.getSimulcastInitialized=function(){return this.$8};c.setSimulcastInitialized=function(a){this.$8=a};c.$10=function(){return b("UserAgent").isBrowser("Chrome < 51")||b("UserAgent").isBrowser("Opera < 43")};c.$9=function(a){var c=this;return this.$10()?new(b("Promise"))(function(b,d){return c.$1.createOffer(b,d,a)}):b("Promise").resolve(this.$1.createOffer(a))};c.getSdpFormat=function(){var a;return(a=this.$2.sdpSemantics)!=null?a:b("ZenonSignalingTypes").ZenonSdpFormat.PLAN_B};c.$11=function(a){var c=this;if(this.getSdpFormat()===b("ZenonSignalingTypes").ZenonSdpFormat.PLAN_B)return;a.forEach(function(a){if(a.type!=="application"){var d=a.msid,e=null;if(d!=null){d=d.split(" ");d.length>=2?e=d[1]:b("FBLogger")("rtc_www").warn("MSID did not have an elgible ID for caching")}e!=null&&a.mid!=null?c.midToMWTrackId.set(String(a.mid),e):b("FBLogger")("rtc_www").warn("Did not cache track due to missing information")}})};c.getMWTrackId=function(a){return this.midToMWTrackId.get(a)};return a}();e.exports=a},null);
__d("ZenonSDPManager",["regeneratorRuntime","ScotchRTWebUserActionLogger","ZenonPlatformExperiments","ZenonSignalingTypes","gkx","qex"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$2=null,this.$3=null,this.$1=a,this.$4=b.getZenonSdpTransformConfig()}var c=a.prototype;c.getLocalSdp=function(){return this.$2};c.shouldPreferH264Multiway=function(){var a=b("gkx")("1707280");if(a===!0&&this.$1.supportsSimulcast()){var c;return(c=b("qex")._("1606177"))!=null?c:!1}return a};c.createAndSetLocalSdp=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(c==="offer")){e.next=6;break}e.next=3;return b("regeneratorRuntime").awrap(this.$1.createOffer({offerToReceiveVideo:this.$1.getSdpFormat()===b("ZenonSignalingTypes").ZenonSdpFormat.UNIFIED_PLAN?void 0:!0,preserveH264:this.$4.isPreserveH264()}));case 3:e.t0=e.sent;e.next=9;break;case 6:e.next=8;return b("regeneratorRuntime").awrap(this.$1.createAnswer());case 8:e.t0=e.sent;case 9:d=e.t0;this.$4.isPreferIsacForGroupAudio()&&d.preferCodec("audio",{preferredCodec:"ISAC",preferredCodecRate:16e3});this.shouldPreferH264Multiway()&&(this.$4.isPreferSwH264()?d.preferH264Codec({levelAsymmetryAllowed:!0,packetizationMode:!0,profileLevelId:"42e01f"}):d.preferCodec("video",{preferredCodec:"H264",preferredCodecRate:9e4}));b("gkx")("1720807")&&d.addFmtpConfig("H264","sps-pps-idr-in-keyframe","1");this.$4.isDisableOpusStereo()&&d.addFmtpConfig("opus","stereo","0");b("ZenonPlatformExperiments").isOpusMungeEnabled()&&d.maybeAddPtimeForOpusOnly(b("ZenonPlatformExperiments").getOpusPtimeMungeValue());this.$4.isPreserveH264()||d.removeCodec("H264");b("ZenonPlatformExperiments").shouldEnableMWSAudioNack()&&d.addAudioNACK();d.setVersion(a);e.prev=18;e.next=21;return b("regeneratorRuntime").awrap(this.$1.setLocalDescription(d));case 21:e.next=27;break;case 23:e.prev=23;e.t1=e["catch"](18);b("ScotchRTWebUserActionLogger").logError({codebase_version:"Zenon",errorDomain:"ZenonSDPManager_createAndSetLocalSdp",errorType:e.t1.toString()});throw e.t1;case 27:this.$2=d;return e.abrupt("return",d);case 29:case"end":return e.stop()}},null,this,[[18,23]])};c.setRemoteSdp=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:b("ZenonPlatformExperiments").isOpusMungeEnabled()&&a.maybeAddPtimeForOpusOnly(b("ZenonPlatformExperiments").getOpusPtimeMungeValue());c.prev=1;c.next=4;return b("regeneratorRuntime").awrap(this.$1.setRemoteDescription(a));case 4:c.next=10;break;case 6:c.prev=6;c.t0=c["catch"](1);b("ScotchRTWebUserActionLogger").logError({codebase_version:"Zenon",errorDomain:"ZenonSDPManager_setRemoteSdp",errorType:c.t0.toString()});throw c.t0;case 10:this.$3=a;case 11:case"end":return c.stop()}},null,this,[[1,6]])};c.setRemoteIceCandidate=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.$1.setRemoteIceCandidate(a));case 2:case"end":return c.stop()}},null,this)};c.closePeerConnection=function(){this.$1.close()};return a}();e.exports=a},null);
__d("ZenonPeerConnectionManager",["FBLogger","ZenonMediaChannelManager","ZenonPeerConnectionStateMachine","ZenonRTCPeerConnectionConfig","ZenonRTCPeerConnectionWrapper","ZenonSDPManager","ZenonSimulcastExperiments","ZenonSimulcastManager","qex","recoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d){var e=this;c===void 0&&(c=!1);d===void 0&&(d=function(){});this.$5=null;this.$6=function(){};this.$7=new Set();this.$9=Date.now();this.$11=function(a){a=a.target;a=a.iceConnectionState;e.$1.processEvent({payload:{iceConnectionState:a},type:"iceConnectionStateChange"})};this.$12=function(a){a=a.candidate;a&&e.$1.processEvent({payload:a,type:"iceCandidateReady"})};this.$8=c;this.$6=d;this.$5=null;d=b("ZenonRTCPeerConnectionConfig").getConfigZenonPlatform();this.$4=new(b("ZenonRTCPeerConnectionWrapper"))(a,babelHelpers["extends"]({},d),{},c);this.$6({name:"peerConnectionCreated",sdpFormat:d.sdpSemantics});this.$2=new(b("ZenonMediaChannelManager"))(this.$4,function(a){return e.$6({mediaStats:a,name:"setMediaStats"})});this.$3=new(b("ZenonSDPManager"))(this.$4,a);this.$1=new(b("ZenonPeerConnectionStateMachine"))(babelHelpers["extends"]({},this.$10(),{logEvent:function(a){return e.$6(a)},mediaChannelManager:this.$2,sdpManager:this.$3}));this.$4.addEventListener("iceconnectionstatechange",this.$11);this.$4.addEventListener("icecandidate",this.$12)}var c=a.prototype;c.getLocalMediaStateVersion=function(){return this.$1.getLocalMediaStateVersion()};c.setLocalMediaStateVersion=function(a){this.$1.processEvent({payload:{version:a},type:"setLocalMediaStateVersion"})};c.addLocalTracks=function(a){this.$1.processEvent({payload:{tracks:a},type:"addLocalTracks"})};c.removeLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"removeLocalTrack"})};c.replaceLocalTrack=function(a,b){this.$1.processEvent({payload:{replacementTrack:b,trackIdToReplace:a},type:"replaceLocalTrack"})};c.createDataChannel=function(a){var b=this;this.$7.add(a);this.$1.processEvent({payload:{dataChannelLabel:a,onDataChannelMessage:function(c){b.$1.processEvent({payload:{data:c,dataChannelLabel:a},type:"dataChannelMessageReceived"}),b.$8&&a==="data"&&b.maybeHandleSimulcastDataMessage(c)}},type:"createDataChannel"})};c.getDataChannelLabels=function(){return this.$7};c.localMediaStateUpdateRetry=function(){this.$1.processEvent({type:"localMediaStateUpdateRetry"})};c.muteLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"muteLocalTrack"})};c.unmuteLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"unmuteLocalTrack"})};c.stopLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"stopLocalTrack"})};c.applyLocalSdp=function(){this.$1.processEvent({type:"applyLocalSdp"})};c.applyRemoteSdp=function(a,b,c){this.$1.processEvent({payload:{mediaStates:b,renegotiationOffer:c,sdp:a},type:"applyRemoteSdp"})};c.applyRemoteIceCandidate=function(a){this.$1.processEvent({payload:a,type:"applyRemoteIceCandidate"})};c.forceEncodingEnabled=function(a){this.$1.processEvent({payload:{enabled:a},type:"forceEncodingEnabled"})};c.end=function(a){var b=this.$2.timeSeries();b!=null&&this.$6({name:"logTSData",time_series:b});this.$1.processEvent({payload:{stopLocalTracks:a},type:"endCall"})};c.getTracks=function(){return this.$2.getTracks()};c.updateTrackInfo=function(a){return this.$2.updateTrackInfo(a)};c.getLocalTracksForMWS=function(){return this.$2.getLocalTracksForMWS()};c.getRtpSenders=function(){return this.$4.getSenders()};c.getRtpReceivers=function(){return this.$4.getReceivers()};c.setPeerConnectionEventHandlers=function(a){this.$5=a};c.registerNetworkListener=function(a){this.$2.registerNetworkListener(a)};c.registerTrackListener=function(a){this.$2.registerTrackListener(a)};c.setTrackListenersFromManager=function(a){this.$2.setTrackListenersFromManager(a.$2)};c.setLoggingEventHandler=function(a){this.$6=a};c.$10=function(){return{onConnectionDestroyed:this.$13("onConnectionDestroyed"),onConnectionDropped:this.$13("onConnectionDropped"),onConnectionEstablished:this.$13("onConnectionEstablished"),onDataChannelMessageReceived:this.$13("onDataChannelMessageReceived"),onIceCandidateReady:this.$13("onIceCandidateReady"),onLocalMediaStateUpdate:this.$13("onLocalMediaStateUpdate"),onLocalSdpSet:this.$13("onLocalSdpSet")}};c.$13=function(a){var b=this;return function(){if(b.$5&&b.$5[a]){var c;(c=b.$5)[a].apply(c,arguments)}}};c.maybeHandleSimulcastDataMessage=function(a){try{a=JSON.parse(a);a=a.body;if(a.videoUploadRequest){var c=null;a.videoUploadRequest.perSsrcTargetBitrateBpsMap&&(c=this.$14(a.videoUploadRequest.perSsrcTargetBitrateBpsMap));c={perSsrcTargetBitrateBpsMap:c,qualityMask:a.videoUploadRequest.qualityMask};this.handleSimulcastUploadRequest(c)}}catch(a){b("FBLogger")("rtc_www").warn("MaybeHandleSimulcastDataMessage failed:",a)}};c.$14=function(a){var c=new Map();Object.keys(a).forEach(function(d){var e=parseInt(a[d],10);if(isNaN(e)){b("recoverableViolation")("Simulcast bitrate string could not be parsed as int","rtc_www");return}c.set(d,e)});return c};c.handleSimulcastUploadRequest=function(a){var c,d;if(!b("ZenonSimulcastExperiments").isCurrentBrowserCompatibleWithSimulcast()||!this.$4.supportsSimulcast()||typeof ((c=window.RTCRtpSender)==null?void 0:c.prototype.getParameters)!=="function")return;c=this.$4.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(c.length===0)return;c=c[0];var e=!1,f=this.$2.getTracks();if((d=c.track)==null?void 0:d.id){f=f.get((d=c.track)==null?void 0:d.id);e=f&&f.contentType==="screen"}d=this.$4.getReceivers().filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});f=Date.now()-this.$9;f=b("ZenonSimulcastManager").getSimulcastEncodingParameters(c.getParameters(),a,d.length+1,b("ZenonSimulcastManager").getSimulcastSsrcToLayerMap(((a=this.$3.getLocalSdp())==null?void 0:a.toDesc().sdp)||""),e,{height:(a=(d=c.track)==null?void 0:d.getSettings().height)!=null?a:720,width:(d=(e=c.track)==null?void 0:e.getSettings().width)!=null?d:1280},(a=b("qex")._("1718199"))!=null?a:!0,f>=((e=b("qex")._("1728155"))!=null?e:0),(d=b("qex")._("1722576"))!=null?d:1,(a=b("qex")._("1722577"))!=null?a:1);e=f.params;d=f.updated;c.setParameters(e);d&&(this.$9=Date.now())};return a}();e.exports=a},null);
__d("OverlayConfigConstants",[],function(a,b,c,d,e,f){"use strict";a={OverlayConfigNumParameters:539,OverlayConfigNotPresentFlagValue:-1};e.exports=a},null);
__d("OverlayConfigLayer",[],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getLayerSource=function(){return this.$1};b.getValue=function(a){return this.$2[a]};b.logExposure=function(a){};return a}();e.exports=a},null);
__d("OverlayConfigLayerBuilder",["OverlayConfigConstants","OverlayConfigLayer","unrecoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=new Array(b("OverlayConfigConstants").OverlayConfigNumParameters).fill(b("OverlayConfigConstants").OverlayConfigNotPresentFlagValue),this.$2=a}var c=a.prototype;c.build=function(){return new(b("OverlayConfigLayer"))(this.$2,this.$1)};c.$3=function(a,c){a>=b("OverlayConfigConstants").OverlayConfigNumParameters&&b("unrecoverableViolation")("Parameter ID passed in exceeds max parameter id","rtc_www"),this.$1[a]=c};c.$4=function(a,b){this.$3(a,b?1:0)};c.setExampleConfigEnabled=function(a){this.$4(0,a)};c.setExampleConfigSomeBoolean=function(a){this.$4(2,a)};c.setExampleConfigSomeInteger=function(a){this.$3(1,a)};c.setExampleConfigSomeOtherInteger=function(a){this.$3(3,a)};c.setZenonSdpTransformConfigPreserveH264=function(a){this.$4(244,a)};c.setZenonSdpTransformConfigPreferH264ForMwCall=function(a){this.$4(420,a)};c.setZenonSdpTransformConfigPreferSwH264=function(a){this.$4(421,a)};c.setZenonSdpTransformConfigAddAudioNack=function(a){this.$4(245,a)};c.setZenonSdpTransformConfigDisableOpusStereo=function(a){this.$4(246,a)};c.setZenonSdpTransformConfigDtlsSrtpKeyAgreement=function(a){this.$4(247,a)};c.setZenonSdpTransformConfigPreferIsacForGroupAudio=function(a){this.$4(248,a)};c.setZenonPeerConnectionConfigDtlsSrtpKeyAgreement=function(a){this.$4(301,a)};c.setZenonPeerConnectionConfigRtpDataChannels=function(a){this.$4(302,a)};c.setZenonStartCallImmediatelyConfigEnabled=function(a){this.$4(308,a)};c.setZenonMultiCallSupportConfigMaxConnectedCalls=function(a){this.$3(309,a)};c.setZenonPlatformSupportConfigSupportsZenonPlatform=function(a){this.$4(316,a)};c.setZenonPlatformSupportConfigStartImmediatelyEnabled=function(a){this.$4(318,a)};c.setZenonPlatformSupportConfigMaxConnectedCalls=function(a){this.$3(317,a)};c.setZenonPlatformSupportConfigParentWindowConnectionTimeoutMs=function(a){this.$3(319,a)};c.setZenonSimulcastConfigSimulcastEnabled=function(a){this.$4(453,a)};return a}();e.exports=a},null);
__d("OverlayConfigLayerSource",[],function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,DEFAULT:1,MOBILECONFIG:2,APP_CRUCIBLE:3,APP_JNI:4,UNIT_TEST:5,SERVER:6,PLACEHOLDER:7,LS_MOBILECONFIG:8,APP_LS:9,APP_JS:10,BROWSER:11,APP_OVRRTC:12,APP_IG:13,MLITE4A_LEGACY_QE:14,APP_MLITE4A:15,APP_PORTAL:16,IG_LAUNCHER:17});e.exports=a},null);
__d("ChromeOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],function(a,b,c,d,e,f){"use strict";a=function(){var a=new(b("OverlayConfigLayerBuilder"))(b("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();c=a;e.exports=c},null);
__d("EdgeOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],function(a,b,c,d,e,f){"use strict";a=function(){var a=new(b("OverlayConfigLayerBuilder"))(b("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();c=a;e.exports=c},null);
__d("FirefoxOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],function(a,b,c,d,e,f){"use strict";a=function(){var a=new(b("OverlayConfigLayerBuilder"))(b("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();c=a;e.exports=c},null);
__d("StructuredConfigBase",[],function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getBool=function(a){return this.$1.getValue(a)>0};b.getInt=function(a){return this.$1.getValue(a)};return a}();e.exports=a},null);
__d("Configs",["StructuredConfigBase"],function(a,b,c,d,e,f){"use strict";c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ExampleConfig1=c.getBool(0),c.$ExampleConfig2=c.getBool(2),c.$ExampleConfig3=c.getInt(1),c.$ExampleConfig4=c.getInt(3),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ExampleConfig1=this.getBool(0),this.$ExampleConfig2=this.getBool(2),this.$ExampleConfig3=this.getInt(1),this.$ExampleConfig4=this.getInt(3)};c.isEnabled=function(){return this.$ExampleConfig1};c.isSomeBoolean=function(){return this.$ExampleConfig2};c.getSomeInteger=function(){return this.$ExampleConfig3};c.getSomeOtherInteger=function(){return this.$ExampleConfig4};return b}(a=b("StructuredConfigBase"));d=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonSdpTransformConfig1=c.getBool(244),c.$ZenonSdpTransformConfig2=c.getBool(420),c.$ZenonSdpTransformConfig3=c.getBool(421),c.$ZenonSdpTransformConfig4=c.getBool(245),c.$ZenonSdpTransformConfig5=c.getBool(246),c.$ZenonSdpTransformConfig6=c.getBool(247),c.$ZenonSdpTransformConfig7=c.getBool(248),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonSdpTransformConfig1=this.getBool(244),this.$ZenonSdpTransformConfig2=this.getBool(420),this.$ZenonSdpTransformConfig3=this.getBool(421),this.$ZenonSdpTransformConfig4=this.getBool(245),this.$ZenonSdpTransformConfig5=this.getBool(246),this.$ZenonSdpTransformConfig6=this.getBool(247),this.$ZenonSdpTransformConfig7=this.getBool(248)};c.isPreserveH264=function(){return this.$ZenonSdpTransformConfig1};c.isPreferH264ForMwCall=function(){return this.$ZenonSdpTransformConfig2};c.isPreferSwH264=function(){return this.$ZenonSdpTransformConfig3};c.isAddAudioNack=function(){return this.$ZenonSdpTransformConfig4};c.isDisableOpusStereo=function(){return this.$ZenonSdpTransformConfig5};c.isDtlsSrtpKeyAgreement=function(){return this.$ZenonSdpTransformConfig6};c.isPreferIsacForGroupAudio=function(){return this.$ZenonSdpTransformConfig7};return b}(a);f=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonPeerConnectionConfig1=c.getBool(301),c.$ZenonPeerConnectionConfig2=c.getBool(302),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonPeerConnectionConfig1=this.getBool(301),this.$ZenonPeerConnectionConfig2=this.getBool(302)};c.isDtlsSrtpKeyAgreement=function(){return this.$ZenonPeerConnectionConfig1};c.isRtpDataChannels=function(){return this.$ZenonPeerConnectionConfig2};return b}(a);b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonStartCallImmediatelyConfig1=c.getBool(308),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonStartCallImmediatelyConfig1=this.getBool(308)};c.isEnabled=function(){return this.$ZenonStartCallImmediatelyConfig1};return b}(a);var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonMultiCallSupportConfig1=c.getInt(309),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonMultiCallSupportConfig1=this.getInt(309)};c.getMaxConnectedCalls=function(){return this.$ZenonMultiCallSupportConfig1};return a}(a),h=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonPlatformSupportConfig1=c.getBool(316),c.$ZenonPlatformSupportConfig2=c.getBool(318),c.$ZenonPlatformSupportConfig3=c.getInt(317),c.$ZenonPlatformSupportConfig4=c.getInt(319),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonPlatformSupportConfig1=this.getBool(316),this.$ZenonPlatformSupportConfig2=this.getBool(318),this.$ZenonPlatformSupportConfig3=this.getInt(317),this.$ZenonPlatformSupportConfig4=this.getInt(319)};c.isSupportsZenonPlatform=function(){return this.$ZenonPlatformSupportConfig1};c.isStartImmediatelyEnabled=function(){return this.$ZenonPlatformSupportConfig2};c.getMaxConnectedCalls=function(){return this.$ZenonPlatformSupportConfig3};c.getParentWindowConnectionTimeoutMs=function(){return this.$ZenonPlatformSupportConfig4};return a}(a);a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonSimulcastConfig1=c.getBool(453),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonSimulcastConfig1=this.getBool(453)};c.isSimulcastEnabled=function(){return this.$ZenonSimulcastConfig1};return b}(a);e.exports={ExampleConfig:c,ZenonSdpTransformConfig:d,ZenonPeerConnectionConfig:f,ZenonStartCallImmediatelyConfig:b,ZenonMultiCallSupportConfig:g,ZenonPlatformSupportConfig:h,ZenonSimulcastConfig:a}},null);
__d("OverlayConfigDefaults",[],function(a,b,c,d,e,f){"use strict";a=Object.freeze([1,0,0,20,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,0,1,0,2e3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);e.exports=a},null);
__d("OverlayConfigDefaultsLayer",["OverlayConfigDefaults","OverlayConfigLayerSource"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.getLayerSource=function(){return b("OverlayConfigLayerSource").DEFAULT};c.getValue=function(a){return b("OverlayConfigDefaults")[a]};c.logExposure=function(a){};return a}();e.exports=a},null);
__d("OverlayConfigLayerManager",["OverlayConfigConstants","OverlayConfigDefaultsLayer","unrecoverableViolation"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[new(b("OverlayConfigDefaultsLayer"))()]}var c=a.prototype;c.getValue=function(a){for(var c=this.$1.length-1;c>=0;c--){var d=this.$1[c].getValue(a);if(d>b("OverlayConfigConstants").OverlayConfigNotPresentFlagValue)return d}throw b("unrecoverableViolation")("OverlayConfigLayerManager: No value found for id "+String(a),"rtc_www")};c.addLayer=function(a){this.$1.push(a);return this.$1.length-1};c.replaceLayer=function(a,c){if(a===0)throw b("unrecoverableViolation")("OverlayConfigLayerManager: Tried to replace default layer!","rtc_www");else if(this.$1[a]==null)throw b("unrecoverableViolation")("OverlayConfigLayerManager: Layer does not exist at index "+String(a),"rtc_www");this.$1[a]=c};return a}();e.exports=a},null);
__d("OverlayConfigManager",["Configs","OverlayConfigLayerManager"],function(a,b,c,d,e,f){"use strict";var g=(a=b("Configs")).ExampleConfig,h=a.ZenonSdpTransformConfig,i=a.ZenonPeerConnectionConfig,j=a.ZenonStartCallImmediatelyConfig,k=a.ZenonMultiCallSupportConfig,l=a.ZenonPlatformSupportConfig,m=a.ZenonSimulcastConfig;c=function(){function a(){this.layerManager=new(b("OverlayConfigLayerManager"))()}var c=a.prototype;c.getExampleConfig=function(){return new g(this.layerManager)};c.getZenonSdpTransformConfig=function(){return new h(this.layerManager)};c.getZenonPeerConnectionConfig=function(){return new i(this.layerManager)};c.getZenonStartCallImmediatelyConfig=function(){return new j(this.layerManager)};c.getZenonMultiCallSupportConfig=function(){return new k(this.layerManager)};c.getZenonPlatformSupportConfig=function(){return new l(this.layerManager)};c.getZenonSimulcastConfig=function(){return new m(this.layerManager)};return a}();e.exports=c},null);
__d("ZenonOverlayConfigManager",["ChromeOverlayConfigLayer","EdgeOverlayConfigLayer","FirefoxOverlayConfigLayer","OverlayConfigManager","RTWebSignalingListener","UserAgentData"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$2=new(b("OverlayConfigManager"))();var c={Chrome:b("ChromeOverlayConfigLayer"),"Edge (Chromium Based)":b("EdgeOverlayConfigLayer"),Firefox:b("FirefoxOverlayConfigLayer")};c=c[b("UserAgentData").browserName];c&&this.$2.layerManager.addLayer(c);a.appConfig&&this.$2.layerManager.addLayer(a.appConfig)}var c=a.prototype;c.getSignalingListener=function(){var a;return(a=this.$1.signalingListener)!=null?a:new(b("RTWebSignalingListener"))()};c.getConfigManager=function(){return this.$2};return a}();e.exports=a},null);
__d("ZenonCallSDK",["regeneratorRuntime","EventEmitter","ScotchCallModelEmitter","ScotchRTWebUserActionLogger","ScotchSignalingEventEmitter","ScotchUtils","ZenonCallsManager","ZenonCallsModelEmitter","ZenonOverlayConfigManager","ZenonPlatformExperiments","ZenonTransportEventEmitter","gkx","immutable","qex"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;c=new(b("ZenonOverlayConfigManager"))(c);var e=c.getConfigManager().getZenonPlatformSupportConfig().isSupportsZenonPlatform()&&g();d.$ZenonCallSDK1=e?new(b("ZenonCallsManager"))(c):new(b("ScotchUtils"))(c);c=e?b("ZenonCallsModelEmitter"):b("ScotchCallModelEmitter");c.CallsModelEmitterInstance.addListener("callsModelUpdate",function(a){d.emit("callsModelUpdate",a)});e?b("ZenonTransportEventEmitter").addListener("transportPlatformEvent",function(a){d.emit("signalingEvent",a)}):b("ScotchSignalingEventEmitter").addListener("signalingPlatformEvent",function(a){d.emit("signalingEvent",a)});return d}var d=c.prototype;d.initSignaling=function(a,b,c){this.$ZenonCallSDK1.initializeSignaling(a,b,c)};d.endCall=function(a,b,c){this.$ZenonCallSDK1.endCall(a,b,c)};d.join=function(a){this.$ZenonCallSDK1.join(a)};d.ringParticipants=function(a,b){this.$ZenonCallSDK1.ringParticipants(a,b)};d.removeParticipants=function(a,b){this.$ZenonCallSDK1.removeParticipants(a,b)};d.forceEncodingEnabled=function(a,b){this.$ZenonCallSDK1.forceEncodingEnabled(a,b)};d.addLocalTrack=function(a,b){this.$ZenonCallSDK1.addLocalTrack(a,b)};d.removeLocalTrack=function(a,b){this.$ZenonCallSDK1.removeLocalTrack(a,b)};d.replaceLocalTrack=function(a,b,c,d){d===void 0&&(d=!1);return this.$ZenonCallSDK1.replaceLocalTrack(a,b,c,d)};d.muteTrack=function(a,b){this.$ZenonCallSDK1.muteTrack(a,b)};d.unmuteTrack=function(a,b){this.$ZenonCallSDK1.unmuteTrack(a,b)};d.stopLocalVideo=function(a,b){this.$ZenonCallSDK1.stopLocalVideo(a,b)};d.acceptVideoEscalation=function(a){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(this.$ZenonCallSDK1.acceptVideoEscalation());case 2:case"end":return a.stop()}},null,this)};d.declineVideoEscalation=function(a){this.$ZenonCallSDK1.declineVideoEscalation()};d.cancelVideoEscalation=function(a){this.$ZenonCallSDK1.cancelVideoEscalation()};d.startVideoEscalation=function(a){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(this.$ZenonCallSDK1.startVideoEscalation());case 2:case"end":return a.stop()}},null,this)};d.createDataMessageSubscription=function(a,b,c){this.$ZenonCallSDK1.createDataMessageSubscription(a,b,c)};d.removeDataMessageSubscription=function(a,b,c){this.$ZenonCallSDK1.removeDataMessageSubscription(a,b,c)};d.sendGenericDataMessage=function(a,b,c,d,e){this.$ZenonCallSDK1.sendGenericDataMessage(a,b,c,d,e)};d.logWithLogIdentifiers=function(a,b){this.$ZenonCallSDK1.logWithLogIdentifiers(a,b)};d.subscribeToRemoteVideo=function(a,c,d){b("gkx")("1390244")&&this.$ZenonCallSDK1.subscribeToRemoteVideo(a,c,d)};d.unsubscribeFromStateSyncTopic=function(a,c){b("gkx")("1418215")&&this.$ZenonCallSDK1.unsubscribeFromStateSyncTopic(a,c)};d.subscribeToStateSyncTopic=function(a,c){b("gkx")("1418215")&&this.$ZenonCallSDK1.updateStateSyncTopic(a,c,null)};d.updateStateSyncTopic=function(a,c,d){b("gkx")("1418215")&&this.$ZenonCallSDK1.updateStateSyncTopic(a,c,d)};d.approveParticipants=function(a,c){if(!b("ZenonPlatformExperiments").shouldUseLobbyMode()){var d=c.toArray().join(", ");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[WR] Product is trying to approve users "+d});return}this.$ZenonCallSDK1.approveParticipants(a,c)};d.denyParticipants=function(a,c){if(!b("ZenonPlatformExperiments").shouldUseLobbyMode()){var d=c.toArray().join(", ");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[WR] Product is trying to deny users "+d});return}this.$ZenonCallSDK1.denyParticipants(a,c)};d.getPlatformType=function(){return this.$ZenonCallSDK1.getPlatformType()};d.notifyScreenShareStart_DEPRECATED=function(a){this.$ZenonCallSDK1.notifyScreenShareStart(a)};d.notifyScreenShareEnd_DEPRECATED=function(a){this.$ZenonCallSDK1.notifyScreenShareEnd(a)};d.getCallProtocolType_DEPRECATED=function(a){return this.$ZenonCallSDK1.getCallProtocolType()};d.initV2Infrastructure_DEPRECATED=function(a,b){this.$ZenonCallSDK1.initializeV2Infrastructure(a,b)};d.submitRating_DEPRECATED=function(a,b,c,d){c===void 0&&(c=null),d===void 0&&(d=null),this.$ZenonCallSDK1.submitRating(a,b,c,d)};d.setRatingImpression_DEPRECATED=function(a,b,c){b===void 0&&(b=!1),c===void 0&&(c=!1),this.$ZenonCallSDK1.setRatingImpression(b,c)};return c}(b("EventEmitter"));e.exports=a;function g(){var a,c;a=(a=b("qex")._("1566746"))!=null?a:!1;c=(c=b("qex")._("1760652"))!=null?c:!1;return a||c}},null);
__d("ScotchRTCStateSyncReducer",["ScotchRTCStateSyncStore"],function(a,b,c,d,e,f){"use strict";f.setState=a;f.setSubscription=c;function a(a,c){switch(c.type){case"SET_INPUT_SYNC_STATE":var d=b("ScotchRTCStateSyncStore").getState().inputStates.set(c.topic,{version:c.version,data:c.inputData});return a.set("inputStates",d);case"SET_OUTPUT_SYNC_STATE":d=b("ScotchRTCStateSyncStore").getState().outputStates.set(c.topic,{version:c.version,data:c.outputData});return a.set("outputStates",d)}return a}function c(a,c){var d=b("ScotchRTCStateSyncStore").getState().subscribedTopics;switch(c.type){case"STATE_SYNC_SUBSCRIBE":return a.set("subscribedTopics",d.add(c.topic));case"STATE_SYNC_UNSUBSCRIBE":return a.set("subscribedTopics",d["delete"](c.topic))}return a}},null);
__d("ScotchRTCStateSyncStoreState",["immutable"],function(a,b,c,d,e,f){"use strict";c={inputStates:(a=b("immutable")).Map([]),outputStates:a.Map([]),subscribedTopics:a.Set([])};d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.Record(c));e.exports=d},null);
__d("ScotchRTCStateSyncStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCGroupCallActions","ScotchRTCStateSyncReducer","ScotchRTCStateSyncStoreState","ScotchRTWebUserActionLogger","ZenonStateSyncSerializer"],function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCStateSyncReducer").setState,b("ScotchRTCStateSyncReducer").setSubscription];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCStateSyncStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.setUpdatedInputState=function(a,c){var d=b("ZenonStateSyncSerializer").serializeInputState(a,c),e=1;if(this.getState().inputStates.has(a)){var f=this.getState().inputStates.get(a);e=f.version+1}b("ScotchRTCGroupCallActions").setStateSyncInput(a,e,c);return{version:e,data:d}};d.setOutputState=function(a,c){if(!this.getState().subscribedTopics.has(a)){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] User is not subscribed to topic: "+a+", dropping output state."});return}var d=-1;if(this.getState().outputStates.has(a)){var e=this.getState().outputStates.get(a);d=e.version}if(c.version<=d){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] Client version: "+d+" is ahead of server version: "+c.version+", dropping output state"});return}e=b("ZenonStateSyncSerializer").deserializeOutputState(a,c.data);b("ScotchRTCGroupCallActions").setStateSyncOutput(a,c.version,e);return};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a(b("ScotchRTCAppDispatcher"));e.exports=c},null);
/**
 * Copyright @ 2015 Atlassian Pty Ltd
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @nolint
 * @preserve-header
 * @preserve-whitespace
 */
__d("sdp-interop-transform",["sdp-transform"],(function $module_sdp_interop_transform(global,require,requireDynamic,requireLazy,module,exports){

const transform = require('sdp-transform');

exports.write = function(session, opts) {

  if (typeof session !== 'undefined' &&
      typeof session.media !== 'undefined' &&
      Array.isArray(session.media)) {

    session.media.forEach(function (mLine) {
      // expand sources to ssrcs
      if (typeof mLine.sources !== 'undefined' &&
        Object.keys(mLine.sources).length !== 0) {
          mLine.ssrcs = [];
          Object.keys(mLine.sources).forEach(function (ssrc) {
            const source = mLine.sources[ssrc];
            Object.keys(source).forEach(function (attribute) {
              mLine.ssrcs.push({
                id: ssrc,
                attribute: attribute,
                value: source[attribute]
              });
            });
          });
          delete mLine.sources;
        }

      // join ssrcs in ssrc groups
      if (typeof mLine.ssrcGroups !== 'undefined' &&
        Array.isArray(mLine.ssrcGroups)) {
          mLine.ssrcGroups.forEach(function (ssrcGroup) {
            if (typeof ssrcGroup.ssrcs !== 'undefined' &&
                Array.isArray(ssrcGroup.ssrcs)) {
              ssrcGroup.ssrcs = ssrcGroup.ssrcs.join(' ');
            }
          });
        }
    });
  }

  // join group mids
  if (typeof session !== 'undefined' &&
      typeof session.groups !== 'undefined' && Array.isArray(session.groups)) {

    session.groups.forEach(function (g) {
      if (typeof g.mids !== 'undefined' && Array.isArray(g.mids)) {
        g.mids = g.mids.join(' ');
      }
    });
  }

  return transform.write(session, opts);
};

exports.parse = function(sdp) {
  const session = transform.parse(sdp);

  if (typeof session !== 'undefined' && typeof session.media !== 'undefined' &&
      Array.isArray(session.media)) {

    session.media.forEach(function (mLine) {
      // group sources attributes by ssrc
      if (typeof mLine.ssrcs !== 'undefined' && Array.isArray(mLine.ssrcs)) {
        mLine.sources = {};
        mLine.ssrcs.forEach(function (ssrc) {
          if (!mLine.sources[ssrc.id])
          mLine.sources[ssrc.id] = {};
        mLine.sources[ssrc.id][ssrc.attribute] = ssrc.value;
        });

        delete mLine.ssrcs;
      }

      // split ssrcs in ssrc groups
      if (typeof mLine.ssrcGroups !== 'undefined' &&
        Array.isArray(mLine.ssrcGroups)) {
          mLine.ssrcGroups.forEach(function (ssrcGroup) {
            if (typeof ssrcGroup.ssrcs === 'string') {
              ssrcGroup.ssrcs = ssrcGroup.ssrcs.split(' ');
            }
          });
        }
    });
  }
  // split group mids
  if (typeof session !== 'undefined' &&
      typeof session.groups !== 'undefined' && Array.isArray(session.groups)) {

    session.groups.forEach(function (g) {
      if (typeof g.mids === 'string') {
        g.mids = g.mids.split(' ');
      }
    });
  }

  return session;
};

/*  */}),null);
/**
 * License: https://www.facebook.com/legal/license/4tlmzNX1_Tc/
 */
__d("ZenonSDPInterop",["sdp-interop-transform"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.cache={mlB2UMap:{},mlU2BMap:{},localMediaLines:[],remoteMediaLines:[],localDescriptionType:"offer",offer:null,answer:null,pranswer:null,rollback:null},this.planBRemoteDescription=null,this.midToMWTrackId=new Map(),this.mwTrackIdToWebrtcTrackId=new Map()}var c=a.prototype;c.setLocalDescriptionType=function(a){this.cache.localDescriptionType=a};c.setPlanBRemoteDescription=function(a){this.planBRemoteDescription=a};c.getPlanBRemoteDescription=function(){return this.planBRemoteDescription};c.correlateWebrtcTrackIdsByMid=function(a,b){b=this.midToMWTrackId.get(b);b!=null&&this.mwTrackIdToWebrtcTrackId.set(b,a)};c.getWebrtcTrackIdFromMWTrackId=function(a){var b=this.mwTrackIdToWebrtcTrackId.get(a);return b?b:a};c.candidateToUnifiedPlan=function(a){a=new RTCIceCandidate(a);a.sdpMLineIndex=this.cache.mlB2UMap[a.sdpMLineIndex];return a};c.candidateToPlanB=function(a){a=new RTCIceCandidate(a);var b=a.sdpMid;if(b!=null)if(b.indexOf("audio")===0)a.sdpMid="audio";else if(b.indexOf("video")===0)a.sdpMid="video";else throw new Error("candidate with "+b+" not allowed");a.sdpMLineIndex=this.cache.mlU2BMap[a.sdpMLineIndex];return a};c.getFirstSendingIndexFromAnswer=function(a){if(!this.cache.answer)return null;var c=b("sdp-interop-transform").parse(this.cache.answer);if(c&&c.media&&Array.isArray(c.media))for(var d=0;d<c.media.length;d++)if(c.media[d].type===a&&(!c.media[d].direction||c.media[d].direction==="sendrecv"||c.media[d].direction==="sendonly"))return d;return null};c.cacheUnifiedPlanOffer=function(a){var c=this,d=[];if(typeof a!=="object"||a===null||typeof a.sdp!=="string")return a;var e=b("sdp-interop-transform").parse(a.sdp);if(e.media===void 0||!Array.isArray(e.media)||e.media.length===0)return a;if(e.media.length<=3&&e.media.every(function(a){a=a.mid;return["video","audio","data"].includes(a)}))return a;var f=a.sdp,g=!1,h=function(a){var f=e.media[a];d.push(f.type);f.rtp.forEach(function(d){if(d.codec==="NULL"){g=!0;var e=b("sdp-interop-transform").parse(c.cache.offer);d.codec=e.media[a].rtp[0].codec}})};for(var i=0;i<e.media.length;i++)h(i);g&&(f=b("sdp-interop-transform").write(e));this.cache[a.type]=f;this.cache.localDescriptionType=a.type;this.cache.localMediaLines=d};c.toUnifiedPlan=function(c){var d=this,e=this;if(typeof c!=="object"||c===null||typeof c.sdp!=="string")return c;if(c.type!=="answer"&&c.type!=="offer")return c;var f=b("sdp-interop-transform").parse(c.sdp);if(f.media===void 0||!Array.isArray(f.media)||f.media.length===0)return c;var g=[];f.media.forEach(function(a){a=a.mid;g.push(a)});var h=[],i;this.cache[c.type]!=null&&(i=b("sdp-interop-transform").parse(this.cache[c.type]));var j={audio:{},video:{}},k={},l=0,m=0;f.media.forEach(function(a){if(a.type==="application"){a.mid=String(a.mid);k[a.mid]=a;return}var b=a.sources,f=a.ssrcGroups,g=a.candidates,h=a.iceUfrag,n=a.icePwd,p=a.fingerprint,q=a.port;typeof b==="object"&&(delete a.sources,delete a.ssrcGroups,delete a.candidates,delete a.iceUfrag,delete a.icePwd,delete a.fingerprint,delete a.port,delete a.mid);var r={};f!==void 0&&Array.isArray(f)&&f.forEach(function(a){if(a.semantics==="SIM")return;a.ssrcs!==void 0&&Array.isArray(a.ssrcs)&&a.ssrcs.forEach(function(b){r[b]===void 0&&(r[b]=[]),r[b].push(a)})});var s={};typeof b==="object"?Object.keys(b).forEach(function(t){var f;if(c.type===d.cache.localDescriptionType&&!b[t].msid){j[a.type][t]=b[t];return}r[t]!==void 0&&Array.isArray(r[t])&&r[t].some(function(a){a=a.ssrcs;return a.some(function(a){if(typeof s[a]==="object"){f=s[a];return!0}})});if(typeof f==="object")f.sources[t]=b[t],delete b[t].msid;else{f=Object.create(a);s[t]=f;b[t].msid!==void 0&&(f.msid=b[t].msid);f.sources={};f.sources[t]=b[t];f.ssrcGroups=r[t];i!==void 0&&i.media!==void 0&&Array.isArray(i.media)&&i.media.forEach(function(a){typeof a.sources==="object"&&Object.keys(a.sources).forEach(function(b){b===t&&(f.mid=String(a.mid))})});if(f.mid===void 0){if(c.type===d.cache.localDescriptionType)throw new Error("An unmapped SSRC was found.");f.mid=[a.type,"-",t].join("")}f.candidates=g;f.iceUfrag=h;f.icePwd=n;f.fingerprint=p;f.port=q;f.type=a.type;k[f.mid]=f;e.cache.mlU2BMap[m]=l;e.cache.mlB2UMap[l]===void 0&&(e.cache.mlB2UMap[l]=m);m++}}):(a.mid=String(a.mid),k[a.mid]=a);l++});f.media=[];g=[];if(c.type===this.cache.localDescriptionType){this.cache[c.type]!=null&&(i=b("sdp-interop-transform").parse(this.cache[c.type]));if(i!==void 0)for(var n=0;n<i.media.length;n++){var o=i.media[n];k[o.mid]===void 0&&(delete o.msid,delete o.sources,delete o.ssrcGroups,!o.direction||o.direction==="sendrecv"?o.direction="recvonly":o.direction==="sendonly"&&(o.direction="inactive"));f.media.push(o);typeof o.mid==="string"&&g.push(o.mid)}}else i!==void 0&&i.media!==void 0&&Array.isArray(i.media)&&i.media.forEach(function(a){var b=String(a.mid);g.push(b);k[b]!==void 0?f.media.push(k[b]):(delete a.msid,delete a.sources,delete a.ssrcGroups,(!a.direction||a.direction==="sendrecv")&&(a.direction="recvonly"),(!a.direction||a.direction==="sendonly")&&(a.direction="inactive"),f.media.push(a))}),Object.keys(k).forEach(function(a){g.includes(a)||(g.push(a),k[a].direction==="recvonly"?f.media.some(function(b){var c=b.direction,d=b.sources;b=b.type;if((c==="sendrecv"||c==="sendonly")&&b===k[a].type){Object.keys(k[a].sources).forEach(function(b){d[b]=k[a].sources[b]});return!0}}):f.media.push(k[a]))});this.cache[c.type]===null&&(f.media=a.sortRemoteSourcesToMatchLocalOrder(this.cache.localMediaLines,f.media));g=[];for(var o=0;o<f.media.length;o++)f.media[o].mid=String(o),g.push(String(o)),h.push(f.media[o].type);this.cacheMidToMWTrackId(f.media);["audio","video"].forEach(function(a){if(!f||!f.media||!Array.isArray(f.media))return;var b=null;if(Object.keys(j[a]).length>0){b=e.getFirstSendingIndexFromAnswer(a);if(b===null)for(var c=0;c<f.media.length;c++)if(f.media[c].type===a){b=c;break}}if(b&&f.media.length>b){var d=f.media[b];Object.keys(j[a]).forEach(function(b){d.sources&&d.sources[b],d.sources||(d.sources={}),d.sources[b]=j[a][b]})}});f.groups.some(function(a){if(a.type==="BUNDLE"){a.mids=g.join(" ");return!0}});f.msidSemantic={semantic:"WMS",token:"*"};n=b("sdp-interop-transform").write(f);this.cache.remoteMediaLines=h;this.cache[c.type]=n;return{sdp:n,type:c.type}};c.getTrackTypesToMatchDescription=function(){var a=[],b=this.cache,c=b.localMediaLines;b=b.remoteMediaLines;if(b.length<=c.length)return a;for(var d=0;d<b.length;d++)c[d]==null&&a.push(b[d]);return a};a.sortRemoteSourcesToMatchLocalOrder=function(a,b){var c=0,d=0;while(c<a.length&&d<b.length){if(b[d].type===a[c]){var e=b[c];b[c]=b[d];b[d]=e;c++;d=0}d++}return b};c.cacheMidToMWTrackId=function(b){var c=this;b.forEach(function(b){var d=b.sources;if(d!=null&&b.type!=="application"){var e=Object.keys(d);e.length>=1&&e.forEach(function(e){e=d[e].msid;e=a.getMWTrackIdFromMsid(e);e!=null&&c.midToMWTrackId.set(b.mid,e)})}})};a.getMWTrackIdFromMsid=function(a){if(a!=null){a=a.split(" ");if(a.length>=2)return a[1]}return null};return a}();e.exports=a},null);
__d("ScotchFBRTCPeerConnectionCurrent",["Promise","regeneratorRuntime","FBLogger","FBRTCConfig","FBRTCConsoleLogger","FBRTCConstants","FBRTCExperiment","RTCConfig","RTCIceCandidate","RTCPeerConnection","ScotchFBRTCSdpUtils","ScotchRTCSessionDescription","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","UserAgent","ZenonRTWebBrowserFeatureSupport","ZenonSDPInterop","ZenonSimulcastExperiments","ZenonSimulcastManager","ZenonSimulcastSdpUtils","gkx","requireCond","webrtc-adapter","cr:1412113"],function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d){var e=this;c===void 0&&(c={});d===void 0&&(d={});this.$3=[];this.$4=[];this.$7=new Map();this.$10=b("FBRTCConstants").SDPSemantics.PLAN_B;this.$12=!1;this.$13=null;this.addEventListener=function(a,b){var c=this.$7.get(a);Array.isArray(c)||(c=[],this.$7.set(a,c));c.push(b);this.$5.addEventListener(a,b)};this.removeEventListener=function(a,b){var c=this.$7.get(a);Array.isArray(c)&&(c=c.filter(function(a){return a!==b}),c.length<1?this.$7["delete"](a):this.$7.set(a,c));this.$5.removeEventListener(a,b)};this.$15=function(a){a=a.candidate;a&&e.$4.push(a)};this.$16=function(a){a=a.channel;e.$18(a)};this.$6=a;this.$1=c;this.$2=d;b("ScotchRTWebExperiments").shouldUseUnifiedPlan()?(this.$10=b("FBRTCConstants").SDPSemantics.UNIFIED_PLAN,this.$11=new(b("ZenonSDPInterop"))()):this.$6===b("FBRTCConstants").SignalingProtocol.MULTIWAY&&b("ScotchRTWebExperiments").shouldUseMWUnifiedPlanSDP()?(this.$10=b("FBRTCConstants").SDPSemantics.UNIFIED_PLAN,this.$11=new(b("ZenonSDPInterop"))()):this.$6===b("FBRTCConstants").SignalingProtocol.P2P&&b("ScotchRTWebExperiments").shouldUseP2PUnifiedPlanSDP()&&(this.$10=b("FBRTCConstants").SDPSemantics.UNIFIED_PLAN);this.$5=this.$14()}var c=a.prototype;c.$14=function(){b("webrtc-adapter")==null&&b("FBLogger")("rtc_www").mustfix("Webrtc-adapter should be loaded");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Creating peer connection with semantics "+this.$10});var a=new(b("RTCPeerConnection"))(babelHelpers["extends"]({},this.$1,{sdpSemantics:this.$10}),this.$2);a.addEventListener("icecandidate",this.$15);a.addEventListener("datachannel",this.$16);for(var c=this.$7.entries(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];for(var f=f,h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;a.addEventListener(g,j)}}return a};c.removeAllListeners=function(){for(var a=this.$7.entries(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;var e=d[0];d=d[1];for(var d=d,f=Array.isArray(d),g=0,d=f?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=d.length)break;h=d[g++]}else{g=d.next();if(g.done)break;h=g.value}h=h;this.$5.removeEventListener(e,h)}}this.$5.removeEventListener("datachannel",this.$16);this.$5.removeEventListener("icecandidate",this.$15)};c.reset=function(){var a=this,c=this.getSenders(),d=this.$5;for(var e=this.$7.entries(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;var i=h[0];h=h[1];for(var h=h,j=Array.isArray(h),l=0,h=j?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(j){if(l>=h.length)break;m=h[l++]}else{l=h.next();if(l.done)break;m=l.value}m=m;d.removeEventListener(i,m)}}d.removeEventListener("datachannel",this.$16);d.removeEventListener("icecandidate",this.$15);this.$3=[];this.$4=[];this.$5=this.$14();for(var m=d.getLocalStreams(),l=Array.isArray(m),j=0,m=l?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(l){if(j>=m.length)break;h=m[j++]}else{j=m.next();if(j.done)break;h=j.value}i=h;this.$17(i,c)&&this.addStream(i)}return b("Promise").race([new(b("Promise"))(function(b){var c=a.$5,e=function a(e){e=e.target;e.iceConnectionState!=="checking"&&e.iceConnectionState!=="new"&&(b(),c.removeEventListener("iceconnectionstatechange",a),k(d))};c.addEventListener("iceconnectionstatechange",e)}),new(b("Promise"))(function(a){return window.setTimeout(a,5e3)})])["catch"](function(a){return b("Promise").resolve()}).then(function(){k(d)})};c.$17=function(c,d){return!b("FBRTCConfig").isVCEndpointCall()||!b("RTCConfig").CollabWhitelistedBrowserGK?!0:a.shouldUseAddTrackForUnifiedPlan()?c.getTracks().some(function(a){return d!=null?d.some(function(b){return b.track===a}):!1}):c.active};c.close=function(){k(this.$5)};c.getCreatedIceCandidates=function(){return this.$4};c.$18=function(a){var b=this;a.addEventListener("close",function(){b.$3=b.$3.filter(function(b){return b!==a})});this.$3.push(a)};c.$19=function(a){return this.$9&&this.$9[a]||a};c.rewriteLocalIceCandidate=function(a,b){return[this.$8&&this.$8[a]||a,b]};c.transformLocalSdp=function(a){return b("ScotchFBRTCSdpUtils").transformSdpMids(a,this.$8)};c.transformRemoteSdp=function(a){return b("ScotchFBRTCSdpUtils").transformSdpMids(a,this.$9)};c.processRemoteOfferSdpForP2PVideoEscalation=function(a){if(!this.$8&&!this.$9)return a;var c=b("ScotchFBRTCSdpUtils").constructMidMapFromRemoteOffer(a),d=c.localSdpMap;c=c.remoteSdpMap;this.$8=d;this.$9=c;return this.transformRemoteSdp(a)};c.onReceivedRemoteIceCandidate=function(a){var c=a.sdp,d=a.label;a=a.sdp_mid;a=this.$19(a);d=new(b("RTCIceCandidate"))({sdpMLineIndex:d,candidate:b("ScotchFBRTCSdpUtils").fixMobileIceSdp(c),sdpMid:a});return b("Promise").resolve(this.$5.addIceCandidate(d))};c.getSignalingProtocol=function(){return this.$6};c.getLocalStreams=function(){return this.$5.getLocalStreams()};c.getRemoteStreams=function(){return this.$5.getRemoteStreams()};a.shouldUseAddTrackForUnifiedPlan=function(){return b("ScotchRTWebExperiments").shouldUseUnifiedPlan()||(b("UserAgent").isBrowser("Firefox")||b("ScotchRTWebExperiments").shouldUseP2PUnifiedPlanSDP())&&l("addTrack")&&b("ZenonRTWebBrowserFeatureSupport").isGetSendersSupported()};c.addStream=function(a,b){var c=this,d=this.getSenders(),e=[],f=function(){if(h){if(i>=g.length)return"break";j=g[i++]}else{i=g.next();if(i.done)return"break";j=i.value}var f=j,k=d.find(function(a){return a.track===f});k===void 0&&(k=c.$5.addTrack(f,a),e.push(k));b&&k&&b(k)};for(var g=a.getTracks(),h=Array.isArray(g),i=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j,k=f();if(k==="break")break}return e};c.removeStream=function(a){var b=a.getTracks();a=this.getSenders().filter(function(a){return b.includes(a.track)});for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;this.$5.removeTrack(e)}};c.removeTrack=function(a){this.$5.removeTrack(a)};c.addTrack=function(a,b){return this.$5.addTrack(a,b)};c.replaceTrack=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=this.getSenders().find(function(a){return a.track===c});if(!(d===void 0)){e.next=3;break}throw new Error("track to be replaced is not found");case 3:return e.abrupt("return",b("Promise").resolve(d.replaceTrack(a)));case 4:case"end":return e.stop()}},null,this)};c.createOffer=function(a,c,d){var e=this,f,h,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:a===void 0&&(a={});c===void 0&&(c={});d===void 0&&(d={});if(!g){l.next=9;break}l.next=6;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,c){e.$5.createOffer(b,c,i(a))}));case 6:l.t0=l.sent;l.next=12;break;case 9:l.next=11;return b("regeneratorRuntime").awrap(this.$5.createOffer(i(a)));case 11:l.t0=l.sent;case 12:f=l.t0;this.$10==b("FBRTCConstants").SDPSemantics.PLAN_B&&this.$6==b("FBRTCConstants").SignalingProtocol.MULTIWAY&&b("UserAgent").isBrowser("Chrome >= 86")&&!this.$12&&b("ZenonSimulcastExperiments").shouldUsePlanBChromeSimulcast()&&(f.sdp=b("ZenonSimulcastSdpUtils").addSimulcastToPlanBOffer(f.sdp,b("ScotchRTWebExperiments").getNumSimulcastLayers()),this.$12=!0,this.$13=b("ZenonSimulcastManager").getSimulcastSsrcToLayerMap(f.sdp));f=o(f,d,a);h=b("ScotchFBRTCSdpUtils").constructMidMap(f.sdp),j=h.localSdpMap,k=h.remoteSdpMap;this.$8=j;this.$9=k;this.$11!=null&&this.$11.cacheUnifiedPlanOffer(f);return l.abrupt("return",new(b("ScotchRTCSessionDescription"))(this.$6,f,c));case 20:case"end":return l.stop()}},null,this)};c.createAnswer=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:a===void 0&&(a={});if(!g){d.next=7;break}d.next=4;return b("regeneratorRuntime").awrap(new(b("Promise"))(this.$5.createAnswer));case 4:d.t0=d.sent;d.next=10;break;case 7:d.next=9;return b("regeneratorRuntime").awrap(this.$5.createAnswer());case 9:d.t0=d.sent;case 10:c=d.t0;return d.abrupt("return",new(b("ScotchRTCSessionDescription"))(this.$6,c,a));case 12:case"end":return d.stop()}},null,this)};c.setLocalDescription=function(a){var c=this,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=a.toDesc();e.prev=1;if(!j){e.next=7;break}e.next=5;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(a,b){c.$5.setLocalDescription(d,a,b)}));case 5:e.next=9;break;case 7:e.next=9;return b("regeneratorRuntime").awrap(this.$5.setLocalDescription(d));case 9:b("cr:1412113")&&b("cr:1412113").onSetLocalDescription(a);b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCPeerConnection_setLocalSDP:\r\n"+b("ScotchFBRTCSdpUtils").toLoggingString(a.toSdp())});e.next=17;break;case 13:e.prev=13;e.t0=e["catch"](1);b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchFBRTCPeerConnection_setLocalSDP",errorType:e.t0.toString()});throw e.t0;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},null,this,[[1,13]])};c.setRemoteDescription=function(a){var c=this,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=a;if(!(this.$11!=null)){e.next=5;break}e.next=4;return b("regeneratorRuntime").awrap(this.renegotiateDescriptionsForUnified(a,this.$11));case 4:d=e.sent;case 5:e.prev=5;if(!j){e.next=11;break}e.next=9;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(a,b){c.$5.setRemoteDescription(d.toDesc(),a,b)}));case 9:e.next=13;break;case 11:e.next=13;return b("regeneratorRuntime").awrap(this.$5.setRemoteDescription(d.toDesc()));case 13:b("cr:1412113")&&b("cr:1412113").onSetRemoteDescription(a);b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCPeerConnection_setRemoteSDP:\r\n"+b("ScotchFBRTCSdpUtils").toLoggingString(a.toSdp())});e.next=21;break;case 17:e.prev=17;e.t0=e["catch"](5);b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchFBRTCPeerConnection_setRemoteSDP",errorType:e.t0.toString()});throw e.t0;case 21:return e.abrupt("return",a);case 22:case"end":return e.stop()}},null,this,[[5,17]])};c.renegotiateDescriptionsForUnified=function(a,c){var d=this,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c.setPlanBRemoteDescription(a);e=c.toUnifiedPlan(a.toDesc());if(!(a.type==="answer")){h.next=11;break}f=c.getTrackTypesToMatchDescription();if(!(f.length>0)){h.next=11;break}f.forEach(function(a){a=d.$5.addTransceiver(a);a.direction="recvonly"});h.next=8;return b("regeneratorRuntime").awrap(this.createOffer());case 8:g=h.sent;h.next=11;return b("regeneratorRuntime").awrap(this.setLocalDescription(g));case 11:return h.abrupt("return",new(b("ScotchRTCSessionDescription"))(this.$6,e));case 12:case"end":return h.stop()}},null,this)};c.getLocalDescription=function(){return new(b("ScotchRTCSessionDescription"))(this.$6,this.$5.localDescription||{})};c.getRemoteDescription=function(){return new(b("ScotchRTCSessionDescription"))(this.$6,this.$5.remoteDescription||{})};c.getRemoteDescriptionForSMU=function(){var a=null;this.$11!=null&&(a=this.$11.getPlanBRemoteDescription());return a!=null?a:this.getRemoteDescription()};c.getSignalingState=function(){return this.$5.signalingState};c.getIceGatheringState=function(){return this.$5.iceGatheringState};c.getIceConnectionState=function(){return this.$5.iceConnectionState};c.getSenders=function(){return b("ZenonRTWebBrowserFeatureSupport").isGetSendersSupported()===!1?[]:this.$5.getSenders()};c.getReceivers=function(){return l("getReceivers")===!1?[]:this.$5.getReceivers()};c.processUnifiedTrackIdTranslation=function(a,b){this.$11!=null&&a!=null&&b!=null&&this.$11.correlateWebrtcTrackIdsByMid(a,b)};c.getWebrtcTrackIdFromMWTrackId=function(a){return this.$11!=null?this.$11.getWebrtcTrackIdFromMWTrackId(a):a};c.getStats=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.$5.getStats(a));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},null,this)};c.createDataChannel=function(a,b){if(this.$5.createDataChannel){a=this.$5.createDataChannel(a,b);this.$18(a);return a}return null};c.getDataChannelByLabel=function(a){return this.$3.find(function(b){return b.label===a})};c.getSdpMidMaps=function(){return{localSdpMap:this.$8,remoteSdpMap:this.$9}};c.getSdpSemantics=function(){return this.$10};c.supportsSimulcast=function(){return this.$12};c.getSsrcToSimulcastLayerMap=function(){return this.$13};return a}();e.exports=a;var g=b("UserAgent").isBrowser("Chrome < 59")||b("UserAgent").isBrowser("Opera < 46")||b("UserAgent").isBrowser("Firefox < 37"),h=b("UserAgent").isBrowser("Chrome < 38")||b("UserAgent").isBrowser("Opera < 26");function i(a){var b=a.offerToReceiveAudio;b=b===void 0?!0:b;var c=a.offerToReceiveVideo;c=c===void 0?!0:c;a=babelHelpers.objectWithoutPropertiesLoose(a,["offerToReceiveAudio","offerToReceiveVideo"]);return h?Object.keys(a).length>0?{mandatory:{OfferToReceiveAudio:b,OfferToReceiveVideo:c},optional:babelHelpers["extends"]({},m(a))}:{mandatory:{OfferToReceiveAudio:b,OfferToReceiveVideo:c}}:babelHelpers["extends"]({offerToReceiveAudio:b,offerToReceiveVideo:c},a)}var j=b("UserAgent").isBrowser("Chrome < 51")||b("UserAgent").isBrowser("Opera < 38")||b("UserAgent").isBrowser("Firefox < 37");function k(a){a&&a.signalingState!=="closed"&&a.close()}function l(a){return typeof b("RTCPeerConnection").prototype[a]==="function"}function m(a){var b={},c=Object.keys(a);for(var d=0;d<c.length;d++){var e=c[d],f=""+e.substr(0,1).toUpperCase()+e.substr(1);b[f]=a[e]}return b}function n(a,c){if(b("FBRTCConfig").isVCEndpointCall())return!1;a=a.video&&a.video.match(/H264/);if(!a&&!c.preserveH264){a=b("FBRTCExperiment").gen("rtc_browser_use_h264");return a.getParam("allow_h264","no")!=="yes"}return!1}function o(a,c,d){d===void 0&&(d={});var e=c.audio,f=c.video,g=a.sdp;n(c,d)&&(g=b("ScotchFBRTCSdpUtils").removeH264(g));e&&(g=b("ScotchFBRTCSdpUtils").preferCodec(g,e,!1));f&&(g=b("ScotchFBRTCSdpUtils").preferCodec(g,f,!0));return{sdp:g,type:a.type}}},null);
__d("ZenonLoggingContext",["React","unrecoverableViolation"],function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext({callID:null,callTrigger:"",codebaseVersion:"",deviceID:"",isCaller:null,isCheckpointDomainLogged:function(a){throw b("unrecoverableViolation")("isCheckpointDomainsLogged is not implemented!","rtc_www")},isErrorDomainLogged:function(a){throw b("unrecoverableViolation")("isErrorDomainLogged is not implemented!","rtc_www")},page:"",peerID:null,roomID:"",setCallTrigger:function(a){throw b("unrecoverableViolation")("setCallTrigger is not implemented!","rtc_www")},setCheckpointDomainLogged:function(a){throw b("unrecoverableViolation")("setCheckpointDomainsLogged is not implemented!","rtc_www")},setErrorDomainLogged:function(a){throw b("unrecoverableViolation")("setErrorDomainLogged is not implemented!","rtc_www")},setIsCaller:function(a){throw b("unrecoverableViolation")("setIsCaller is not implemented!","rtc_www")},startTimer:function(a){throw b("unrecoverableViolation")("startTimer is not implemented!","rtc_www")},stopTimer:function(a){throw b("unrecoverableViolation")("stopTimer is not implemented!","rtc_www")}});d=c;e.exports=d},null);
__d("ZenonLoggingSurfaceContext",["React"],function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext("call_container");e.exports=c},null);
__d("ZenonLoggingHooks",["FBLogger","FBRTCConsoleLogger","React","RtcWebUserActionsDebugFalcoEvent","RtcWebUserActionsFalcoEvent","ZenonCallsContext","ZenonCallsHooks","ZenonCallsModelTypes","ZenonLoggingContext","ZenonLoggingSurfaceContext"],function(a,b,c,d,e,f){"use strict";f.useSetIsCaller=a;f.useSetCallTrigger=c;f.useImpressionLogging=d;f.useClickLogging=e;f.useCheckpointLogging=h;f.useErrorLoggingOnceForDomain=i;f.useErrorLogging=j;f.useCheckpointLoggingOnceForDomain=k;f.useTimerLogging=l;var g=b("React");function a(){var a=g.useContext(b("ZenonLoggingContext"));return g.useCallback(function(b){a.setIsCaller(b)},[a])}function c(){var a=g.useContext(b("ZenonLoggingContext"));return g.useCallback(function(b){a.setCallTrigger(b)},[a])}function d(a){var b=n();g.useEffect(function(){b({component:a})},[a,b])}function e(a,b){var c=o();return g.useCallback(function(d){c({component:b});return a(d)},[a,b,c])}function h(){var a=p();return g.useCallback(function(b){return a({checkpoint:b})},[a])}function i(a){var c=g.useContext(b("ZenonLoggingContext")),d=c.isErrorDomainLogged,e=c.setErrorDomainLogged,f=m();return g.useCallback(function(c){d(a)||(e(a),f({errorDomain:a,errorType:c.toString()}),b("FBLogger")("rtc_www").catching(c).warn(a))},[a,d,f,e])}function j(){var a=m();return g.useCallback(function(c){var d=c.checkpoint,e=c.error;c=c.errorDomain;a({checkpoint:d,errorDomain:c,errorType:e.toString()});e instanceof Error?b("FBLogger")("rtc_www").catching(e).warn(d):b("FBLogger")("rtc_www").warn(d+"_"+e.toString())},[a])}function k(a){var c=g.useContext(b("ZenonLoggingContext")),d=c.isCheckpointDomainLogged,e=c.setCheckpointDomainLogged,f=p();return g.useCallback(function(){d(a)||(e(a),f({checkpoint:a}))},[a,d,f,e])}function l(a,c){var d=g.useContext(b("ZenonLoggingContext")),e=d.startTimer,f=d.stopTimer;d=g.useCallback(function(){return e(a)},[a,e]);var h=p(),i=g.useCallback(function(){var b;b=(b=c)!=null?b:a;var d=f(a);h({checkpoint:b+"_timerEnd",timeElapsed:d});return d},[c,h,a,f]);return[d,i]}function m(){var a=q();return g.useCallback(function(b){return a(babelHelpers["extends"]({eventName:"error"},b))},[a])}function n(){var a=q();return g.useCallback(function(b){return a(babelHelpers["extends"]({eventName:"impression"},b))},[a])}function o(){var a=q();return g.useCallback(function(b){return a(babelHelpers["extends"]({eventName:"tap"},b))},[a])}function p(){var a=q();return g.useCallback(function(b){return a(babelHelpers["extends"]({eventName:"checkpoint"},b))},[a])}function q(){var a=r();return g.useCallback(function(c){a(c,b("RtcWebUserActionsDebugFalcoEvent"));var d=a(c,b("RtcWebUserActionsFalcoEvent"));s(c.eventName,d)},[a])}function r(){var a=g.useContext(b("ZenonLoggingSurfaceContext")),c=b("ZenonCallsHooks").useCallState(),d=g.useContext(b("ZenonCallsContext")),e=g.useContext(b("ZenonLoggingContext")),f=b("ZenonCallsHooks").useIsAudioCall(),h=g.useRef(a),i=g.useRef(c),j=g.useRef(d),k=g.useRef(e),l=g.useRef(f);h.current=a;i.current=c;j.current=d;k.current=e;l.current=f;return g.useCallback(function(a,b){var c,d=j.current,e=d.calls,f=d.callSDK;d=d.currentClientCallId;f=f.getCallProtocolType_DEPRECATED(d);var g=l.current?"audio":"video";c=(c=k.current.callID)==null?void 0:c.toString();var m=k.current.roomID,n=k.current.isCaller,o=k.current.page,p=k.current.deviceID,q=k.current.callTrigger,r=k.current.codebaseVersion,s=k.current.peerID;d=(e=e.get(d))==null?void 0:e.collisionContext.serverInfoData;var w={call_id:c,call_trigger:q,call_type:t(f),checkpoint:a.checkpoint,client_time:Date.now().toString(),codebase_version:r,component:a.component,conference_name:m,conference_state:u(i.current),device_id:p,error_domain:a.errorDomain,error_type:a.errorType,event:a.eventName,event_time_elapsed:(e=a.timeElapsed)==null?void 0:e.toString(),is_caller:n,media_type:g,page:v(o),peer_id:s,server_info_data:d,surface:h.current};b.log(function(){return w});return w},[])}function s(a,c){a=a==null?"null":a;b("FBRTCConsoleLogger").getInstance().getLogHistory().log(a,JSON.stringify(c))}function t(a){switch(a){case"p2p":return"p2p";case"multiway":return"mw";default:return null}}function u(a){switch(a){case b("ZenonCallsModelTypes").ZenonCallState.New:return"NEW";case b("ZenonCallsModelTypes").ZenonCallState.Connecting:return"CONNECTING";case b("ZenonCallsModelTypes").ZenonCallState.Connected:return"CONNECTED";case b("ZenonCallsModelTypes").ZenonCallState.Terminating:return"TERMINATING";case b("ZenonCallsModelTypes").ZenonCallState.Terminated:return"TERMINATED";case b("ZenonCallsModelTypes").ZenonCallState.PendingApproval:return"PENDING_APPROVAL"}}function v(a){switch(a){case"messenger_dot_com":case"facebook":case"mweb":case"workplace":return a;default:return null}}},null);
__d("ZenonChevronIcon.react",["React"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){return g.jsx("svg",{className:a.className,viewBox:"0 0 8 28",children:g.jsx("path",{d:h(a.direction==="start",((a=document.body)==null?void 0:a.dir)==="rtl")?"M6 2L2 14l4 12":"M2 2l4 12-4 12",fill:"none"})})}function h(a,b){return a!==b}},null);
__d("ZenonSelfViewCollapsedAtom",["Recoil"],function(a,b,c,d,e,f){"use strict";a=b("Recoil").atom({"default":!1,key:"ZenonSelfViewCollapsed"});c=a;e.exports=c},null);
__d("ZenonSelfViewDarkenOverlay.react",["React","gkx","stylex"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){a=a.hovering;var c=b("gkx")("1376351");return h.jsx("div",{className:(g||(g=b("stylex"))).dedupe({"background-color-1":"n6pnak0z","bottom-1":"geq71ugt","end-1":"hnte7a8w","opacity-1":"qn324pbh","position-1":"alrytcbg","start-1":"r30xiam5","top-1":"m0q0jmkx","transition-duration-1":"fnft7yz3","transition-property-1":"s354ubxd","transition-timing-function-1":"obh9u62v"},c?{"border-top-start-radius-1":"f939mx11","border-top-end-radius-1":"l1er3j58","border-bottom-end-radius-1":"bb50dua7","border-bottom-start-radius-1":"do5ynftk"}:null,a?{"opacity-1":"ngf26f1o"}:null),"data-testid":void 0})}},null);
__d("ZenonSelfViewCameraTile.react",["fbt","React","Recoil","ZenonChevronIcon.react","ZenonExperiments","ZenonLoggingHooks","ZenonProfileImageRound.react","ZenonSelfViewCollapsedAtom","ZenonSelfViewDarkenOverlay.react","ZenonVideo.react","requireCond","stylex","usePrevious","cr:1376399"],function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(a){var c=a.hovering,d=a.isAudioMuted,e=a.isVideoMuted,f=a.onVideoError,i=a.onVideoReady,j=a.profilePictureUrl,k=a.stream,l=a.tileHeight;a=a.visible;var m=b("Recoil").useRecoilState(b("ZenonSelfViewCollapsedAtom")),n=m[0],o=m[1];b("ZenonLoggingHooks").useImpressionLogging("self_view");m=b("ZenonLoggingHooks").useClickLogging(function(){o(!n)},n?"self_view_unminimize":"self_view_minimize");var p=h.useRef(null),q=h.useState(l),r=q[0],s=q[1],t=h.useCallback(function(){if(p.current!==null&&!e){var a=p.current.getDimension(),b=a.height;a=a.width;if(a!==void 0&&a>0&&b!==void 0&&b>0){a=a/b;s(l*a)}}},[e,l]),u=b("ZenonLoggingHooks").useCheckpointLogging(),v=h.useCallback(function(){if(p.current!==null){var a=p.current.getDimension(),b=a.height;a=a.width;a!==void 0&&a>0&&b!==void 0&&b>0&&u("ZenonVideo: SelfView width:"+a+" height:"+b)}},[u]);q=(q=b("usePrevious")(a))!=null?q:!1;q=!q&&a;var w=!e&&k!==null,x=b("ZenonExperiments").shouldUseM4Buttons();h.useEffect(function(){o(e)},[e]);h.useEffect(function(){t()},[t]);var y=h.useCallback(function(){i(),t(),v()},[t,v,i]);return h.jsxs("button",{"aria-label":g._("{description}. {hint}",[g._param("description",d?g._("Your video, microphone muted"):g._("Your video, microphone on")),g._param("hint",n?g._("Click to show"):g._("Click to minimise"))]),className:(x?"do5ynftk bb50dua7 l1er3j58 f939mx11":"")+" hs7kmpfx pxsnkk09 l5wt5ig2 ggagh4we ruewosqj hgsucude rb9yzgxv gl66n4rk hpjrawbn jwazp5mb eojxk3nf c57me6gj d6kjcoho tg5ta3cq nfkmi1yv ndb5vzhq"+(a?"":" dlhm39sn")+(q?"":" qi0aauul risz2epz ay6cn6dd")+(n?" f3l8fepl t7n1rplc":""),"data-testid":void 0,onClick:m,style:{height:l,width:n?null:r},children:[x?h.jsx("div",{className:"m0q0jmkx r30xiam5 alrytcbg ocjcko58 foed1vyy sd0tyowg obh9u62v s354ubxd fnft7yz3 g0jqabx1",style:{height:l,width:r},children:h.jsx("div",{className:"alrytcbg",children:h.jsx(b("ZenonProfileImageRound.react"),{diameter:72,profilePictureUrl:j})})}):h.jsx("div",{className:"m0q0jmkx r30xiam5 alrytcbg ocjcko58 foed1vyy g0jqabx1 sd0tyowg obh9u62v s354ubxd fnft7yz3"+(w||!a?" qn324pbh":""),style:{height:l,width:r},children:h.jsx(b("ZenonProfileImageRound.react"),{diameter:72,profilePictureUrl:j})}),h.jsx(b("ZenonVideo.react"),{className:"k8t1dplf eheimbl6 l30l7tkp obh9u62v s354ubxd fnft7yz3"+(x?" do5ynftk bb50dua7 l1er3j58 f939mx11":"")+(n?" dlhm39sn":"")+(w?"":" qn324pbh"),"data-testid":void 0,muted:!0,onError:f,onReady:y,onResize:t,ref:p,stream:k}),h.jsx(b("cr:1376399"),{className:"mirs599h alrytcbg lptv2sst kian5wox"+(x?"":" m0q0jmkx hnte7a8w")+(x?" r30xiam5 geq71ugt":"")+" obh9u62v s354ubxd fnft7yz3"+(!d||n?" qn324pbh":""),shadow:!0}),h.jsx(b("ZenonSelfViewDarkenOverlay.react"),{hovering:c}),h.jsx("div",{className:"m0q0jmkx alrytcbg l30l7tkp foed1vyy sd0tyowg",children:h.jsx(b("ZenonChevronIcon.react"),{className:"r2dbpma5 el0elw3z cuxzjwz1 no2rrwty cbs720r5 r30xiam5 alrytcbg o2x6389i b80demol",direction:n?"start":"end"})})]})}},null);
__d("ZenonSelfViewScreenTile.react",["fbt","React","ZenonChevronIcon.react","ZenonLoggingHooks","ZenonSelfViewDarkenOverlay.react","ZenonVideo.react","gkx","stylex"],function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h,i=b("React");function a(a){var c=a.hovering,d=a.maxWidth,e=a.onClick,f=a.stream,j=a.tileHeight;a=i.useState(!1);var k=a[0],l=a[1];a=i.useState(!1);var m=a[0],n=a[1];i.useEffect(function(){return function(){l(!1)}},[f]);a=b("gkx")("1376351");var o=b("ZenonLoggingHooks").useClickLogging(function(){n(!m)},m?"self_view_unminimize":"self_view_minimize"),p=i.useRef(null),q=i.useState(j),r=q[0],s=q[1],t=i.useCallback(function(){if(p.current!==null){var a=p.current.getDimension(),b=a.height;a=a.width;if(a!==void 0&&a>0&&b!==void 0&&b>0){a=a/b;s(j*a)}}},[j]);i.useEffect(function(){t()},[t]);q=i.useCallback(function(){l(!0),t()},[t,l]);return i.jsxs("div",{className:"hs7kmpfx pxsnkk09 l5wt5ig2 ggagh4we ruewosqj hgsucude rb9yzgxv gl66n4rk hpjrawbn jwazp5mb eojxk3nf c57me6gj d6kjcoho tg5ta3cq nfkmi1yv ndb5vzhq qi0aauul risz2epz ay6cn6dd"+(k?"":" dlhm39sn")+(a?" do5ynftk bb50dua7 l1er3j58 f939mx11":"")+(m?" f3l8fepl t7n1rplc":""),"data-testid":void 0,style:{height:j,width:m?null:r},children:[i.jsx(b("ZenonVideo.react"),{className:"k8t1dplf l30l7tkp n6pnak0z obh9u62v s354ubxd fnft7yz3"+(a?" do5ynftk bb50dua7 l1er3j58 f939mx11":"")+(m?" dlhm39sn":""),"data-testid":void 0,maxWidth:d,muted:!0,onReady:q,onResize:t,ref:p,stream:f}),i.jsx(b("ZenonSelfViewDarkenOverlay.react"),{hovering:c}),i.jsx("button",{"aria-label":g._("{description} {hint}",[g._param("description",g._("Your screen,")),g._param("hint",m?g._("click to show."):g._("click to minimise."))]),className:"f5zavhip m0q0jmkx r30xiam5 alrytcbg p3f4w9ai foed1vyy t46uw55m f481skqt epyemlxq m2b8ij95 ndb5vzhq sd0tyowg"+(a?" do5ynftk bb50dua7 l1er3j58 f939mx11":""),onClick:o,children:i.jsx(b("ZenonChevronIcon.react"),{className:"r2dbpma5 el0elw3z cuxzjwz1 no2rrwty cbs720r5 r30xiam5 alrytcbg o2x6389i b80demol",direction:m?"start":"end"})}),i.jsx("button",{"aria-label":g._("Click to stop sharing screen."),className:(h||(h=b("stylex"))).dedupe({"align-items-1":"sd0tyowg","background-color-1":"ndb5vzhq","border-top-0.3":"jiemks8r","border-end-0.3":"a7z00p6d","border-bottom-0.3":"qgy4q07g","border-start-0.3":"tvebpkc0","border-top-start-radius-1":"or10ahs5","border-top-end-radius-1":"s31a3zng","border-bottom-end-radius-1":"i9eqajil","border-bottom-start-radius-1":"l49hbic2","box-sizing-1":"g7usbkpd","color-1":"dyco0h0g","cursor-1":"di6nqzxa","display-1":"foed1vyy","flex-direction-1":"t7elcel3","height-1":"i66iyt61","justify-content-1":"ocjcko58","margin-start-1":"anqa7qcz","margin-top-1":"k3qu3w0j","min-width-1":"kmhx4zvy","position-1":"alrytcbg","start-1":"rw8jrik7","top-1":"sdy8ra2n"},{"transition-duration-1":"fnft7yz3","transition-property-1":"s354ubxd","transition-timing-function-1":"obh9u62v"},c?null:{"opacity-1":"qn324pbh"},m?{"display-1":"dlhm39sn"}:null),"data-testid":void 0,onClick:e,children:g._("Stop")})]})}},null);
__d("ZenonSelfView.react",["React","ZenonExperiments","ZenonSelfViewCameraTile.react","ZenonSelfViewScreenTile.react","emptyFunction","stylex"],function(a,b,c,d,e,f){"use strict";var g=b("React"),h=16/9;function a(a,c){var d=a.cameraStream,e=a.isAudioMuted,f=a.isVideoMuted,i=a.onStopScreenSharingClick;i=i===void 0?b("emptyFunction"):i;var j=a.profilePictureUrl,k=a.screenStream;a=a.tileHeight;var l=g.useState(!1),m=l[0],n=l[1];l=g.useState(!1);var o=l[0],p=l[1];g.useEffect(function(){d===null&&p(!1)},[d]);l=g.useCallback(function(){p(!0)},[]);var q=b("ZenonExperiments").shouldUseM4Buttons();return g.jsxs("div",{className:"thscx07h fbttax1d op7tdfk2 hpjrawbn duj1if5x eojxk3nf foed1vyy di6nqzxa"+(q?" do5ynftk bb50dua7 l1er3j58 f939mx11":"")+" obh9u62v s354ubxd fnft7yz3"+(!o&&k===null?" qn324pbh":""),"data-testid":void 0,onMouseEnter:g.useCallback(function(){n(!0)},[]),onMouseLeave:g.useCallback(function(){n(!1)},[]),ref:c,style:{height:a},children:[k?g.jsx(b("ZenonSelfViewScreenTile.react"),{hovering:m,maxWidth:a*h,onClick:i,stream:k,tileHeight:a}):null,d?g.jsx(b("ZenonSelfViewCameraTile.react"),{hovering:m,isAudioMuted:e,isVideoMuted:f,onVideoError:l,onVideoReady:l,profilePictureUrl:(q=j)!=null?q:null,stream:d,tileHeight:a,visible:o}):null]})}c=g.forwardRef(a);e.exports=c},null);
__d("ZenonSelfViewContainer.react",["CurrentUser","React","ZenonCallsContext","ZenonCallsHooks","ZenonLoggingHooks","ZenonSelfView.react","ZenonUsersHooks","ZenonStyleHooks","ZenonStyleContext"],function(a,b,c,d,e,f){"use strict";var g=b("React"),h=b("ZenonCallsHooks").useLocalAudio,i=b("ZenonCallsHooks").useLocalScreen,j=b("ZenonCallsHooks").useLocalVideo,k=function(a){switch(a){case b("ZenonStyleContext").WindowStyle.Large:return 200;case b("ZenonStyleContext").WindowStyle.Medium:return 150;case b("ZenonStyleContext").WindowStyle.Small:case b("ZenonStyleContext").WindowStyle.Compact:return 92;case b("ZenonStyleContext").WindowStyle.MiniView:return 60}};function a(a,c){a=b("ZenonUsersHooks").useZenonUser(b("CurrentUser").getID());var d=h(),e=j(),f=i(),l=b("ZenonLoggingHooks").useCheckpointLogging(),m=g.useContext(b("ZenonCallsContext")),n=m.callSDK,o=m.currentClientCallId;m=b("ZenonCallsHooks").useSupportMultipleStreams();var p=b("ZenonStyleHooks").useWindowStyle();p=k(p);return g.jsx(b("ZenonSelfView.react"),{cameraStream:m||!f?(m=e==null?void 0:e.webrtcStream)!=null?m:null:null,isAudioMuted:!((m=d==null?void 0:d.enabled)!=null?m:!0),isVideoMuted:!((d=e==null?void 0:e.enabled)!=null?d:!0),onStopScreenSharingClick:g.useCallback(function(){f&&(l("screen_sharing_stop"),n.removeLocalTrack(o,f.trackId))},[n,o,f,l]),profilePictureUrl:(m=a==null?void 0:a.profilePictureUrl)!=null?m:null,ref:c,screenStream:(e=f==null?void 0:f.webrtcStream)!=null?e:null,tileHeight:p})}c=g.forwardRef(a);e.exports=c},null);
__d("ZenonFooterLabeledButton.react",["React","ZenonAbstractButton.react","ZenonStyleContext","ZenonStyleHooks","joinClasses","stylex"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){var c=a.disabled;c=c===void 0?!1:c;var d=a.label,e=a.labelColor,f=a.themeClassNames;a=babelHelpers.objectWithoutPropertiesLoose(a,["disabled","label","labelColor","themeClassNames"]);var j=b("ZenonStyleHooks").useButtonSize();j=j===b("ZenonStyleContext").ButtonSize.Large?i.large:j===b("ZenonStyleContext").ButtonSize.Small?i.small:i.medium;var k=b("ZenonStyleHooks").useFont();return h.jsxs("div",{className:(g||(g=b("stylex")))(i.buttonSpace),children:[h.jsx(b("ZenonAbstractButton.react"),babelHelpers["extends"]({className:b("joinClasses")(f,g(i.root,j,c?i.disabled:i.enabled)),"data-hover":"none",disabled:c,label:d},a)),h.jsx("div",{className:b("joinClasses")(e,g(i.buttonLabel,k===b("ZenonStyleContext").Font.M4&&i.m4Font)),children:d})]})}var i={buttonLabel:{marginTop:"qql18x7w"},buttonSpace:{display:"ra7dho7y"},disabled:{cursor:"q1b3xtip"},enabled:{cursor:"di6nqzxa"},large:{height:"h2ube01z",marginTop:"eojxk3nf",marginEnd:"ma8itso7",marginBottom:"hpjrawbn",marginStart:"l18enhar",width:"s92jnjdw"},m4Font:{fontSize:"s30tea04",lineHeight:"n4e9g8kl"},medium:{height:"lptv2sst",marginTop:"eojxk3nf",marginEnd:"p42dirnl",marginBottom:"hpjrawbn",marginStart:"m088clv2",width:"mirs599h"},root:{display:"ra7dho7y",textDecoration:"i80c910l",whiteSpace:"ah27w7js",borderTopStartRadius:"aew9upud",borderTopEndRadius:"a83566g4",borderBottomEndRadius:"h6hzo99s",borderBottomStartRadius:"fcqeik31",overflowX:"rb9yzgxv",overflowY:"hgsucude",pointerEvents:"fbttax1d",transitionProperty:"dctssvuh",transitionDuration:"ajhy1zej",willChange:"cga8r29z",paddingTop:"ruewosqj",paddingEnd:"ggagh4we",paddingBottom:"l5wt5ig2",paddingStart:"pxsnkk09",borderTopWidth:"sx6w6q81",borderEndWidth:"m6mjsuy5",borderBottomWidth:"d9ld5tmb",borderStartWidth:"g7qt043t",borderTopStyle:"ip84sjpb",borderEndStyle:"k8jac56g",borderBottomStyle:"qx2l0eg4",borderStartStyle:"rw0juz62"},small:{height:"ldmaiw43",marginTop:"eojxk3nf",marginEnd:"ma8itso7",marginBottom:"hpjrawbn",marginStart:"l18enhar",width:"smcs1li6"}}},null);
__d("ZenonAcceptVideoEscalationFooterButton.react",["fbt","React","ZenonFooterLabeledButton.react","ZenonLoggingHooks","ZenonThemeContext","ZenonWithTooltip.react","requireCond","stylex","cr:1376392"],function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(a){var c=a.disabled;c=c===void 0?!1:c;var d=a.label,e=a.onClick;a=a.toolTip;var f=h.useContext(b("ZenonThemeContext"));f=f==="light"?"c89si7am":"dyco0h0g";b("ZenonLoggingHooks").useImpressionLogging("video_escalate_accept");e=b("ZenonLoggingHooks").useClickLogging(e,"video_escalate_accept");d=(d=d)!=null?d:g._("Accept");c=h.jsx(b("ZenonFooterLabeledButton.react"),{"data-testid":void 0,disabled:c,label:d,labelColor:f,onClick:e,themeClassNames:"tcfs3m6z osrkypuz j985830a nxe5nuwb k0wp8trf gnr7189n ek9wyhim s2jnn2op",children:h.jsx(b("cr:1376392"),{className:"hz965sd9 ehi1kzmu i0i9u5yc pr0mtg1e svuzmm7t g0javuny nkafkkgu qukc8cf6"})});return a!==null?h.jsx(b("ZenonWithTooltip.react"),{tooltip:a,children:c}):h.jsx(h.Fragment,{children:c})}},null);
__d("ZenonAcceptVideoEscalationButtonContainer.react",["fbt","React","ZenonAcceptVideoEscalationFooterButton.react","ZenonButtonThrottledClick","ZenonCallsHooks","ZenonCallsModelTypes","gkx"],function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(){var a=b("ZenonCallsHooks").useVideoEscalationStatus(),c=b("ZenonCallsHooks").useAcceptVideoEscalation(),d=h.useCallback(function(){return c()},[c]),e=b("ZenonCallsHooks").useIsP2P_TEMP()&&b("gkx")("1758634"),f=e?g._("To enable video, end this call and start a video call."):null;return h.jsx(b("ZenonAcceptVideoEscalationFooterButton.react"),{disabled:a===b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.Accepted||e,onClick:b("ZenonButtonThrottledClick").useButtonThrottledClick(d),toolTip:f})}},null);
__d("ZenonDeclineVideoEscalationFooterButton.react",["fbt","React","ZenonExperiments","ZenonFooterLabeledButton.react","ZenonLoggingHooks","ZenonThemeContext","ZenonXIcon.react","stylex"],function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h,i=b("React");function a(a){var c=a.disabled;c=c===void 0?!1:c;var d=a.label;a=a.onClick;var e=i.useContext(b("ZenonThemeContext"));e=e==="light"?"c89si7am":"dyco0h0g";b("ZenonLoggingHooks").useImpressionLogging("video_escalate_decline");a=b("ZenonLoggingHooks").useClickLogging(a,"video_escalate_decline");d=(d=d)!=null?d:g._("Decline");var f=b("ZenonExperiments").shouldUseM4Buttons();return i.jsx(b("ZenonFooterLabeledButton.react"),{"data-testid":void 0,disabled:c,label:d,labelColor:e,onClick:a,themeClassNames:(h||(h=b("stylex"))).dedupe(f?{"background-color-1":"oklsrz6c","border-top-color-0.4":"ek9wyhim","border-end-color-0.4":"gnr7189n","border-bottom-color-0.4":"k0wp8trf","border-start-color-0.4":"nxe5nuwb","color-1":"j985830a","background-color-10":"ahe5v5kc","color-10":"tcfs3m6z"}:{"background-color-1":"cvbsb0mp","border-top-color-0.4":"h9bf5znu","border-end-color-0.4":"k6nmzn78","border-bottom-color-0.4":"pzngizxp","border-start-color-0.4":"hi6abz6u","color-1":"kzkqk8lu","background-color-10":"cikbfkbc","border-top-color-9.4":"btp3y9py","border-end-color-9.4":"c873y8w0","border-bottom-color-9.4":"cdlalhei","border-start-color-9.4":"iu9o5v6e"}),children:i.jsx(b("ZenonXIcon.react"),{className:"hz965sd9 ehi1kzmu i0i9u5yc pr0mtg1e svuzmm7t g0javuny nkafkkgu qukc8cf6"})})}},null);
__d("ZenonDeclineVideoEscalationButtonContainer.react",["React","ZenonButtonThrottledClick","ZenonCallsHooks","ZenonCallsModelTypes","ZenonDeclineVideoEscalationFooterButton.react"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=b("ZenonCallsHooks").useVideoEscalationStatus(),c=b("ZenonCallsHooks").useDeclineVideoEscalation(),d=g.useCallback(function(){return c()},[c]);return g.jsx(b("ZenonDeclineVideoEscalationFooterButton.react"),{disabled:a===b("ZenonCallsModelTypes").ZenonVideoEscalationStatus.Accepted,onClick:b("ZenonButtonThrottledClick").useButtonThrottledClick(d)})}},null);
__d("ZenonChatPanelIcon.react",["React","ZenonOptionalDropShadowFilter.react"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){return g.jsx("svg",{className:a.className,viewBox:"0 0 50 50",children:g.jsx(b("ZenonOptionalDropShadowFilter.react"),{height:24,shadow:!!a.shadow,width:24,children:g.jsx("path",{d:"M24.999 35.986c-1.162 0-2.269-.103-3.307-.357a4.647 4.647 0 0 0-2.608.098l-4.001 1.228c-.645.22-1.27-.406-1.052-1.075l.795-2.63a3.28 3.28 0 0 0-.318-2.728c-1.056-1.725-1.507-3.786-1.508-6.067C13.001 17.795 18.026 13 24.999 13c6.974 0 11.999 4.795 12 11.453-.002 6.66-5.026 11.533-12 11.533z"})})})}},null);
__d("ZenonChatHeaderButton.react",["React","ZenonChatPanelIcon.react","ZenonExperiments","ZenonLoggingHooks","ZenonThemeContext","requireCond","stylex","cr:1431514"],function(a,b,c,d,e,f){"use strict";var g,h=b("React");function a(a,c){var d=a.label;a=a.onClick;b("ZenonLoggingHooks").useImpressionLogging("toggle_chat");a=b("ZenonLoggingHooks").useClickLogging(a,"toggle_chat");var e=h.useContext(b("ZenonThemeContext")),f=b("ZenonExperiments").displayNewLayoutAndDarkTheme(),j=e==="dark";e=e==="light";return h.jsx(b("cr:1431514"),{"data-testid":void 0,disabled:!1,label:d,onClick:a,ref:c,themeClassNames:(g||(g=b("stylex")))(f&&i.shadow,f?i.fill:e?i.headerLight:i.headerDark),children:h.jsx(b("ZenonChatPanelIcon.react"),{className:g(i.buttonIcon),shadow:!f&&j})})}var i={buttonIcon:{display:"qukc8cf6",fill:"nkafkkgu",stroke:"hz965sd9"},fill:{backgroundColor:"f6xbwjrt",borderTopColor:"ek9wyhim",borderEndColor:"gnr7189n",borderBottomColor:"k0wp8trf",borderStartColor:"nxe5nuwb",color:"dyco0h0g",":active":{backgroundColor:"j6xmpfkq"},":hover":{backgroundColor:"pcwd6mxu"}},headerDark:{backgroundColor:"ndb5vzhq",color:"dyco0h0g"},headerLight:{color:"n2lt2jnd"},shadow:{boxShadow:"mc84s5ar"}};c=h.forwardRef(a);e.exports=c},null);
__d("ZenonToggleChatNuxContainer.react",["fbt","React","XUIAmbientNUX.react","ZenonExperiments","ZenonNuxHooks"],function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(a){var c=a.buttonRef;a=b("ZenonNuxHooks").useNux(7736);var d=a[0];a=a[1];var e=b("ZenonExperiments").displayNewLayoutAndDarkTheme()?"above":"below";return h.jsx(b("XUIAmbientNUX.react"),{alignment:"left",contextRef:h.useCallback(function(){return c.current},[c]),offsetX:4,onCloseButtonClick:a,position:e,shown:d,width:"auto",children:g._("Open chat window.")})}},null);
__d("ZenonChatButtonContainer.react",["fbt","React","ZenonAppFeaturesHooks","ZenonButtonThrottledClick","ZenonCallsContext","ZenonChatHeaderButton.react","ZenonChatHooks","ZenonExperiments","ZenonToggleChatNuxContainer.react"],function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function i(){var a=h.useContext(b("ZenonCallsContext")),c=a.callSDK;a=a.currentClientCallId;c=c.getCallProtocolType_DEPRECATED(a);a=c==="p2p"||c==="multiway"&&b("ZenonExperiments").shouldUseChatInGroupCalls();var d=b("ZenonChatHooks").useChatWindowVisible(),e=d[0],f=d[1];d=b("ZenonButtonThrottledClick").useButtonThrottledClick(h.useCallback(function(){f(!0)},[f]));var i=h.useRef(null);if(e)return null;else return a?h.jsxs(h.Fragment,{children:[h.jsx(b("ZenonChatHeaderButton.react"),{label:g._("Open Chat"),onClick:d,ref:i})," ",c!=="p2p"?h.jsx(b("ZenonToggleChatNuxContainer.react"),{buttonRef:i}):null]}):null}function a(){return b("ZenonAppFeaturesHooks").useChatEnabled()?h.jsx(i,{}):null}},null);
__d("ZenonResizeDownIcon.react",["React"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){return g.jsx("svg",{className:a.className,viewBox:"0 0 36 36",children:g.jsx("path",{d:"M10.064 23.838L8.298 22.07a1 1 0 01.51-1.688l7.001-1.355a.998.998 0 011.175 1.176L15.63 27.21a.999.999 0 01-1.685.512l-1.757-1.758-3.76 3.759a1.002 1.002 0 01-1.416 0l-.709-.709a1.003 1.003 0 010-1.417l3.76-3.76zm8.961-8.025l1.356-6.998a1.001 1.001 0 011.688-.51l1.758 1.755 3.765-3.754a1.005 1.005 0 011.42 0l.708.707a.997.997 0 010 1.415l-3.765 3.755 1.768 1.766a.998.998 0 01-.511 1.685l-7.01 1.353a.998.998 0 01-1.177-1.174z",fillRule:"evenodd"})})}},null);
__d("ZenonResizeUpIcon.react",["React"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){return g.jsx("svg",{className:a.className,viewBox:"0 0 36 36",children:g.jsx("path",{d:"M12.955 25.184l1.768 1.765a.998.998 0 01-.511 1.685l-7.01 1.353a.998.998 0 01-1.177-1.174l1.356-6.997a1.001 1.001 0 011.688-.512l1.758 1.756 3.765-3.754a1.006 1.006 0 011.419 0l.71.707a.998.998 0 010 1.415l-3.766 3.756zM29.984 7.2L28.628 14.2a1.001 1.001 0 01-1.688.512l-1.759-1.756-3.764 3.754c-.392.39-1.028.39-1.42 0l-.709-.707a.998.998 0 010-1.415l3.766-3.756-1.769-1.765a.998.998 0 01.512-1.685l7.01-1.354a.998.998 0 011.177 1.174z",fillRule:"evenodd"})})}},null);
__d("ZenonToggleLayoutOverlay.react",["React","ShimButton.react","ZenonFadeOnIdle.react","ZenonResizeDownIcon.react","ZenonResizeUpIcon.react","gkx","stylex"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.onClick;a=a.showExpand;var e=g.useState(!1),f=e[0],h=e[1];e=g.useCallback(function(){return h(!0)},[h]);var i=g.useCallback(function(){return h(!1)},[h]),j=null;f&&(a?b("gkx")("1636150")||(j=g.jsx(b("ZenonFadeOnIdle.react"),{children:g.jsx("div",{className:"m0q0jmkx r30xiam5 alrytcbg ocjcko58 hnte7a8w foed1vyy geq71ugt sd0tyowg z3jnf08k",children:g.jsx(b("ZenonResizeUpIcon.react"),{className:"ebn1mt6t dgryc8og ri7cljcl"})})})):j=g.jsx(b("ZenonFadeOnIdle.react"),{children:g.jsx("div",{className:"m0q0jmkx r30xiam5 alrytcbg ocjcko58 hnte7a8w foed1vyy geq71ugt sd0tyowg",children:g.jsx("div",{className:"ebn1mt6t fyi946na ebucrlxy iuwz3gim l0x5e6ug dgryc8og fcqeik31 h6hzo99s a83566g4 aew9upud z3jnf08k",children:g.jsx(b("ZenonResizeDownIcon.react"),{className:"ebn1mt6t dgryc8og ri7cljcl"})})})}));return g.jsxs(b("ShimButton.react"),{className:"f5zavhip hs7kmpfx p3f4w9ai",onClick:d,onMouseEnter:e,onMouseLeave:i,onMouseOver:e,children:[c,j]})}},null);
__d("ZenonToggleLayoutOverlayContainer.react",["React","ZenonLayout","ZenonLayoutHooks","ZenonLoggingHooks","ZenonToggleLayoutOverlay.react"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.userID;a=b("ZenonLayoutHooks").useCanSetLayout();var e=b("ZenonLayoutHooks").useLayout(),f=e[0],h=e[1];e=b("ZenonLayoutHooks").usePinnedSpeakerID();e[0];var i=e[1];e=g.useCallback(function(){switch(f){case b("ZenonLayout").Grid:h(b("ZenonLayout").DominantSpeaker);i(d);break;case b("ZenonLayout").DominantSpeaker:h(b("ZenonLayout").Grid);break}},[f,h,i,d]);e=b("ZenonLoggingHooks").useClickLogging(e,"video_layout_switch");return!a?c:g.jsx(b("ZenonToggleLayoutOverlay.react"),{onClick:e,showExpand:f===b("ZenonLayout").Grid,children:c})}},null);
__d("ZenonMenuButton.react",["ix","fbt","Image.react","React","ShimButton.react","asset","stylex"],function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React"),j=h._("Menu options");function a(a){var c;return i.jsx(b("ShimButton.react"),{"aria-label":j,className:a.className,label:j,onBlur:a.onBlur,onClick:(c=a.onClick)!=null?c:k,onRef:a.onRef,role:"presentation",children:i.jsx(b("Image.react"),{className:"aeg9wcf4 bb9rp2hf",src:g("621636")})})}function k(a){a.stopPropagation()}},null);
__d("useContentRect",["React","useResizeObserver"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=g.useState(null),c=a[0],d=a[1];a=g.useCallback(function(a){return d(a)},[]);a=b("useResizeObserver")(a);return[c,a]}},null);
__d("ZenonCenteredWithAside.react",["React","gkx","stylex","useContentRect"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=b("useContentRect")(),d=c[0];c=c[1];var e=b("useContentRect")(),f=e[0];e=e[1];var i="auto";if(a.startAside!==null){var j;j=(j=d==null?void 0:d.width)!=null?j:0;f=(f=f==null?void 0:f.width)!=null?f:0;i=j>f?j:f!==0?f:"auto"}else{i=(j=d==null?void 0:d.width)!=null?j:"auto"}return g.jsxs("div",{className:"dncz0pse foed1vyy"+(a.align==="bottom"?" iqvxn7wm":""),children:[a.startAside!==null?g.jsx(h,{className:"mgj6it3g foed1vyy",flexBasis:i,ref:e,children:a.startAside}):g.jsx("div",{className:"c8wj6tg8",style:{flexBasis:i}}),g.jsx("div",{className:"tmim2xmv",children:a.children}),g.jsx(h,{className:"gdwkc3y8 foed1vyy",flexBasis:i,ref:c,children:a.endAside})]})}var h=g.forwardRef(function(a,c){var d=a.className,e=a.flexBasis;return b("gkx")("1117772")?g.jsx("div",{className:d,style:{flexBasis:e},children:g.jsx("div",{className:"swy5yuy3 qsdyjm8m dl6wuu1c",ref:c,children:a.children})}):g.jsx("div",{className:d,ref:c,style:{flexBasis:e},children:a.children})})},null);
__d("ZenonFooterAside.react",["React","stylex"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var b=a.buttons,c=a.remoteView;a=a.selfView;return g.jsxs("div",{className:"ictdia2t bgwf36b8 r5baciwu nu47e99o muiqotw9 c8wj6tg8 o41g1cp1 foed1vyy"+(c!=null?" hgsucude rb9yzgxv":""),children:[a!=null?g.jsx("div",{className:"bsmblwdv bldip169 e5ixzc7a hf4nqxtf c8wj6tg8",children:a}):null,c!=null?g.jsx("div",{className:"hgsucude rb9yzgxv c8wj6tg8 t7elcel3 foed1vyy iqvxn7wm",children:c}):null,b!=null?g.jsx("div",{className:"rpihpz28 jp9kvoz7 p42dirnl eojxk3nf gdwkc3y8 tmim2xmv t7elcel3 foed1vyy",children:b}):null]})}},null);
__d("ZenonStartFooterAside.react",["React","stylex"],function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){a=a.chatButton;return g.jsx("div",{className:"mgj6it3g tmim2xmv t7elcel3 foed1vyy",children:a!==null?g.jsx("div",{className:"l18enhar siwqgy3p",children:a}):null})}},null);
__d("ArchonAppBridge",[],function(a,b,c,d,e,f){f.isArchon=a;function a(){return Boolean(window.__archonBridge)}b=window.__archonBridge;f.archonAppBridge=b},null);
__d("WebSessionExtensionTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:WebSessionExtensionLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:WebSessionExtensionLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:WebSessionExtensionLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setClientTime=function(a){this.$1.client_time=a;return this};c.setReason=function(a){this.$1.reason=a;return this};c.setWebsessionID=function(a){this.$1.websession_id=a;return this};return a}();c={client_time:!0,reason:!0,websession_id:!0};e.exports=a},null);
__d("fbjs/lib/ExecutionEnvironment",["ExecutionEnvironment"],function(a,b,c,d,e,f){"use strict";e.exports=b("ExecutionEnvironment")},null);
__d("getVendorPrefixedEventName",["fbjs/lib/ExecutionEnvironment"],function(a,b,c,d,e,f){"use strict";function a(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;c["ms"+a]="MS"+b;c["O"+a]="o"+b.toLowerCase();return c}var g={animationend:a("Animation","AnimationEnd"),animationiteration:a("Animation","AnimationIteration"),animationstart:a("Animation","AnimationStart"),transitionend:a("Transition","TransitionEnd")},h={},i={};b("fbjs/lib/ExecutionEnvironment").canUseDOM&&(i=document.createElement("div").style,"AnimationEvent"in window||(delete g.animationend.animation,delete g.animationiteration.animation,delete g.animationstart.animation),"TransitionEvent"in window||delete g.transitionend.transition);function c(a){if(h[a])return h[a];else if(!g[a])return a;var b=g[a];for(var c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&c in i)return h[a]=b[c];return""}e.exports=c},null);
__d("ReactTransitionChildMapping",["React","emptyFunction","warning"],function(a,b,c,d,e,f){"use strict";var g=b("React");a=b("emptyFunction");c={getChildMapping:function(a){if(!a)return a;var b={};g.Children.toArray(a).forEach(function(a){var c=a.key,d=b[c]===void 0;d&&(b[c]=a)});return b},mergeChildMappings:function(a,b){a=a||{};b=b||{};function c(c){if(Object.prototype.hasOwnProperty.call(b,c))return b[c];else return a[c]}var d={},e=[];for(var f in a)Object.prototype.hasOwnProperty.call(b,f)?e.length&&(d[f]=e,e=[]):e.push(f);var g,h={};for(var i in b){if(Object.prototype.hasOwnProperty.call(d,i))for(g=0;g<d[i].length;g++){var j=d[i][g];h[d[i][g]]=c(j)}h[i]=c(i)}for(g=0;g<e.length;g++)h[e[g]]=c(e[g]);return h}};e.exports=c},null);
__d("ReactTransitionEvents",["fbjs/lib/ExecutionEnvironment","getVendorPrefixedEventName"],function(a,b,c,d,e,f){"use strict";var g=[];function a(){var a=b("getVendorPrefixedEventName")("animationend"),c=b("getVendorPrefixedEventName")("transitionend");a&&g.push(a);c&&g.push(c)}b("fbjs/lib/ExecutionEnvironment").canUseDOM&&a();function h(a,b,c){a.addEventListener(b,c,!1)}function i(a,b,c){a.removeEventListener(b,c,!1)}c={addEndEventListener:function(a,b){if(g.length===0){window.setTimeout(b,0);return}g.forEach(function(c){h(a,c,b)})},removeEndEventListener:function(a,b){if(g.length===0)return;g.forEach(function(c){i(a,c,b)})}};e.exports=c},null);
__d("ReactTransitionGroup",["React","ReactTransitionChildMapping","fbjs/lib/emptyFunction","prop-types"],function(a,b,c,d,e,f){"use strict";var g=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.currentlyTransitioningKeys={},d.keysToEnter=[],d.keysToLeave=[],d.state={children:b("ReactTransitionChildMapping").getChildMapping(d.props.children)},d.performEnter=function(a){d.currentlyTransitioningKeys[a]=!0;var b=d.refs[a];b.componentWillEnter?b.componentWillEnter(d.$2.bind(babelHelpers.assertThisInitialized(d),a)):d.$2(a)},d.performLeave=function(a){d.currentlyTransitioningKeys[a]=!0;var b=d.refs[a];b.componentWillLeave?b.componentWillLeave(d.$3.bind(babelHelpers.assertThisInitialized(d),a)):d.$3(a)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.UNSAFE_componentWillMount=function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]};d.componentDidMount=function(){var a=this.state.children;for(var b in a)a[b]&&this.performAppear(b)};d.UNSAFE_componentWillReceiveProps=function(a){a=b("ReactTransitionChildMapping").getChildMapping(a.children);var c=this.state.children;this.setState({children:b("ReactTransitionChildMapping").mergeChildMappings(c,a)});var d;for(d in a){var e=c&&Object.prototype.hasOwnProperty.call(c,d);a[d]&&!e&&!this.currentlyTransitioningKeys[d]&&this.keysToEnter.push(d)}for(d in c){e=a&&Object.prototype.hasOwnProperty.call(a,d);c[d]&&!e&&!this.currentlyTransitioningKeys[d]&&this.keysToLeave.push(d)}};d.componentDidUpdate=function(){var a=this.keysToEnter;this.keysToEnter=[];a.forEach(this.performEnter);a=this.keysToLeave;this.keysToLeave=[];a.forEach(this.performLeave)};d.performAppear=function(a){this.currentlyTransitioningKeys[a]=!0;var b=this.refs[a];b.componentWillAppear?b.componentWillAppear(this.$1.bind(this,a)):this.$1(a)};d.$1=function(a){var c=this.refs[a];c.componentDidAppear&&c.componentDidAppear();delete this.currentlyTransitioningKeys[a];c=b("ReactTransitionChildMapping").getChildMapping(this.props.children);(!c||!Object.prototype.hasOwnProperty.call(c,a))&&this.performLeave(a)};d.$2=function(a){var c=this.refs[a];c.componentDidEnter&&c.componentDidEnter();delete this.currentlyTransitioningKeys[a];c=b("ReactTransitionChildMapping").getChildMapping(this.props.children);(!c||!Object.prototype.hasOwnProperty.call(c,a))&&this.performLeave(a)};d.$3=function(a){var c=this.refs[a];c.componentDidLeave&&c.componentDidLeave();delete this.currentlyTransitioningKeys[a];c=b("ReactTransitionChildMapping").getChildMapping(this.props.children);c&&Object.prototype.hasOwnProperty.call(c,a)?this.performEnter(a):this.setState(function(b){b=Object.assign({},b.children);delete b[a];return{children:b}})};d.render=function(){var a=[];for(var b in this.state.children){var c=this.state.children[b];c&&a.push(g.cloneElement(this.props.childFactory(c),{ref:b,key:b}))}c=Object.assign({},this.props);delete c.transitionLeave;delete c.transitionName;delete c.transitionAppear;delete c.transitionEnter;delete c.childFactory;delete c.transitionLeaveTimeout;delete c.transitionEnterTimeout;delete c.transitionAppearTimeout;delete c.component;return g.createElement(this.props.component,c,a)};return c}(g.Component);a.displayName="ReactTransitionGroup";a.propTypes={component:b("prop-types").any,childFactory:b("prop-types").func};a.defaultProps={children:null,component:"span",childFactory:b("fbjs/lib/emptyFunction").thatReturnsArgument};e.exports=a},null);
__d("WebSessionExtender",["WebSession","WebSessionExtensionTypedLogger","clearInterval","gkx","setInterval"],function(a,b,c,d,e,f){"use strict";f.subscribe=a;f.unsubscribe=c;var g=2e4,h=new Set(),i=null;function a(a,c){c===void 0&&(c="extender");h.add(a);var d=b("gkx")("1252196");i==null&&(b("WebSession").extend(Date.now()+g+2e3),i=b("setInterval")(function(){b("WebSession").extend(Date.now()+g+2e3),d&&new(b("WebSessionExtensionTypedLogger"))().setClientTime(Date.now()).setWebsessionID(b("WebSession").getId()).setReason(c).log()},g))}function c(a){h["delete"](a);a=h.size;a===0&&i!=null&&(b("clearInterval")(i),i=null)}},null);